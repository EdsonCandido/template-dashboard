import{c as bt,g as It}from"./@babel-EnWrEA7o.js";function wt(ut,vt){for(var j=0;j<vt.length;j++){const h=vt[j];if(typeof h!="string"&&!Array.isArray(h)){for(const d in h)if(d!=="default"&&!(d in ut)){const m=Object.getOwnPropertyDescriptor(h,d);m&&Object.defineProperty(ut,d,m.get?m:{enumerable:!0,get:()=>h[d]})}}}return Object.freeze(Object.defineProperty(ut,Symbol.toStringTag,{value:"Module"}))}var mt={exports:{}};/*!
 * DevExpress Diagram (dx-diagram.min)
 * Version: 2.1.70
 * Build date: Wed Feb 08 2023
 * 
 * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED
 * Read about DevExpress licensing here: https://www.devexpress.com/Support/EULAs
 */var Tt=mt.exports;(function(ut,vt){(function(j,h){ut.exports=h()})(bt,function(){return function(j){var h={};function d(m){if(h[m])return h[m].exports;var P=h[m]={i:m,l:!1,exports:{}};return j[m].call(P.exports,P,P.exports,d),P.l=!0,P.exports}return d.m=j,d.c=h,d.d=function(m,P,p){d.o(m,P)||Object.defineProperty(m,P,{enumerable:!0,get:p})},d.r=function(m){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})},d.t=function(m,P){if(1&P&&(m=d(m)),8&P||4&P&&typeof m=="object"&&m&&m.__esModule)return m;var p=Object.create(null);if(d.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:m}),2&P&&typeof m!="string")for(var u in m)d.d(p,u,(function(s){return m[s]}).bind(null,u));return p},d.n=function(m){var P=m&&m.__esModule?function(){return m.default}:function(){return m};return d.d(P,"a",P),P},d.o=function(m,P){return Object.prototype.hasOwnProperty.call(m,P)},d.p="",d(d.s=58)}([function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(p,u){this.x=p,this.y=u}return P.zero=function(){return new P(0,0)},P.fromNumber=function(p){return new P(p,p)},P.prototype.isZero=function(){return this.x===0&&this.y===0},P.prototype.toString=function(){return JSON.stringify(this)},P.prototype.copyFrom=function(p){this.x=p.x,this.y=p.y},P.prototype.clone=function(){return new P(this.x,this.y)},P.prototype.equals=function(p){return this.x===p.x&&this.y===p.y},P.prototype.offset=function(p,u){return this.x+=p,this.y+=u,this},P.prototype.offsetByPoint=function(p){return this.x+=p.x,this.y+=p.y,this},P.prototype.multiply=function(p,u){return this.x*=p,this.y*=u,this},P.prototype.negative=function(){return this.x*=-1,this.y*=-1,this},P.prototype.applyConverter=function(p){return this.x=p(this.x),this.y=p(this.y),this},P.plus=function(p,u){return new P(p.x+u.x,p.y+u.y)},P.minus=function(p,u){return new P(p.x-u.x,p.y-u.y)},P.xComparer=function(p,u){return p.x-u.x},P.yComparer=function(p,u){return p.y-u.y},P.equals=function(p,u){return p.x===u.x&&p.y===u.y},P}();h.Point=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeType=h.ShapeTypes=h.ShapeCategories=void 0;var m=function(){function p(){}return p.General="general",p.Flowchart="flowchart",p.OrgChart="orgChart",p.Containers="containers",p.Custom="custom",p}();h.ShapeCategories=m;var P=function(){function p(){}return p.Text="text",p.Rectangle="rectangle",p.Ellipse="ellipse",p.Cross="cross",p.Triangle="triangle",p.Diamond="diamond",p.Heart="heart",p.Pentagon="pentagon",p.Hexagon="hexagon",p.Octagon="octagon",p.Star="star",p.ArrowLeft="arrowLeft",p.ArrowUp="arrowTop",p.ArrowRight="arrowRight",p.ArrowDown="arrowBottom",p.ArrowUpDown="arrowNorthSouth",p.ArrowLeftRight="arrowEastWest",p.Process="process",p.Decision="decision",p.Terminator="terminator",p.PredefinedProcess="predefinedProcess",p.Document="document",p.MultipleDocuments="multipleDocuments",p.ManualInput="manualInput",p.Preparation="preparation",p.Data="data",p.Database="database",p.HardDisk="hardDisk",p.InternalStorage="internalStorage",p.PaperTape="paperTape",p.ManualOperation="manualOperation",p.Delay="delay",p.StoredData="storedData",p.Display="display",p.Merge="merge",p.Connector="connector",p.Or="or",p.SummingJunction="summingJunction",p.Container="container",p.VerticalContainer="verticalContainer",p.HorizontalContainer="horizontalContainer",p.Card="card",p.CardWithImageOnLeft="cardWithImageOnLeft",p.CardWithImageOnTop="cardWithImageOnTop",p.CardWithImageOnRight="cardWithImageOnRight",p}();h.ShapeTypes=P,function(p){p[p.text=0]="text",p[p.rectangle=1]="rectangle",p[p.ellipse=2]="ellipse",p[p.cross=3]="cross",p[p.triangle=4]="triangle",p[p.diamond=5]="diamond",p[p.heart=6]="heart",p[p.pentagon=7]="pentagon",p[p.hexagon=8]="hexagon",p[p.octagon=9]="octagon",p[p.star=10]="star",p[p.arrowLeft=11]="arrowLeft",p[p.arrowTop=12]="arrowTop",p[p.arrowRight=13]="arrowRight",p[p.arrowBottom=14]="arrowBottom",p[p.arrowNorthSouth=15]="arrowNorthSouth",p[p.arrowEastWest=16]="arrowEastWest",p[p.process=17]="process",p[p.decision=18]="decision",p[p.terminator=19]="terminator",p[p.predefinedProcess=20]="predefinedProcess",p[p.document=21]="document",p[p.multipleDocuments=22]="multipleDocuments",p[p.manualInput=23]="manualInput",p[p.preparation=24]="preparation",p[p.data=25]="data",p[p.database=26]="database",p[p.hardDisk=27]="hardDisk",p[p.internalStorage=28]="internalStorage",p[p.paperTape=29]="paperTape",p[p.manualOperation=30]="manualOperation",p[p.delay=31]="delay",p[p.storedData=32]="storedData",p[p.display=33]="display",p[p.merge=34]="merge",p[p.connector=35]="connector",p[p.or=36]="or",p[p.summingJunction=37]="summingJunction",p[p.verticalContainer=38]="verticalContainer",p[p.horizontalContainer=39]="horizontalContainer",p[p.cardWithImageOnLeft=40]="cardWithImageOnLeft",p[p.cardWithImageOnTop=41]="cardWithImageOnTop",p[p.cardWithImageOnRight=42]="cardWithImageOnRight"}(h.ShapeType||(h.ShapeType={}))},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(p,u){this.width=p,this.height=u}return P.empty=function(){return new P(0,0)},P.fromNumber=function(p){return new P(p,p)},P.initByCommonAction=function(p){var u=function(i){return i.width},s=function(i){return i.height};return new P(p(u,s),p(s,u))},P.prototype.isEmpty=function(){return this.width===0&&this.height===0},P.prototype.toString=function(){return JSON.stringify(this)},P.prototype.nonNegativeSize=function(){return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this},P.prototype.offset=function(p,u){return this.width=this.width+p,this.height=this.height+u,this},P.prototype.multiply=function(p,u){return this.width*=p,this.height*=u,this},P.prototype.equals=function(p){return this.width===p.width&&this.height===p.height},P.prototype.clone=function(){return new P(this.width,this.height)},P.prototype.copyFrom=function(p){this.width=p.width,this.height=p.height},P.prototype.applyConverter=function(p){return this.width=p(this.width),this.height=p(this.height),this},P.equals=function(p,u){return p.width===u.width&&p.height===u.height},P}();h.Size=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.EventUtils=h.HtmlFocusUtils=h.ObjectUtils=h.GeometryUtils=h.Utils=h.EventDispatcher=h.Range=h.LineEquation=void 0,d(174);var m=d(2),P=d(0),p=d(13),u=d(41),s=d(35),i=d(31),t=d(60),e=d(33),n=d(26),o=d(18),r=d(65),a=function(){function b(S,x,I){this.aParam=S,this.bParam=x,this.cParam=I}return b.fromPoints=function(S,x,I){return I===void 0&&(I=1e-5),g.areDuplicatedPoints(S,x,I)?void 0:new b(x.y-S.y,S.x-x.x,x.x*S.y-S.x*x.y)},b.prototype.getPointIntersection=function(S,x){x===void 0&&(x=1e-5);var I=this.aParam,w=this.bParam,_=this.cParam,T=S.aParam,R=S.bParam,E=S.cParam,D=T*w-I*R;if(i.MathUtils.numberCloseTo(D,0,x))return null;if(I===0){var L=(R*_-E*w)/(w*T);return this.createPoint(L,-_/w)}var H=(E*I-_*T)/D;return this.createPoint((-w*H-_)/I,H)},b.prototype.containsPoint=function(S,x){return x===void 0&&(x=1e-5),i.MathUtils.numberCloseTo(this.aParam*S.x+this.bParam*S.y+this.cParam,0,x)},b.prototype.createPoint=function(S,x,I){return I===void 0&&(I=1e-5),new P.Point(i.MathUtils.numberCloseTo(S,0,I)?0:S,i.MathUtils.numberCloseTo(x,0,I)?0:x)},b}();h.LineEquation=a;var c=function(){function b(S,x){this.from=S,this.to=x!==void 0?x:S}return Object.defineProperty(b.prototype,"length",{get:function(){return Math.abs(this.to-this.from)},enumerable:!1,configurable:!0}),b.prototype.extend=function(S){this.from=Math.min(S.from,this.from),this.to=Math.max(S.to,this.to)},b.prototype.includes=function(S){return S>=this.from&&S<=this.to},b.fromLength=function(S,x){return new b(S,S+x)},b}();h.Range=c;var l=function(){function b(){this.listeners=[]}return b.prototype.add=function(S){if(!S)throw new Error("Not Implemented");this.hasEventListener(S)||this.listeners.push(S)},b.prototype.remove=function(S){for(var x=0,I=void 0;I=this.listeners[x];x++)if(I===S){this.listeners.splice(x,1);break}},b.prototype.raise=function(S){for(var x=[],I=1;I<arguments.length;I++)x[I-1]=arguments[I];for(var w=0,_=void 0;_=this.listeners[w];w++){var T=_[S];T&&T.apply(_,x)}},b.prototype.raise1=function(S){for(var x=0,I=void 0;I=this.listeners[x];x++)S(I)},b.prototype.hasEventListener=function(S){for(var x=0,I=this.listeners.length;x<I;x++)if(this.listeners[x]===S)return!0;return!1},b}();h.EventDispatcher=l;var y=function(){function b(){}return b.flatten=function(S){return[].concat.apply([],S)},b}();h.Utils=y;var g=function(){function b(){}return b.getCommonRectangle=function(S){if(!S.length)return new p.Rectangle(0,0,0,0);var x=Number.MAX_VALUE,I=-Number.MAX_VALUE,w=Number.MAX_VALUE,_=-Number.MAX_VALUE;return S.forEach(function(T){x=Math.min(x,T.x),I=Math.max(I,T.right),w=Math.min(w,T.y),_=Math.max(_,T.bottom)}),new p.Rectangle(x,w,I-x,_-w)},b.findFreeSpace=function(S,x,I,w){var _=[w?w.x:0],T=[w?w.y:0];S.forEach(function(K){_.push(K.x),_.push(K.right),T.push(K.y),T.push(K.bottom)}),_=_.sort(function(K,A){return K-A}).reduce(function(K,A,M){return _[M-1]!==A&&K.push(A)&&K||K},[]);for(var R=(T=T.sort(function(K,A){return K-A}).reduce(function(K,A,M){return T[M-1]!==A&&K.push(A)&&K||K},[])).map(function(K){return _.map(function(A,M){return _[M+1]-A})}),E=function(K,A){for(var M=u.SearchUtils.binaryIndexOf(_,function(W){return W-A.x}),U=u.SearchUtils.binaryIndexOf(_,function(W){return W-A.right}),V=u.SearchUtils.binaryIndexOf(T,function(W){return W-A.y}),G=u.SearchUtils.binaryIndexOf(T,function(W){return W-A.bottom}),Y=V;Y<G;Y++)for(var tt=M;tt<U;tt++)R[Y][tt]*=-1},D=0,L=void 0;L=S[D];D++)E(0,L);for(var H=0;H<T.length;H++)for(var O=0;O<_.length-1;O++){var z=this.checkRect(R,T,_,H,O,x,I);if(z>0)O=z;else if(z===0)return new P.Point(_[O],T[H])}return null},b.checkRect=function(S,x,I,w,_,T,R){for(var E=0,D=0,L=I.length-2,H=w;H<x.length;H++){E=x[H+1]-x[w];for(var O=_;O<=L;O++){if(S[H][O]<0)return O===0?-1:O;if(D=I[O+1]-I[_],T.width<=D||!R&&O===I.length-2&&T.width/2<=D){if(T.height<=E||!R&&H===x.length-2&&T.height/2<=E)return 0;L=O}}}},b.getArrowPoints=function(S,x,I,w){if(S.x===x.x&&S.y===x.y)return{point1:S.clone(),point2:S.clone(),point3:S.clone()};var _=x.x-S.x,T=x.y-S.y,R=Math.sqrt(Math.pow(_,2)+Math.pow(T,2)),E=_/R,D=T/R,L=S.x+I*E+w*D,H=S.y+I*D-w*E,O=S.x+I*E-w*D,z=S.y+I*D+w*E,K=S.x+I*E,A=S.y+I*D;return{point1:new P.Point(L,H),point2:new P.Point(O,z),point3:new P.Point(K,A)}},b.createSegments=function(S){for(var x=[],I=1;I<S.length;I++)x.push(new e.Segment(S[I-1],S[I]));return x},b.createRectagle=function(S){var x=S.map(function(E){return E.x}),I=S.map(function(E){return E.y}),w=x.reduce(function(E,D){return Math.min(E,D)},Number.MAX_VALUE),_=x.reduce(function(E,D){return Math.max(E,D)},-Number.MAX_VALUE),T=I.reduce(function(E,D){return Math.min(E,D)},Number.MAX_VALUE),R=I.reduce(function(E,D){return Math.max(E,D)},-Number.MAX_VALUE);return new p.Rectangle(w,T,_-w,R-T)},b.createSegmentsFromRectangle=function(S){var x=[],I=new P.Point(S.x,S.y),w=new P.Point(S.right,S.y),_=new P.Point(S.right,S.bottom),T=new P.Point(S.x,S.bottom);return x.push(new e.Segment(I,w)),x.push(new e.Segment(w,_)),x.push(new e.Segment(_,T)),x.push(new e.Segment(T,I)),x},b.areSegmentsCutRectangle=function(S,x){if(!x)return!1;for(var I=b.createSegmentsFromRectangle(x),w=!1,_=!1,T=function(D){if(w&&_)return{value:!0};var L=S[D];if(L.isIntersectedByRect(x)){var H=L.startPoint,O=L.endPoint,z=x.containsPoint(H),K=x.containsPoint(O);if(!z&&!K)return{value:!0};if(z&&!K){var A=I.filter(function(G){return G.containsPoint(H)});return A.length>0&&I.filter(function(G){return A.length===1?!G.containsPoint(A[0].startPoint)&&!G.containsPoint(A[0].endPoint):G!==A[0]&&G!==A[1]}).some(function(G){return L.isIntersected(G)})&&!w&&(w=!0),_||(_=!0),"continue"}if(!z&&K){w||(w=!0,_&&(_=!1));var M=I.filter(function(G){return G.containsPoint(O)});return M.length>0&&I.filter(function(G){return M.length===1?!G.containsPoint(M[0].startPoint)&&!G.containsPoint(M[0].endPoint):G!==M[0]&&G!==M[1]}).some(function(G){return L.isIntersected(G)})&&!_&&(_=!0),"continue"}var U=I.filter(function(G){return G.containsPoint(H)}),V=I.filter(function(G){return G.containsPoint(O)});if(U.length===2&&V.length===2)return{value:!0};if(U.length===1&&V.length===1&&U[0]!==V[0])return{value:!0};_||V.length!==1||U.length||(_=!0),w||U.length!==1||V.length||(w=!0,_&&(_=!1))}},R=0;R<S.length;R++){var E=T(R);if(typeof E=="object")return E.value}return w&&_},b.areIntersectedSegments=function(S,x){if(!x)return!1;for(var I,w=0;I=S[w];){for(var _=0,T=void 0;T=x[_];){if(T.isIntersected(I))return!0;_++}w++}return!1},b.isLineIntersected=function(S,x,I,w,_){var T=a.fromPoints(S,x),R=I.startPoint,E=I.endPoint;if(T.containsPoint(R)&&T.containsPoint(E))return!w&&!_;var D=a.fromPoints(R,E).getPointIntersection(T);return!(!D||!I.containsPoint(D))&&(w?!b.areDuplicatedPoints(R,D):!_||!b.areDuplicatedPoints(E,D))},b.removeUnnecessaryPoints=function(S,x,I,w){I===void 0&&(I=function(_){return _!==void 0}),w===void 0&&(w=1e-5),this.removeUnnecessaryPointsCore(S,x,I,w),this.removeBackwardPoints(S,x,I,w),this.removeUnnecessaryPointsCore(S,x,I,w)},b.removeUnnecessaryRightAnglePoints=function(S,x,I,w){I===void 0&&(I=function(_){return _!==void 0}),w===void 0&&(w=1e-5),this.removeUnnecessaryPointsCore(S,x,I,w),this.removeBackwardPoints(S,x,I,w),this.removeNotRightAnglePoints(S,x,I,w),this.removeUnnecessaryPointsCore(S,x,I,w)},b.removeUnnecessaryPointsCore=function(S,x,I,w){I===void 0&&(I=function(_){return _!==void 0}),w===void 0&&(w=1e-5),this.removeDuplicatedPoints(S,x,I,w),this.removeNotCornersPoints(S,x,I,w)},b.removeNotRightAnglePoints=function(S,x,I,w){I===void 0&&(I=function(D){return D!==void 0}),w===void 0&&(w=1e-5);for(var _,T=0;(_=S[T])&&S.length>2;){var R=this.getNextPoint(S,T,1,I),E=this.getNextPoint(S,T,-1,I);E&&R&&!b.isRightAngleCorner(E,_,R,w)&&x(_,T)||T++}},b.removeDuplicatedPoints=function(S,x,I,w){I===void 0&&(I=function(D){return D!==void 0}),w===void 0&&(w=1e-5);for(var _,T=0;(_=S[T])&&S.length>2;){var R=this.getNextPoint(S,T,1,I);if(R&&b.areDuplicatedPoints(_,R,w)){var E=T===S.length-2?T:T+1;if(x(S[E],E))continue}T++}},b.removeNotCornersPoints=function(S,x,I,w){I===void 0&&(I=function(D){return D!==void 0}),w===void 0&&(w=1e-5);for(var _,T=0;(_=S[T])&&S.length>2;){var R=this.getNextPoint(S,T,1,I),E=this.getNextPoint(S,T,-1,I);E&&R&&!b.isCorner(E,_,R,w)&&x(_,T)||T++}},b.removeBackwardPoints=function(S,x,I,w){I===void 0&&(I=function(D){return D!==void 0}),w===void 0&&(w=1e-5);for(var _,T=0;(_=S[T])&&S.length>2;){var R=this.getNextPoint(S,T,1,I),E=this.getNextPoint(S,T,-1,I);E&&R&&b.isBackwardPoint(E,_,R,w)&&x(_,T)||T++}},b.isRightAngleCorner=function(S,x,I,w){return w===void 0&&(w=1e-5),i.MathUtils.numberCloseTo(b.createAngle(S,x,I),Math.PI/2,w)||i.MathUtils.numberCloseTo(b.createAngle(S,x,I),Math.PI,w)||i.MathUtils.numberCloseTo(b.createAngle(S,x,I),3*Math.PI/2,w)},b.isCorner=function(S,x,I,w){return w===void 0&&(w=1e-5),!i.MathUtils.numberCloseTo(b.createAngle(S,x,I),0,w)},b.areDuplicatedPoints=function(S,x,I){return I===void 0&&(I=1e-5),i.MathUtils.numberCloseTo(S.x,x.x,I)&&i.MathUtils.numberCloseTo(S.y,x.y,I)},b.isBackwardPoint=function(S,x,I,w){return w===void 0&&(w=1e-5),i.MathUtils.numberCloseTo(b.createAngle(S,x,I),Math.PI,w)},b.createAngle=function(S,x,I){var w=t.Vector.fromPoints(x,I),_=t.Vector.fromPoints(S,x),T=w.x,R=w.y,E=_.x,D=_.y,L=Math.atan2(T*D-E*R,T*E+R*D);return L<0?2*Math.PI+L:L},b.getNextPoint=function(S,x,I,w){for(var _,T=x+I;_=S[T];){if(w(_))return _;T+=I}},b.addSelectedLinesTo=function(S,x,I,w,_,T,R,E,D,L,H,O,z,K){K===void 0&&(K=1e-5);var A=x.y-S.y,M=I.y-x.y,U=S.x-x.x,V=x.x-I.x,G=A*V-M*U;if(!i.MathUtils.numberCloseTo(G,0,K)){var Y=A*(S.x+w)+U*(S.y+_),tt=M*(x.x+E)+V*(x.y+D);O((V*Y-U*tt)/G,(A*tt-M*Y)/G);var W=A*(S.x+T)+U*(S.y+R),N=M*(x.x+L)+V*(x.y+H);z((V*W-U*N)/G,(A*N-M*W)/G)}},b.getSelectionOffsetPoint=function(S,x,I){return new P.Point((S.y-x.y)/I,(x.x-S.x)/I)},b.getSelectionTextStartEndPoints=function(S,x,I,w,_,T){var R=(x.x-S.x)/I,E=(x.y-S.y)/I,D=_.width*R+_.height*E;switch(T){case n.TextAlignment.Left:return[w,new P.Point(w.x+R*D,w.y+E*D)];case n.TextAlignment.Right:return[new P.Point(w.x-R*D,w.y-E*D),w];default:return[new P.Point(w.x-.5*R*D,w.y-.5*E*D),new P.Point(w.x+.5*R*D,w.y+.5*E*D)]}},b.getPathLength=function(S){var x,I=0;return S.forEach(function(w){x!==void 0&&(I+=s.Metrics.euclideanDistance(w,x)),x=w}),I},b.getPathPointByPosition=function(S,x){if(!S.length)throw new Error("Invalid points");if(0>x||x>1)throw new Error("Invalid relative position");var I=this.getPathLength(S);if(S.length<=2&&I===0||x===0)return[S[0],0];for(var w=I*x,_=0,T=1;T<S.length;T++){var R=s.Metrics.euclideanDistance(S[T],S[T-1]);if(_+R>=w){var E=w-_,D=(S[T].x-S[T-1].x)/R,L=(S[T].y-S[T-1].y)/R;return[new P.Point(S[T-1].x+D*E,S[T-1].y+L*E),T]}_+=R}return[S[S.length-1],S.length-1]},b.getLineAngle=function(S,x){return Math.atan2(x.y-S.y,x.x-S.x)},b.getTriangleBeginAngle=function(S,x,I){var w=this.getLineAngle(S,x),_=this.getLineAngle(S,I);return Math.abs(_-w)},b.getTriangleEndAngle=function(S,x,I){var w=this.getLineAngle(S,x),_=this.getLineAngle(I,x);return Math.abs(w-_)},b.getPathPointByPoint=function(S,x){if(!S.length)throw new Error("Invalid points");if(S.length===1)return S[0];for(var I,w=Number.MAX_VALUE,_=1;_<S.length;_++){var T=S[_-1],R=S[_];if(x.equals(T)){I=T.clone();break}if(x.equals(R)){I=R.clone();break}var E=this.getTriangleBeginAngle(T,R,x),D=this.getTriangleEndAngle(T,R,x),L=s.Metrics.euclideanDistance(x,T),H=s.Metrics.euclideanDistance(x,R),O=L*Math.sin(E),z=void 0;if((z=Math.PI/2<=E&&E<=3*Math.PI/2?L:Math.PI/2<=D&&D<=3*Math.PI/2?H:Math.abs(O))<w)if(w=z,Math.PI/2<=E&&E<=3*Math.PI/2)I=T.clone();else if(Math.PI/2<=D&&D<=3*Math.PI/2)I=R.clone();else{var K=Math.fround||Math.round,A=this.getLineAngle(T,R),M=K(Math.abs(O*Math.sin(A))),U=K(Math.abs(O*Math.cos(A))),V=x.y-T.y<K((x.x-T.x)*Math.tan(A));0<=A&&A<=Math.PI/2?(M*=V?-1:1,U*=V?1:-1):Math.PI/2<=A&&A<=Math.PI||0>=A&&A>=-Math.PI/2?(M*=V?1:-1,U*=V?1:-1):-Math.PI/2>=A&&A>=-Math.PI&&(M*=V?-1:1,U*=V?1:-1),I=x.clone().offset(M,U)}}return I},b.getPathPositionByPoint=function(S,x,I){I===void 0&&(I=100),x=this.getPathPointByPoint(S,x);for(var w=this.getPathLength(S),_=0,T=1;T<S.length;T++){var R=S[T-1],E=S[T],D=s.Metrics.euclideanDistance(E,R),L=Math.atan((E.y-R.y)/(E.x-R.x)),H=Math.fround||Math.round;if(x.x===E.x&&x.x===R.x||x.y===E.y&&x.y===R.y||H(x.y-R.y)===H((x.x-R.x)*Math.tan(L)))return Math.sin(L)!==0?_+=Math.abs((x.y-R.y)/Math.sin(L)):_+=Math.abs(x.x-R.x),Math.round(_*I/w)/I;_+=D}return 1},b.arePointsEqual=function(S,x){var I=S.length;if(I!==x.length)return!1;for(var w=0;w<I;w++)if(!S[w].equals(x[w]))return!1;return!0},b.getMaxRectangleEnscribedInEllipse=function(S){var x=S.width*Math.sqrt(2)/2,I=S.height*Math.sqrt(2)/2;return new m.Size(x,I)},b.getEllipseByEnscribedRectangle=function(S){return new m.Size(2*S.width/Math.sqrt(2),2*S.height/Math.sqrt(2))},b}();h.GeometryUtils=g;var f=function(){function b(){}return b.cloneObject=function(S){return S&&Object.assign({},S)},b.compareObjects=function(S,x){return S===x||typeof S=="object"&&typeof x=="object"&&this.isDeepEqual(S,x)},b.isDeepEqual=function(S,x){var I=S?Object.getOwnPropertyNames(S):[],w=x?Object.getOwnPropertyNames(x):[];if(I.length!==w.length)return!1;for(var _=0;_<I.length;_++){var T=I[_];switch(typeof S[T]){case"object":if(!this.isDeepEqual(S[T],x[T]))return!1;break;case"number":if(!(isNaN(S[T])&&isNaN(x[T])||S[T]===x[T]))return!1;break;default:if(S[T]!==x[T])return!1}}return!0},b}();h.ObjectUtils=f;var v=function(){function b(){}return b.focusWithPreventScroll=function(S){try{var x=o.Browser.Safari,I=x&&this.getHtmlScrollPosition();if(x){var w=S.parentElement&&S.parentElement.getBoundingClientRect();if(w){var _=w.left<0?1-w.left:0,T=w.top<0?1-w.top:0,R=window.frameElement&&window.frameElement.getBoundingClientRect();R&&(R.top<0&&-R.top>w.top&&(T=-R.top-w.top+1),R.left<0&&-R.left>w.left&&(_=-R.left-w.left+1)),S.style.setProperty("left",_+"px","important"),S.style.setProperty("top",T+"px","important")}}if(S.focus({preventScroll:!0}),x){var E=this.getHtmlScrollPosition();f.compareObjects(I,E)||this.setHtmlScrollPosition(I),S.style.setProperty("left","-1000px","important"),S.style.setProperty("top","-1000px","important")}}catch{}},b.getHtmlScrollPosition=function(){return{pos:this.getDocumentScrollPosition(window,document),iframePos:window.top!==window&&this.getDocumentScrollPosition(window.top,window.top.document)}},b.getDocumentScrollPosition=function(S,x){return{left:S.pageXOffset||x.documentElement.scrollLeft||x.body.scrollLeft,top:S.pageYOffset||x.documentElement.scrollTop||x.body.scrollTop}},b.setHtmlScrollPosition=function(S){this.setDocumentScrollPosition(document,S.pos),window.top!==window&&S.iframePos&&this.setDocumentScrollPosition(window.top.document,S.iframePos)},b.setDocumentScrollPosition=function(S,x){S.documentElement.scrollTop=x.top,S.documentElement.scrollLeft=x.left,S.body.scrollTop=x.top,S.body.scrollLeft=x.left},b}();h.HtmlFocusUtils=v;var C=function(){function b(){}return b.isLeftButtonPressed=function(S){return r.EvtUtils.isLeftButtonPressed(S)},b.isPointerEvents=function(){return window.PointerEvent},b.isMousePointer=function(S){return this.isPointerEvents()&&(S.pointerType&&S.pointerType==="mouse"||o.Browser.Firefox&&S.type==="click")},b.isTouchMode=function(){return o.Browser.TouchUI||window.navigator&&window.navigator.maxTouchPoints>0},b.isTouchEvent=function(S){return o.Browser.TouchUI||!b.isMousePointer(S)},b}();h.EventUtils=C},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ModelUtils=void 0;var m=d(12),P=d(35),p=d(0),u=d(13),s=d(2),i=d(60),t=d(31),e=d(47),n=d(48),o=d(66),r=d(188),a=d(53),c=d(86),l=d(112),y=d(67),g=d(113),f=d(114),v=d(189),C=d(190),b=d(191),S=d(192),x=d(115),I=d(68),w=d(193),_=d(194),T=d(88),R=d(69),E=d(116),D=d(117),L=d(89),H=d(70),O=d(54),z=d(195),K=d(38),A=d(3),M=d(6),U=d(32),V=d(29),G=d(85),Y=d(14),tt=function(){function W(){}return W.setShapePosition=function(N,k,B,F,Z){if(Z===void 0&&(Z=!0),!B.position.equals(F)){var q=F.clone().offset(-B.position.x,-B.position.y);N.addAndRedo(new b.MoveShapeHistoryItem(B.key,F)),Z&&B.children.forEach(function(J){if(J instanceof Y.Shape){var $=J.position.clone().offset(q.x,q.y);W.setShapePosition(N,k,J,$)}})}},W.setShapeSize=function(N,k,B,F,Z){B.size.equals(Z)&&B.position.equals(F)||N.addAndRedo(new x.ResizeShapeHistoryItem(B.key,F,Z))},W.addConnectorPoint=function(N,k,B,F){N.addAndRedo(new r.AddConnectorPointHistoryItem(k,B,F))},W.deleteConnectorCustomPoints=function(N,k){if(k.points.length>2){var B=k.tryCreateRenderPointsContext();if(k.properties.lineOption!==U.ConnectorLineOption.Straight&&B){var F=k.points[0].clone(),Z=k.points[k.points.length-1].clone();N.addAndRedo(new c.ChangeConnectorPointsHistoryItem(k.key,[F,Z],new G.ConnectorRenderPointsContext([new V.ConnectorRenderPoint(F.x,F.y,0),new V.ConnectorRenderPoint(Z.x,Z.y,1)],!1,B.actualRoutingMode)))}else N.addAndRedo(new c.ReplaceConnectorPointsHistoryItem(k.key,[k.points[0].clone(),k.points[k.points.length-1].clone()]))}},W.deleteConnectorUnnecessaryPoints=function(N,k){var B=k.getRenderPoints(!0).map(function(Q){return Q.clone()});if(k.properties.lineOption===U.ConnectorLineOption.Straight){var F=W.createUnnecessaryRenderPoints(B.filter(function(Q){return!Q.skipped}).map(function(Q){return Q.clone()}),k.skippedRenderPoints,function(Q){return W.findFirstPointIndex(B,function(nt){return nt.equals(Q)})});Object.keys(F).length&&N.addAndRedo(new c.ReplaceConnectorPointsHistoryItem(k.key,W.createNecessaryPoints(k.points.map(function(Q){return Q.clone()}),F)))}else{var Z=k.tryCreateRenderPointsContext(!0),q=B.filter(function(Q){return!Q.skipped}).map(function(Q){return Q.clone()});if(F=W.createUnnecessaryRightAngleRenderPoints(q,k.skippedRenderPoints,function(Q){return W.findFirstPointIndex(B,function(nt){return nt.equals(Q)})}),Object.keys(F).length){var J=W.createNecessaryPoints(k.points.map(function(Q){return Q.clone()}),F),$=new G.ConnectorRenderPointsContext(W.validateRenderPointIndexes(J,q,0),Z.lockCreateRenderPoints,Z.actualRoutingMode);N.addAndRedo(new c.ChangeConnectorPointsHistoryItem(k.key,J,$))}}},W.fixConnectorBeginEndConnectionIndex=function(N,k){if(k.beginItem&&k.beginConnectionPointIndex===-1){var B=k.beginItem.getNearestConnectionPoint(k.points[0]);N.addAndRedo(new n.SetConnectionPointIndexHistoryItem(k,B,M.ConnectorPosition.Begin))}if(k.endItem&&k.endConnectionPointIndex===-1){var F=k.endItem.getNearestConnectionPoint(k.points[k.points.length-1]);N.addAndRedo(new n.SetConnectionPointIndexHistoryItem(k,F,M.ConnectorPosition.End))}},W.skipUnnecessaryRenderPoints=function(N){var k=N.map(function(B){return B.clone()});W.removeUnnecessaryRenderPoints(k),N.forEach(function(B){return B.skipped=k.some(function(F){return F.skipped&&F.equals(B)})}),N[0].skipped=!1,N[N.length-1].skipped=!1},W.skipUnnecessaryRightAngleRenderPoints=function(N){var k=N.map(function(B){return B.clone()});W.removeUnnecessaryRightAngleRenderPoints(k),N.forEach(function(B){return B.skipped=k.some(function(F){return F.skipped&&F.equals(B)})}),N[0].skipped=!1,N[N.length-1].skipped=!1},W.removeUnnecessaryRenderPoints=function(N){A.GeometryUtils.removeUnnecessaryPoints(N,function(k,B){return W.removeUnnecessaryPoint(N,k,B)},function(k){return k!==void 0&&!k.skipped}),N[0].skipped=!1,N[N.length-1].skipped=!1},W.removeUnnecessaryRightAngleRenderPoints=function(N){A.GeometryUtils.removeUnnecessaryRightAnglePoints(N,function(k,B){return W.removeUnnecessaryPoint(N,k,B)},function(k){return k!==void 0&&!k.skipped}),N[0].skipped=!1,N[N.length-1].skipped=!1},W.createUnnecessaryRenderPoints=function(N,k,B,F){F===void 0&&(F=function(q){return!0});var Z={};return A.GeometryUtils.removeUnnecessaryPoints(N,function(q,J){return W.collectNotSkippedRenderPoints(Z,N,q,J,B,F)}),W.collectSkippedRenderPoints(Z,k,B,F),Z},W.createUnnecessaryRightAngleRenderPoints=function(N,k,B,F){F===void 0&&(F=function(q){return!0});var Z={};return A.GeometryUtils.removeUnnecessaryRightAnglePoints(N,function(q,J){return W.collectNotSkippedRenderPoints(Z,N,q,J,B,F)}),W.collectSkippedRenderPoints(Z,k,B,F),Z},W.createNecessaryPoints=function(N,k){var B=this,F=[],Z=N.length-1;return N.forEach(function(q,J){(J===0||J===Z||B.isNecessaryPoint(q,J,k))&&F.push(q.clone())}),F},W.isNecessaryPoint=function(N,k,B){return!Object.keys(B).some(function(F){var Z=B[F];return Z.pointIndex===k&&A.GeometryUtils.areDuplicatedPoints(N,Z)})},W.collectSkippedRenderPoints=function(N,k,B,F){F===void 0&&(F=function(Z){return!0}),k&&k.forEach(function(Z){if(F(Z)){var q=B(Z);N[q]===void 0&&(N[q]=Z)}})},W.collectNotSkippedRenderPoints=function(N,k,B,F,Z,q){if(q===void 0&&(q=function($){return!0}),!q(B))return!1;var J=Z(B);return N[J]===void 0&&(N[J]=B,B.skipped=!0,k.splice(F,1)),!0},W.removeUnnecessaryPoint=function(N,k,B){return k.pointIndex===-1?(N.splice(B,1),!0):(k.skipped=!0,!1)},W.validateRenderPointIndexes=function(N,k,B){var F=this,Z=k.map(function(q,J){return new V.ConnectorRenderPoint(q.x,q.y,J>=B&&q.pointIndex>=0?F.findFirstPointIndex(N,function($){return $.equals(q)}):q.pointIndex,q.skipped)});return Z[0].skipped=!1,Z[Z.length-1].skipped=!1,Z},W.findFirstPointIndex=function(N,k){if(!N||!k)return-1;for(var B=0;B<N.length;B++)if(k(N[B]))return B;return-1},W.moveConnectorRightAnglePoints=function(N,k,B,F,Z,q){A.GeometryUtils.areDuplicatedPoints(k.points[F],B)&&A.GeometryUtils.areDuplicatedPoints(k.points[q],Z)||N.addAndRedo(new C.MoveConnectorRightAnglePointsHistoryItem(k.key,F,B,q,Z))},W.moveConnectorPoint=function(N,k,B,F){return!k.points[B].equals(F)&&(N.addAndRedo(new C.MoveConnectorPointHistoryItem(k.key,B,F)),!0)},W.updateConnectorAttachedPoints=function(N,k,B){N.beginTransaction();var F=B.beginItem&&k.findItemCollapsedContainer(B.beginItem),Z=F&&(!B.endItem||!k.isContainerItem(F,B.endItem)),q=B.endItem&&k.findItemCollapsedContainer(B.endItem),J=q&&(!B.beginItem||!k.isContainerItem(q,B.beginItem)),$=!1;return $=Z?this.updateConnectorBeginPoint(N,B,F,J&&q||B.endItem,function(Q){return F.getConnectionPointIndexForItem(B.beginItem,Q)})||$:this.updateConnectorBeginPoint(N,B,B.beginItem,J&&q||B.endItem)||$,$=J?this.updateConnectorEndPoint(N,B,q,function(Q){return q.getConnectionPointIndexForItem(B.beginItem,Q)})||$:this.updateConnectorEndPoint(N,B,B.endItem)||$,N.endTransaction(),$},W.updateConnectorBeginPoint=function(N,k,B,F,Z){if(B){var q=Z!==void 0?Z(k.beginConnectionPointIndex):k.beginConnectionPointIndex,J=k.points[1];F&&k.points.length===2&&(J=k.endConnectionPointIndex!==-1?F.getConnectionPointPosition(k.endConnectionPointIndex,p.Point.zero()):F.rectangle.center);var $=B.getConnectionPointPosition(q,J);return this.moveConnectorPoint(N,k,0,$.clone())}},W.updateConnectorEndPoint=function(N,k,B,F){if(B){var Z=F!==void 0?F(k.endConnectionPointIndex):k.endConnectionPointIndex,q=B.getConnectionPointPosition(Z,k.points[k.points.length-2]);return this.moveConnectorPoint(N,k,k.points.length-1,q)}},W.updateContainerConnectorsAttachedPoints=function(N,k,B,F){var Z=this;F===void 0&&(F=B),N.beginTransaction(),k.getChildren(F).forEach(function(q){q instanceof Y.Shape&&(q.attachedConnectors.forEach(function(J){var $=J.beginItem&&k.isContainerItem(F,J.beginItem),Q=J.endItem&&k.isContainerItem(F,J.endItem);if($&&!Q){var nt=k.findItemTopCollapsedContainer(J.beginItem),ot=J.endItem&&k.findItemTopCollapsedContainer(J.endItem);nt?Z.updateConnectorBeginPoint(N,J,nt,ot||J.endItem,function(it){return B.getConnectionPointIndexForItem(J.beginItem,it)}):Z.updateConnectorBeginPoint(N,J,J.beginItem,ot||J.endItem)}Q&&!$&&((nt=k.findItemTopCollapsedContainer(J.endItem))?Z.updateConnectorEndPoint(N,J,nt,function(it){return B.getConnectionPointIndexForItem(J.endItem,it)}):Z.updateConnectorEndPoint(N,J,J.endItem))}),Z.updateContainerConnectorsAttachedPoints(N,k,B,q))}),N.endTransaction()},W.getConnectorsWithoutBeginItemInfo=function(N){return N.findConnectorsWithoutBeginItem().map(function(k){return{connector:k,point:k.points[0].clone()}})},W.getConnectorsWithoutEndItemInfo=function(N){return N.findConnectorsWithoutEndItem().map(function(k){return{connector:k,point:k.points[k.points.length-1].clone()}})},W.updateShapeAttachedConnectors=function(N,k,B){var F=this;B.attachedConnectors.forEach(function(Z){F.tryRemoveConnectorIntermediatePoints(N,Z),F.updateConnectorAttachedPoints(N,k,Z)})},W.updateMovingShapeConnections=function(N,k,B,F,Z,q,J){var $=this;Z(),B.forEach(function(Q){var nt=$.getMovingShapeConnectionPointIndex(k,Q.point);k.rectangle.containsPoint(Q.point)||nt>-1?(q(k,nt),nt!==Q.connector.beginConnectionPointIndex&&Q.connector.beginItem&&N.addAndRedo(new y.DeleteConnectionHistoryItem(Q.connector,M.ConnectorPosition.Begin)),J(Q.connector),N.addAndRedo(new n.AddConnectionHistoryItem(Q.connector,k,nt,M.ConnectorPosition.Begin))):Q.connector.beginItem&&(N.addAndRedo(new y.DeleteConnectionHistoryItem(Q.connector,M.ConnectorPosition.Begin)),N.addAndRedo(new C.MoveConnectorPointHistoryItem(Q.connector.key,0,Q.point)))}),F.forEach(function(Q){var nt=$.getMovingShapeConnectionPointIndex(k,Q.point);k.rectangle.containsPoint(Q.point)||nt>-1?(q(k,nt),nt!==Q.connector.endConnectionPointIndex&&Q.connector.endItem&&N.addAndRedo(new y.DeleteConnectionHistoryItem(Q.connector,M.ConnectorPosition.End)),J(Q.connector),N.addAndRedo(new n.AddConnectionHistoryItem(Q.connector,k,nt,M.ConnectorPosition.End))):Q.connector.endItem&&(N.addAndRedo(new y.DeleteConnectionHistoryItem(Q.connector,M.ConnectorPosition.End)),N.addAndRedo(new C.MoveConnectorPointHistoryItem(Q.connector.key,Q.connector.points.length-1,Q.point)))})},W.getMovingShapeConnectionPointIndex=function(N,k){var B=this,F=-1;return N.getConnectionPoints().forEach(function(Z,q){P.Metrics.euclideanDistance(k,Z)<B.connectionPointActionSize&&(F=q)}),F},W.shouldRemoveConnectorIntermediatePoints=function(N,k){if(N.properties.lineOption!==U.ConnectorLineOption.Orthogonal||N.points.length===2||!k||!k.length)return!1;for(var B,F=0;B=k[F];){if(this.isShapeIntersectConnectorCustomPoints(B,N))return!0;F++}return!1},W.tryRemoveConnectorIntermediatePoints=function(N,k){this.shouldRemoveConnectorIntermediatePoints(k,[k.beginItem,k.endItem])&&this.deleteConnectorCustomPoints(N,k)},W.isShapeIntersectConnectorCustomPoints=function(N,k){if(!N)return!1;var B=k.getCustomRenderPoints(!0);if(!B.length)return!1;var F=M.Connector.minOffset-m.UnitConverter.pixelsToTwips(1);return A.GeometryUtils.areIntersectedSegments(A.GeometryUtils.createSegments(B),A.GeometryUtils.createSegmentsFromRectangle(N.rectangle.clone().inflate(F,F)))},W.getSnappedPos=function(N,k,B,F){var Z=F?N.snapStartPoint.x:N.snapStartPoint.y;return Math.round((B-Z)/k)*k+Z},W.tryUpdateModelRectangle=function(N,k){var B=N.modelManipulator.getModelSizeUpdateOffset();B.isEmpty()||(N.addAndRedo(new w.ModelResizeHistoryItem(B)),(B.left||B.top)&&(N.addAndRedo(new _.UpdatePositionsOnPageResizeHistoryItem(new i.Vector(B.left,B.top))),k!==void 0&&k(B.left,B.top)),N.modelManipulator.raiseModelRectangleChanged(N.modelManipulator.model.getRectangle(!0)))},W.deleteItems=function(N,k,B,F,Z){N.beginTransaction();var q={};F.forEach(function($){return q[$.key]=$});var J=B.getKeys().filter(function($){return!q[$]});N.addAndRedo(new I.SetSelectionHistoryItem(B,J)),this.deleteItemsCore(N,k,F,Z),this.tryUpdateModelRectangle(N),N.endTransaction()},W.deleteItemsCore=function(N,k,B,F){var Z=this;B.sort(function(q,J){return(q instanceof M.Connector?0:1)-(J instanceof M.Connector?0:1)}),B.forEach(function(q){if(q.container&&Z.removeFromContainer(N,k,q),q instanceof Y.Shape){var J=k.getChildren(q);J.length&&(J.forEach(function($){N.addAndRedo(new S.RemoveFromContainerHistoryItem($)),Z.updateAttachedConnectorsContainer(N,k,$)}),Z.deleteItemsCore(N,k,J.filter(function($){return!$.locked||F}),F)),k.findItem(q.key)&&Z.deleteShape(N,q)}q instanceof M.Connector&&k.findItem(q.key)&&Z.deleteConnector(N,q)})},W.detachConnectors=function(N,k){for(N.beginTransaction();k.attachedConnectors.length>0;){var B=k.attachedConnectors[0];N.addAndRedo(new y.DeleteConnectionHistoryItem(B,B.beginItem===k?M.ConnectorPosition.Begin:M.ConnectorPosition.End))}N.endTransaction()},W.deleteShape=function(N,k){var B=N.modelManipulator.permissionsProvider.canDeleteItems([k]);N.beginTransaction(),this.detachConnectors(N,k),N.addAndRedo(new f.DeleteShapeHistoryItem(k.key,B)),N.endTransaction()},W.deleteConnector=function(N,k){N.beginTransaction(),k.beginItem&&N.addAndRedo(new y.DeleteConnectionHistoryItem(k,M.ConnectorPosition.Begin)),k.endItem&&N.addAndRedo(new y.DeleteConnectionHistoryItem(k,M.ConnectorPosition.End)),N.addAndRedo(new g.DeleteConnectorHistoryItem(k.key)),N.endTransaction()},W.deleteAllItems=function(N,k,B){this.deleteItems(N,k,B,k.items.slice(),!0)},W.deleteSelection=function(N,k,B){this.deleteItems(N,k,B,B.getSelectedItems())},W.changeSelectionLocked=function(N,k,B,F){N.beginTransaction(),B.getSelectedItems(!0).forEach(function(Z){N.addAndRedo(new D.ChangeLockedHistoryItem(Z,F))}),W.updateSelection(N,B),N.endTransaction()},W.copyStylesToItem=function(N,k,B,F){var Z=k.findItem(F);B.styleText.forEach(function(q){B.styleText[q]!==Z.styleText[q]&&N.addAndRedo(new H.ChangeStyleTextHistoryItem(F,q,B.styleText[q]))}),B.style.forEach(function(q){B.style[q]!==Z.style[q]&&N.addAndRedo(new L.ChangeStyleHistoryItem(F,q,B.style[q]))})},W.updateSelection=function(N,k){N.addAndRedo(new I.SetSelectionHistoryItem(k,k.getKeys(),!0))},W.cloneShapeToOffset=function(N,k,B,F,Z){N.beginTransaction();var q=B.position.clone().offset(F,Z),J=new a.AddShapeHistoryItem(B.description,q,B.text);N.addAndRedo(J);var $=J.shapeKey;return N.addAndRedo(new x.ResizeShapeHistoryItem($,q,B.size.clone())),N.addAndRedo(new E.ChangeCustomDataHistoryItem($,A.ObjectUtils.cloneObject(B.customData))),N.addAndRedo(new l.ChangeShapeParametersHistoryItem($,B.parameters.clone())),this.copyStylesToItem(N,k,B,$),N.endTransaction(),$},W.applyOffsetToConnectorRenderPointsContext=function(N,k,B){return N&&N.renderPoints?new G.ConnectorRenderPointsContext(N.renderPoints.map(function(F){return F.clone().offset(k,B)}),!0,N.actualRoutingMode):void 0},W.cloneConnectorToOffset=function(N,k,B,F,Z,q,J){N.beginTransaction();var $=B.points.map(function(st){return st.clone().offset(q,J)}),Q=new o.AddConnectorHistoryItem($,void 0,this.applyOffsetToConnectorRenderPointsContext(B.tryCreateRenderPointsContext(),q,J));N.addAndRedo(Q);var nt=Q.connectorKey,ot=k.findConnector(nt);if(B.properties.forEach(function(st){B.properties[st]!==ot.properties[st]&&N.addAndRedo(new T.ChangeConnectorPropertyHistoryItem(nt,st,B.properties[st]))}),F){var it=k.findShape(F);N.addAndRedo(new n.AddConnectionHistoryItem(ot,it,B.beginConnectionPointIndex,M.ConnectorPosition.Begin))}if(Z){var rt=k.findShape(Z);N.addAndRedo(new n.AddConnectionHistoryItem(ot,rt,B.endConnectionPointIndex,M.ConnectorPosition.End))}return B.texts.clone().forEach(function(st){N.addAndRedo(new R.ChangeConnectorTextHistoryItem(ot,st.position,st.value))}),this.copyStylesToItem(N,k,B,nt),N.endTransaction(),nt},W.cloneSelectionToOffset=function(N,k,B,F,Z,q){var J=this;N.beginTransaction();var $={},Q=[];F.getSelectedShapes().forEach(function(nt){var ot=J.cloneShapeToOffset(N,k,nt,Z,q);$[nt.key]=ot,Q.push(ot),B&&B(ot)}),F.getSelectedConnectors().forEach(function(nt){var ot=nt.beginItem?$[nt.beginItem.key]:null,it=nt.endItem?$[nt.endItem.key]:null,rt=J.cloneConnectorToOffset(N,k,nt,ot,it,Z,q);Q.push(rt),B&&B(rt)}),N.addAndRedo(new I.SetSelectionHistoryItem(F,Q)),W.tryUpdateModelRectangle(N),N.endTransaction()},W.findContainerByEventKey=function(N,k,B){var F=N.findContainer(B);if(F&&!F.isLocked)return F;var Z=N.findShape(B);return Z&&Z.container&&!k.hasKey(Z.key)?W.findContainerByEventKey(N,k,Z.container.key):void 0},W.canInsertToContainer=function(N,k,B){return k!==B&&!(k instanceof Y.Shape&&N.findChild(k,B.key))},W.canInsertSelectionToContainer=function(N,k,B){var F=!0;return k.getSelectedItems().forEach(function(Z){Z!==B?Z instanceof Y.Shape&&N.findChild(Z,B.key)&&(F=!1):F=!1}),F},W.insertToContainer=function(N,k,B,F){if(!F.enableChildren)throw Error("Inpossible to add children to non-container shape.");if(this.canInsertToContainer(k,B,F)){var Z=B.container;Z!==F&&(N.beginTransaction(),Z&&(N.addAndRedo(new S.RemoveFromContainerHistoryItem(B)),B.attachedConnectors.forEach(function(q){q.container&&N.addAndRedo(new S.RemoveFromContainerHistoryItem(q))})),N.addAndRedo(new v.InsertToContainerHistoryItem(B,F)),this.updateAttachedConnectorsContainer(N,k,B),N.endTransaction())}},W.removeFromContainer=function(N,k,B){B.container&&(N.beginTransaction(),N.addAndRedo(new S.RemoveFromContainerHistoryItem(B)),this.updateAttachedConnectorsContainer(N,k,B),N.endTransaction())},W.insertSelectionToContainer=function(N,k,B,F){var Z=this;N.beginTransaction();var q=B.getSelectedItems();q.filter(function(J){return!J.container||q.indexOf(J.container)===-1}).forEach(function(J){Z.insertToContainer(N,k,J,F)}),N.endTransaction()},W.removeSelectionFromContainer=function(N,k,B){var F=this;N.beginTransaction(),B.getSelectedItems().forEach(function(Z){Z.container&&!B.hasKey(Z.container.key)&&(N.addAndRedo(new S.RemoveFromContainerHistoryItem(Z)),F.updateAttachedConnectorsContainer(N,k,Z))}),N.endTransaction()},W.getConnectorContainer=function(N){if(N.beginItem&&N.endItem){for(var k={},B=N.beginItem.container;B;)k[B.key]=!0,B=B.container;for(var F=N.endItem.container;F;){if(k[F.key]!==void 0)return F;F=F.container}}},W.updateAttachedConnectorsContainer=function(N,k,B){var F=this;N.beginTransaction(),B.attachedConnectors.forEach(function(Z){F.updateConnectorContainer(N,k,Z)}),N.endTransaction()},W.updateConnectorContainer=function(N,k,B){var F=this.getConnectorContainer(B);F?N.addAndRedo(new v.InsertToContainerHistoryItem(B,F)):B.container&&N.addAndRedo(new S.RemoveFromContainerHistoryItem(B))},W.updateNewShapeProperties=function(N,k,B){k.inputPosition.getDefaultStyle().forEach(function(F){N.addAndRedo(new L.ChangeStyleHistoryItem(B,F,k.inputPosition.getDefaultStylePropertyValue(F)))}),k.inputPosition.getDefaultTextStyle().forEach(function(F){N.addAndRedo(new H.ChangeStyleTextHistoryItem(B,F,k.inputPosition.getDefaultTextStylePropertyValue(F)))})},W.updateNewConnectorProperties=function(N,k,B){k.inputPosition.getDefaultConnectorProperties().forEach(function(F){N.addAndRedo(new T.ChangeConnectorPropertyHistoryItem(B,F,k.inputPosition.getDefaultConnectorPropertyValue(F)))}),k.inputPosition.getDefaultStyle().forEach(function(F){N.addAndRedo(new L.ChangeStyleHistoryItem(B,F,k.inputPosition.getDefaultStylePropertyValue(F)))}),k.inputPosition.getDefaultTextStyle().forEach(function(F){N.addAndRedo(new H.ChangeStyleTextHistoryItem(B,F,k.inputPosition.getDefaultTextStylePropertyValue(F)))})},W.applyLayout=function(N,k,B,F,Z,q,J,$,Q,nt){N.beginTransaction();var ot=this.getOccupiedRectangles(q,B);return Z=this.offsetLayoutToFreeSpace(Z,B&&B.clientRectangle,ot,J.containerPadding),$&&this.adjustLayoutToSnapGrid(k,Z,Q),B&&this.resizeContainerOnLayout(N,k,Z,B,J.containerPadding),this.applyLayoutToNodes(N,k,Z,F.edges.map(function(it){return k.findConnector(it.key)})),this.applyLayoutToConnectors(N,k,Z,F.edges.map(function(it){return k.findConnector(it.key)}),nt),N.endTransaction(),Z.getRectangle(!0)},W.getNonGraphItems=function(N,k,B,F,Z){return(k?N.getChildren(k):N.items.filter(function(q){return!q.container})).filter(function(q){return q instanceof M.Connector?!(q.beginItem&&B[q.beginItem.key]||q.endItem&&B[q.endItem.key]||Z.indexOf(q)!==-1):q instanceof Y.Shape?!B[q.key]&&F.indexOf(q)===-1:void 0})},W.getOccupiedRectangles=function(N,k){var B=N.map(function(Z){return Z.rectangle});if(k&&B.length){var F=k.clientRectangle;B.push(new u.Rectangle(F.right,F.y,1,1)),B.push(new u.Rectangle(F.right,F.bottom,1,1))}return B},W.offsetLayoutToFreeSpace=function(N,k,B,F){var Z=N.getRectangle(!0),q=A.GeometryUtils.findFreeSpace(B,Z.createSize().offset(F,F).nonNegativeSize(),!1,k);if(q){var J=q.x+F,$=q.y+F;return N.offsetNodes(J,$)}var Q=B&&B.length?B.reduce(function(ot,it){return it.right>ot?it.right:ot},0):k?k.x:0,nt=k?k.y:Math.max(0,Z.y);return N.offsetNodes(Q+F,nt+F)},W.resizeContainerOnLayout=function(N,k,B,F,Z){var q=B.getRectangle(!0),J=F.children.filter(function(it){return it instanceof Y.Shape?B.nodeKeys.indexOf(it.key)===-1:!!(it instanceof M.Connector&&it.beginItem&&it.endItem)&&B.nodeKeys.indexOf(it.beginItem.key)===-1&&B.nodeKeys.indexOf(it.endItem.key)===-1}).map(function(it){return it.rectangle}),$=J.map(function(it){return it.right}).reduce(function(it,rt){return Math.max(it,rt)},q.right),Q=J.map(function(it){return it.bottom}).reduce(function(it,rt){return Math.max(it,rt)},q.bottom),nt=F.rectangle.width+$+Z-F.rectangle.right,ot=F.rectangle.height+Q+Z-F.rectangle.bottom;W.setShapeSize(N,k,F,F.position,new s.Size(nt,ot)),W.updateShapeAttachedConnectors(N,k,F)},W.applyLayoutToNodes=function(N,k,B,F){var Z=this,q=F.reduce(function(J,$){return J[$.key]=J},{});B.forEachNode(function(J,$){var Q=k.findShape($);Z.applyLayoutToNode(N,k,Q,J.position,q)})},W.applyLayoutToNode=function(N,k,B,F,Z){var q=this,J=F.clone().offset(-B.position.x,-B.position.y);W.setShapePosition(N,k,B,F,!1),J.x===0&&J.y===0||(B.attachedConnectors.filter(function($){return!Z[$.key]}).forEach(function($){q.updateConnectorAttachedPoints(N,k,$);for(var Q=$.beginItem?1:0,nt=$.endItem?$.points.length-2:$.points.length-1,ot=Q;ot<=nt;ot++)q.moveConnectorPoint(N,$,ot,$.points[ot].offset(J.x,J.y))}),k.getChildren(B).forEach(function($){if($ instanceof Y.Shape){var Q=$.position.clone().offset(J.x,J.y);q.applyLayoutToNode(N,k,$,Q,Z)}}))},W.applyLayoutToConnectors=function(N,k,B,F,Z){var q=this;F.filter(function(J){return J.beginItem||J.endItem}).forEach(function(J){var $=B.edgeToPosition[J.key];if(J.beginItem&&J.endItem&&!Z&&$){var Q=J.beginItem.getConnectionPointIndexForSide($.beginIndex);Q!==J.beginConnectionPointIndex&&N.addAndRedo(new n.SetConnectionPointIndexHistoryItem(J,Q,M.ConnectorPosition.Begin));var nt=J.endItem.getConnectionPointIndexForSide($.endIndex);nt!==J.endConnectionPointIndex&&N.addAndRedo(new n.SetConnectionPointIndexHistoryItem(J,nt,M.ConnectorPosition.End))}q.updateConnectorAttachedPoints(N,k,J),$&&q.deleteConnectorCustomPoints(N,J)})},W.adjustLayoutToSnapGrid=function(N,k,B){var F=this;k.nodeKeys.forEach(function(Z){k.nodeToLayout[Z].position.x=F.getSnappedPos(N,B,k.nodeToLayout[Z].position.x,!0),k.nodeToLayout[Z].position.y=F.getSnappedPos(N,B,k.nodeToLayout[Z].position.y,!1)})},W.getGraphInfoByItems=function(N,k,B,F){F===void 0&&(F=!0);var Z={};[].concat(k).concat(B).forEach(function(it){var rt=it.container&&it.container.key;Z[rt]||(Z[rt]=[]),Z[rt].push(it)});var q=[];for(var J in Z)if(Object.prototype.hasOwnProperty.call(Z,J)){var $=J&&N.findContainer(J);if(!$||$.expanded&&!N.findItemCollapsedContainer($)){var Q=$&&$.key,nt=this.getGraphByItems(N,Z[J],Q,!F),ot=!1;(nt.nodes.length>1||nt.nodes.length&&(F||$&&Z[$.container&&$.container.key]))&&(ot=!0),ot&&q.push(new z.GraphInfo($,nt))}}return q.sort(function(it,rt){return rt.level-it.level})},W.getGraphByItems=function(N,k,B,F){var Z=this,q=new O.Graph([],[]),J={};return k.forEach(function($){Z.extendByConnectedComponents($,q,B,J,F)}),q.nodes.sort(function($,Q){return N.getItemIndex(N.findItem($))-N.getItemIndex(N.findItem(Q))}),q.edges.sort(function($,Q){return N.getItemIndex(N.findItem($.key))-N.getItemIndex(N.findItem(Q.key))}),q.edges=q.edges.filter(function($){return q.getNode($.from)&&q.getNode($.to)}),q},W.extendByConnectedComponents=function(N,k,B,F,Z){var q=this;!N||Z&&N.locked||F[N.key]||(F[N.key]=!0,!(N instanceof M.Connector&&(N.container&&N.container.key)===B&&N.beginItem)||N.beginItem.locked&&Z||!N.endItem||N.endItem.locked&&Z||N.beginItem===N.endItem?N instanceof Y.Shape&&(N.container&&N.container.key)===B&&(k.addNode(N),N.attachedConnectors.forEach(function(J){return q.extendByConnectedComponents(J,k,B,F,Z)})):(k.addEdge(new K.Edge(N.key,N.beginItem&&N.beginItem.key,N.endItem&&N.endItem.key)),this.extendByConnectedComponents(N.beginItem,k,B,F,Z),this.extendByConnectedComponents(N.endItem,k,B,F,Z)))},W.getlUnitValue=function(N,k){switch(N){case e.DiagramUnit.Cm:return m.UnitConverter.twipsToCentimeters(k);case e.DiagramUnit.In:return m.UnitConverter.twipsToInches(k);case e.DiagramUnit.Px:return m.UnitConverter.twipsToPixels(k)}},W.getUnitText=function(N,k,B,F,Z){Z===void 0&&(Z=2);var q=k[N]?" "+k[N]:"",J=this.getlUnitValue(N,F);switch(N){case e.DiagramUnit.Cm:case e.DiagramUnit.In:return B(+J.toFixed(Z))+q;case e.DiagramUnit.Px:return B(+J.toFixed(0))+q}},W.getTwipsValue=function(N,k){switch(N){case e.DiagramUnit.Cm:return m.UnitConverter.centimetersToTwips(k);case e.DiagramUnit.In:return m.UnitConverter.inchesToTwips(k);case e.DiagramUnit.Px:return m.UnitConverter.pixelsToTwips(k)}},W.getGuidItemKey=function(){return t.MathUtils.generateGuid()},W.createSelectedItems=function(N){var k={};return N.getSelectedItems(!0).forEach(function(B){return k[B.key]=B}),k},W.canMoveConnector=function(N,k){var B=k.beginItem,F=k.endItem;return B||F?!!N[k.key]&&(B===F?!!N[B.key]:B?F?!!N[B.key]&&!!N[F.key]:!!N[B.key]:!!N[F.key]):!k.isLocked},W.createRectangle=function(N){return A.GeometryUtils.getCommonRectangle(N.map(function(k){return k.rectangle}))},W.connectionPointActionSize=m.UnitConverter.pixelsToTwips(8),W}();h.ModelUtils=tt},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.PathPrimitiveClosePathCommand=h.PathPrimitiveArcToCommand=h.PathPrimitiveQuadraticCurveToCommand=h.PathPrimitiveCubicCurveToCommand=h.PathPrimitiveLineToCommand=h.PathPrimitiveMoveToCommand=h.PathPrimitiveCommand=h.PathPrimitive=void 0;var p=d(15),u=d(24),s=d(109),i=function(l){function y(g,f,v,C,b){var S=l.call(this,f,v,C,b)||this;return S.commands=g.map(function(x){return x.style=f,x}),S}return P(y,l),y.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"path")},y.prototype.applyElementProperties=function(g,f){g.setAttribute("d",this.commands.map(function(v){return v.toString()}).join(" ")),this.setPositionCorrectionAttribute(g),l.prototype.applyElementProperties.call(this,g,f)},y}(u.SvgPrimitive);h.PathPrimitive=i;var t=function(l){function y(){return l!==null&&l.apply(this,arguments)||this}return P(y,l),y}(s.PrimitiveObject);h.PathPrimitiveCommand=t;var e=function(l){function y(g,f){var v=l.call(this)||this;return v.x=g,v.y=f,v}return P(y,l),y.prototype.toString=function(){return"M "+this.getUnitVaue(this.x)+" "+this.getUnitVaue(this.y)},y.fromPoint=function(g){return new y(g.x,g.y)},y}(t);h.PathPrimitiveMoveToCommand=e;var n=function(l){function y(g,f){var v=l.call(this)||this;return v.x=g,v.y=f,v}return P(y,l),y.prototype.toString=function(){return"L "+this.getUnitVaue(this.x)+" "+this.getUnitVaue(this.y)},y.fromPoint=function(g){return new y(g.x,g.y)},y}(t);h.PathPrimitiveLineToCommand=n;var o=function(l){function y(g,f,v,C,b,S){var x=l.call(this)||this;return x.x1=g,x.y1=f,x.x2=v,x.y2=C,x.x3=b,x.y3=S,x}return P(y,l),y.prototype.toString=function(){return"C "+this.getUnitVaue(this.x1)+" "+this.getUnitVaue(this.y1)+","+this.getUnitVaue(this.x2)+" "+this.getUnitVaue(this.y2)+","+this.getUnitVaue(this.x3)+" "+this.getUnitVaue(this.y3)},y}(t);h.PathPrimitiveCubicCurveToCommand=o;var r=function(l){function y(g,f,v,C){var b=l.call(this)||this;return b.x1=g,b.y1=f,b.x2=v,b.y2=C,b}return P(y,l),y.prototype.toString=function(){return"Q "+this.getUnitVaue(this.x1)+" "+this.getUnitVaue(this.y1)+","+this.getUnitVaue(this.x2)+" "+this.getUnitVaue(this.y2)},y}(t);h.PathPrimitiveQuadraticCurveToCommand=r;var a=function(l){function y(g,f,v,C,b,S,x){var I=l.call(this)||this;return I.rx=g,I.ry=f,I.xAxisRotation=v,I.largeArcFlag=C,I.sweepFag=b,I.x=S,I.y=x,I}return P(y,l),y.prototype.toString=function(){return"A "+this.getUnitVaue(this.rx)+" "+this.getUnitVaue(this.ry)+" "+this.getUnitVaue(this.xAxisRotation)+" "+(this.largeArcFlag?"1":"0")+" "+(this.sweepFag?"1":"0")+this.getUnitVaue(this.x)+","+this.getUnitVaue(this.y)},y}(t);h.PathPrimitiveArcToCommand=a;var c=function(l){function y(){return l.call(this)||this}return P(y,l),y.prototype.toString=function(){return"z"},y}(t);h.PathPrimitiveClosePathCommand=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(T,R){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,D){E.__proto__=D}||function(E,D){for(var L in D)D.hasOwnProperty(L)&&(E[L]=D[L])})(T,R)},function(T,R){function E(){this.constructor=T}m(T,R),T.prototype=R===null?Object.create(R):(E.prototype=R.prototype,new E)});Object.defineProperty(h,"__esModule",{value:!0}),h.Connector=h.CONNECTOR_DEFAULT_TEXT_POSITION=h.ConnectorPosition=void 0;var p,u=d(12),s=d(13),i=d(33),t=d(2),e=d(42),n=d(84),o=d(11),r=d(43),a=d(5),c=d(63),l=d(17),y=d(28),g=d(3),f=d(9),v=d(4),C=d(179),b=d(180),S=d(186),x=d(32),I=d(187),w=d(85);(function(T){T[T.Begin=0]="Begin",T[T.End=1]="End"})(p=h.ConnectorPosition||(h.ConnectorPosition={})),h.CONNECTOR_DEFAULT_TEXT_POSITION=.5;var _=function(T){function R(E){var D=T.call(this)||this;if(D.beginConnectionPointIndex=-1,D.endConnectionPointIndex=-1,D.properties=new x.ConnectorProperties,D.points=E.map(function(L){return L.clone()}),E.length<2)throw Error("Points count should be greater than 1");return D.texts=new I.ConnectorTexts,D}return P(R,T),Object.defineProperty(R.prototype,"rectangle",{get:function(){return g.GeometryUtils.createRectagle(this.getRenderPoints(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"skippedRenderPoints",{get:function(){return this.renderPoints?this.renderPoints.filter(function(E){return E.skipped}):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"shouldChangeRenderPoints",{get:function(){return this.renderPoints!==void 0&&this.routingStrategy!==void 0},enumerable:!1,configurable:!0}),R.prototype.assign=function(E){T.prototype.assign.call(this,E),E.beginItem=this.beginItem,E.beginConnectionPointIndex=this.beginConnectionPointIndex,E.endItem=this.endItem,E.endConnectionPointIndex=this.endConnectionPointIndex,E.properties=this.properties.clone(),E.texts=this.texts.clone(),this.routingStrategy!==void 0&&(E.routingStrategy=this.routingStrategy.clone()),this.renderPoints!==void 0&&(E.renderPoints=this.renderPoints.map(function(D){return D.clone()})),this.renderPointsWithoutSkipped!==void 0&&(E.renderPointsWithoutSkipped=this.renderPointsWithoutSkipped.map(function(D){return D.clone()})),this.actualRoutingMode!==void 0&&(E.actualRoutingMode=this.actualRoutingMode),this.lockCreateRenderPoints!==void 0&&(E.lockCreateRenderPoints=this.lockCreateRenderPoints),this.shouldInvalidateRenderPoints!==void 0&&(E.shouldInvalidateRenderPoints=this.shouldInvalidateRenderPoints)},R.prototype.clone=function(){var E=new R(this.points);return this.assign(E),E},R.prototype.getTextCount=function(){return this.texts.count()},R.prototype.getText=function(E){E===void 0&&(E=h.CONNECTOR_DEFAULT_TEXT_POSITION);var D=this.texts.get(E);return D?D.value:""},R.prototype.setText=function(E,D){D===void 0&&(D=h.CONNECTOR_DEFAULT_TEXT_POSITION),E&&E!==""?this.texts.set(D,new I.ConnectorText(D,E)):this.texts.remove(D)},R.prototype.getTextPoint=function(E){var D=this.getRenderPoints();return g.GeometryUtils.getPathPointByPosition(D,E)[0]},R.prototype.getTextPositionByPoint=function(E){var D=this.getRenderPoints(),L=g.GeometryUtils.getPathLength(D),H=g.GeometryUtils.getPathPositionByPoint(D,E),O=u.UnitConverter.pointsToTwips(parseInt(this.styleText["font-size"]));return O>H*L?O/L:O>L-H*L?(L-O)/L:H},R.prototype.getTextRectangle=function(E){return s.Rectangle.fromGeometry(this.getTextPoint(E),new t.Size(0,0))},R.prototype.changeRoutingStrategy=function(E){this.routingStrategy=E,this.invalidateRenderPoints()},R.prototype.clearRoutingStrategy=function(){delete this.routingStrategy,delete this.renderPoints,delete this.renderPointsWithoutSkipped,delete this.lockCreateRenderPoints,delete this.actualRoutingMode,delete this.shouldInvalidateRenderPoints,this.invalidateRenderPoints()},R.prototype.getCustomRenderPoints=function(E){E===void 0&&(E=!1);var D=this.getRenderPoints(E),L=[];return D.forEach(function(H,O){O>0&&O<D.length-1&&L.push(H)}),L},R.prototype.getRenderPoints=function(E){if(E===void 0&&(E=!1),this.shouldInvalidateRenderPoints===void 0||this.shouldInvalidateRenderPoints)if(this.shouldInvalidateRenderPoints=!1,this.routingStrategy){if(!this.lockCreateRenderPoints&&(this.changeRenderPoints(new b.ConnectorPointsOrthogonalCalculator(this).getPoints()),this.actualRoutingMode!==y.ConnectorRoutingMode.None&&this.points&&this.renderPoints)){var D=this.points[0],L=this.points[this.points.length-1];if(!D.equals(L)){var H=this.routingStrategy.createRenderPoints(this.points,this.renderPoints,this.beginItem,this.endItem,this.beginConnectionPointIndex,this.endConnectionPointIndex,v.ModelUtils.getConnectorContainer(this));H?(this.changeRenderPoints(H),this.actualRoutingMode=y.ConnectorRoutingMode.AllShapesOnly):this.actualRoutingMode=y.ConnectorRoutingMode.None}}}else this.changeRenderPoints(this.getCalculator().getPoints());return E?this.renderPoints:this.renderPointsWithoutSkipped},R.prototype.tryCreateRenderPointsContext=function(E){return E||this.shouldChangeRenderPoints?new w.ConnectorRenderPointsContext(this.renderPoints.map(function(D){return D.clone()}),this.lockCreateRenderPoints,this.actualRoutingMode):void 0},R.prototype.updatePointsOnPageResize=function(E,D){this.points=this.points.map(function(L){return L.clone().offset(E,D)}),this.renderPoints&&this.changeRenderPoints(this.renderPoints.map(function(L){var H=L.clone().offset(E,D);return H.pointIndex=L.pointIndex,H.skipped=L.skipped,H}))},R.prototype.addPoint=function(E,D){this.points.splice(E,0,D)},R.prototype.deletePoint=function(E){this.points.splice(E,1)},R.prototype.movePoint=function(E,D){this.points[E]=D},R.prototype.onAddPoint=function(E,D){this.shouldChangeRenderPoints?this.replaceRenderPointsCore(this.routingStrategy.onAddPoint(this.points,E,D,this.renderPoints),!0,y.ConnectorRoutingMode.AllShapesOnly):this.invalidateRenderPoints()},R.prototype.onDeletePoint=function(E){this.shouldChangeRenderPoints?this.replaceRenderPointsCore(this.routingStrategy.onDeletePoint(this.points,E,this.renderPoints),this.points.length>2,y.ConnectorRoutingMode.AllShapesOnly):this.invalidateRenderPoints()},R.prototype.onMovePoint=function(E,D){this.shouldChangeRenderPoints?(E!==0&&E!==this.points.length-1||(this.lockCreateRenderPoints=!1),this.replaceRenderPointsCore(this.routingStrategy.onMovePoint(this.points,E,D,this.renderPoints),this.lockCreateRenderPoints,y.ConnectorRoutingMode.AllShapesOnly)):this.invalidateRenderPoints()},R.prototype.onMovePoints=function(E,D,L,H){this.shouldChangeRenderPoints?(E!==0&&L!==this.points.length-1||(this.lockCreateRenderPoints=!1),this.replaceRenderPointsCore(this.routingStrategy.onMovePoints(this.points,E,D,L,H,this.renderPoints),this.lockCreateRenderPoints,y.ConnectorRoutingMode.AllShapesOnly)):this.invalidateRenderPoints()},R.prototype.replaceRenderPoints=function(E){E!==void 0?this.replaceRenderPointsCore(E.renderPoints,E.lockCreateRenderPoints,E.actualRoutingMode):this.invalidateRenderPoints()},R.prototype.clearRenderPoints=function(){this.changeRenderPoints(void 0),this.lockCreateRenderPoints=!1,this.actualRoutingMode=void 0,this.invalidateRenderPoints()},R.prototype.replaceRenderPointsCore=function(E,D,L){this.changeRenderPoints(E),this.lockCreateRenderPoints=D,this.actualRoutingMode=L,this.invalidateRenderPoints()},R.prototype.changeRenderPoints=function(E){this.renderPoints=E,this.renderPointsWithoutSkipped=E?this.renderPoints.filter(function(D){return!D.skipped}):void 0},R.prototype.getCalculator=function(){return this.properties.lineOption===x.ConnectorLineOption.Straight?new C.ConnectorPointsCalculator(this):new b.ConnectorPointsOrthogonalCalculator(this)},R.prototype.invalidateRenderPoints=function(){this.shouldInvalidateRenderPoints=!0},R.prototype.createPrimitives=function(){var E=[],D=this.getRenderPoints(),L=new a.PathPrimitive(D.map(function(H,O){return O===0?new a.PathPrimitiveMoveToCommand(H.x,H.y):new a.PathPrimitiveLineToCommand(H.x,H.y)}),this.style);return E.push(L),E=(E=E.concat(this.createLineEndingPrimitives(D,L))).concat(this.createTextPrimitives())},R.prototype.createLineEndingPrimitives=function(E,D){var L=[];return E.length>1&&[{strategy:this.createLineEndingStrategy(this.properties.startLineEnding),point1:E[0],point2:E[1]},{strategy:this.createLineEndingStrategy(this.properties.endLineEnding),point1:E[E.length-1],point2:E[E.length-2]}].forEach(function(H){var O=H.strategy;if(O.hasCommands()){var z=D;O.needCreateSeparatePrimitive()&&L.push(z=O.createPrimitive()),z.commands=z.commands.concat(O.createCommands(H.point1,H.point2))}}),L},R.prototype.createLineEndingStrategy=function(E){switch(E){case x.ConnectorLineEnding.None:return new S.ConnectorLineEndingNoneStrategy(this.style);case x.ConnectorLineEnding.Arrow:return new S.ConnectorLineEndingArrowStrategy(this.style);case x.ConnectorLineEnding.OutlinedTriangle:return new S.ConnectorLineEndingOutlinedTriangleStrategy(this.style);case x.ConnectorLineEnding.FilledTriangle:return new S.ConnectorLineEndingFilledTriangleStrategy(this.style);default:return new S.ConnectorLineEndingStrategy(this.style)}},R.prototype.createSelectorPrimitives=function(){var E=[],D=this.getRenderPoints();return E.push(new a.PathPrimitive(D.map(function(L,H){return H===0?new a.PathPrimitiveMoveToCommand(L.x,L.y):new a.PathPrimitiveLineToCommand(L.x,L.y)}),null,"selector")),E},R.prototype.createTextPrimitives=function(){var E=this;if(!this.enableText)return[];var D=[];return this.texts.forEach(function(L){var H=E.getText(L.position);if(H&&H!==""){var O=E.getTextPoint(L.position);D=D.concat([new c.TextPrimitive(O.x,O.y,H,r.TextOwner.Connector,void 0,void 0,void 0,E.styleText,!0,null,e.PAGE_BG_TEXTFLOOR_FILTER_ID,void 0,function(z){l.RenderUtils.setElementEventData(z,o.MouseEventElementType.ConnectorText,E.key,L.position)})])}}),D},R.prototype.getExtremeItem=function(E){return E===p.Begin?this.beginItem:E===p.End?this.endItem:null},R.prototype.getExtremeConnectionPointIndex=function(E){return E===p.Begin?this.beginConnectionPointIndex:E===p.End?this.endConnectionPointIndex:-1},R.prototype.getMinX=function(){return this.getRenderPoints().map(function(E){return E.x}).reduce(function(E,D){return Math.min(E,D)},Number.MAX_VALUE)},R.prototype.getMinY=function(){return this.getRenderPoints().map(function(E){return E.y}).reduce(function(E,D){return Math.min(E,D)},Number.MAX_VALUE)},R.prototype.getConnectionPoints=function(){return[]},R.prototype.getConnectionPointSide=function(E,D){return f.ConnectionPointSide.Undefined},R.prototype.getSegments=function(){var E=[],D=this.getRenderPoints();return D.forEach(function(L,H){H>0&&E.push(new i.Segment(D[H-1],L))}),E},R.prototype.intersectedByRect=function(E){return this.getSegments().some(function(D){return D.isIntersectedByRect(E)})},R.prototype.toNative=function(E){var D=new n.NativeConnector(this.key,this.dataKey);return D.fromKey=this.beginItem&&this.beginItem.dataKey,D.toKey=this.endItem&&this.endItem.dataKey,D.texts=this.texts.map(function(L){return L}).sort(function(L,H){return L.position-H.position}).map(function(L){return L.value}),D.fromId=this.beginItem&&this.beginItem.key,D.fromPointIndex=this.beginConnectionPointIndex,D.toId=this.endItem&&this.endItem.key,D.toPointIndex=this.endConnectionPointIndex,D.points=this.points.map(function(L){return L.clone()}),D.applyUnits(E),D},R.minOffset=u.UnitConverter.pixelsToTwips(24),R.minTextHeight=u.UnitConverter.pixelsToTwips(12),R}(f.DiagramItem);h.Connector=_},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeDescription=h.ShapeTextPadding=h.ShapeDefaultSize=h.ShapeMinDimension=h.ShapeDefaultDimension=void 0;var m=d(12),P=d(2),p=d(36),u=d(43),s=d(21),i=d(63),t=d(3),e=d(45),n=d(9);h.ShapeDefaultDimension=1440,h.ShapeMinDimension=360,h.ShapeDefaultSize=new P.Size(h.ShapeDefaultDimension,h.ShapeDefaultDimension),h.ShapeTextPadding=m.UnitConverter.pixelsToTwips(10);var o=function(){function r(a,c){a===void 0&&(a=h.ShapeDefaultSize.clone()),this.defaultSize=a,this.hasDefaultText=c,this.onChanged=new t.EventDispatcher,this.connectionPoints=this.createConnectionPoints()}return Object.defineProperty(r.prototype,"enableText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"allowEditText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"enableImage",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"allowEditImage",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hasTemplate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"enableChildren",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minWidth",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minHeight",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxHeight",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"toolboxSize",{get:function(){return this.defaultSize},enumerable:!1,configurable:!0}),r.prototype.getTitle=function(){return p.DiagramLocalizationService.shapeTexts[this.key]},r.prototype.getDefaultText=function(){return this.hasDefaultText?p.DiagramLocalizationService.shapeTexts[this.key]:""},r.prototype.getDefaultImageUrl=function(){return""},r.prototype.getConnectionPoints=function(){return this.connectionPoints},r.prototype.createConnectionPoints=function(){return[new e.ConnectionPoint(.5,0,n.ConnectionPointSide.North),new e.ConnectionPoint(1,.5,n.ConnectionPointSide.East),new e.ConnectionPoint(.5,1,n.ConnectionPointSide.South),new e.ConnectionPoint(0,.5,n.ConnectionPointSide.West)]},r.prototype.processConnectionPoint=function(a,c){},r.prototype.getConnectionPointIndexForItem=function(a,c){return c},r.prototype.getConnectionPointIndexForSide=function(a){return a},r.getConnectionPointSideByGeometry=function(a){return a.x>=a.y&&(a.x>0||a.y>0)?a.x<.5||1-a.x>=a.y?n.ConnectionPointSide.North:n.ConnectionPointSide.East:a.x>.5||1-a.x<=a.y?n.ConnectionPointSide.South:n.ConnectionPointSide.West},r.prototype.createParameters=function(a){},r.prototype.normalizeParameters=function(a,c){},r.prototype.modifyParameters=function(a,c,l,y){throw Error("Not implemented")},r.prototype.changeParameterValue=function(a,c,l){var y=a.get(c);y.value=l(y)},r.prototype.getParameterPoints=function(a){return[]},r.prototype.getExpandedSize=function(a){return a.size},r.prototype.getCollapsedSize=function(a){return a.size},r.prototype.getToolboxHeightToWidthRatio=function(a,c){return c/a},r.prototype.allowResizeHorizontally=function(a){return!0},r.prototype.allowResizeVertically=function(a){return!0},r.prototype.createPrimitives=function(a,c){var l=[];return l=l.concat(this.createShapePrimitives(a,c)),this.enableImage&&(l=l.concat(this.createImagePrimitives(a,c))),this.enableText&&(l=l.concat(this.createTextPrimitives(a,c))),l},r.prototype.createImagePrimitives=function(a,c){return[]},r.prototype.createTextPrimitives=function(a,c){if(a.text===void 0||a.text==="")return[];var l=this.getTextRectangle(a);return[new i.TextPrimitive(l.x,l.y,a.text,u.TextOwner.Shape,l.width,l.height,r.textSpacing,a.styleText,!1,this.getTextClipPathId(c),void 0,this.getTextAngle())]},r.prototype.getTextClipPathId=function(a){},r.prototype.getTextAngle=function(){return i.TextAngle.Angle0deg},r.prototype.getClientRectangle=function(a){return a.rectangle},r.prototype.getTextEditRectangle=function(a){return this.getTextRectangle(a)},r.prototype.createSelectorPrimitives=function(a){return[new s.RectanglePrimitive(a.position.x,a.position.y,a.size.width,a.size.height,null,"selector")]},r.prototype.raiseShapeDescriptionChanged=function(a){this.onChanged.raise1(function(c){return c.notifyShapeDescriptionChanged(a)})},r.textSpacing=m.UnitConverter.pixelsToTwips(2),r}();h.ShapeDescription=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.CompositionHistoryItem=h.HistoryItem=void 0;var p=function(){function s(){this.uniqueId=-1}return s.prototype.changeModified=function(){return!0},s.prototype.getName=function(){return this.constructor.name},s}();h.HistoryItem=p;var u=function(s){function i(){var t=s!==null&&s.apply(this,arguments)||this;return t.historyItems=[],t.dataSyncItems=[],t}return P(i,s),i.prototype.changeModified=function(){for(var t,e=0;t=this.historyItems[e];e++)if(t.changeModified())return!0;return!1},i.prototype.redo=function(t){for(var e,n=0;e=this.historyItems[n];n++)e.redo(t)},i.prototype.undo=function(t){for(var e,n=this.dataSyncItems.length-1;e=this.dataSyncItems[n];n--)e.undo(t);for(this.dataSyncItems=[],n=this.historyItems.length-1;e=this.historyItems[n];n--)e.undo(t)},i.prototype.add=function(t){if(t==null)throw new Error("cannot be null");this.historyItems.push(t)},i}(p);h.CompositionHistoryItem=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramItem=h.DEFAULT_ZINDEX=h.ConnectionPointSide=void 0;var m,P=d(13),p=d(35),u=d(3),s=d(26);(function(t){t[t.Undefined=-1]="Undefined",t[t.North=0]="North",t[t.East=1]="East",t[t.South=2]="South",t[t.West=3]="West"})(m=h.ConnectionPointSide||(h.ConnectionPointSide={})),h.DEFAULT_ZINDEX=0;var i=function(){function t(){this.key=void 0,this.dataKey=void 0,this.customData=void 0,this.attachedConnectors=[],this.zIndex=h.DEFAULT_ZINDEX,this.locked=!1,this.container=void 0,this.style=new s.Style,this.styleText=new s.TextStyle}return t.prototype.assign=function(e){e.key=this.key,e.dataKey=this.dataKey,e.customData=u.ObjectUtils.cloneObject(this.customData),e.locked=this.locked,e.attachedConnectors=this.attachedConnectors.slice(),e.style=this.style.clone(),e.styleText=this.styleText.clone(),e.zIndex=this.zIndex,e.container=this.container},t.prototype.getConnectionPointPosition=function(e,n){return this.getConnectionPoint(e,n).toPoint()},t.prototype.getConnectionPoint=function(e,n){e<0&&n&&(e=this.getNearestConnectionPoint(n));var o=this.getConnectionPoints();return o[e]||o[0]},t.prototype.getNearestConnectionPoint=function(e){var n,o=Number.MAX_VALUE;return this.getConnectionPoints().forEach(function(r,a){var c=p.Metrics.euclideanDistance(r,e);c<o&&(o=c,n=a)}),n},t.prototype.getConnectionPointIndex=function(e){var n=this.getConnectionPoints();return n.reduce(function(o,r,a){return e===m.North&&r.y<n[o].y||e===m.South&&r.y>n[o].y||e===m.West&&r.x<n[o].x||e===m.East&&r.x>n[o].x?a:o},0)},t.prototype.getConnectionPointSideByIndex=function(e,n){var o=this.getConnectionPoint(e,n);return this.getConnectionPointSide(o,n)},t.prototype.getConnectionPointIndexForSide=function(e){return e},Object.defineProperty(t.prototype,"enableText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowEditText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasTemplate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enableChildren",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLocked",{get:function(){return this.locked||this.container&&this.container.isLocked},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowResizeHorizontally",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowResizeVertically",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return this.style.strokeWidth},enumerable:!1,configurable:!0}),t.prototype.intersectedByRect=function(e){return P.Rectangle.areIntersected(this.rectangle,e)},t}();h.DiagramItem=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.SimpleCommandBase=void 0;var p=d(197),u=d(198),s=d(4),i=d(36),t=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return P(n,e),n.prototype.getState=function(){return new u.SimpleCommandState(this.isEnabled(),this.getValue(),this.getDefaultValue(),this.getItems(),this.isVisible())},n.prototype.isVisible=function(){return!0},n.prototype.isEnabled=function(){return!this.control.settings.readOnly||this.isEnabledInReadOnlyMode()},n.prototype.isEnabledInReadOnlyMode=function(){return!1},n.prototype.getValue=function(){},n.prototype.getDefaultValue=function(){},n.prototype.getItems=function(){},n.prototype.getModelUnit=function(o){return s.ModelUtils.getlUnitValue(this.control.model.units,o)},n.prototype.getModelUnitText=function(o){return s.ModelUtils.getUnitText(this.control.model.units,i.DiagramLocalizationService.unitItems,i.DiagramLocalizationService.formatUnit,o)},n.prototype.getModelUnitTwipsValue=function(o){return s.ModelUtils.getTwipsValue(this.control.model.units,o)},n.prototype.getViewUnit=function(o){return s.ModelUtils.getlUnitValue(this.control.settings.viewUnits,o)},n.prototype.getViewUnitText=function(o){return s.ModelUtils.getUnitText(this.control.settings.viewUnits,i.DiagramLocalizationService.unitItems,i.DiagramLocalizationService.formatUnit,o)},n.prototype.getViewUnitTwipsValue=function(o){return s.ModelUtils.getTwipsValue(this.control.settings.viewUnits,o)},n}(p.CommandBase);h.SimpleCommandBase=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramClipboardEvent=h.DiagramKeyboardEvent=h.DiagramContextMenuEvent=h.DiagramWheelEvent=h.DiagramMouseEvent=h.DiagramMouseEventBase=h.DiagramMouseEventTouch=h.DiagramFocusEvent=h.DiagramEvent=h.ResizeEventSource=h.MouseEventSource=h.MouseEventElementType=h.MouseButton=void 0;var p=d(25);(function(l){l[l.None=0]="None",l[l.Left=1]="Left",l[l.Right=2]="Right",l[l.Middle=4]="Middle"})(h.MouseButton||(h.MouseButton={})),function(l){l[l.Undefined=0]="Undefined",l[l.Background=1]="Background",l[l.Document=2]="Document",l[l.Connector=3]="Connector",l[l.ConnectorPoint=4]="ConnectorPoint",l[l.ConnectorSide=5]="ConnectorSide",l[l.ConnectorOrthogonalSide=6]="ConnectorOrthogonalSide",l[l.ConnectorText=7]="ConnectorText",l[l.Shape=8]="Shape",l[l.ShapeResizeBox=9]="ShapeResizeBox",l[l.ShapeParameterBox=10]="ShapeParameterBox",l[l.SelectionRect=11]="SelectionRect",l[l.ShapeConnectionPoint=12]="ShapeConnectionPoint",l[l.ShapeExpandButton=13]="ShapeExpandButton"}(h.MouseEventElementType||(h.MouseEventElementType={}));var u=function(){return function(l,y,g){this.type=l,this.key=y,this.value=g}}();h.MouseEventSource=u,function(l){l[l.Undefined=0]="Undefined",l[l.ResizeBox_NW=1]="ResizeBox_NW",l[l.ResizeBox_NE=2]="ResizeBox_NE",l[l.ResizeBox_SE=3]="ResizeBox_SE",l[l.ResizeBox_SW=4]="ResizeBox_SW",l[l.ResizeBox_N=5]="ResizeBox_N",l[l.ResizeBox_E=6]="ResizeBox_E",l[l.ResizeBox_S=7]="ResizeBox_S",l[l.ResizeBox_W=8]="ResizeBox_W"}(h.ResizeEventSource||(h.ResizeEventSource={}));var s=function(){return function(l){this.modifiers=l}}();h.DiagramEvent=s;var i=function(l){function y(g){var f=l.call(this,p.ModifierKey.None)||this;return f.inputText=g,f}return P(y,l),y}(s);h.DiagramFocusEvent=i;var t=function(){return function(l,y){this.offsetPoint=l,this.modelPoint=y}}();h.DiagramMouseEventTouch=t;var e=function(l){function y(g,f,v,C){var b=l.call(this,g)||this;return b.offsetPoint=f,b.modelPoint=v,b.source=C,b}return P(y,l),y}(s);h.DiagramMouseEventBase=e;var n=function(l){function y(g,f,v,C,b,S,x){S===void 0&&(S=[]);var I=l.call(this,g,v,C,b)||this;return I.button=f,I.touches=S,I.isTouchMode=x,I.scrollX=0,I.scrollY=0,I}return P(y,l),y}(e);h.DiagramMouseEvent=n;var o=function(l){function y(g,f,v,C,b,S){var x=l.call(this,g,C,b,S)||this;return x.deltaX=f,x.deltaY=v,x}return P(y,l),y}(e);h.DiagramWheelEvent=o;var r=function(l){function y(g,f,v){var C=l.call(this,g)||this;return C.eventPoint=f,C.modelPoint=v,C}return P(y,l),y}(s);h.DiagramContextMenuEvent=r;var a=function(l){function y(g,f,v){var C=l.call(this,g)||this;return C.keyCode=f,C.inputText=v,C}return P(y,l),y.prototype.getShortcutCode=function(){return this.modifiers|this.keyCode},y}(s);h.DiagramKeyboardEvent=a;var c=function(l){function y(g){var f=l.call(this,p.ModifierKey.None)||this;return f.clipboardData=g,f}return P(y,l),y}(s);h.DiagramClipboardEvent=c},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return P.hundredthsOfMillimeterToTwipsRound=function(p){return Math.round(1440*p/2540)},P.documentsToTwips=function(p){return 24*p/5},P.pixelsToTwips=function(p){return Math.round(P.pixelsToTwipsF(p))},P.pixelsToTwipsCustomDpi=function(p,u){return Math.round(P.pixelsToTwipsFCustomDpi(p,u))},P.inchesToTwips=function(p){return Math.round(P.inchesToTwipsF(p))},P.pointsToTwips=function(p){return Math.round(P.pointsToTwipsF(p))},P.picasToTwips=function(p){return Math.round(1440*p/P.PICAS_PER_INCH)},P.centimetersToTwips=function(p){return Math.round(P.centimetersToTwipsF(p))},P.pixelsToTwipsF=function(p){return 1440*p/P.DPI},P.pixelsToTwipsFCustomDpi=function(p,u){return 1440*p/u},P.inchesToTwipsF=function(p){return 1440*p},P.pointsToTwipsF=function(p){return 20*p},P.centimetersToTwipsF=function(p){return 1440*p/P.CENTIMETERS_PER_INCH},P.twipsToDegrees=function(p){return p/6e4},P.twipsToRadians=function(p){return p/6e4*Math.PI/180},P.degreesToTwips=function(p){return 6e4*p},P.radiansToTwips=function(p){return 6e4*p/Math.PI*180},P.radiansToDegrees=function(p){return p/Math.PI*180},P.twipsToFD=function(p){return Math.round(2048*p/1875)},P.fdToTwips=function(p){return Math.round(1875*p/2048)},P.emuToTwips=function(p){return p/635},P.twipsToPixels=function(p){return Math.round(P.twipsToPixelsF(p))},P.inchesToPixels=function(p){return Math.round(P.DPI*p)},P.centimeterToPixel=function(p){return Math.round(this.centimeterToPixelF(p))},P.centimeterToPixelF=function(p){return p*P.DPI/P.CENTIMETERS_PER_INCH},P.millimetersToPixel=function(p){return Math.round(p/(P.CENTIMETERS_PER_INCH/P.DPI)/10)},P.pointsToPixels=function(p){return Math.round(p*P.DPI/72)},P.pointsToPixelsF=function(p){return p*P.DPI/72},P.twipsToPixelsF=function(p){return p*P.DPI/1440},P.pixelsToPoints=function(p){return Math.round(72*p/P.DPI)},P.pixelsToPointsF=function(p){return 72*p/P.DPI},P.twipsToPoints=function(p){return Math.round(this.twipsToPointsF(p))},P.twipsToPointsF=function(p){return p/20},P.twipsToInches=function(p){return p/1440},P.pixelsToInches=function(p){return p/P.DPI},P.twipsToCentimeters=function(p){return p*P.CENTIMETERS_PER_INCH/1440},P.pixelToCentimeters=function(p){return p*P.CENTIMETERS_PER_INCH/P.DPI},P.twipsToHundredthsOfMillimeter=function(p){return Math.round(127*p/72)},P.pixelsToHundredthsOfMillimeter=function(p){return Math.round(2540*p/P.DPI)},P.hundredthsOfMillimeterToTwips=function(p){return 15*p/127},P.twipsToEmu=function(p){return 635*p},P.twipsToDegree=function(p){return p/6e4},P.DPI=96,P.CENTIMETERS_PER_INCH=2.54,P.PICAS_PER_INCH=6,P}();h.UnitConverter=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m,P=d(163),p=d(164),u=d(106),s=d(0),i=d(2),t=function(){function n(o,r,a,c){this.x=o,this.y=r,this.width=a,this.height=c}return Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{get:function(){return n.center(this)},enumerable:!0,configurable:!0}),n.prototype.createRectangle=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.createSize=function(){return new i.Size(this.width,this.height)},n.prototype.createPosition=function(){return new s.Point(this.x,this.y)},n.prototype.createVerticalInterval=function(){return new u.FixedInterval(this.y,this.height)},n.prototype.createHorizontalInterval=function(){return new u.FixedInterval(this.x,this.width)},n.fromGeometry=function(o,r){return new n(o.x,o.y,r.width,r.height)},n.fromPoints=function(o,r){return new n(Math.min(o.x,r.x),Math.min(o.y,r.y),Math.abs(o.x-r.x),Math.abs(o.y-r.y))},n.fromPositions=function(o,r,a,c){return new n(Math.min(o,a),Math.min(r,c),Math.abs(a-o),Math.abs(c-r))},n.fromCenter=function(o,r){return new n(o.x-r,o.y-r,2*r,2*r)},n.prototype.isCollapsed=function(){return this.width===0||this.height===0},n.prototype.isEmpty=function(){return this.x===0&&this.y===0&&this.width===0&&this.height===0},n.prototype.toString=function(){return JSON.stringify(this)},n.prototype.setPosition=function(o){return this.x=o.x,this.y=o.y,this},n.prototype.setSize=function(o){return this.width=o.width,this.height=o.height,this},n.prototype.setGeomerty=function(o){return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this},n.prototype.moveRectangle=function(o,r){return this.x+=o,this.y+=r,this},n.prototype.moveRectangleByPoint=function(o){return this.x+=o.x,this.y+=o.y,this},n.prototype.resize=function(o,r){return this.width+=o,this.height+=r,this},n.prototype.nonNegativeSize=function(){return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this},n.prototype.multiply=function(o,r){return this.x*=o,this.y*=r,this.width*=o,this.height*=r,this},n.prototype.equals=function(o){return n.equals(this,o)},n.prototype.clone=function(){var o=new n(0,0,0,0);return o.copyFrom(this),o},n.prototype.copyFrom=function(o){this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height},n.prototype.containsPoint=function(o){return n.containsPoint(this,o)},n.prototype.containsRectangle=function(o){return this.x<=o.x&&this.right>=o.right&&this.y<=o.y&&this.bottom>=o.bottom},n.prototype.inflate=function(o,r){return r===void 0&&(r=o),this.x-=o,this.y-=r,this.width+=2*o,this.height+=2*r,this},n.prototype.applyOffsetsInside=function(o){return this.x+=o.left,this.y+=o.top,this.width-=o.left+o.right,this.height-=o.top+o.bottom,this},n.prototype.applyNormalizedOffsetsInside=function(o){var r=Math.max(0,o.left),a=r+Math.max(0,o.right);a!==0&&(a<=this.width?(this.x+=r,this.width-=a):(this.x+=this.width*(r/a),this.width=0));var c=Math.max(0,o.top),l=c+Math.max(0,o.bottom);return l!==0&&(l<=this.height?(this.y+=c,this.height-=l):(this.y+=this.height*(c/l),this.height=0)),this},n.prototype.applyOffsetsOutside=function(o){return this.x-=o.left,this.y-=o.top,this.width+=o.left+o.right,this.height+=o.top+o.bottom,this},n.prototype.applyConverter=function(o){return this.x=o(this.x),this.y=o(this.y),this.width=o(this.width),this.height=o(this.height),this},n.getHorizIntersection=function(o,r){return p.IntervalAlgorithms.getIntersection(new u.FixedInterval(o.x,o.width),new u.FixedInterval(r.x,r.width))},n.getVertIntersection=function(o,r){return p.IntervalAlgorithms.getIntersection(new u.FixedInterval(o.y,o.height),new u.FixedInterval(r.y,r.height))},n.getIntersection=function(o,r){var a=p.IntervalAlgorithms.getIntersection(new u.FixedInterval(o.x,o.width),new u.FixedInterval(r.x,r.width));if(!a)return null;var c=p.IntervalAlgorithms.getIntersection(new u.FixedInterval(o.y,o.height),new u.FixedInterval(r.y,r.height));return c?new n(a.start,c.start,a.length,c.length):null},n.getHorNonCollapsedIntersection=function(o,r){var a=n.getHorizIntersection(o,r);return a&&!a.isCollapsed()?a:null},n.getVertNonCollapsedIntersection=function(o,r){var a=n.getVertIntersection(o,r);return a&&!a.isCollapsed()?a:null},n.getNonCollapsedIntersection=function(o,r){var a=n.getIntersection(o,r);return a&&!a.isCollapsed()?a:null},n.areIntersected=function(o,r){return!(o.x>r.x+r.width||r.x>o.x+o.width||o.y>r.y+r.height||r.y>o.y+o.height)},n.union=function(o,r){var a=Math.max(o.x+o.width,r.x+r.width),c=Math.max(o.y+o.height,r.y+r.height),l=Math.min(o.x,r.x),y=Math.min(o.y,r.y);return new n(l,y,a-l,c-y)},n.equals=function(o,r){return o.x===r.x&&o.y===r.y&&o.width===r.width&&o.height===r.height},n.center=function(o){return new s.Point(o.x+o.width/2,o.y+o.height/2)},n.containsPoint=function(o,r){var a=o.x+o.width,c=o.y+o.height;return r.y>=o.y&&c>=r.y&&r.x>=o.x&&a>=r.x},n}();h.Rectangle=t,function(n){n[n.None=0]="None",n[n.Top=1]="Top",n[n.Bottom=2]="Bottom",n[n.Left=4]="Left",n[n.Right=8]="Right"}(m=h.HitTestDeviation||(h.HitTestDeviation={}));var e=function(){function n(o,r){this.initRectangle=o,this.initPoint=r,this.deviation=new P.Flag(m.None)}return n.prototype.calcDeviation=function(){return this.initPoint.x<this.initRectangle.x?this.deviation.set(m.Left,!0):this.initPoint.x>this.initRectangle.right&&this.deviation.set(m.Right,!0),this.initPoint.y<this.initRectangle.y?this.deviation.set(m.Top,!0):this.initPoint.y>this.initRectangle.bottom&&this.deviation.set(m.Bottom,!0),this},n.prototype.calcAdditionalParams=function(){return this.insidePoint=this.initPoint.clone(),this.offsetToInside=new s.Point(0,0),this.deviation.get(m.Left)?(this.insidePoint.x=this.initRectangle.x,this.offsetToInside.x=this.insidePoint.x-this.initPoint.x):this.deviation.get(m.Right)&&(this.insidePoint.x=this.initRectangle.right,this.offsetToInside.x=this.initPoint.x-this.insidePoint.x),this.deviation.get(m.Top)?(this.insidePoint.y=this.initRectangle.y,this.offsetToInside.y=this.insidePoint.y-this.initPoint.y):this.deviation.get(m.Bottom)&&(this.insidePoint.y=this.initRectangle.bottom,this.offsetToInside.y=this.initPoint.y-this.insidePoint.y),this},n}();h.RectangleDeviation=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.Shape=void 0;var p=d(13),u=d(7),s=d(37),i=d(9),t=d(45),e=d(51),n=d(84),o=function(r){function a(c,l,y){var g=r.call(this)||this;if(g.description=c,g.children=[],g.expanded=!0,g.expandedSize=void 0,!c)throw Error("Shape type is incorrect");g.position=l.clone();var f=y?c.toolboxSize:c.defaultSize;return g.size=f.clone(),g.text=c.getDefaultText(),g.image=new e.ImageInfo(c.getDefaultImageUrl()),g.parameters=new s.ShapeParameters,c.createParameters(g.parameters),g}return P(a,r),a.prototype.assign=function(c){r.prototype.assign.call(this,c),c.size=this.size.clone(),c.text=this.text,c.image=this.image.clone(),c.parameters=this.parameters.clone(),c.children=this.children.slice(),c.expanded=this.expanded,this.expandedSize&&(c.expandedSize=this.expandedSize.clone())},a.prototype.clone=function(){var c=new a(this.description,this.position.clone());return this.assign(c),c},Object.defineProperty(a.prototype,"enableText",{get:function(){return this.description.enableText},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"allowEditText",{get:function(){return this.description.allowEditText},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hasTemplate",{get:function(){return this.description.hasTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"enableChildren",{get:function(){return this.description.enableChildren},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"enableImage",{get:function(){return this.description.enableImage},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"allowEditImage",{get:function(){return this.description.allowEditImage},enumerable:!1,configurable:!0}),a.prototype.getMinWidth=function(c){return typeof this.description.minWidth=="number"?this.description.minWidth:typeof c=="number"?c:u.ShapeMinDimension},a.prototype.getMinHeight=function(c){return typeof this.description.minHeight=="number"?this.description.minHeight:typeof c=="number"?c:u.ShapeMinDimension},a.prototype.getMaxWidth=function(c){return typeof this.description.maxWidth=="number"?this.description.maxWidth:typeof c=="number"?c:void 0},a.prototype.getMaxHeight=function(c){return typeof this.description.maxHeight=="number"?this.description.maxHeight:typeof c=="number"?c:void 0},a.prototype.createPrimitives=function(){return this.description.createPrimitives(this)},a.prototype.createSelectorPrimitives=function(){return this.description.createSelectorPrimitives(this)},a.prototype.normalizeX=function(c){return Math.max(this.position.x,Math.min(c,this.position.x+this.size.width))},a.prototype.normalizeY=function(c){return Math.max(this.position.y,Math.min(c,this.position.y+this.size.height))},a.prototype.getConnectionPoints=function(){var c=this;return this.description.getConnectionPoints().map(function(l){var y=new t.ConnectionPoint(c.position.x+l.x*c.size.width,c.position.y+l.y*c.size.height,l.side);return c.description.processConnectionPoint(c,y),y})},a.prototype.getConnectionPointSide=function(c,l){return c.side!==i.ConnectionPointSide.Undefined?c.side:this.getConnectionPointSideByGeometry(c)},a.prototype.getConnectionPointSideByGeometry=function(c){var l=c.clone().offset(-this.position.x,-this.position.y).multiply(1/this.size.width,1/this.size.height);return u.ShapeDescription.getConnectionPointSideByGeometry(l)},a.prototype.getConnectionPointIndexForItem=function(c,l){return this.description.getConnectionPointIndexForItem(c,l)},a.prototype.getConnectionPointIndexForSide=function(c){return this.description.getConnectionPointIndexForSide(c)},a.prototype.toggleExpandedSize=function(){this.expanded?(this.size=this.getExpandedSize(),this.expandedSize=void 0):(this.expandedSize=this.size.clone(),this.size=this.getCollapsedSize())},a.prototype.getExpandedSize=function(){return this.description.getExpandedSize(this)},a.prototype.getCollapsedSize=function(){return this.description.getCollapsedSize(this)},a.prototype.getToolboxHeightToWidthRatio=function(){return this.description.getToolboxHeightToWidthRatio(this.size.width,this.size.height)},Object.defineProperty(a.prototype,"allowResizeHorizontally",{get:function(){return this.description.allowResizeHorizontally(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"allowResizeVertically",{get:function(){return this.description.allowResizeVertically(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rectangle",{get:function(){return p.Rectangle.fromGeometry(this.position,this.size)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"clientRectangle",{get:function(){return this.description.getClientRectangle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"textRectangle",{get:function(){return this.description.getTextRectangle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"textEditRectangle",{get:function(){return this.description.getTextEditRectangle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"textAngle",{get:function(){return this.description.getTextAngle()},enumerable:!1,configurable:!0}),a.prototype.toNative=function(c){var l=new n.NativeShape(this.key,this.dataKey);return l.type=this.description.key,l.text=this.text,l.position=this.position.clone(),l.size=this.size.clone(),l.attachedConnectorIds=this.attachedConnectors.map(function(y){return y.key}),l.applyUnits(c),l.containerId=this.container?this.container.key:null,l.containerChildItemIds=this.children.map(function(y){return y.key}),l.containerExpanded=this.expanded,l},a}(i.DiagramItem);h.Shape=o},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.RenderHelper=h.svgNS=void 0;var m=d(61);h.svgNS="http://www.w3.org/2000/svg";var P=function(){function p(){}return p.createSvgElement=function(u,s){s===void 0&&(s=!1);var i=document.createElementNS(h.svgNS,"svg");return i.className.baseVal="dxdi-canvas"+(s?" export":""),u&&u.appendChild(i),i},p.createMainElement=function(u,s){s===void 0&&(s=!1);var i=document.createElement("div");return i.setAttribute("class","dxdi-control"+(s?" measurer":"")),m.Diagnostics.optimizeLayers&&(i.style.transform="translateZ(0)"),u&&u.appendChild(i),i},p.addEventListener=function(u,s,i){u.addEventListener(s,i)},p.removeEventListener=function(u,s,i){u.removeEventListener(s,i)},p}();h.RenderHelper=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramModelOperation=h.ModelOperationSettings=void 0;var m=function(){function P(){this._addShape=!0,this._addShapeFromToolbox=!0,this._deleteShape=!0,this._deleteConnector=!0,this._changeConnection=!0,this._changeConnectorPoints=!0,this._changeShapeText=!0,this._changeConnectorText=!0,this._resizeShape=!0,this._moveShape=!0}return Object.defineProperty(P.prototype,"addShape",{get:function(){return this._addShape},set:function(p){p!==this._addShape&&(this._addShape=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"addShapeFromToolbox",{get:function(){return this._addShapeFromToolbox},set:function(p){p!==this._addShapeFromToolbox&&(this._addShapeFromToolbox=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"deleteShape",{get:function(){return this._deleteShape},set:function(p){p!==this._deleteShape&&(this._deleteShape=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"deleteConnector",{get:function(){return this._deleteConnector},set:function(p){p!==this._deleteConnector&&(this._deleteConnector=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"changeConnection",{get:function(){return this._changeConnection},set:function(p){p!==this._changeConnection&&(this._changeConnection=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"changeConnectorPoints",{get:function(){return this._changeConnectorPoints},set:function(p){p!==this._changeConnectorPoints&&(this._changeConnectorPoints=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"changeShapeText",{get:function(){return this._changeShapeText},set:function(p){p!==this._changeShapeText&&(this._changeShapeText=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"changeConnectorText",{get:function(){return this._changeConnectorText},set:function(p){p!==this._changeConnectorText&&(this._changeConnectorText=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"resizeShape",{get:function(){return this._resizeShape},set:function(p){p!==this._resizeShape&&(this._resizeShape=p)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"moveShape",{get:function(){return this._moveShape},set:function(p){p!==this._moveShape&&(this._moveShape=p)},enumerable:!1,configurable:!0}),P.prototype.applySettings=function(p){p&&(typeof p.addShape=="boolean"&&(this.addShape=p.addShape),typeof p.addShapeFromToolbox=="boolean"&&(this.addShapeFromToolbox=p.addShapeFromToolbox),typeof p.deleteShape=="boolean"&&(this.deleteShape=p.deleteShape),typeof p.deleteConnector=="boolean"&&(this.deleteConnector=p.deleteConnector),typeof p.changeConnection=="boolean"&&(this.changeConnection=p.changeConnection),typeof p.changeConnectorPoints=="boolean"&&(this.changeConnectorPoints=p.changeConnectorPoints),typeof p.changeShapeText=="boolean"&&(this.changeShapeText=p.changeShapeText),typeof p.changeConnectorText=="boolean"&&(this.changeConnectorText=p.changeConnectorText),typeof p.resizeShape=="boolean"&&(this.resizeShape=p.resizeShape),typeof p.moveShape=="boolean"&&(this.moveShape=p.moveShape))},P}();h.ModelOperationSettings=m,function(P){P[P.AddShape=0]="AddShape",P[P.AddShapeFromToolbox=1]="AddShapeFromToolbox",P[P.DeleteShape=2]="DeleteShape",P[P.DeleteConnector=3]="DeleteConnector",P[P.ChangeConnection=4]="ChangeConnection",P[P.ChangeConnectorPoints=5]="ChangeConnectorPoints",P[P.BeforeChangeShapeText=6]="BeforeChangeShapeText",P[P.ChangeShapeText=7]="ChangeShapeText",P[P.BeforeChangeConnectorText=8]="BeforeChangeConnectorText",P[P.ChangeConnectorText=9]="ChangeConnectorText",P[P.ResizeShape=10]="ResizeShape",P[P.MoveShape=11]="MoveShape"}(h.DiagramModelOperation||(h.DiagramModelOperation={}))},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.raiseEvent=h.RenderUtils=void 0;var m=d(11),P=d(31),p=function(){function u(){}return u.updateSvgElementSize=function(s,i,t,e){s.style.width=i+"px",s.style.height=t+"px",s.setAttribute("viewBox","0 0 "+i+" "+t),e&&(s.setAttribute("width",i.toString()),s.setAttribute("height",t.toString()))},u.removeElement=function(s){s&&s.parentNode&&s.parentNode.removeChild(s)},u.removeContent=function(s){for(;s&&s.firstChild;)s.removeChild(s.firstChild)},u.setElementEventData=function(s,i,t,e){i!==m.MouseEventElementType.Undefined&&(s.setAttribute("data-type",i.toString()),t!==void 0&&s.setAttribute("data-key",t.toString()),e!==void 0&&s.setAttribute("data-value",e.toString()))},u.getElementEventData=function(s){if(s.getAttribute&&s.getAttribute("data-type"))return new m.MouseEventSource(parseInt(s.getAttribute("data-type")),s.getAttribute("data-key"),s.getAttribute("data-value"));var i=s.getAttribute&&s.getAttribute("class");return i==="dxdi-page"||i==="dxdi-main"?new m.MouseEventSource(m.MouseEventElementType.Document):void 0},u.getHtmlElementStylePropertyName=function(s){switch(s){case"fill":return"color";case"text-anchor":return"text-align"}return s},u.getTextAnchorValue=function(s,i){if(i===void 0&&(i=!1),i){if(s==="start")return"end";if(s==="end")return"start"}return s},u.getStrokeDasharrayValue=function(s,i){if(i){var t=s&&s.toString();return(t?t.split(/[\s,]+/):[]).map(function(e){return parseInt(e)/2*i}).join(",")}return s},u.applyStyleToElement=function(s,i,t){var e=this;t===void 0&&(t=!1);var n=s.getDefaultInstance();s.forEach(function(o){var r=s[o],a=i instanceof HTMLElement?e.getHtmlElementStylePropertyName(o):o;if(r!==void 0&&r!==""&&r!==n[o]){switch(o){case"text-anchor":r=e.getTextAnchorValue(r,t);break;case"stroke-dasharray":r=e.getStrokeDasharrayValue(r,parseInt(s["stroke-width"]))}i.style.setProperty(a,r)}else i.style.setProperty(a,"")})},u.generateSvgElementId=function(s){return s+"_"+P.MathUtils.generateGuid()},u.getUrlPathById=function(s){return"url(#"+s+")"},u}();h.RenderUtils=p,h.raiseEvent=function(u,s,i){i(s),s.preventDefault&&u.preventDefault()}},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return P.IdentUserAgent=function(p,u){u===void 0&&(u=!1);var s=["Mozilla","IE","Firefox","Netscape","Safari","Chrome","Opera","Opera10","Edge"],i={Safari:2,Chrome:.1,Mozilla:1.9,Netscape:8,Firefox:2,Opera:9,IE:6,Edge:12};if(p&&p.length!==0){p=p.toLowerCase(),P.indentPlatformMajorVersion(p);try{for(var t={Windows:"Win",Macintosh:"Mac","Mac OS":"Mac",Mac_PowerPC:"Mac","cpu os":"MacMobile","cpu iphone os":"MacMobile",Android:"Android","!Windows Phone":"WinPhone","!WPDesktop":"WinPhone","!ZuneWP":"WinPhone"},e="(?:(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?)?",n={Safari:"applewebkit(?:.*?(?:version/(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?[\\.\\w\\d]*?(?:\\s+mobile/\\S*)?\\s+safari))?",Chrome:"(?:chrome|crios)(?!frame)(?:/|\\s*)?"+e,Mozilla:"mozilla(?:.*rv:"+e+".*Gecko)?",Netscape:"(?:netscape|navigator)\\d*/?\\s*"+e,Firefox:"firefox(?:/|\\s*)?"+e,Opera:"(?:opera|\\sopr)(?:/|\\s*)?"+e,Opera10:"opera.*\\s*version(?:/|\\s*)?"+e,IE:"msie\\s*"+e,Edge:"edge(?:/|\\s*)?"+e},o=null,r=-1,a=0;a<s.length;a++){var c=s[a],l=new RegExp(n[c],"i").exec(p);if(l&&l.index>=0){if(o==="IE"&&r>=11&&c==="Safari")continue;(o=c)==="Opera10"&&(o="Opera"),r=P.GetBrowserVersion(p,l,"trident(?:/|\\s*)?(?:(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?)?",P.getIECompatibleVersionString()),o==="Mozilla"&&r>=11&&(o="IE")}}o||(o="IE");var y=r!==-1;y||(r=i[o]);var g=null,f=Number.MAX_VALUE;for(var v in t)if(Object.prototype.hasOwnProperty.call(t,v)){var C=v.substr(0,1)==="!",b=p.indexOf((C?v.substr(1):v).toLowerCase());b>=0&&(b<f||C)&&(f=C?0:b,g=t[v])}var S=p.toUpperCase().match("SM-[A-Z]"),x=S&&S.length>0;g==="WinPhone"&&r<9&&(r=Math.floor(P.getVersionFromTrident(p,"trident(?:/|\\s*)?"+e))),!u&&o==="IE"&&r>7&&document.documentMode<r&&(r=document.documentMode),g==="WinPhone"&&(r=Math.max(9,r)),g||(g="Win"),g!==t["cpu os"]||y||(r=4),P.fillUserAgentInfo(s,o,r,g,x)}catch{P.fillUserAgentInfo(s,"IE",i.IE,"Win")}}else P.fillUserAgentInfo(s,"IE",i.IE,"Win")},P.GetBrowserVersion=function(p,u,s,i){var t=P.getVersionFromMatches(u);if(i){var e=P.getVersionFromTrident(p,s);if(i==="edge"||parseInt(i)===e)return e}return t},P.getIECompatibleVersionString=function(){if(document.compatible){for(var p=0;p<document.compatible.length;p++)if(document.compatible[p].userAgent==="IE"&&document.compatible[p].version)return document.compatible[p].version.toLowerCase()}return""},P.isTouchEnabled=function(){return P.hasTouchStart()||P.hasMaxTouchPoints()||P.hasMsMaxTouchPoints()},P.hasTouchStart=function(){return"ontouchstart"in window},P.hasMaxTouchPoints=function(){return navigator.maxTouchPoints>0},P.hasMsMaxTouchPoints=function(){return navigator.msMaxTouchPoints>0},P.hasNavigator=function(){return typeof navigator<"u"},P.fillUserAgentInfo=function(p,u,s,i,t){t===void 0&&(t=!1);for(var e=0;e<p.length;e++){var n=p[e];P[n]=n===u}P.Version=Math.floor(10*s)/10,P.MajorVersion=Math.floor(P.Version),P.WindowsPlatform=i==="Win"||i==="WinPhone",P.MacOSMobilePlatform=i==="MacMobile"||i==="Mac"&&P.isTouchEnabled(),P.MacOSPlatform=i==="Mac"&&!P.MacOSMobilePlatform,P.AndroidMobilePlatform=i==="Android",P.WindowsPhonePlatform=i==="WinPhone",P.WebKitFamily=P.Safari||P.Chrome||P.Opera&&P.MajorVersion>=15,P.NetscapeFamily=P.Netscape||P.Mozilla||P.Firefox,P.WebKitTouchUI=P.MacOSMobilePlatform||P.AndroidMobilePlatform;var o=P.IE&&P.MajorVersion>9&&P.WindowsPlatform&&P.UserAgent.toLowerCase().indexOf("touch")>=0;if(P.MSTouchUI=o||P.Edge&&!!window.navigator.maxTouchPoints,P.TouchUI=P.WebKitTouchUI||P.MSTouchUI,P.MobileUI=P.WebKitTouchUI||P.WindowsPhonePlatform,P.AndroidDefaultBrowser=P.AndroidMobilePlatform&&!P.Chrome,P.AndroidChromeBrowser=P.AndroidMobilePlatform&&P.Chrome,t&&(P.SamsungAndroidDevice=t),P.MSTouchUI){var r=P.UserAgent.toLowerCase().indexOf("arm;")>-1;P.VirtualKeyboardSupported=r||P.WindowsPhonePlatform}else P.VirtualKeyboardSupported=P.WebKitTouchUI;P.fillDocumentElementBrowserTypeClassNames(p)},P.indentPlatformMajorVersion=function(p){var u=/(?:(?:windows nt|macintosh|mac os|cpu os|cpu iphone os|android|windows phone|linux) )(\d+)(?:[-0-9_.])*/.exec(p);u&&(P.PlaformMajorVersion=u[1])},P.getVersionFromMatches=function(p){var u=-1,s="";return p&&(p[1]&&(s+=p[1],p[2]&&(s+="."+p[2])),s!==""&&(u=parseFloat(s),isNaN(u)&&(u=-1))),u},P.getVersionFromTrident=function(p,u){var s=new RegExp(u,"i").exec(p);return P.getVersionFromMatches(s)+4},P.fillDocumentElementBrowserTypeClassNames=function(p){for(var u="",s=p.concat(["WindowsPlatform","MacOSPlatform","MacOSMobilePlatform","AndroidMobilePlatform","WindowsPhonePlatform","WebKitFamily","WebKitTouchUI","MSTouchUI","TouchUI","AndroidDefaultBrowser"]),i=0;i<s.length;i++){var t=s[i];P[t]&&(u+="dx"+t+" ")}u+="dxBrowserVersion-"+P.MajorVersion,typeof document<"u"&&document&&document.documentElement&&(document.documentElement.className!==""&&(u=" "+u),document.documentElement.className+=u,P.Info=u)},P.getUserAgent=function(){return P.hasNavigator()&&navigator.userAgent?navigator.userAgent.toLowerCase():""},P.UserAgent=P.getUserAgent(),P._foo=P.IdentUserAgent(P.UserAgent),P}();h.Browser=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.RectangleShapeDescription=void 0;var p=d(7),u=d(2),s=d(21),i=d(1),t=function(e){function n(o,r){return o===void 0&&(o=new u.Size(p.ShapeDefaultDimension,.75*p.ShapeDefaultDimension)),e.call(this,o,r)||this}return P(n,e),Object.defineProperty(n.prototype,"key",{get:function(){return i.ShapeTypes.Rectangle},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(o){var r=o.rectangle,a=r.x,c=r.y,l=r.width,y=r.height;return[new s.RectanglePrimitive(a,c,l,y,o.style)]},n.prototype.getTextRectangle=function(o){return o.rectangle.clone().inflate(-p.ShapeTextPadding,-p.ShapeTextPadding)},n.prototype.getSizeByText=function(o,r){return o.clone().offset(2*p.ShapeTextPadding,2*p.ShapeTextPadding)},n}(p.ShapeDescription);h.RectangleShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.Alignment=h.DataLayoutOrientation=h.LogicalDirectionKind=h.TreeLayoutSettings=h.LayoutSettings=void 0;var p=d(6),u=function(){return function(n){this.orientation=i.Vertical,this.direction=s.Forward;var o=n&&2*n>p.Connector.minOffset?2*n:p.Connector.minOffset;this.columnSpacing=o,this.layerSpacing=2*o,this.containerPadding=2*o,this.componentSpacing=2*o}}();h.LayoutSettings=u;var s,i,t,e=function(n){function o(r){var a=n.call(this,r)||this;return a.alignment=t.Center,a.subTreeColumnSpacing=a.componentSpacing/2,a}return P(o,n),o}(u);h.TreeLayoutSettings=e,function(n){n[n.Backward=0]="Backward",n[n.Forward=1]="Forward"}(s=h.LogicalDirectionKind||(h.LogicalDirectionKind={})),function(n){n[n.Horizontal=0]="Horizontal",n[n.Vertical=1]="Vertical"}(i=h.DataLayoutOrientation||(h.DataLayoutOrientation={})),function(n){n[n.Left=0]="Left",n[n.Center=1]="Center"}(t=h.Alignment||(h.Alignment={}))},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.RectanglePrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a,c,l){var y=s.call(this,r,a,c,l)||this;return y.x=t,y.y=e,y.width=n,y.height=o,y}return P(i,s),i.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"rect")},i.prototype.applyElementProperties=function(t,e){this.setUnitAttribute(t,"x",this.x),this.setUnitAttribute(t,"y",this.y),this.setUnitAttribute(t,"width",this.width),this.setUnitAttribute(t,"height",this.height),this.setPositionCorrectionAttribute(t),s.prototype.applyElementProperties.call(this,t,e)},i}(d(24).SvgPrimitive);h.RectanglePrimitive=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(49),P=function(){function p(){}return p.getAlpha=function(u){return u>>24&255},p.getRed=function(u){return u>>16&255},p.getGreen=function(u){return u>>8&255},p.getBlue=function(u){return 255&u},p.redPartToString=function(u){var s=p.getRed(u).toString(16);return s.length>1?s:"0"+s},p.greenPartToString=function(u){var s=p.getGreen(u).toString(16);return s.length>1?s:"0"+s},p.bluePartToString=function(u){var s=p.getBlue(u).toString(16);return s.length>1?s:"0"+s},p.fromArgbNumber=function(u,s,i,t){return u<<24|s<<16|i<<8|t},p.fromRgbaString=function(u,s){s===void 0&&(s=255);var i=u.replace(/ +/g,"").match(/(rgba?)|(\d+(\.\d+)?%?)|(\.\d+)/g);if(i&&i.length>3){for(var t=[],e=1,n=void 0;n=i[e];e++){var o=n.indexOf("%")!==-1?Math.round(2.55*parseFloat(n)):parseInt(n);if(o<0||o>255)return null;t.push(o)}if(u.indexOf("rgba")===0){if(isNaN(t[3])||t[3]<0||t[3]>1)return null;t[3]<=1&&(t[3]=Math.round(255*t[3]))}else if(t[3])return null;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]|(255&(t.length>3?t[3]:s))<<24}return null},p.fromHashString=function(u,s){return s===void 0&&(s=255),p.isHashColorString(u)?(u.charAt(0)==="#"&&(u=u.substr(1)),u.length===3&&(u=m.StringUtils.repeat(u.charAt(0),2)+m.StringUtils.repeat(u.charAt(1),2)+m.StringUtils.repeat(u.charAt(2),2)),parseInt(u,16)|s<<24):null},p.fromColorName=function(u,s){s===void 0&&(s=255);var i=p.colorNames[u.toLowerCase()];return i?p.fromHashString(i,s):null},p.fromString=function(u,s){s===void 0&&(s=255);var i=p.fromRgbaString(u,s);if(i!==null)return i;var t=p.fromHashString(u,s);return t!==null?t:p.fromColorName(u,s)},p.colorToHash=function(u){return"#"+p.redPartToString(u)+p.greenPartToString(u)+p.bluePartToString(u)},p.stringToHash=function(u){var s=this.fromString(u);return s!==null?this.colorToHash(s):null},p.isHashColorString=function(u){return/^#?([0-9a-f]{6})$/i.test(u)||/^#?([0-9a-f]{3})$/i.test(u)},p.isKnownColorName=function(u){return!!p.colorNames[u.toLowerCase()]},p.isGray=function(u){var s=p.getRed(u);return s===p.getGreen(u)&&s===p.getBlue(u)},p.DARK_COLOR=-16777216,p.LIGHT_COLOR=-1,p.colorNames={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#00ff00",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",windowtext:"#000000"},p}();h.ColorUtils=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PermissionRequestEventArgs=h.RequestedEntity=void 0;var m=function(){function p(u){this.apiController=u}return Object.defineProperty(p.prototype,"allowed",{get:function(){return this.eventArgs.allowed},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"updateUI",{get:function(){return this.eventArgs.updateUI},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"eventArgs",{get:function(){return this._eventArgs||(this._eventArgs=this.createEventArgs()),this._eventArgs},enumerable:!1,configurable:!0}),p}();h.RequestedEntity=m;var P=function(){return function(){this.allowed=!0,this.updateUI=!1}}();h.PermissionRequestEventArgs=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.SvgPrimitive=void 0;var p=d(17),u=function(s){function i(t,e,n,o){var r=s.call(this,t)||this;return r.className=e,r.clipPathId=n,r.onApplyProperties=o,r.children=[],r}return P(i,s),i.prototype.createElement=function(t){var e=this.createMainElement();return this.createChildElements(e),t(e),this.createCustomContent(e),e},i.prototype.createChildElements=function(t){for(var e=0;e<this.children.length;e++)this.children[e].createElement(function(n){return t.appendChild(n)})},i.prototype.applyElementProperties=function(t,e){this.applyElementStyleProperties(t),this.className&&t.setAttribute("class",this.className),typeof this.clipPathId=="string"&&(this.clipPathId?t.setAttribute("clip-path",p.RenderUtils.getUrlPathById(this.clipPathId)):t.removeAttribute("clip-path")),this.onApplyProperties&&this.onApplyProperties(t),this.applyChildrenProperties(t,e)},i.prototype.applyChildrenProperties=function(t,e){for(var n=0;n<this.children.length;n++)this.children[n].applyElementProperties(t.childNodes[n],e)},i.prototype.applyElementStyleProperties=function(t){this.applyElementStylePropertiesCore(t)},i.prototype.applyElementStylePropertiesCore=function(t,e){e===void 0&&(e=!1),this.style&&p.RenderUtils.applyStyleToElement(this.style,t,e)},i.prototype.createCustomContent=function(t){},i.prototype.destroyCustomContent=function(t){},i.prototype.dispose=function(){this.children&&this.children.forEach(function(t){return t.dispose()})},i}(d(109).PrimitiveObject);h.SvgPrimitive=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m,P,p=d(18),u=d(173),s=d(49),i=function(){function t(){}return t.getKeyModifiers=function(e){var n=0;return e.altKey&&(n|=m.Alt),e.ctrlKey&&(n|=m.Ctrl),e.shiftKey&&(n|=m.Shift),e.metaKey&&(n|=m.Meta),n},t.getShortcutCode=function(e,n,o,r,a){var c=e;return c|=n?m.Ctrl:0,c|=o?m.Shift:0,c|=r?m.Alt:0,c|=a?m.Meta:0},t.getShortcutCodeByEvent=function(e){return t.getShortcutCode(t.getEventKeyCode(e),e.ctrlKey,e.shiftKey,e.altKey,!!p.Browser.MacOSPlatform&&e.metaKey)},t.getEventKeyCode=function(e){return p.Browser.NetscapeFamily||p.Browser.Opera?e.which:e.keyCode},t.parseShortcutString=function(e){if(!e)return 0;var n=!1,o=!1,r=!1,a=!1,c=null,l=e.toString().split("+");if(l.length>0)for(var y=0;y<l.length;y++){var g=s.StringUtils.trim(l[y].toUpperCase());switch(g){case"CONTROL":case"CONTROLKEY":case"CTRL":n=!0;break;case"SHIFT":case"SHIFTKEY":o=!0;break;case"ALT":r=!0;break;case"CMD":a=!0;break;case"F1":c=P.F1;break;case"F2":c=P.F2;break;case"F3":c=P.F3;break;case"F4":c=P.F4;break;case"F5":c=P.F5;break;case"F6":c=P.F6;break;case"F7":c=P.F7;break;case"F8":c=P.F8;break;case"F9":c=P.F9;break;case"F10":c=P.F10;break;case"F11":c=P.F11;break;case"F12":c=P.F12;break;case"RETURN":case"ENTER":c=P.Enter;break;case"HOME":c=P.Home;break;case"END":c=P.End;break;case"LEFT":c=P.Left;break;case"RIGHT":c=P.Right;break;case"UP":c=P.Up;break;case"DOWN":c=P.Down;break;case"PAGEUP":c=P.PageUp;break;case"PAGEDOWN":c=P.PageDown;break;case"SPACE":c=P.Space;break;case"TAB":c=P.Tab;break;case"BACKSPACE":case"BACK":c=P.Backspace;break;case"CONTEXT":c=P.ContextMenu;break;case"ESCAPE":case"ESC":c=P.Esc;break;case"DELETE":case"DEL":c=P.Delete;break;case"INSERT":case"INS":c=P.Insert;break;case"PLUS":c=43;break;default:c=g.charCodeAt(0)}}else alert(u.EncodeUtils.decodeViaTextArea("Invalid shortcut"));return t.getShortcutCode(c,n,o,r,a)},t}();h.KeyUtils=i,function(t){t[t.None=0]="None",t[t.Ctrl=65536]="Ctrl",t[t.Shift=262144]="Shift",t[t.Alt=1048576]="Alt",t[t.Meta=16777216]="Meta"}(m=h.ModifierKey||(h.ModifierKey={})),function(t){t[t.Backspace=8]="Backspace",t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Pause=19]="Pause",t[t.CapsLock=20]="CapsLock",t[t.Esc=27]="Esc",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down",t[t.Insert=45]="Insert",t[t.Delete=46]="Delete",t[t.Key_0=48]="Key_0",t[t.Key_1=49]="Key_1",t[t.Key_2=50]="Key_2",t[t.Key_3=51]="Key_3",t[t.Key_4=52]="Key_4",t[t.Key_5=53]="Key_5",t[t.Key_6=54]="Key_6",t[t.Key_7=55]="Key_7",t[t.Key_8=56]="Key_8",t[t.Key_9=57]="Key_9",t[t.Key_a=65]="Key_a",t[t.Key_b=66]="Key_b",t[t.Key_c=67]="Key_c",t[t.Key_d=68]="Key_d",t[t.Key_e=69]="Key_e",t[t.Key_f=70]="Key_f",t[t.Key_g=71]="Key_g",t[t.Key_h=72]="Key_h",t[t.Key_i=73]="Key_i",t[t.Key_j=74]="Key_j",t[t.Key_k=75]="Key_k",t[t.Key_l=76]="Key_l",t[t.Key_m=77]="Key_m",t[t.Key_n=78]="Key_n",t[t.Key_o=79]="Key_o",t[t.Key_p=80]="Key_p",t[t.Key_q=81]="Key_q",t[t.Key_r=82]="Key_r",t[t.Key_s=83]="Key_s",t[t.Key_t=84]="Key_t",t[t.Key_u=85]="Key_u",t[t.Key_v=86]="Key_v",t[t.Key_w=87]="Key_w",t[t.Key_x=88]="Key_x",t[t.Key_y=89]="Key_y",t[t.Key_z=90]="Key_z",t[t.Windows=91]="Windows",t[t.ContextMenu=93]="ContextMenu",t[t.Numpad_0=96]="Numpad_0",t[t.Numpad_1=97]="Numpad_1",t[t.Numpad_2=98]="Numpad_2",t[t.Numpad_3=99]="Numpad_3",t[t.Numpad_4=100]="Numpad_4",t[t.Numpad_5=101]="Numpad_5",t[t.Numpad_6=102]="Numpad_6",t[t.Numpad_7=103]="Numpad_7",t[t.Numpad_8=104]="Numpad_8",t[t.Numpad_9=105]="Numpad_9",t[t.Multiply=106]="Multiply",t[t.Add=107]="Add",t[t.Subtract=109]="Subtract",t[t.Decimal=110]="Decimal",t[t.Divide=111]="Divide",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NumLock=144]="NumLock",t[t.ScrollLock=145]="ScrollLock",t[t.Semicolon=186]="Semicolon",t[t.Equals=187]="Equals",t[t.Comma=188]="Comma",t[t.Dash=189]="Dash",t[t.Period=190]="Period",t[t.ForwardSlash=191]="ForwardSlash",t[t.GraveAccent=192]="GraveAccent",t[t.OpenBracket=219]="OpenBracket",t[t.BackSlash=220]="BackSlash",t[t.CloseBracket=221]="CloseBracket",t[t.SingleQuote=222]="SingleQuote"}(P=h.KeyCode||(h.KeyCode={}))},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(a,c){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var g in y)y.hasOwnProperty(g)&&(l[g]=y[g])})(a,c)},function(a,c){function l(){this.constructor=a}m(a,c),a.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)});Object.defineProperty(h,"__esModule",{value:!0}),h.EmptyStyle=h.StrokeStyle=h.TextAlignment=h.TextStyle=h.Style=h.DEFAULT_STROKE_DASHARRAY=h.DEFAULT_STROKE_WIDTH=h.StyleBase=void 0;var p=d(22),u=d(110),s=d(12),i=function(){function a(){this.createDefaultProperties()}return a.prototype.clone=function(){var c=this,l=this.createInstance();return this.forEach(function(y){l[y]=c[y]}),l},a.prototype.forEach=function(c){for(var l in this)Object.prototype.hasOwnProperty.call(this,l)&&c(l)},Object.defineProperty(a.prototype,"strokeWidthPx",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"strokeWidth",{get:function(){return s.UnitConverter.pixelsToTwips(this.strokeWidthPx)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"strokeOffset",{get:function(){return .5},enumerable:!1,configurable:!0}),a.prototype.toHash=function(){var c=this.toObject();return c?Object.keys(c).map(function(l){return l+"|"+c[l]}).join(""):""},a.prototype.toObject=function(){var c=this,l={},y=!1,g=this.getDefaultInstance();return this.forEach(function(f){c[f]!==g[f]&&(l[f]=c[f],y=!0)}),y?l:null},a.prototype.fromObject=function(c){for(var l in c)if(Object.prototype.hasOwnProperty.call(c,l)){var y=u.isColorProperty(l)?p.ColorUtils.stringToHash(c[l]):c[l];this[l]=y}},a}();h.StyleBase=i,h.DEFAULT_STROKE_WIDTH=2,h.DEFAULT_STROKE_DASHARRAY="";var t=function(a){function c(){return a!==null&&a.apply(this,arguments)||this}return P(c,a),c.prototype.createInstance=function(){return new c},c.prototype.createDefaultProperties=function(){this.fill="#ffffff",this.stroke="#000000",this["stroke-width"]=h.DEFAULT_STROKE_WIDTH.toString(),this["stroke-dasharray"]=h.DEFAULT_STROKE_DASHARRAY},c.prototype.getDefaultInstance=function(){return c.defaultInstance},c.prototype.isDefaultStrokeDashArray=function(){return this["stroke-dasharray"]===h.DEFAULT_STROKE_DASHARRAY},c.prototype.resetStrokeDashArray=function(){this["stroke-dasharray"]=h.DEFAULT_STROKE_DASHARRAY},Object.defineProperty(c.prototype,"strokeWidthPx",{get:function(){return parseInt(this["stroke-width"])},enumerable:!1,configurable:!0}),c.defaultInstance=new c,c}(i);h.Style=t;var e,n=function(a){function c(){return a!==null&&a.apply(this,arguments)||this}return P(c,a),c.prototype.createInstance=function(){return new c},c.prototype.createDefaultProperties=function(){this.fill="#000000",this["font-family"]="Arial",this["font-size"]="10pt",this["font-weight"]="",this["font-style"]="",this["text-decoration"]="",this["text-anchor"]="middle"},c.prototype.getDefaultInstance=function(){return c.defaultInstance},c.prototype.getAlignment=function(){switch(this["text-anchor"]){case"left":return e.Left;case"right":return e.Right;default:return e.Center}},c.defaultInstance=new c,c}(i);h.TextStyle=n,function(a){a[a.Left=0]="Left",a[a.Right=1]="Right",a[a.Center=2]="Center"}(e=h.TextAlignment||(h.TextAlignment={}));var o=function(a){function c(l,y){var g=a.call(this)||this;return g._strokeWidthPx=l,g._strokeOffset=y,g}return P(c,a),c.prototype.createInstance=function(){return new c},c.prototype.createDefaultProperties=function(){},c.prototype.getDefaultInstance=function(){return n.defaultInstance},Object.defineProperty(c.prototype,"strokeWidthPx",{get:function(){return this._strokeWidthPx||0},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"strokeOffset",{get:function(){return this._strokeOffset||0},enumerable:!1,configurable:!0}),c.default1pxInstance=new c(1,.5),c.default1pxNegativeOffsetInstance=new c(1,-.5),c.default2pxInstance=new c(2),c}(t);h.StrokeStyle=o;var r=function(a){function c(l){var y=a.call(this)||this;return l&&Object.keys(l).forEach(function(g){return y[g]=l[g]}),y}return P(c,a),c.prototype.createInstance=function(){return new c},c.prototype.createDefaultProperties=function(){},c.prototype.getDefaultInstance=function(){return n.defaultInstance},c.defaultInstance=new c,c}(t);h.EmptyStyle=r},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(18),P=d(50),p=d(31),u=d(49),s=function(){function e(){}return e.clearInnerHtml=function(n){for(;n.firstChild;)n.removeChild(n.firstChild)},e.setStylePosition=function(n,o){n.left=p.MathUtils.round(o.x,3)+"px",n.top=p.MathUtils.round(o.y,3)+"px"},e.setStyleSize=function(n,o){n.width=p.MathUtils.round(o.width,3)+"px",n.height=p.MathUtils.round(o.height,3)+"px"},e.setStyleSizeAndPosition=function(n,o){e.setStylePosition(n,o),e.setStyleSize(n,o)},e.hideNode=function(n){if(n){var o=n.parentNode;o&&o.removeChild(n)}},e.isHTMLElementNode=function(n){return n.nodeType===Node.ELEMENT_NODE},e.isTextNode=function(n){return n.nodeType===Node.TEXT_NODE},e.isElementNode=function(n){return n.nodeType===Node.ELEMENT_NODE},e.isHTMLTableRowElement=function(n){return n.tagName==="TR"},e.isItParent=function(n,o){if(!n||!o)return!1;for(;o;){if(o===n)return!0;if(o.tagName==="BODY")return!1;o=o.parentNode}return!1},e.getParentByTagName=function(n,o){for(o=o.toUpperCase();n;){if(n.tagName==="BODY")return null;if(n.tagName===o)return n;n=n.parentNode}return null},e.getDocumentScrollTop=function(){var n=m.Browser.IE&&e.getCurrentStyle(document.body).overflow==="hidden"&&document.body.scrollTop>0;return m.Browser.WebKitFamily||m.Browser.Edge||n?m.Browser.MacOSMobilePlatform?window.pageYOffset:m.Browser.WebKitFamily&&document.documentElement.scrollTop||document.body.scrollTop:document.documentElement.scrollTop},e.getDocumentScrollLeft=function(){var n=m.Browser.IE&&e.getCurrentStyle(document.body).overflow==="hidden"&&document.body.scrollLeft>0;return m.Browser.Edge||n?document.body?document.body.scrollLeft:document.documentElement.scrollLeft:m.Browser.WebKitFamily?document.documentElement.scrollLeft||document.body.scrollLeft:document.documentElement.scrollLeft},e.getCurrentStyle=function(n){if(n.currentStyle)return n.currentStyle;if(document.defaultView&&document.defaultView.getComputedStyle){var o=document.defaultView.getComputedStyle(n,null);if(!o&&m.Browser.Firefox&&window.frameElement){for(var r=[],a=window.frameElement;!(o=document.defaultView.getComputedStyle(n,null));)r.push([a,a.style.display]),a.style.setProperty("display","block","important"),a=a.tagName==="BODY"?a.ownerDocument.defaultView.frameElement:a.parentNode;o=function(y){if(typeof y!="object"||!P.isDefined(y))return y;var g={};for(var f in y)g[f]=y[f];return g}(o);for(var c=void 0,l=0;c=r[l];l++)c[0].style.display=c[1];document.body.offsetWidth}return o}return window.getComputedStyle(n,null)},e.setFocus=function(n){function o(){try{n.focus(),m.Browser.IE&&document.activeElement!==n&&n.focus()}catch{}}m.Browser.MacOSMobilePlatform?o():setTimeout(function(){o()},100)},e.hasClassName=function(n,o){try{var r=o.split(" "),a=n.classList;if(a){for(var c=r.length-1;c>=0;c--)if(!a.contains(r[c]))return!1}else{var l=n.getAttribute&&n.getAttribute("class");if(!l)return!1;var y=l.split(" ");for(c=r.length-1;c>=0;c--)if(y.indexOf(r[c])<0)return!1}return!0}catch{return!1}},e.addClassName=function(n,o){if(!e.hasClassName(n,o)){var r=n.getAttribute&&n.getAttribute("class");n.setAttribute("class",r===""?o:r+" "+o)}},e.removeClassName=function(n,o){var r=" "+(n.getAttribute&&n.getAttribute("class"))+" ",a=r.replace(" "+o+" "," ");r.length!==a.length&&n.setAttribute("class",u.StringUtils.trim(a))},e.toggleClassName=function(n,o,r){r===void 0?e.hasClassName(n,o)?e.removeClassName(n,o):e.addClassName(n,o):r?e.addClassName(n,o):e.removeClassName(n,o)},e.pxToInt=function(n){return i(n,parseInt)},e.pxToFloat=function(n){return i(n,parseFloat)},e.getAbsolutePositionY=function(n){function o(r){return Math.round(r.getBoundingClientRect().top+e.getDocumentScrollTop())}return n?m.Browser.IE?function(r){return m.Browser.IE&&r.parentNode===null?0:r.getBoundingClientRect().top+e.getDocumentScrollTop()}(n):m.Browser.Firefox&&m.Browser.Version>=3?o(n):m.Browser.Opera?function(r){var a=!0;r&&e.isHTMLTableRowElement(r)&&r.cells.length>0&&(r=r.cells[0]);for(var c=t(r,!1);r!=null;)c+=r.offsetTop,a||(c-=r.scrollTop),r=r.offsetParent,a=!1;return c+=document.body.scrollTop}(n):m.Browser.NetscapeFamily&&(!m.Browser.Firefox||m.Browser.Version<3)?function(r){for(var a=t(r,!1),c=!0;r!=null;){if(a+=r.offsetTop,c||r.offsetParent==null||(a-=r.scrollTop),!c&&m.Browser.Firefox){var l=e.getCurrentStyle(r);r.tagName==="DIV"&&l.overflow!=="visible"&&(a+=e.pxToInt(l.borderTopWidth))}c=!1,r=r.offsetParent}return a}(n):m.Browser.WebKitFamily||m.Browser.Edge?o(n):function(r){for(var a=0,c=!0;r!=null;)a+=r.offsetTop,c||r.offsetParent==null||(a-=r.scrollTop),c=!1,r=r.offsetParent;return a}(n):0},e.getAbsolutePositionX=function(n){function o(r){return Math.round(r.getBoundingClientRect().left+e.getDocumentScrollLeft())}return n?m.Browser.IE?function(r){return m.Browser.IE&&r.parentNode===null?0:r.getBoundingClientRect().left+e.getDocumentScrollLeft()}(n):m.Browser.Firefox&&m.Browser.Version>=3?o(n):m.Browser.Opera&&m.Browser.Version<=12?function(r){for(var a=!0,c=t(r,!0);r!=null;)c+=r.offsetLeft,a||(c-=r.scrollLeft),r=r.offsetParent,a=!1;return c+=document.body.scrollLeft}(n):m.Browser.NetscapeFamily&&(!m.Browser.Firefox||m.Browser.Version<3)?function(r){for(var a=t(r,!0),c=!0;r!=null;){if(a+=r.offsetLeft,c||r.offsetParent==null||(a-=r.scrollLeft),!c&&m.Browser.Firefox){var l=e.getCurrentStyle(r);r.tagName==="DIV"&&l.overflow!=="visible"&&(a+=e.pxToInt(l.borderLeftWidth))}c=!1,r=r.offsetParent}return a}(n):m.Browser.WebKitFamily||m.Browser.Edge?o(n):function(r){for(var a=0,c=!0;r!=null;)a+=r.offsetLeft,c||r.offsetParent==null||(a-=r.scrollLeft),c=!1,r=r.offsetParent;return a}(n):0},e.isInteractiveControl=function(n){return["A","INPUT","SELECT","OPTION","TEXTAREA","BUTTON","IFRAME"].indexOf(n.tagName)>-1},e.getClearClientHeight=function(n){return n.offsetHeight-(e.getTopBottomPaddings(n)+e.getVerticalBordersWidth(n))},e.getTopBottomPaddings=function(n,o){var r=o||e.getCurrentStyle(n);return e.pxToInt(r.paddingTop)+e.pxToInt(r.paddingBottom)},e.getVerticalBordersWidth=function(n,o){P.isDefined(o)||(o=m.Browser.IE&&m.Browser.MajorVersion!==9&&window.getComputedStyle?window.getComputedStyle(n):e.getCurrentStyle(n));var r=0;return o.borderTopStyle!=="none"&&(r+=e.pxToFloat(o.borderTopWidth)),o.borderBottomStyle!=="none"&&(r+=e.pxToFloat(o.borderBottomWidth)),r},e.getNodes=function(n,o){for(var r=n.all||n.getElementsByTagName("*"),a=[],c=0;c<r.length;c++){var l=r[c];o(l)&&a.push(l)}return a},e.getChildNodes=function(n,o){for(var r=n.childNodes,a=[],c=0;c<r.length;c++){var l=r[c];o(l)&&a.push(l)}return a},e.getNodesByClassName=function(n,o){if(n.querySelectorAll){var r=n.querySelectorAll("."+o),a=[];return r.forEach(function(c){return a.push(c)}),a}return e.getNodes(n,function(c){return e.hasClassName(c,o)})},e.getChildNodesByClassName=function(n,o){return n.querySelectorAll?function(r,a){for(var c=[],l=0;l<r.length;l++){var y=r[l];a(y)&&c.push(y)}return c}(n.querySelectorAll("."+o),function(r){return r.parentNode===n}):e.getChildNodes(n,function(r){return!!e.isElementNode(r)&&P.isNonNullString(r.className)&&e.hasClassName(r,r.className)})},e.getVerticalScrollBarWidth=function(){if(e.verticalScrollBarWidth===void 0){var n=document.createElement("DIV");n.style.cssText="position: absolute; top: 0px; left: 0px; visibility: hidden; width: 200px; height: 150px; overflow: hidden; box-sizing: content-box",document.body.appendChild(n);var o=document.createElement("P");n.appendChild(o),o.style.cssText="width: 100%; height: 200px;";var r=o.offsetWidth;n.style.overflow="scroll";var a=o.offsetWidth;r===a&&(a=n.clientWidth),e.verticalScrollBarWidth=r-a,document.body.removeChild(n)}return e.verticalScrollBarWidth},e.getHorizontalBordersWidth=function(n,o){P.isDefined(o)||(o=m.Browser.IE&&window.getComputedStyle?window.getComputedStyle(n):e.getCurrentStyle(n));var r=0;return o.borderLeftStyle!=="none"&&(r+=e.pxToFloat(o.borderLeftWidth)),o.borderRightStyle!=="none"&&(r+=e.pxToFloat(o.borderRightWidth)),r},e.getFontFamiliesFromCssString=function(n){return n.split(",").map(function(o){return u.StringUtils.trim(o.replace(/'|"/gi,""))})},e.getInnerText=function(n){if(m.Browser.Safari&&m.Browser.MajorVersion<=5){e.html2PlainTextFilter===null&&(e.html2PlainTextFilter=document.createElement("DIV"),e.html2PlainTextFilter.style.width="0",e.html2PlainTextFilter.style.height="0",e.html2PlainTextFilter.style.overflow="visible",e.html2PlainTextFilter.style.display="none",document.body.appendChild(e.html2PlainTextFilter));var o=e.html2PlainTextFilter;o.innerHTML=n.innerHTML,o.style.display="";var r=o.innerText;return o.style.display="none",r}return m.Browser.NetscapeFamily||m.Browser.WebKitFamily||m.Browser.IE&&m.Browser.Version>=9||m.Browser.Edge?n.textContent:n.innerText},e.html2PlainTextFilter=null,e.verticalScrollBarWidth=void 0,e}();function i(e,n){var o=0;if(P.isDefined(e)&&e!=="")try{var r=e.indexOf("px");r>-1&&(o=n(e.substr(0,r)))}catch{}return o}function t(e,n){for(var o=0,r=!0;e!=null&&e.tagName!=="BODY";){var a=s.getCurrentStyle(e);if(a.position==="absolute")break;r||e.tagName!=="DIV"||a.position!==""&&a.position!=="static"||(o-=n?e.scrollLeft:e.scrollTop),e=e.parentNode,r=!1}return o}h.DomUtils=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorRoutingMode=h.AutoZoomMode=h.DiagramSettings=void 0;var m,P,p=d(3),u=d(2),s=d(47),i=d(4),t=function(){function e(){this.onZoomChanged=new p.EventDispatcher,this.onViewChanged=new p.EventDispatcher,this.onReadOnlyChanged=new p.EventDispatcher,this.onConnectorRoutingModeChanged=new p.EventDispatcher,this._zoomLevel=1,this._zoomLevelWasChanged=!1,this._zoomLevelItems=[.5,.75,1,1.25,1.5,2,3],this._simpleView=!1,this._fullscreen=!1,this._readOnly=!1,this._autoZoom=m.Disabled,this._snapToGrid=!0,this._showGrid=!0,this._contextMenuEnabled=!0,this._gridSize=180,this._gridSizeItems=[90,180,360,720],this._pageSizeItems=[{size:new u.Size(12240,15840),text:"US-Letter ({width} x {height})"},{size:new u.Size(12240,20160),text:"US-Legal ({width} x {height})"},{size:new u.Size(15817,24491),text:"US-Tabloid ({width} x {height})"},{size:new u.Size(47679,67408),text:"A0 ({width} x {height})"},{size:new u.Size(33676,47679),text:"A1 ({width} x {height})"},{size:new u.Size(23811,33676),text:"A2 ({width} x {height})"},{size:new u.Size(16838,23811),text:"A3 ({width} x {height})"},{size:new u.Size(11906,16838),text:"A4 ({width} x {height})"},{size:new u.Size(8391,11906),text:"A5 ({width} x {height})"},{size:new u.Size(5953,8391),text:"A6 ({width} x {height})"},{size:new u.Size(4195,5953),text:"A7 ({width} x {height})"}],this._viewUnits=s.DiagramUnit.In,this._connectorRoutingMode=P.AllShapesOnly,this._reloadInsertedItemRequired=!1,this._useCanvgForExportToImage=!0}return Object.defineProperty(e.prototype,"zoomLevel",{get:function(){return this._zoomLevel},set:function(n){var o=this;(n=e.correctZoomLevel(n))!==this._zoomLevel&&(this._zoomLevel=n,this._zoomLevelWasChanged=!0,this.onZoomChanged.raise1(function(r){return r.notifyZoomChanged(n,o._autoZoom)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zoomLevelWasChanged",{get:function(){return this._zoomLevelWasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zoomLevelItems",{get:function(){return this._zoomLevelItems},set:function(n){(n=n.map(function(o){return e.correctZoomLevel(o)}))!==this._zoomLevelItems&&(this._zoomLevelItems=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoZoom",{get:function(){return this._autoZoom},set:function(n){var o=this;n!==this._autoZoom&&(this._autoZoom=n,this.onZoomChanged.raise1(function(r){return r.notifyZoomChanged(o._zoomLevel,n)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"simpleView",{get:function(){return this._simpleView},set:function(n){n!==this._simpleView&&(this._simpleView=n,this.notifyViewChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readOnly",{get:function(){return this._readOnly},set:function(n){n!==this._readOnly&&(this._readOnly=n,this.onReadOnlyChanged.raise1(function(o){return o.notifyReadOnlyChanged(n)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(n){this._fullscreen=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapToGrid",{get:function(){return this._snapToGrid},set:function(n){this._snapToGrid=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showGrid",{get:function(){return this._showGrid},set:function(n){var o=this;n!==this._showGrid&&(this._showGrid=n,this.onViewChanged.raise1(function(r){return r.notifyGridChanged(o.showGrid,o.gridSize)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextMenuEnabled",{get:function(){return this._contextMenuEnabled},set:function(n){this._contextMenuEnabled=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridSize",{get:function(){return this._gridSize},set:function(n){var o=this;n!==this._gridSize&&(this._gridSize=n,this.onViewChanged.raise1(function(r){return r.notifyGridChanged(o.showGrid,o.gridSize)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridSizeItems",{get:function(){return this._gridSizeItems},set:function(n){n!==this._gridSizeItems&&(this._gridSizeItems=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeItems",{get:function(){return this._pageSizeItems},set:function(n){n!==this._pageSizeItems&&(this._pageSizeItems=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewUnits",{get:function(){return this._viewUnits},set:function(n){this._viewUnits=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectorRoutingMode",{get:function(){return this._connectorRoutingMode},set:function(n){n!==this._connectorRoutingMode&&(this._connectorRoutingMode=n,this.onConnectorRoutingModeChanged.raise1(function(o){return o.notifyConnectorRoutingModeChanged(n)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reloadInsertedItemRequired",{get:function(){return this._reloadInsertedItemRequired},set:function(n){this._reloadInsertedItemRequired=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useCanvgForExportToImage",{get:function(){return this._useCanvgForExportToImage},set:function(n){this._useCanvgForExportToImage=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shapeMinWidth",{get:function(){return this._shapeMinWidth},set:function(n){this._shapeMinWidth=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shapeMinHeight",{get:function(){return this._shapeMinHeight},set:function(n){this._shapeMinHeight=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shapeMaxWidth",{get:function(){return this._shapeMaxWidth},set:function(n){this._shapeMaxWidth=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shapeMaxHeight",{get:function(){return this._shapeMaxHeight},set:function(n){this._shapeMaxHeight=n},enumerable:!1,configurable:!0}),e.prototype.applyShapeSizeSettings=function(n,o){n&&(typeof n.shapeMaxHeight=="number"&&(this.shapeMaxHeight=i.ModelUtils.getTwipsValue(o,n.shapeMaxHeight)),typeof n.shapeMinHeight=="number"&&(this.shapeMinHeight=i.ModelUtils.getTwipsValue(o,n.shapeMinHeight)),typeof n.shapeMaxWidth=="number"&&(this.shapeMaxWidth=i.ModelUtils.getTwipsValue(o,n.shapeMaxWidth)),typeof n.shapeMinWidth=="number"&&(this.shapeMinWidth=i.ModelUtils.getTwipsValue(o,n.shapeMinWidth)))},e.prototype.notifyViewChanged=function(){var n=this;this.onViewChanged.raise1(function(o){return o.notifyViewChanged(n._simpleView)})},e.correctZoomLevel=function(n){return Math.min(10,Math.max(n,.01))},e}();h.DiagramSettings=t,function(e){e[e.Disabled=0]="Disabled",e[e.FitContent=1]="FitContent",e[e.FitToWidth=2]="FitToWidth"}(m=h.AutoZoomMode||(h.AutoZoomMode={})),function(e){e[e.None=0]="None",e[e.ConnectorShapesOnly=1]="ConnectorShapesOnly",e[e.AllShapesOnly=2]="AllShapesOnly"}(P=h.ConnectorRoutingMode||(h.ConnectorRoutingMode={}))},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorRenderPoint=void 0;var p=function(u){function s(i,t,e,n){e===void 0&&(e=-1),n===void 0&&(n=!1);var o=u.call(this,i,t)||this;return o.pointIndex=e,o.skipped=n,o}return P(s,u),s.prototype.offset=function(i,t){return u.prototype.offset.call(this,i,t),this.pointIndex=-1,this.skipped=!1,this},s.prototype.multiply=function(i,t){return u.prototype.multiply.call(this,i,t),this.pointIndex=-1,this.skipped=!1,this},s.prototype.clone=function(){return new s(this.x,this.y,this.pointIndex,this.skipped)},s}(d(0).Point);h.ConnectorRenderPoint=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeParameterPoint=void 0;var m=function(){return function(P,p){this.key=P,this.point=p}}();h.ShapeParameterPoint=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(105),P=function(){function p(){}return p.round=function(u,s){s===void 0&&(s=0);var i=p.powFactor[s];return Math.round(u*i)/i},p.numberCloseTo=function(u,s,i){return i===void 0&&(i=1e-5),Math.abs(u-s)<i},p.restrictValue=function(u,s,i){return i<s&&(i=s),u>i?i:u<s?s:u},p.getRandomInt=function(u,s){return Math.floor(Math.random()*(s-u+1))+u},p.generateGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var s=16*Math.random()|0;return(u==="x"?s:3&s|8).toString(16)})},p.powFactor=m.ListUtils.initByCallback(20,function(u){return Math.pow(10,u)}),p.somePrimes=[1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003],p}();h.MathUtils=P},function(j,h,d){"use strict";var m,P;Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorProperties=h.DEFAULT_CONNECTOR_ENDLINEENDING=h.DEFAULT_CONNECTOR_STARTLINEENDING=h.DEFAULT_CONNECTOR_LINEOPTION=h.ConnectorLineEnding=h.ConnectorLineOption=void 0,function(u){u[u.Straight=0]="Straight",u[u.Orthogonal=1]="Orthogonal"}(m=h.ConnectorLineOption||(h.ConnectorLineOption={})),function(u){u[u.None=0]="None",u[u.Arrow=1]="Arrow",u[u.OutlinedTriangle=2]="OutlinedTriangle",u[u.FilledTriangle=3]="FilledTriangle"}(P=h.ConnectorLineEnding||(h.ConnectorLineEnding={})),h.DEFAULT_CONNECTOR_LINEOPTION=m.Orthogonal,h.DEFAULT_CONNECTOR_STARTLINEENDING=P.None,h.DEFAULT_CONNECTOR_ENDLINEENDING=P.Arrow;var p=function(){function u(){this.lineOption=h.DEFAULT_CONNECTOR_LINEOPTION,this.startLineEnding=h.DEFAULT_CONNECTOR_STARTLINEENDING,this.endLineEnding=h.DEFAULT_CONNECTOR_ENDLINEENDING}return u.prototype.clone=function(){var s=new u;return s.lineOption=this.lineOption,s.startLineEnding=this.startLineEnding,s.endLineEnding=this.endLineEnding,s},u.prototype.forEach=function(s){for(var i in this)Object.prototype.hasOwnProperty.call(this,i)&&s(i)},u.prototype.toObject=function(){var s={},i=!1;return this.lineOption!==h.DEFAULT_CONNECTOR_LINEOPTION&&(s.lineOption=this.lineOption,i=!0),this.startLineEnding!==h.DEFAULT_CONNECTOR_STARTLINEENDING&&(s.startLineEnding=this.startLineEnding,i=!0),this.endLineEnding!==h.DEFAULT_CONNECTOR_ENDLINEENDING&&(s.endLineEnding=this.endLineEnding,i=!0),i?s:null},u.prototype.fromObject=function(s){typeof s.lineOption=="number"&&(this.lineOption=s.lineOption),typeof s.startLineEnding=="number"&&(this.startLineEnding=s.startLineEnding),typeof s.endLineEnding=="number"&&(this.endLineEnding=s.endLineEnding)},u}();h.ConnectorProperties=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(31),P=d(35),p=d(0),u=d(13),s=function(){function i(t,e){this.startPoint=t,this.endPoint=e}return Object.defineProperty(i.prototype,"length",{get:function(){return P.Metrics.euclideanDistance(this.startPoint,this.endPoint)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"xLength",{get:function(){return Math.abs(this.endPoint.x-this.startPoint.x)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"yLength",{get:function(){return Math.abs(this.endPoint.y-this.startPoint.y)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"center",{get:function(){return new p.Point(this.startPoint.x+(this.endPoint.x-this.startPoint.x)/2,this.startPoint.y+(this.endPoint.y-this.startPoint.y)/2)},enumerable:!0,configurable:!0}),i.prototype.isIntersected=function(t){return this.startPoint.equals(t.startPoint)||this.endPoint.equals(t.startPoint)||this.startPoint.equals(t.endPoint)||this.endPoint.equals(t.endPoint)||this.intersectCore(t)&&t.intersectCore(this)},i.prototype.containsPoint=function(t,e){return e===void 0&&(e=1e-7),this.startPoint.equals(t)||this.endPoint.equals(t)||m.MathUtils.numberCloseTo(this.length,P.Metrics.euclideanDistance(this.startPoint,t)+P.Metrics.euclideanDistance(this.endPoint,t),e)},i.prototype.isIntersectedByRect=function(t){if(u.Rectangle.containsPoint(t,this.startPoint)||u.Rectangle.containsPoint(t,this.endPoint))return!0;var e=t.x,n=t.x+t.width,o=t.y,r=t.y+t.height;return this.isIntersected(new i(new p.Point(e,o),new p.Point(e,r)))||this.isIntersected(new i(new p.Point(n,o),new p.Point(n,r)))||this.isIntersected(new i(new p.Point(e,o),new p.Point(n,o)))||this.isIntersected(new i(new p.Point(e,r),new p.Point(n,r)))},i.prototype.intersectCore=function(t){if(this.startPoint.x===this.endPoint.x){if(this.startPoint.x-t.endPoint.x!=0)return(this.startPoint.x-t.startPoint.x)/(this.startPoint.x-t.endPoint.x)<=0;if(t.endPoint.y-this.endPoint.y!=0)return(t.endPoint.y-this.startPoint.y)/(t.endPoint.y-this.endPoint.y)<=0}if(this.startPoint.y===this.endPoint.y){if(this.startPoint.y-t.endPoint.y!=0)return(this.startPoint.y-t.startPoint.y)/(this.startPoint.y-t.endPoint.y)<=0;if(t.endPoint.x-this.endPoint.x!=0)return(t.endPoint.x-this.startPoint.x)/(t.endPoint.x-this.endPoint.x)<=0}var e=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x),n=this.startPoint.y+(t.startPoint.x-this.startPoint.x)*e,o=this.startPoint.y+(t.endPoint.x-this.startPoint.x)*e,r=t.startPoint.y-n,a=t.endPoint.y-o;return r===0&&a===0?(this.startPoint.y-n)/(this.endPoint.y-n)<=0||(this.startPoint.y-o)/(this.endPoint.y-o)<=0:r===0||a===0||r/a<0},i}();h.Segment=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDraggingState=void 0;var p=d(40),u=d(11),s=d(12),i=function(t){function e(n,o){var r=t.call(this,n)||this;return r.history=o,r}return P(e,t),e.prototype.canApplyChangesOnMouseMove=function(n,o){return!n||!o||Math.abs(n.x-o.x)>e.dragStartLimit||Math.abs(n.y-o.y)>e.dragStartLimit},e.prototype.onAfterApplyChanges=function(){this.modified||this.handler.raiseDragStart(this.getDraggingElementKeys()),this.modified=!0,this.mouseDownPoint=void 0},e.prototype.onMouseDown=function(n){this.mouseDownPoint=n.modelPoint.clone()},e.prototype.onMouseMove=function(n){this.mouseMoveEvent=n,n.button!==u.MouseButton.Left?(this.cancelChanges(),this.handler.switchToDefaultState()):n.button===u.MouseButton.Left&&this.canApplyChangesOnMouseMove(this.mouseDownPoint,n.modelPoint)&&(this.onApplyChanges(n),this.onAfterApplyChanges())},e.prototype.onKeyDown=function(n){!this.mouseMoveEvent||n.keyCode!==16&&n.keyCode!==17&&n.keyCode!==18||this.performMouseMoveEvent(n.modifiers)},e.prototype.onKeyUp=function(n){!this.mouseMoveEvent||n.keyCode!==16&&n.keyCode!==17&&n.keyCode!==18||this.performMouseMoveEvent(n.modifiers)},e.prototype.onMouseUp=function(n){this.mouseDownPoint=void 0,this.mouseMoveEvent=void 0,this.handler.switchToDefaultState()},e.prototype.performMouseMoveEvent=function(n){this.mouseMoveEvent.modifiers=n,this.onMouseMove(this.mouseMoveEvent)},e.prototype.start=function(){this.handler.beginStorePermissions(),this.history.beginTransaction()},e.prototype.finish=function(){this.checkStoredPermissionsOnFinish(),this.modified?(this.onFinishWithChanges(),this.modified=!1,this.history.endTransaction(),this.handler.raiseDragEnd(this.getDraggingElementKeys())):this.history.endTransaction(),this.handler.endStorePermissions(),this.handler.clearInteractingItems()},e.prototype.checkStoredPermissionsOnFinish=function(){this.handler.isStoredPermissionsGranted()||(this.cancelChanges(),this.modified=!1)},e.prototype.onFinishWithChanges=function(){},e.prototype.cancelChanges=function(){this.handler.lockPermissions(),this.history.undoTransaction(),this.handler.unlockPermissions(),this.modified&&this.handler.raiseDragEnd(this.getDraggingElementKeys()),this.modified=!1},e.prototype.getSnappedPoint=function(n,o){return this.handler.getSnappedPointOnDragPoint(n,o)},e.dragStartLimit=s.UnitConverter.pixelsToTwips(4),e}(p.MouseHandlerCancellableState);h.MouseHandlerDraggingState=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return P.euclideanDistance=function(p,u){var s=p.x-u.x,i=p.y-u.y;return Math.sqrt(s*s+i*i)},P.manhattanDistance=function(p,u){return Math.abs(p.x-u.x)+Math.abs(p.y-u.y)},P}();h.Metrics=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramLocalizationService=void 0;var m=d(1),P=d(47),p=function(){function u(){}return u.unitItems={},u.formatUnit=function(s){return s.toString()},u.shapeTexts={},u}();h.DiagramLocalizationService=p,p.unitItems[P.DiagramUnit.In]="in",p.unitItems[P.DiagramUnit.Cm]="cm",p.unitItems[P.DiagramUnit.Px]="px",p.shapeTexts[m.ShapeTypes.Text]="Text",p.shapeTexts[m.ShapeTypes.Rectangle]="Rectangle",p.shapeTexts[m.ShapeTypes.Ellipse]="Ellipse",p.shapeTexts[m.ShapeTypes.Cross]="Cross",p.shapeTexts[m.ShapeTypes.Triangle]="Triangle",p.shapeTexts[m.ShapeTypes.Diamond]="Diamond",p.shapeTexts[m.ShapeTypes.Heart]="Heart",p.shapeTexts[m.ShapeTypes.Pentagon]="Pentagon",p.shapeTexts[m.ShapeTypes.Hexagon]="Hexagon",p.shapeTexts[m.ShapeTypes.Octagon]="Octagon",p.shapeTexts[m.ShapeTypes.Star]="Star",p.shapeTexts[m.ShapeTypes.ArrowLeft]="Left Arrow",p.shapeTexts[m.ShapeTypes.ArrowUp]="Up Arrow",p.shapeTexts[m.ShapeTypes.ArrowRight]="Right Arrow",p.shapeTexts[m.ShapeTypes.ArrowDown]="Down Arrow",p.shapeTexts[m.ShapeTypes.ArrowUpDown]="Up Down Arrow",p.shapeTexts[m.ShapeTypes.ArrowLeftRight]="Left Right Arrow",p.shapeTexts[m.ShapeTypes.Process]="Process",p.shapeTexts[m.ShapeTypes.Decision]="Decision",p.shapeTexts[m.ShapeTypes.Terminator]="Terminator",p.shapeTexts[m.ShapeTypes.PredefinedProcess]="Predefined Process",p.shapeTexts[m.ShapeTypes.Document]="Document",p.shapeTexts[m.ShapeTypes.MultipleDocuments]="Multiple Documents",p.shapeTexts[m.ShapeTypes.ManualInput]="Manual Input",p.shapeTexts[m.ShapeTypes.Preparation]="Preparation",p.shapeTexts[m.ShapeTypes.Data]="Data",p.shapeTexts[m.ShapeTypes.Database]="Database",p.shapeTexts[m.ShapeTypes.HardDisk]="Hard Disk",p.shapeTexts[m.ShapeTypes.InternalStorage]="Internal Storage",p.shapeTexts[m.ShapeTypes.PaperTape]="Paper Tape",p.shapeTexts[m.ShapeTypes.ManualOperation]="Manual Operation",p.shapeTexts[m.ShapeTypes.Delay]="Delay",p.shapeTexts[m.ShapeTypes.StoredData]="Stored Data",p.shapeTexts[m.ShapeTypes.Display]="Display",p.shapeTexts[m.ShapeTypes.Merge]="Merge",p.shapeTexts[m.ShapeTypes.Connector]="Connector",p.shapeTexts[m.ShapeTypes.Or]="Or",p.shapeTexts[m.ShapeTypes.SummingJunction]="Summing Junction",p.shapeTexts[m.ShapeTypes.Container]="Container",p.shapeTexts[m.ShapeTypes.VerticalContainer]="Vertical Container",p.shapeTexts[m.ShapeTypes.HorizontalContainer]="Horizontal Container",p.shapeTexts[m.ShapeTypes.Card]="Person's Name",p.shapeTexts[m.ShapeTypes.CardWithImageOnLeft]="Card with Image on the Left",p.shapeTexts[m.ShapeTypes.CardWithImageOnTop]="Card with Image on the Top",p.shapeTexts[m.ShapeTypes.CardWithImageOnRight]="Card with Image on the Right"},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeParameters=h.ShapeParameter=void 0;var m=function(){return function(p,u){this.key=p,this.value=u}}();h.ShapeParameter=m;var P=function(){function p(){this.items={}}return p.prototype.add=function(u){this.items[u.key]=u},p.prototype.addRange=function(u){for(var s=0;s<u.length;s++)this.add(u[s])},p.prototype.get=function(u){return this.items[u]},p.prototype.forEach=function(u){for(var s in this.items)Object.prototype.hasOwnProperty.call(this.items,s)&&u(this.items[s])},p.prototype.clone=function(){var u=new p;return this.forEach(function(s){u.add(new m(s.key,s.value))}),u},p.prototype.toObject=function(){var u={},s=!1;return this.forEach(function(i){u[i.key]={value:i.value},s=!0}),s?u:null},p.prototype.fromObject=function(u){this.forEach(function(s){var i=u[s.key];i&&typeof i.value=="number"&&(s.value=i.value)})},p}();h.ShapeParameters=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectionMode=h.PositionInfo=h.Edge=void 0;var m=function(){function p(u,s,i,t){t===void 0&&(t=1),this.weight=t,this.key=u,this.from=s,this.to=i}return p.prototype.getHashKey=function(){return this.from+"_"+this.to},p.prototype.reverse=function(){return new p(this.key,this.to,this.from,this.weight)},p}();h.Edge=m;var P=function(){return function(p,u){this.item=p,this.position=u}}();h.PositionInfo=P,function(p){p[p.Outgoing=1]="Outgoing",p[p.Incoming=2]="Incoming",p[p.OutgoingAndIncoming=3]="OutgoingAndIncoming"}(h.ConnectionMode||(h.ConnectionMode={}))},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.GroupPrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a){var c=s.call(this,null,e,o,r)||this;return c.zIndex=n,c.onBeforeDispose=a,c.children=t,c}return P(i,s),i.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"g")},i.prototype.applyElementProperties=function(t,e){(this.zIndex||this.zIndex===0)&&t.style.setProperty("z-index",this.zIndex.toString()),s.prototype.applyElementProperties.call(this,t,e)},i.prototype.dispose=function(){this.onBeforeDispose&&this.onBeforeDispose(),s.prototype.dispose.call(this)},i}(d(24).SvgPrimitive);h.GroupPrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerCancellableState=h.MouseHandlerStateBase=void 0;var p=d(25),u=function(){function i(t){this.handler=t}return i.prototype.start=function(){},i.prototype.finish=function(){},i.prototype.onMouseClick=function(t){},i.prototype.onMouseDblClick=function(t){this.handler.switchToDefaultState()},i.prototype.onMouseDown=function(t){},i.prototype.onMouseUp=function(t){},i.prototype.onMouseMove=function(t){},i.prototype.onMouseWheel=function(t){return!1},i.prototype.onDragStart=function(t){},i.prototype.onDragEnd=function(t){},i.prototype.onShortcut=function(t){return!1},i.prototype.onKeyDown=function(t){},i.prototype.onKeyUp=function(t){},i.prototype.onConnectionPointsShow=function(t,e){},i.prototype.onConnectionTargetShow=function(t,e){},i}();h.MouseHandlerStateBase=u;var s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.onShortcut=function(e){return e===p.KeyCode.Esc&&(this.cancelChanges(),this.handler.switchToDefaultState(),!0)},t}(u);h.MouseHandlerCancellableState=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return P.binaryIndexOf=function(p,u,s,i){s===void 0&&(s=0),i===void 0&&(i=-2);var t=s===0;for(i===-2&&(i=p.length-1);s<=i;){var e=s+(i-s>>1),n=u(p[e]);if(n<0)s=e+1;else{if(!(n>0))return e;i=e-1}}return t?~s:-1},P.normedBinaryIndexOf=function(p,u,s,i){s===void 0&&(s=0),i===void 0&&(i=-2);var t=P.binaryIndexOf(p,u,s,i);return P.binaryIndexNormalizator(t)},P.binaryIndexNormalizator=function(p){return p<0?~p-1:p},P.normedInterpolationIndexOf=function(p,u,s,i,t){i===void 0&&(i=0),t===void 0&&(t=-2),t===-2&&(t=p.length-1);var e=p[Math.min(i,t)];if(e===void 0||s<u(e))return-1;for(var n=u(p[i]),o=u(p[t]);;){if(!(s>n&&s<o))return s===n?i:t;var r=i+Math.floor((s-n)*(t-i)/(o-n)),a=u(p[r]);if(s>a){if(s<(n=u(p[i=r+1])))return r}else{if(!(s<a))return r;o=u(p[t=r-1])}}},P}();h.SearchUtils=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasManagerBase=h.PAGE_BG_TEXTFLOOR_FILTER_ID=void 0;var m=d(172),P=d(12);h.PAGE_BG_TEXTFLOOR_FILTER_ID="page-text-flood";var p=function(){function u(s,i){this.elements={},this.actualZoom=s,this.dom=i}return u.prototype.createAndChangePrimitivesElements=function(s,i){var t=this;s.forEach(function(e){t.createAndChangePrimitiveElement(e,i)})},u.prototype.createPrimitiveElement=function(s,i,t){return this.dom.createElement(s,i,t)},u.prototype.createAndChangePrimitiveElement=function(s,i,t){var e=this.createPrimitiveElement(s,i,t);return this.dom.changeByPrimitive(e,s),e},u.prototype.changePrimitiveElement=function(s,i){this.dom.changeByPrimitive(i,s)},u.prototype.getOrCreateElement=function(s,i,t,e){var n=s&&this.elements[s]||(this.elements[s]=this.createPrimitiveElement(i,t,e));return this.changePrimitiveElement(i,n),n},u.prototype.createTextFloodFilter=function(s,i,t){this.getOrCreateElement(s,new m.TextFloodFilterPrimitive(h.PAGE_BG_TEXTFLOOR_FILTER_ID,t),i)},u.prototype.getAbsoluteSize=function(s){return s.clone().applyConverter(P.UnitConverter.twipsToPixelsF).clone().multiply(this.actualZoom,this.actualZoom)},u}();h.CanvasManagerBase=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.TextOwner=void 0,function(m){m[m.Shape=0]="Shape",m[m.Connector=1]="Connector",m[m.ExtensionLine=2]="ExtensionLine",m[m.Resize=3]="Resize"}(h.TextOwner||(h.TextOwner={}))},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Data=h.SetAbsoluteY=h.SetAbsoluteX=void 0;var m=d(27),P=d(50);function p(i){return!isNaN(parseFloat(i))&&isFinite(i)}function u(i,t,e){return i-=function(n,o){var r=function(c){var l=document.createElement("DIV");return l.style.top="0px",l.style.left="0px",l.style.visibility="hidden",l.style.position=m.DomUtils.getCurrentStyle(c).position,l}(n);r.style.position==="static"&&(r.style.position="absolute"),n.parentNode.appendChild(r);var a=o?m.DomUtils.getAbsolutePositionX(r):m.DomUtils.getAbsolutePositionY(r);return n.parentNode.removeChild(r),Math.round(a)}(t,e)}h.SetAbsoluteX=function(i,t){i.style.left=u(t,i,!0)+"px"},h.SetAbsoluteY=function(i,t){i.style.top=u(t,i,!1)+"px"};var s=function(){function i(){}return i.ArrayInsert=function(t,e,n){if(0<=n&&n<t.length){for(var o=t.length;o>n;o--)t[o]=t[o-1];t[n]=e}else t.push(e)},i.ArrayRemove=function(t,e){var n=i.ArrayIndexOf(t,e);n>-1&&i.ArrayRemoveAt(t,n)},i.ArrayRemoveAt=function(t,e){if(e>=0&&e<t.length){for(var n=e;n<t.length-1;n++)t[n]=t[n+1];t.pop()}},i.ArrayClear=function(t){for(;t.length>0;)t.pop()},i.ArrayIndexOf=function(t,e,n){if(n){for(o=0;o<t.length;o++)if(n(t[o],e))return o}else for(var o=0;o<t.length;o++)if(t[o]===e)return o;return-1},i.ArrayContains=function(t,e){return i.ArrayIndexOf(t,e)>=0},i.ArrayEqual=function(t,e){var n=t.length;if(n!==e.length)return!1;for(var o=0;o<n;o++)if(t[o]!==e[o])return!1;return!0},i.ArraySame=function(t,e){return t.length===e.length&&t.every(function(n){return i.ArrayContains(e,n)})},i.ArrayGetIntegerEdgeValues=function(t){var e=i.CollectionToArray(t);return i.ArrayIntegerAscendingSort(e),{start:e[0],end:e[e.length-1]}},i.ArrayIntegerAscendingSort=function(t){i.ArrayIntegerSort(t,!1)},i.ArrayIntegerSort=function(t,e){t.sort(function(n,o){var r=0;return n>o?r=1:n<o&&(r=-1),e&&(r*=-1),r})},i.CollectionsUnionToArray=function(t,e){for(var n=[],o=t.length,r=e.length,a=0;a<o+r;a++)a<o?n.push(t[a]):n.push(e[a-o]);return n},i.CollectionToArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},i.CreateHashTableFromArray=function(t){for(var e=[],n=0;n<t.length;n++)e[t[n]]=1;return e},i.CreateIndexHashTableFromArray=function(t){for(var e=[],n=0;n<t.length;n++)e[t[n]]=n;return e},i.ArrayToHash=function(t,e,n){return t instanceof Array?t.reduce(function(o,r,a){var c=e(r,a),l=n(r,a);return o[c]=l,o},{}):{}},i.Sum=function(t,e){return t instanceof Array?t.reduce(function(n,o){var r=e?e(o):o;return p(r)||(r=0),n+r},0):0},i.Min=function(t,e){return i.CalculateArrayMinMax(t,e,!1)},i.Max=function(t,e){return i.CalculateArrayMinMax(t,e,!0)},i.NearestLeftBinarySearchComparer=function(t,e,n){var o=t[e],r=o<n;return r&&e===t.length-1||r&&t[e+1]>=n?0:o<n?-1:1},i.ArrayBinarySearch=function(t,e,n,o,r){n||(n=i.defaultBinarySearchComparer),P.isDefined(o)||(o=0),P.isDefined(r)||(r=t.length-o);for(var a=o+r-1;o<=a;){var c=o+(a-o>>1),l=n(t,c,e);if(l===0)return c;l<0?o=c+1:a=c-1}return-(o+1)},i.ArrayFlatten=function(t){var e=[];return t.forEach(function(n){e=e.concat(n)}),e},i.GetDistinctArray=function(t){for(var e=[],n=0;n<t.length;n++){var o=t[n];i.ArrayIndexOf(e,o)===-1&&e.push(o)}return e},i.ForEach=function(t,e){if(Array.prototype.forEach)Array.prototype.forEach.call(t,e);else for(var n=0,o=t.length;n<o;n++)e(t[n],n,t)},i.MergeHashTables=function(t,e){if(!e||typeof e=="string")return t;for(var n in t||(t={}),e)!n||n in t||(t[n]=e[n]);return t},i.Range=function(t,e){return(t=parseInt(t)||0)<0&&(t=0),(e=parseInt(e)||0)<0&&(e=0),Array(t).map(function(n,o){return e+o})},i.CalculateArrayMinMax=function(t,e,n){if(!(t instanceof Array))return 0;var o=n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;return t.reduce(function(r,a){var c=e?e(a):a;return p(c)||(c=o),(n?Math.max:Math.min)(c,r)},o)},i.byRange=function(t,e,n){return Math.min(Math.max(t,e),n)},i.defaultBinarySearchComparer=function(t,e,n){var o=t[e];return o===n?0:o<n?-1:1},i.cssTextToObject=function(t){return t?(t=t.replace(/\/\*(.|\s)*?\*\//g,"").replace(/\s+/g," ")).split(";").reduce(function(e,n){if(n){var o=/\s*([^:]+?)\s*:\s*([^;]*)\s*$/.exec(n);if(o){var r=o[1],a=o[2];r&&a&&(e[r.trim()]=a.trim())}return e}return e},{}):{}},i.objectToCssText=function(t){return t?Object.keys(t).reduce(function(e,n){var o=n.trim(),r=t[n];return o&&r&&e.push(o+": "+r.toString().trim()),e},[]).join("; "):""},i}();h.Data=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectionPoint=void 0;var p=d(0),u=d(9),s=function(i){function t(e,n,o){o===void 0&&(o=u.ConnectionPointSide.Undefined);var r=i.call(this,e,n)||this;return r.side=o,r}return P(t,i),t.prototype.offset=function(e,n){return i.prototype.offset.call(this,e,n),this.side=u.ConnectionPointSide.Undefined,this},t.prototype.multiply=function(e,n){return i.prototype.multiply.call(this,e,n),this.side=u.ConnectionPointSide.Undefined,this},t.prototype.clone=function(){return new t(this.x,this.y,this.side)},t.prototype.toPoint=function(){return new p.Point(this.x,this.y)},t}(p.Point);h.ConnectionPoint=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ImageCache=h.CacheImageInfo=void 0;var m=d(83),P=d(51),p=d(3),u=function(){function i(t,e,n,o,r){this._base64=t!==void 0?m.Base64Utils.normalizeToDataUrl(t,"image/png"):void 0,this.actualId=e,this._referenceInfo=o,this._isLoaded=r!==void 0&&r,this.imageUrl=n}return Object.defineProperty(i.prototype,"isLoaded",{get:function(){return this._referenceInfo?this._referenceInfo._isLoaded:this._isLoaded},set:function(t){this._isLoaded=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"base64",{get:function(){return this._base64},set:function(t){this._base64=m.Base64Utils.normalizeToDataUrl(t,"image/png")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"referenceInfo",{get:function(){return this._referenceInfo},set:function(t){this._referenceInfo=t,this._base64=void 0,this._isLoaded=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isLoading",{get:function(){return this._referenceInfo?this.referenceInfo._isLoading:this._isLoading},enumerable:!1,configurable:!0}),i.prototype.startLoading=function(){this._referenceInfo?this._referenceInfo.startLoading():this._isLoading=!0},i.prototype.finalizeLoading=function(){this._referenceInfo?this._referenceInfo.finalizeLoading():this._isLoading=!1},i}();h.CacheImageInfo=u;var s=function(){function i(){this.emptyImageId=0,this.lastActualId=0,this.onReadyStateChanged=new p.EventDispatcher,this.cache=[],this.nonLoadedImages=[],this.createUnloadedInfoByBase64(P.ImageInfo.transparentOnePixelImage).isLoaded=!0}return i.prototype.reset=function(){this.cache.splice(1),this.nonLoadedImages=[],this.lastActualId=1},Object.defineProperty(i.prototype,"emptyImage",{get:function(){return this.cache[this.emptyImageId]},enumerable:!1,configurable:!0}),i.prototype.getImageData=function(t){return this.cache[t]},i.prototype.createUnloadedInfoByUrl=function(t){var e=this.findInfoByUrl(t);return e||this.registerImageData(new u(void 0,this.getNextActualId(),t))},i.prototype.createUnloadedInfoByBase64=function(t){var e=this.findInfoByBase64(t);return e||this.registerImageData(new u(t,this.getNextActualId()))},i.prototype.createUnloadedInfoByShapeImageInfo=function(t){var e=t.exportUrl;return m.Base64Utils.checkPrependDataUrl(e)?this.createUnloadedInfoByBase64(e):this.createUnloadedInfoByUrl(e)},i.prototype.registerImageData=function(t){var e=this.cache[t.actualId];return e||(e=t),t.actualId!==void 0&&(this.cache[t.actualId]=e),t.actualId!==0&&(this.nonLoadedImages.push(t),this.nonLoadedImages.length===1&&this.raiseReadyStateChanged(!1)),e},i.prototype.loadAllImages=function(t){var e=this;this.cache.forEach(function(n){e.emptyImageId===n.actualId||n.isLoaded||n.isLoading||t.load(n)})},i.prototype.finalizeLoading=function(t,e){t.finalizeLoading(),t.isLoaded=!0;var n=this.nonLoadedImages.indexOf(t);if(this.nonLoadedImages.splice(n,1),this.nonLoadedImages.length===0&&this.raiseReadyStateChanged(!0),!t.referenceInfo&&e.base64){var o=m.Base64Utils.normalizeToDataUrl(e.base64,"image/png");this.cache.forEach(function(r){var a=r.base64===o&&r!==t&&r.isLoaded;return a&&(t.referenceInfo=r.referenceInfo?r.referenceInfo:r),a}),t.base64=o}},i.prototype.hasNonLoadedImages=function(){return this.nonLoadedImages.length!==0},i.prototype.getNextActualId=function(){return this.lastActualId++},i.prototype.findInfoByBase64=function(t){return t=m.Base64Utils.normalizeToDataUrl(t,"image/png"),this.findInfoCore(function(e){return e.base64===t})},i.prototype.findInfoByUrl=function(t){return this.findInfoCore(function(e){return e.imageUrl===t})},i.prototype.findInfoCore=function(t){var e;return this.cache.forEach(function(n){t(n)&&(e=n)}),e},i.prototype.raiseReadyStateChanged=function(t){this.onReadyStateChanged.raise1(function(e){return e.notifyImageCacheReadyStateChanged(t)})},i.instance=new i,i}();h.ImageCache=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PageOrientation=h.DiagramUnit=void 0,function(m){m[m.In=0]="In",m[m.Cm=1]="Cm",m[m.Px=2]="Px"}(h.DiagramUnit||(h.DiagramUnit={})),function(m){m[m.Portrait=0]="Portrait",m[m.Landscape=1]="Landscape"}(h.PageOrientation||(h.PageOrientation={}))},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.SetConnectionPointIndexHistoryItem=h.AddConnectionHistoryItem=void 0;var p=d(8),u=d(6),s=function(t){function e(n,o,r,a){var c=t.call(this)||this;return c.connectorKey=n.key,c.itemKey=o.key,c.connectionPointIndex=r,c.position=a,c}return P(e,t),e.prototype.redo=function(n){var o=n.model.findConnector(this.connectorKey),r=n.model.findItem(this.itemKey);n.addConnection(o,r,this.connectionPointIndex,this.position)},e.prototype.undo=function(n){var o=n.model.findConnector(this.connectorKey);n.deleteConnection(o,this.position)},e}(p.HistoryItem);h.AddConnectionHistoryItem=s;var i=function(t){function e(n,o,r){var a=t.call(this)||this;return a.connectorKey=n.key,a.connectionPointIndex=o,a.position=r,a}return P(e,t),e.prototype.redo=function(n){var o=n.model.findConnector(this.connectorKey);this.oldConnectionPointIndex=this.position===u.ConnectorPosition.Begin?o.beginConnectionPointIndex:o.endConnectionPointIndex,n.setConnectionPointIndex(o,this.connectionPointIndex,this.position)},e.prototype.undo=function(n){var o=n.model.findConnector(this.connectorKey);n.setConnectionPointIndex(o,this.oldConnectionPointIndex,this.position)},e}(p.HistoryItem);h.SetConnectionPointIndexHistoryItem=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return P.isAlpha=function(p){return p>="a"&&p<="z"||p>="A"&&p<="Z"},P.isDigit=function(p){return p>="0"&&p<="9"},P.stringHashCode=function(p){var u=0;if(p.length===0)return u;for(var s=p.length,i=0;i<s;i++)u=(u<<5)-u+p.charCodeAt(i),u|=0;return u},P.endsAt=function(p,u){var s=p.length-1,i=u.length-1,t=s-i;if(t<0)return!1;for(;s>=t;s--,i--)if(p[s]!==u[i])return!1;return!0},P.startsAt=function(p,u){return p.substr(0,u.length)===u},P.stringInLowerCase=function(p){return p.toLowerCase()===p},P.stringInUpperCase=function(p){return p.toUpperCase()===p},P.atLeastOneSymbolInUpperCase=function(p){for(var u=0,s=void 0;s=p[u];u++)if(P.stringInUpperCase(s)&&!P.stringInLowerCase(s))return!0;return!1},P.getSymbolFromEnd=function(p,u){return p[p.length-u]},P.trim=function(p,u){if(u===void 0)return P.trimInternal(p,!0,!0);var s=u.join("");return p.replace(new RegExp("(^["+s+"]*)|(["+s+"]*$)","g"),"")},P.trimStart=function(p,u){if(u===void 0)return P.trimInternal(p,!0,!1);var s=u.join("");return p.replace(new RegExp("^["+s+"]*","g"),"")},P.trimEnd=function(p,u){if(u===void 0)return P.trimInternal(p,!1,!0);var s=u.join("");return p.replace(new RegExp("["+s+"]*$","g"),"")},P.getDecimalSeparator=function(){return 1.1.toLocaleString().substr(1,1)},P.repeat=function(p,u){return new Array(u<=0?0:u+1).join(p)},P.isNullOrEmpty=function(p){return!p||!p.length},P.padLeft=function(p,u,s){return P.repeat(s,Math.max(0,u-p.length))+p},P.trimInternal=function(p,u,s){var i=p.length;if(!i)return p;if(i<764833){var t=p;return u&&(t=t.replace(/^\s+/,"")),s&&(t=t.replace(/\s+$/,"")),t}var e=0;if(s)for(;i>0&&/\s/.test(p[i-1]);)i--;if(u&&i>0)for(;e<i&&/\s/.test(p[e]);)e++;return p.substring(e,i)},P}();h.StringUtils=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(49);h.isDefined=function(P){return P!=null},h.boolToInt=function(P){return P?1:0},h.boolToString=function(P){return P?"1":"0"},h.isNumber=function(P){return typeof P=="number"},h.isString=function(P){return typeof P=="string"},h.isNonNullString=function(P){return!!P},h.isEven=function(P){return P%2!=0},h.isOdd=function(P){return P%2==0},h.numberToStringBin=function(P,p){return p===void 0&&(p=0),m.StringUtils.padLeft(P.toString(2),p,"0")},h.numberToStringHex=function(P,p){return p===void 0&&(p=0),m.StringUtils.padLeft(P.toString(16),p,"0")}},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ImageInfo=void 0;var m=d(83),P=function(){function p(u){this.url=void 0,this.base64=void 0,u&&(m.Base64Utils.checkPrependDataUrl(u)?this.base64=u:this.url=u),this.loadFailed=!1}return p.prototype.clone=function(){var u=new p;return u.url=this.url,u.base64=this.base64,u},Object.defineProperty(p.prototype,"isEmpty",{get:function(){return this.url===void 0&&this.base64===void 0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"unableToLoad",{get:function(){return this.loadFailed},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"renderUrl",{get:function(){return this.base64||""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"exportUrl",{get:function(){return this.base64?this.base64:this.url},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actualUrl",{get:function(){return this.url?this.url:this.base64},enumerable:!1,configurable:!0}),Object.defineProperty(p,"transparentOnePixelImage",{get:function(){return this.transparentWhiteImage1_1},enumerable:!1,configurable:!0}),p.prototype.loadBase64Content=function(u){this.base64=m.Base64Utils.normalizeToDataUrl(u,"image/png")},p.prototype.setUnableToLoadFlag=function(){this.loadFailed=!0},p.transparentWhiteImage1_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAANSURBVBhXY/j///9/AAn7A/0FQ0XKAAAAAElFTkSuQmCC",p}();h.ImageInfo=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalSideCalculatorBase=void 0;var m=d(13),P=d(9),p=d(6),u=function(){function s(i){this.parent=i}return Object.defineProperty(s.prototype,"connector",{get:function(){return this.parent.connector},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"beginRect",{get:function(){return this.parent.beginRect},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"endRect",{get:function(){return this.parent.endRect},enumerable:!1,configurable:!0}),s.prototype.getBeginOffsetPoints=function(i,t,e,n){if(t=this.getCorrectOriginPoint(t,n),i!==P.ConnectionPointSide.Undefined){if(this.isBeginEndSame())return this.getSameShapeOffsetPoints(i,t,e,n);if(this.isBeginEndOverlappedPoints(t,e))return this.getOverlappedPointsOffsetPoints(i,t,e,n);if(this.isBeginEndOverlapped())return this.getBeginOverlappedShapeOffsetPoints(i,t,e,n)}else if(this.isOriginRectContainsTargetPoint(n,e))return this.getOverlappedPointsOffsetPoints(i,t,e,n);return this.isOnSidePoint(t,e)?this.getBeginOnSideOffsetPoints(i,t,e,n):this.getBeginOffSideOffsetPoints(i,t,e,n)},s.prototype.getEndOffsetPoints=function(i,t,e,n){if(t=this.getCorrectOriginPoint(t,n),i!==P.ConnectionPointSide.Undefined){if(this.isBeginEndSame())return this.getSameShapeOffsetPoints(i,t,e,n);if(this.isBeginEndOverlappedPoints(e,t))return this.getOverlappedPointsOffsetPoints(i,t,e,n);if(this.isBeginEndOverlapped())return this.getEndOverlappedShapeOffsetPoints(i,t,e,n)}else if(this.isOriginRectContainsTargetPoint(n,e))return this.getOverlappedPointsOffsetPoints(i,t,e,n);return this.isOnSidePoint(t,e)?this.getEndOnSideOffsetPoints(i,t,e,n):this.getEndOffSideOffsetPoints(i,t,e,n)},s.prototype.getSide=function(i,t){return Math.abs(t.x-i.x)>Math.abs(t.y-i.y)?t.x>i.x?P.ConnectionPointSide.East:P.ConnectionPointSide.West:t.y>i.y?P.ConnectionPointSide.South:P.ConnectionPointSide.North},s.prototype.getSideCalculator=function(i,t){return this.parent.getSideCalculator(this.getSide(i,t))},s.prototype.getMinOffset=function(){return p.Connector.minOffset},s.prototype.isBeginEndSame=function(){return this.connector.beginItem===this.connector.endItem},s.prototype.isBeginEndOverlapped=function(){return this.beginRect&&this.endRect&&m.Rectangle.areIntersected(this.beginRect,this.endRect)},s.prototype.isBeginEndOverlappedX=function(){return this.beginRect&&this.endRect&&!!m.Rectangle.getHorizIntersection(this.beginRect,this.endRect)},s.prototype.isBeginEndOverlappedY=function(){return this.beginRect&&this.endRect&&!!m.Rectangle.getVertIntersection(this.beginRect,this.endRect)},s.prototype.isBeginEndOverlappedPoints=function(i,t){return this.beginRect&&this.endRect&&(this.beginRect.containsPoint(t)||this.endRect.containsPoint(i))},s.prototype.isOriginRectContainsTargetPoint=function(i,t){return i&&t&&i.containsPoint(t)},s}();h.ConnectorPointsOrthogonalSideCalculatorBase=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.AddShapeHistoryItem=void 0;var p=d(8),u=d(14),s=function(i){function t(e,n,o,r){var a=i.call(this)||this;return a.shapeDescription=e,a.position=n,a.text=o,a.dataKey=r,a}return P(t,i),t.prototype.redo=function(e){var n=new u.Shape(this.shapeDescription,this.position);typeof this.text=="string"&&(n.text=this.text),this.dataKey!==void 0&&(n.dataKey=this.dataKey),e.addShape(n,this.shapeKey),this.shapeKey=n.key},t.prototype.undo=function(e){e.deleteShape(e.model.findShape(this.shapeKey),!0)},t}(p.HistoryItem);h.AddShapeHistoryItem=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.GraphIterator=h.FastGraph=h.Graph=void 0;var p=d(38),u=d(14),s=d(41),i=d(90),t=function(){function r(a,c){this.nodeMap={},this.edgeMap={},this.nodes=[],this.edges=[],this.onInit(),a.forEach(this.addNode.bind(this)),c.forEach(this.addEdge.bind(this))}return Object.defineProperty(r.prototype,"items",{get:function(){return this.nodes.map(this.getNode.bind(this))},enumerable:!1,configurable:!0}),r.prototype.onInit=function(){},r.prototype.addEdge=function(a){this.edgeMap[a.key]=a,this.edges.push(a)},r.prototype.addNode=function(a){this.nodeMap[a.key]=a,this.nodes.push(a.key)},r.prototype.getNode=function(a){return this.nodeMap[a]},r.prototype.getEdge=function(a){return this.edgeMap[a]},r.prototype.isEmpty=function(){return!this.nodes.length&&!this.edges.length},r.prototype.getAdjacentEdges=function(a,c){return c===void 0&&(c=p.ConnectionMode.OutgoingAndIncoming),this.edges.filter(function(l){return c&p.ConnectionMode.Incoming&&l.to===a||c&p.ConnectionMode.Outgoing&&l.from===a})},r}(),e=function(r){function a(){return r!==null&&r.apply(this,arguments)||this}return P(a,r),a.prototype.cast=function(c,l){var y=this;return new a(this.nodes.map(function(g){return c(y.getNode(g))}),this.edges.map(function(g){return l?l(g):g}))},a.prototype.getConnectedComponents=function(){var c=this.createIterator(p.ConnectionMode.OutgoingAndIncoming);c.visitEachEdgeOnce=!0;for(var l=[],y=function(v){var C=[],b=[];c.onNode=function(S){return C.push(S)},c.onEdge=function(S){return b.push(S)},c.iterate(g.nodes[v]),C.length&&l.push(new a(C,b))},g=this,f=0;f<this.nodes.length;f++)y(f);return l},a.prototype.createIterator=function(c){var l=new o(this,c);return l.comparer=function(y,g){return y.weight-g.weight},l},a.prototype.getSpanningGraph=function(c,l,y){var g=this;if(y===void 0&&(y=void 0),!this.nodes.length)return new a([],[]);y||(y=function(x){return x.weight});var f=[],v=new i.HashSet,C=new i.HashSet([],function(x){return x.getHashKey()});for(this.addNodeToSpanningGraph(c,l,f,v,C,y);f.length&&v.length!==this.nodes.length;){var b=f.shift();C.tryPush(b);var S=v.contains(b.from)?b.to:b.from;this.addNodeToSpanningGraph(S,l,f,v,C,y),f=f.filter(function(x){return!v.contains(x.from)||!v.contains(x.to)})}return new a(v.list().map(function(x){return g.getNode(x)}),C.list())},a.prototype.addNodeToSpanningGraph=function(c,l,y,g,f,v){g.tryPush(c),this.getAdjacentEdges(c,l).filter(function(C){return!f.contains(C)}).forEach(function(C){var b=v(C),S=s.SearchUtils.binaryIndexOf(y,function(x){return x.weight-b});for(S=S<0?~S:S;S<y.length&&v(y[S])===b;)S++;y.splice(S,0,new p.Edge(C.key,C.from,C.to,b))})},a.create=function(c,l){return new a(c,l.filter(function(y){return y.beginItem&&y.endItem instanceof u.Shape&&y.endItem&&y.endItem instanceof u.Shape&&y.beginItem!==y.endItem}).map(function(y){return new p.Edge(y.key,y.beginItem&&y.beginItem.key,y.endItem&&y.endItem.key)}))},a}(t);h.Graph=e;var n=function(r){function a(){return r!==null&&r.apply(this,arguments)||this}return P(a,r),a.prototype.onInit=function(){this.parentToChildren={},this.childToParents={}},a.prototype.addEdge=function(c){r.prototype.addEdge.call(this,c),(this.parentToChildren[c.from]||(this.parentToChildren[c.from]=[])).push(c.to),(this.childToParents[c.to]||(this.childToParents[c.to]=[])).push(c.from)},a.prototype.getChildren=function(c){return this.parentToChildren[c]||[]},a.prototype.getParents=function(c){return this.childToParents[c]||[]},a.prototype.createIterator=function(c){return new o(this,c)},a}(t);h.FastGraph=n;var o=function(){function r(a,c){c===void 0&&(c=p.ConnectionMode.OutgoingAndIncoming),this.graph=a,this.connectionMode=c,this.visitEachEdgeOnce=!0,this.visitEachNodeOnce=!0,this.visitedNodes={},this.visitedEdges={}}return r.prototype.iterate=function(a){if(!this.visitEachNodeOnce&&!this.visitEachEdgeOnce&&!this.skipNode)throw"skipNode or visitEachNodeOnce or visitEachEdgeOnce must be set to avoid SOF";this.iterateCore(a)},r.prototype.iterateCore=function(a){var c=this,l=this.graph.getNode(a);if(!(!l||this.skipNode&&this.skipNode(l)||this.visitEachNodeOnce&&this.isNodeVisited(a))){this.visitedNodes[a]=!0,this.onNode&&this.onNode(l);var y=this.graph.getAdjacentEdges(a,this.connectionMode);if(this.skipEdge&&(y=y.filter(function(v){return!c.skipEdge(v)})),this.connectionMode&p.ConnectionMode.Outgoing){var g=y.filter(function(v){return v.from===a});this.comparer&&g.sort(this.comparer),g.forEach(function(v){c.visitEachEdgeOnce&&c.visitedEdges[v.key]||(c.visitedEdges[v.key]=!0,c.onEdge&&c.onEdge(v,!0),c.iterateCore(v.to),c.onAfterEdge&&c.onAfterEdge(v,!0))})}if(this.onAllEdges&&this.onAllEdges(l,!0),this.connectionMode&p.ConnectionMode.Incoming){var f=y.filter(function(v){return v.to===a});this.comparer&&f.sort(this.comparer),f.forEach(function(v){c.visitEachEdgeOnce&&c.visitedEdges[v.key]||(c.visitedEdges[v.key]=!0,c.onEdge&&c.onEdge(v,!1),c.iterateCore(v.from),c.onAfterEdge&&c.onAfterEdge(v,!1))})}this.onAllEdges&&this.onAllEdges(l,!1)}},r.prototype.isNodeVisited=function(a){return!!this.visitedNodes[a]},r.prototype.isEdgeVisited=function(a){return!!this.visitedEdges[a]},r}();h.GraphIterator=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.EllipsePrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a,c){var l=s.call(this,r,a,void 0,c)||this;return l.cx=t,l.cy=e,l.rx=n,l.ry=o,l}return P(i,s),i.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"ellipse")},i.prototype.applyElementProperties=function(t,e){this.setUnitAttribute(t,"cx",this.cx),this.setUnitAttribute(t,"cy",this.cy),this.setUnitAttribute(t,"rx",this.rx),this.setUnitAttribute(t,"ry",this.ry),this.setPositionCorrectionAttribute(t),s.prototype.applyElementProperties.call(this,t,e)},i}(d(24).SvgPrimitive);h.EllipsePrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ClipPathPrimitive=void 0;var p=d(15),u=function(s){function i(t,e){var n=s.call(this)||this;return n.id=t,n.children=e,n}return P(i,s),i.prototype.createMainElement=function(){var t=document.createElementNS(p.svgNS,"clipPath");return t.setAttribute("id",this.id),t},i.prototype.applyElementProperties=function(t,e){this.id&&t.setAttribute("id",this.id),s.prototype.applyElementProperties.call(this,t,e)},i}(d(24).SvgPrimitive);h.ClipPathPrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportImportCommandBase=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabledInReadOnlyMode=function(){return!0},s}(d(10).SimpleCommandBase);h.ExportImportCommandBase=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramModelOperation=h.Diagnostics=h.RenderHelper=h.DiagramLocalizationService=h.NativeConnector=h.NativeShape=h.ShapeType=h.ColorUtils=h.PageOrientation=h.ConnectorPosition=h.ConnectorLineOption=h.ConnectorLineEnding=h.AutoZoomMode=h.Browser=h.UnitConverter=h.EventDispatcher=h.DataLayoutOrientation=h.DataLayoutType=h.ShapeCategories=h.ShapeTypes=h.DiagramUnit=h.default=h.DiagramControl=h.DiagramCommand=h.Point=h.Size=void 0;var m=d(82);Object.defineProperty(h,"DiagramCommand",{enumerable:!0,get:function(){return m.DiagramCommand}});var P=d(301);Object.defineProperty(h,"DiagramControl",{enumerable:!0,get:function(){return P.DiagramControl}}),Object.defineProperty(h,"default",{enumerable:!0,get:function(){return P.DiagramControl}});var p=d(2);Object.defineProperty(h,"Size",{enumerable:!0,get:function(){return p.Size}});var u=d(0);Object.defineProperty(h,"Point",{enumerable:!0,get:function(){return u.Point}});var s=d(3);Object.defineProperty(h,"EventDispatcher",{enumerable:!0,get:function(){return s.EventDispatcher}});var i=d(1);Object.defineProperty(h,"ShapeTypes",{enumerable:!0,get:function(){return i.ShapeTypes}}),Object.defineProperty(h,"ShapeCategories",{enumerable:!0,get:function(){return i.ShapeCategories}}),Object.defineProperty(h,"ShapeType",{enumerable:!0,get:function(){return i.ShapeType}});var t=d(12);Object.defineProperty(h,"UnitConverter",{enumerable:!0,get:function(){return t.UnitConverter}});var e=d(18);Object.defineProperty(h,"Browser",{enumerable:!0,get:function(){return e.Browser}});var n=d(28);Object.defineProperty(h,"AutoZoomMode",{enumerable:!0,get:function(){return n.AutoZoomMode}});var o=d(103);Object.defineProperty(h,"DataLayoutType",{enumerable:!0,get:function(){return o.DataLayoutType}});var r=d(20);Object.defineProperty(h,"DataLayoutOrientation",{enumerable:!0,get:function(){return r.DataLayoutOrientation}}),d(380);var a=d(32);Object.defineProperty(h,"ConnectorLineEnding",{enumerable:!0,get:function(){return a.ConnectorLineEnding}}),Object.defineProperty(h,"ConnectorLineOption",{enumerable:!0,get:function(){return a.ConnectorLineOption}});var c=d(22);Object.defineProperty(h,"ColorUtils",{enumerable:!0,get:function(){return c.ColorUtils}});var l=d(61);Object.defineProperty(h,"Diagnostics",{enumerable:!0,get:function(){return l.Diagnostics}});var y=d(84);Object.defineProperty(h,"NativeShape",{enumerable:!0,get:function(){return y.NativeShape}}),Object.defineProperty(h,"NativeConnector",{enumerable:!0,get:function(){return y.NativeConnector}});var g=d(36);Object.defineProperty(h,"DiagramLocalizationService",{enumerable:!0,get:function(){return g.DiagramLocalizationService}});var f=d(15);Object.defineProperty(h,"RenderHelper",{enumerable:!0,get:function(){return f.RenderHelper}});var v=d(47);Object.defineProperty(h,"DiagramUnit",{enumerable:!0,get:function(){return v.DiagramUnit}}),Object.defineProperty(h,"PageOrientation",{enumerable:!0,get:function(){return v.PageOrientation}});var C=d(16);Object.defineProperty(h,"DiagramModelOperation",{enumerable:!0,get:function(){return C.DiagramModelOperation}});var b=d(6);Object.defineProperty(h,"ConnectorPosition",{enumerable:!0,get:function(){return b.ConnectorPosition}})},function(j,h,d){"use strict";d.r(h),d.d(h,"__extends",function(){return P}),d.d(h,"__assign",function(){return p}),d.d(h,"__rest",function(){return u}),d.d(h,"__decorate",function(){return s}),d.d(h,"__param",function(){return i}),d.d(h,"__metadata",function(){return t}),d.d(h,"__awaiter",function(){return e}),d.d(h,"__generator",function(){return n}),d.d(h,"__createBinding",function(){return o}),d.d(h,"__exportStar",function(){return r}),d.d(h,"__values",function(){return a}),d.d(h,"__read",function(){return c}),d.d(h,"__spread",function(){return l}),d.d(h,"__spreadArrays",function(){return y}),d.d(h,"__await",function(){return g}),d.d(h,"__asyncGenerator",function(){return f}),d.d(h,"__asyncDelegator",function(){return v}),d.d(h,"__asyncValues",function(){return C}),d.d(h,"__makeTemplateObject",function(){return b}),d.d(h,"__importStar",function(){return x}),d.d(h,"__importDefault",function(){return I}),d.d(h,"__classPrivateFieldGet",function(){return w}),d.d(h,"__classPrivateFieldSet",function(){return _});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var m=function(T,R){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,D){E.__proto__=D}||function(E,D){for(var L in D)Object.prototype.hasOwnProperty.call(D,L)&&(E[L]=D[L])})(T,R)};function P(T,R){function E(){this.constructor=T}m(T,R),T.prototype=R===null?Object.create(R):(E.prototype=R.prototype,new E)}var p=function(){return(p=Object.assign||function(T){for(var R,E=1,D=arguments.length;E<D;E++)for(var L in R=arguments[E])Object.prototype.hasOwnProperty.call(R,L)&&(T[L]=R[L]);return T}).apply(this,arguments)};function u(T,R){var E={};for(var D in T)Object.prototype.hasOwnProperty.call(T,D)&&R.indexOf(D)<0&&(E[D]=T[D]);if(T!=null&&typeof Object.getOwnPropertySymbols=="function"){var L=0;for(D=Object.getOwnPropertySymbols(T);L<D.length;L++)R.indexOf(D[L])<0&&Object.prototype.propertyIsEnumerable.call(T,D[L])&&(E[D[L]]=T[D[L]])}return E}function s(T,R,E,D){var L,H=arguments.length,O=H<3?R:D===null?D=Object.getOwnPropertyDescriptor(R,E):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(T,R,E,D);else for(var z=T.length-1;z>=0;z--)(L=T[z])&&(O=(H<3?L(O):H>3?L(R,E,O):L(R,E))||O);return H>3&&O&&Object.defineProperty(R,E,O),O}function i(T,R){return function(E,D){R(E,D,T)}}function t(T,R){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(T,R)}function e(T,R,E,D){return new(E||(E=Promise))(function(L,H){function O(A){try{K(D.next(A))}catch(M){H(M)}}function z(A){try{K(D.throw(A))}catch(M){H(M)}}function K(A){var M;A.done?L(A.value):(M=A.value,M instanceof E?M:new E(function(U){U(M)})).then(O,z)}K((D=D.apply(T,R||[])).next())})}function n(T,R){var E,D,L,H,O={label:0,sent:function(){if(1&L[0])throw L[1];return L[1]},trys:[],ops:[]};return H={next:z(0),throw:z(1),return:z(2)},typeof Symbol=="function"&&(H[Symbol.iterator]=function(){return this}),H;function z(K){return function(A){return function(M){if(E)throw new TypeError("Generator is already executing.");for(;O;)try{if(E=1,D&&(L=2&M[0]?D.return:M[0]?D.throw||((L=D.return)&&L.call(D),0):D.next)&&!(L=L.call(D,M[1])).done)return L;switch(D=0,L&&(M=[2&M[0],L.value]),M[0]){case 0:case 1:L=M;break;case 4:return O.label++,{value:M[1],done:!1};case 5:O.label++,D=M[1],M=[0];continue;case 7:M=O.ops.pop(),O.trys.pop();continue;default:if(!(L=(L=O.trys).length>0&&L[L.length-1])&&(M[0]===6||M[0]===2)){O=0;continue}if(M[0]===3&&(!L||M[1]>L[0]&&M[1]<L[3])){O.label=M[1];break}if(M[0]===6&&O.label<L[1]){O.label=L[1],L=M;break}if(L&&O.label<L[2]){O.label=L[2],O.ops.push(M);break}L[2]&&O.ops.pop(),O.trys.pop();continue}M=R.call(T,O)}catch(U){M=[6,U],D=0}finally{E=L=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([K,A])}}}var o=Object.create?function(T,R,E,D){D===void 0&&(D=E),Object.defineProperty(T,D,{enumerable:!0,get:function(){return R[E]}})}:function(T,R,E,D){D===void 0&&(D=E),T[D]=R[E]};function r(T,R){for(var E in T)E==="default"||Object.prototype.hasOwnProperty.call(R,E)||o(R,T,E)}function a(T){var R=typeof Symbol=="function"&&Symbol.iterator,E=R&&T[R],D=0;if(E)return E.call(T);if(T&&typeof T.length=="number")return{next:function(){return T&&D>=T.length&&(T=void 0),{value:T&&T[D++],done:!T}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(T,R){var E=typeof Symbol=="function"&&T[Symbol.iterator];if(!E)return T;var D,L,H=E.call(T),O=[];try{for(;(R===void 0||R-- >0)&&!(D=H.next()).done;)O.push(D.value)}catch(z){L={error:z}}finally{try{D&&!D.done&&(E=H.return)&&E.call(H)}finally{if(L)throw L.error}}return O}function l(){for(var T=[],R=0;R<arguments.length;R++)T=T.concat(c(arguments[R]));return T}function y(){for(var T=0,R=0,E=arguments.length;R<E;R++)T+=arguments[R].length;var D=Array(T),L=0;for(R=0;R<E;R++)for(var H=arguments[R],O=0,z=H.length;O<z;O++,L++)D[L]=H[O];return D}function g(T){return this instanceof g?(this.v=T,this):new g(T)}function f(T,R,E){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var D,L=E.apply(T,R||[]),H=[];return D={},O("next"),O("throw"),O("return"),D[Symbol.asyncIterator]=function(){return this},D;function O(U){L[U]&&(D[U]=function(V){return new Promise(function(G,Y){H.push([U,V,G,Y])>1||z(U,V)})})}function z(U,V){try{(G=L[U](V)).value instanceof g?Promise.resolve(G.value.v).then(K,A):M(H[0][2],G)}catch(Y){M(H[0][3],Y)}var G}function K(U){z("next",U)}function A(U){z("throw",U)}function M(U,V){U(V),H.shift(),H.length&&z(H[0][0],H[0][1])}}function v(T){var R,E;return R={},D("next"),D("throw",function(L){throw L}),D("return"),R[Symbol.iterator]=function(){return this},R;function D(L,H){R[L]=T[L]?function(O){return(E=!E)?{value:g(T[L](O)),done:L==="return"}:H?H(O):O}:H}}function C(T){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R,E=T[Symbol.asyncIterator];return E?E.call(T):(T=a(T),R={},D("next"),D("throw"),D("return"),R[Symbol.asyncIterator]=function(){return this},R);function D(L){R[L]=T[L]&&function(H){return new Promise(function(O,z){(function(K,A,M,U){Promise.resolve(U).then(function(V){K({value:V,done:M})},A)})(O,z,(H=T[L](H)).done,H.value)})}}}function b(T,R){return Object.defineProperty?Object.defineProperty(T,"raw",{value:R}):T.raw=R,T}var S=Object.create?function(T,R){Object.defineProperty(T,"default",{enumerable:!0,value:R})}:function(T,R){T.default=R};function x(T){if(T&&T.__esModule)return T;var R={};if(T!=null)for(var E in T)E!=="default"&&Object.prototype.hasOwnProperty.call(T,E)&&o(R,T,E);return S(R,T),R}function I(T){return T&&T.__esModule?T:{default:T}}function w(T,R){if(!R.has(T))throw new TypeError("attempted to get private field on non-instance");return R.get(T)}function _(T,R,E){if(!R.has(T))throw new TypeError("attempted to set private field on non-instance");return R.set(T,E),E}},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(p,u){p===void 0&&(p=0),u===void 0&&(u=0),this.x=p,this.y=u}return Object.defineProperty(P.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),P.fromPoints=function(p,u){return new P(u.x-p.x,u.y-p.y)},P.fromSegment=function(p){return new P(p.endPoint.x-p.startPoint.x,p.endPoint.y-p.startPoint.y)},P.prototype.normalize=function(){var p=this.length;return p!==0&&(this.x/=p,this.y/=p),this},P.prototype.negative=function(){return this.x*=-1,this.y*=-1,this},Object.defineProperty(P,"axisX",{get:function(){return new P(1,0)},enumerable:!0,configurable:!0}),Object.defineProperty(P,"axisY",{get:function(){return new P(0,1)},enumerable:!0,configurable:!0}),P.angleBetween=function(p,u){var s=P.scalarProduct(p,u)/(p.length*u.length);return Math.acos(s)},P.scalarProduct=function(p,u){return p.x*u.x+p.y*u.y},P}();h.Vector=m},function(j,h,d){"use strict";var m;Object.defineProperty(h,"__esModule",{value:!0}),h.Diagnostics=void 0,function(p){p[p.Disabled=0]="Disabled",p[p.Console=1]="Console",p[p.Document=2]="Document"}(m||(m={}));var P=function(){function p(){}return p.beginAverage=function(u){this.enableLogsAndTimers&&(this.lastAverageGroupName=u)},p.endAverage=function(){this.enableLogsAndTimers&&(this.lastAverageGroupName=null)},p.tryLogAverage=function(u){var s=this;if(this.lastAverageGroupName!==u){var i=Object.keys(this.timers).map(function(e){return s.timers[e]}).filter(function(e){return e.groupName===u});if(!i.filter(function(e){return!e.endTime}).length){var t=i.reduce(function(e,n){return e+(n.endTime-n.startTime)},0)/i.length;this.log("average: "+t)}}},p.timer=function(u){this.enableLogsAndTimers&&(this.lastCreatedTimer={message:u,startTime:performance.now(),groupName:this.lastAverageGroupName})},p.endTimer=function(){var u=this;if(this.enableLogsAndTimers){var s=this.lastCreatedTimer,i=setTimeout(function(){s.endTime=performance.now(),u.showMessage('timer "'+s.message+'": '+(s.endTime-s.startTime)),s.groupName&&u.tryLogAverage(s.groupName)},0);this.timers[i]=s,this.lastCreatedTimer=null}},p.logPerfInfo=function(){var u=document.querySelector(".dxdi-control > svg").querySelectorAll("*").length,s=performance.memory;this.log("nodes: "+u.toLocaleString()+(s?" memory: ":"")+(s?s.usedJSHeapSize.toLocaleString():""))},p.log=function(u){this.showMessage(u)},p.showMessage=function(u){switch(p.mode){case m.Console:console.log(u);break;case m.Document:var s=this.getElement().value;if(this.lastMessage===u){var i=s.indexOf(`\r
`);i<0&&(i=s.indexOf(`
`));var t=s.substr(0,i);/( \()([0-9]+)(\))$/.test(t)?t=t.replace(/( \()([0-9]+)(\))$/,function(e,n,o,r){return n+ ++o+r}):t+=" (1)",this.getElement().value=t+s.substr(i)}else this.getElement().value=u+`\r
`+s,this.lastMessage=u}},p.getElement=function(){var u=this;if(!this.el){this.el=document.createElement("textarea"),this.el.style.top="0px",this.el.style.right="0px",this.el.style.position="fixed",this.el.style.background="transparent",this.el.style.fontSize="11px",this.el.style.fontFamily="monospace",this.el.style.overflow="auto",this.el.style.width="400px",document.body.appendChild(this.el);var s=document.createElement("button");s.innerHTML="x",s.addEventListener("click",function(){u.el.value="",u.lastMessage=""}),s.style.top="0px",s.style.right="400px",s.style.position="fixed",s.style.opacity="0.1",document.body.appendChild(s)}return this.el},p.mode=m.Document,p.optimizeUsingRAF=!0,p.optimizeLayers=!0,p.timers={},p.enableLogsAndTimers=!1,p}();h.Diagnostics=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramModel=void 0;var m=d(14),P=d(6),p=d(3),u=d(13),s=d(2),i=d(0),t=d(46),e=d(22),n=d(47),o=d(4),r=function(){function a(c){c===void 0&&(c=new s.Size(8391,11906)),this.items=[],this.itemIndexByKey={},this.keyCounter=0,this.pageSize=new s.Size(8391,11906),this.pageLandscape=!1,this.pageColor=a.defaultPageColor,this.units=n.DiagramUnit.In,this.snapStartPoint=new i.Point(0,0),this.pageSize=c,this.size=this.pageSize.clone(),this.rectangle=u.Rectangle.fromGeometry(new i.Point(0,0),new s.Size(0,0)),this.initializeKeyCounter()}return Object.defineProperty(a.prototype,"pageWidth",{get:function(){return this.pageLandscape?this.pageSize.height:this.pageSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pageHeight",{get:function(){return this.pageLandscape?this.pageSize.width:this.pageSize.height},enumerable:!1,configurable:!0}),a.prototype.getRectangle=function(c){return c&&(this.rectangle=o.ModelUtils.createRectangle(this.items)),this.rectangle},a.prototype.pushItem=function(c){var l=this.items.push(c);this.itemIndexByKey[c.key]=l-1,c instanceof m.Shape&&!c.image.isEmpty&&this.cacheShapeImage(c)},a.prototype.removeItem=function(c){var l=this.getItemIndex(c);delete this.itemIndexByKey[c.key],this.items.splice(l,1),this.updateIndicesHash(l)},a.prototype.updateIndicesHash=function(c){for(var l=c;l<this.items.length;l++)this.itemIndexByKey[this.items[l].key]=l},a.prototype.getItemIndex=function(c){return this.itemIndexByKey[c.key]},a.prototype.findShape=function(c){var l=this.findItem(c);return l instanceof m.Shape?l:void 0},a.prototype.findShapesCore=function(c){var l=[];return this.items.forEach(function(y){y instanceof m.Shape&&c(y)&&l.push(y)}),l},a.prototype.findShapeCore=function(c){for(var l=0;l<this.items.length;l++){var y=this.items[l];if(y instanceof m.Shape&&c(y))return y}},a.prototype.findShapeAtPosition=function(c){return this.findShapeCore(function(l){return l.position.equals(c)})},a.prototype.findShapeByDataKey=function(c){return this.findShapeCore(function(l){return l.dataKey===c})},a.prototype.findShapesByImageUrl=function(c){return this.findShapesCore(function(l){return l.image.url===c})},a.prototype.findShapesByDescription=function(c){return this.findShapesCore(function(l){return l.description.key===c.key})},a.prototype.cacheShapeImage=function(c){var l=t.ImageCache.instance.createUnloadedInfoByShapeImageInfo(c.image);l.isLoaded&&c.image.loadBase64Content(l.base64)},a.prototype.loadAllImages=function(c){t.ImageCache.instance.loadAllImages(c)},a.prototype.findContainer=function(c){var l=this.findShape(c);return l&&l.enableChildren?l:void 0},a.prototype.findNearestContainer=function(c){var l=this.findShape(c);return l?l.enableChildren?l:l.container:void 0},a.prototype.getChildren=function(c){var l=this;return c.children.map(function(y){return l.findItem(y.key)}).filter(function(y){return y})},a.prototype.findChild=function(c,l,y){var g,f=this;return y===void 0&&(y=!0),c.children.forEach(function(v){g||(v.key!==l?y&&v instanceof m.Shape&&(g=f.findChild(v,l,y)):g=v)}),g},a.prototype.findItemContainerCore=function(c,l){for(var y=c.container;y&&l&&!l(y);)y=y.container;return y},a.prototype.findItemContainer=function(c){return this.findItemContainerCore(c)},a.prototype.findItemCollapsedContainer=function(c){return this.findItemContainerCore(c,function(l){return!l.expanded})},a.prototype.findItemTopCollapsedContainer=function(c){for(var l,y=c.container;y;)y.expanded||(l=y),y=y.container;return l},a.prototype.isContainerItem=function(c,l){return this.findItemContainerCore(l,function(y){return y.key===c.key})!==void 0},a.prototype.findConnector=function(c){var l=this.findItem(c);return l instanceof P.Connector?l:void 0},a.prototype.findConnectorCore=function(c){for(var l=0;l<this.items.length;l++){var y=this.items[l];if(y instanceof P.Connector&&c(y))return y}},a.prototype.findConnectorAtPoints=function(c){return this.findConnectorCore(function(l){return p.GeometryUtils.arePointsEqual(l.points,c)})},a.prototype.findConnectorByDataKey=function(c){return this.findConnectorCore(function(l){return l.dataKey===c})},a.prototype.findConnectorByBeginEndDataKeys=function(c,l){return this.findConnectorCore(function(y){return y.beginItem&&y.beginItem.dataKey===c&&y.endItem&&y.endItem.dataKey===l})},a.prototype.findConnectorsCore=function(c){var l=[];return this.items.forEach(function(y){y instanceof P.Connector&&c(y)&&l.push(y)}),l},a.prototype.findConnectorsWithoutBeginItem=function(){return this.findConnectorsCore(function(c){return!c.beginItem})},a.prototype.findConnectorsWithoutEndItem=function(){return this.findConnectorsCore(function(c){return!c.endItem})},a.prototype.findItem=function(c){return this.items[this.itemIndexByKey[c]]},a.prototype.findItemByDataKey=function(c){return this.findItemCore(function(l){return l.dataKey===c})},a.prototype.findItemCore=function(c){for(var l=0;l<this.items.length;l++)if(c(this.items[l]))return this.items[l]},a.isIntersectedItems=function(c,l){var y=!1;return c instanceof m.Shape?y=l.intersectedByRect(c.rectangle):c instanceof P.Connector&&c.getSegments().forEach(function(g){l instanceof m.Shape?y=y||g.isIntersectedByRect(l.rectangle):l instanceof P.Connector&&l.getSegments().forEach(function(f){y=y||g.isIntersected(f)})}),y},a.prototype.getIntersectItems=function(c){var l=[];return this.items.forEach(function(y){y.container===c.container&&(c===y||y instanceof P.Connector&&c.attachedConnectors.indexOf(y)!==-1||!a.isIntersectedItems(y,c)||l.push(y))}),l},a.prototype.getIntersectItemsMinZIndex=function(c){return this.getIntersectItems(c).map(function(l){return l.zIndex}).reduce(function(l,y){return Math.min(l,y)},Number.MAX_VALUE)},a.prototype.getIntersectItemsMaxZIndex=function(c){return this.getIntersectItems(c).map(function(l){return l.zIndex}).reduce(function(l,y){return Math.max(l,y)},-Number.MAX_VALUE)},a.prototype.iterateItems=function(c){this.items.forEach(c)},a.prototype.getNextKey=function(){return(this.keyCounter++).toString()},a.prototype.initializeKeyCounter=function(){this.keyCounter=this.items.reduce(function(c,l){var y=parseInt(l.key);return Math.max(c,isNaN(y)?0:y+1)},this.items.length)},a.defaultPageColor=e.ColorUtils.LIGHT_COLOR,a}();h.DiagramModel=r},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.TextPrimitive270degRenderHelper=h.TextPrimitive180degRenderHelper=h.TextPrimitive90degRenderHelper=h.TextPrimitiveRenderHelper=h.TextPrimitive=h.TextAngle=void 0;var p,u=d(12),s=d(15),i=d(24),t=d(17),e=d(64);(function(l){l[l.Angle0deg=0]="Angle0deg",l[l.Angle90deg=90]="Angle90deg",l[l.Angle180deg=180]="Angle180deg",l[l.Angle270deg=270]="Angle270deg"})(p=h.TextAngle||(h.TextAngle={}));var n=function(l){function y(g,f,v,C,b,S,x,I,w,_,T,R,E){var D=l.call(this,I,"",_,E)||this;return D.x=g,D.y=f,D.text=v,D.owner=C,D.textWidth=b,D.textHeight=S,D.textSpacing=x,D.reverseTextAhchor=w,D.angle=R,D.filterId=T,D.textSegmens=e.textToParagraphs(D.text),D.renderHelper=D.createRenderHelper(),D.textWidth!==void 0&&D.textWidth!==void 0&&(D.x=D.renderHelper.getTextX(D.x),D.y=D.renderHelper.getTextY(D.y)),D}return P(y,l),y.prototype.createMainElement=function(){return document.createElementNS(s.svgNS,"text")},y.prototype.applyElementProperties=function(g,f){this.setUnitAttribute(g,"x",this.x),this.setUnitAttribute(g,"y",this.y),this.filterId&&g.setAttribute("filter",t.RenderUtils.getUrlPathById(this.filterId)),l.prototype.applyElementProperties.call(this,g,f),g.getAttribute("appliedText")!==this.text||g.getAttribute("appliedSize")!==(this.fitToSize&&this.fitToSize.toString())?(this.createTSpanElements(g,f),g.setAttribute("appliedText",this.text),g.setAttribute("appliedSize",this.fitToSize&&this.fitToSize.toString())):this.prepareTSpanElements(g),this.renderHelper.prepareMainElement(g,this.x,this.y)},y.prototype.createTSpanElements=function(g,f){var v=this;t.RenderUtils.removeContent(g),this.textSegmens.forEach(function(b,S){if(!b&&v.textSegmens.length>1)v.createTSpanElement(g).textContent=" ";else if(v.fitToSize){var x=e.textToWords(b),I=e.wordsByLines(u.UnitConverter.twipsToPixels(v.fitToSize),x,function(){return f.measureWords(x,v.style,v.owner)});I.forEach(function(w){v.createTSpanElement(g).textContent=w}),!I.length&&(v.createTSpanElement(g).textContent=" ")}else v.createTSpanElement(g).textContent=b});var C=g.firstChild;C&&this.prepareFirstTSpanElement(C,g.childNodes.length)},y.prototype.createTSpanElement=function(g){var f=document.createElementNS(s.svgNS,"tspan");return g.appendChild(f),this.prepareTSpanElement(f),f},y.prototype.prepareTSpanElements=function(g){for(var f=0;f<g.childNodes.length;f++){var v=g.childNodes[f];this.prepareTSpanElement(v)}var C=g.firstChild;C&&this.prepareFirstTSpanElement(C,g.childNodes.length)},y.prototype.prepareTSpanElement=function(g){this.renderHelper.prepareTSpanElement(g,this.x,this.y)},y.prototype.prepareFirstTSpanElement=function(g,f){this.renderHelper.prepareFirstTSpanElement(g,f)},y.prototype.applyElementStyleProperties=function(g){this.applyElementStylePropertiesCore(g,this.reverseTextAhchor)},Object.defineProperty(y.prototype,"fitToSize",{get:function(){return this.renderHelper.fitToSize},enumerable:!1,configurable:!0}),y.prototype.createRenderHelper=function(){switch(this.angle){case p.Angle90deg:return new r(this);case p.Angle180deg:return new a(this);case p.Angle270deg:return new c(this);default:return new o(this)}},y.baselineCorrection=.35,y}(i.SvgPrimitive);h.TextPrimitive=n;var o=function(){function l(y){this.primitive=y}return Object.defineProperty(l.prototype,"textWidth",{get:function(){return this.primitive.textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"textHeight",{get:function(){return this.primitive.textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"fitToSize",{get:function(){return this.textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"textAnchor",{get:function(){return this.primitive.style["text-anchor"]},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"textSpacing",{get:function(){return this.primitive.textSpacing},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"angle",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"needRotation",{get:function(){return!1},enumerable:!1,configurable:!0}),l.prototype.prepareMainElement=function(y,g,f){this.needRotation&&y.setAttribute("transform","rotate("+this.angle+", "+u.UnitConverter.twipsToPixels(g)+", "+u.UnitConverter.twipsToPixels(f)+")")},l.prototype.prepareTSpanElement=function(y,g,f){this.primitive.setUnitAttribute(y,"x",g),y.setAttribute("dy",e.LINE_HEIGHT+"em")},l.prototype.prepareFirstTSpanElement=function(y,g){var f=-(g-1)/2+n.baselineCorrection;y.setAttribute("dy",f.toFixed(2)+"em")},l.prototype.getTextX=function(y){return this.textAnchor&&this.textAnchor!=="middle"?this.textAnchor==="end"?y+this.textWidth-this.textSpacing:this.textAnchor==="start"?y+this.textSpacing:y:y+this.textWidth/2},l.prototype.getTextY=function(y){return y+this.textHeight/2},l.prototype.setUnitAttribute=function(y,g,f){this.primitive.setUnitAttribute(y,g,f)},l}();h.TextPrimitiveRenderHelper=o;var r=function(l){function y(g){return l.call(this,g)||this}return P(y,l),Object.defineProperty(y.prototype,"fitToSize",{get:function(){return this.textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"angle",{get:function(){return 90},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needRotation",{get:function(){return!0},enumerable:!1,configurable:!0}),y.prototype.getTextX=function(g){return g+this.textWidth/2},y.prototype.getTextY=function(g){return this.textAnchor&&this.textAnchor!=="middle"?this.textAnchor==="end"?g+this.textHeight-this.textSpacing:this.textAnchor==="start"?g+this.textSpacing:g:g+this.textHeight/2},y}(o);h.TextPrimitive90degRenderHelper=r;var a=function(l){function y(g){return l.call(this,g)||this}return P(y,l),Object.defineProperty(y.prototype,"angle",{get:function(){return 180},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needRotation",{get:function(){return!0},enumerable:!1,configurable:!0}),y.prototype.getTextX=function(g){return this.textAnchor&&this.textAnchor!=="middle"?this.textAnchor==="start"?g+this.textWidth-this.textSpacing:this.textAnchor==="end"?g+this.textSpacing:g:g+this.textWidth/2},y}(o);h.TextPrimitive180degRenderHelper=a;var c=function(l){function y(g){return l.call(this,g)||this}return P(y,l),Object.defineProperty(y.prototype,"angle",{get:function(){return 270},enumerable:!1,configurable:!0}),y.prototype.getTextY=function(g){return this.textAnchor&&this.textAnchor!=="middle"?this.textAnchor==="start"?g+this.textHeight-this.textSpacing:this.textAnchor==="end"?g+this.textSpacing:g:g+this.textHeight/2},y}(r);h.TextPrimitive270degRenderHelper=c},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.getLineHeight=h.getTextHeight=h.getTextLineSize=h.getOptimalTextRectangle=h.TEXTRECT_RATIO_EPS=h.textToParagraphs=h.textToWords=h.wordsByLines=h.LINE_HEIGHT=void 0;var m=d(3),P=d(2),p=d(44),u=/\s/gm;function s(y,g,f){if(g.length===1)return g;for(var v=f(),C=v.words[" "].width,b=[],S=0,x=-1,I=0;I<g.length;I++){var w=g[I],_=v.words[w].width;x===-1||S+C+_>y?(x=b.push(w)-1,S=_):(S+=C+_,b[x]+=" "+w)}return b}function i(y){return y.split(u).filter(function(g){return g.length})}function t(y){return y.split(`
`)}h.LINE_HEIGHT=1.05,h.wordsByLines=s,h.textToWords=i,h.textToParagraphs=t,h.TEXTRECT_RATIO_EPS=1.2;var e=1;function n(y,g,f){var v=y<1?1/y:y,C=g<1?1/g:g,b=v/C;return(b<1?1/b:b)<=f?0:C>v?1:-1}function o(y,g,f,v){return r(c(y,g,f,!1),v)}function r(y,g){return[p.Data.byRange(y,g.from,g.to),y<=g.to]}function a(y,g){return i(y).reduce(function(f,v,C){var b=g.words[v];return f.width+=b.width,f.height=Math.max(f.height,b.height),C>0&&(f.width+=g.words[" "].width),f},new P.Size(0,0))}function c(y,g,f,v){var C=Array.isArray(y)?y:t(y);return!v||C.length&&(C.length!==1||C[0].length)?C.reduce(function(b,S){return b+s(g,i(S),function(){return f}).length},0)*l(f):l(f)}function l(y){return y.fontSize*h.LINE_HEIGHT}h.getOptimalTextRectangle=function(y,g,f,v,C,b,S,x,I,w){if(S===void 0&&(S=0),x===void 0&&(x=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE),I===void 0&&(I=0),w===void 0&&(w=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE),!y)return new P.Size(p.Data.byRange(C.width,S,x),p.Data.byRange(C.height,I,w));if(S>x||I>w)throw new Error("Min size cannot exceed max size");if(S===x&&I===w)return new P.Size(S,I);var _=v.measureWords(y,g,f),T=t(y),R=Object.keys(_.words).reduce(function(H,O){return Math.max(H,_.words[O].width)},0),E=new m.Range(p.Data.byRange(Math.max(C.width,R),S,x),x),D=new m.Range(p.Data.byRange(C.height,I,w),w);if(R<=C.width&&c(T,C.width,_,!1)<=C.height&&E.includes(C.width)&&D.includes(C.height))return C;var L=C.width/C.height;return function(H,O,z,K,A,M){for(var U,V,G=H.reduce(function(Z,q){return Math.max(Z,a(q,O).width)},0),Y=new P.Size(0,0),tt=new P.Size(0,0),W=0,N=0,k=0;k<5;k++){if(k===0)tt.width=r(G,K)[0];else{if(!(Math.abs(W)>e))break;tt.width=r(Y.width+W,K)[0]}if(U=o(H,tt.width,O,A),tt.height=U[0],V=U[1],k===0&&(Y=tt.clone(),N=Y.width/Y.height/z),k===0&&!V)break;var B=tt.width/tt.height,F=B/z;if(k===0)W=(tt.width/F-tt.width)/2;else if(V){if(!n(z,B,h.TEXTRECT_RATIO_EPS)){Y=tt.clone(),N=F;break}if(!(n(N,F,1)<0))break;Y=tt.clone(),N=F,W=(tt.width/F-tt.width)/2,F<1&&(W/=2)}else W/=2}return M&&(Y.height=p.Data.byRange(Y.width/z,Y.height,A.to)),Y}(T,_,L,E,D,b)},h.getTextLineSize=a,h.getTextHeight=c,h.getLineHeight=l},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(18),P=d(50),p=d(27),u=d(176),s=function(){function i(){}return i.preventEvent=function(t){t.cancelable&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},i.getEventSource=function(t){return P.isDefined(t)?i.getEventSourceCore(t):null},i.getEventSourceByPosition=function(t){if(!P.isDefined(t))return null;if(!document.elementFromPoint)return i.getEventSourceCore(t);var e=i.getEventX(t)-(i.clientEventRequiresDocScrollCorrection()?p.DomUtils.getDocumentScrollLeft():0),n=i.getEventY(t)-(i.clientEventRequiresDocScrollCorrection()?p.DomUtils.getDocumentScrollTop():0);return e===void 0||n===void 0?i.getEventSourceCore(t):document.elementFromPoint(e,n)},i.getEventSourceCore=function(t){return t.srcElement?t.srcElement:t.target},i.getMouseWheelEventName=function(){return m.Browser.Safari?"mousewheel":m.Browser.NetscapeFamily&&m.Browser.MajorVersion<17?"DOMMouseScroll":"wheel"},i.isLeftButtonPressed=function(t){return!!u.TouchUtils.isTouchEvent(t)||!!(t=m.Browser.IE&&P.isDefined(event)?event:t)&&(m.Browser.IE&&m.Browser.Version<11?!!m.Browser.MSTouchUI||t.button%2==1:m.Browser.WebKitFamily?t.type==="pointermove"||t.type==="pointerenter"||t.type==="pointerleave"?t.buttons===1:t.which===1:m.Browser.NetscapeFamily||m.Browser.Edge||m.Browser.IE&&m.Browser.Version>=11?i.isMoveEventName(t.type)?t.buttons===1:t.which===1:!m.Browser.Opera||t.button===0)},i.isMoveEventName=function(t){return t===u.TouchUtils.touchMouseMoveEventName||t===i.getMoveEventName()},i.getMoveEventName=function(){return window.PointerEvent?"pointermove":m.Browser.TouchUI?"touchmove":"mousemove"},i.preventEventAndBubble=function(t){i.preventEvent(t),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0},i.clientEventRequiresDocScrollCorrection=function(){var t=m.Browser.Safari&&m.Browser.Version<3,e=m.Browser.MacOSMobilePlatform&&m.Browser.Version<5.1;return m.Browser.AndroidDefaultBrowser||m.Browser.AndroidChromeBrowser||!(t||e)},i.getEventX=function(t){return u.TouchUtils.isTouchEvent(t)?u.TouchUtils.getEventX(t):t.clientX+(i.clientEventRequiresDocScrollCorrection()?p.DomUtils.getDocumentScrollLeft():0)},i.getEventY=function(t){return u.TouchUtils.isTouchEvent(t)?u.TouchUtils.getEventY(t):t.clientY+(i.clientEventRequiresDocScrollCorrection()?p.DomUtils.getDocumentScrollTop():0)},i.cancelBubble=function(t){t.cancelBubble=!0},i.getWheelDelta=function(t){var e;return e=m.Browser.NetscapeFamily&&m.Browser.MajorVersion<17?-t.detail:m.Browser.Safari?t.wheelDelta:-t.deltaY,m.Browser.Opera&&m.Browser.Version<9&&(e=-e),e},i}();h.EvtUtils=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.AddConnectorHistoryItem=void 0;var p=d(8),u=d(6),s=function(i){function t(e,n,o){var r=i.call(this)||this;return r.points=e,r.dataKey=n,r.renderPointsContext=o,r}return P(t,i),t.prototype.redo=function(e){var n=new u.Connector(this.points);this.dataKey!==void 0&&(n.dataKey=this.dataKey),this.renderPointsContext!==void 0&&n.replaceRenderPoints(this.renderPointsContext),e.addConnector(n,this.connectorKey),this.connectorKey=n.key},t.prototype.undo=function(e){var n=e.model.findConnector(this.connectorKey);e.deleteConnector(n)},t}(p.HistoryItem);h.AddConnectorHistoryItem=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteConnectionHistoryItem=void 0;var p=d(8),u=d(6),s=function(i){function t(e,n){var o=i.call(this)||this;return o.connectorKey=e.key,o.position=n,o.itemKey=e.getExtremeItem(o.position).key,o}return P(t,i),t.prototype.redo=function(e){var n=e.model.findConnector(this.connectorKey);this.oldConnectionPointIndex=this.position===u.ConnectorPosition.Begin?n.beginConnectionPointIndex:n.endConnectionPointIndex,e.deleteConnection(n,this.position)},t.prototype.undo=function(e){var n=e.model.findConnector(this.connectorKey),o=e.model.findItem(this.itemKey);e.addConnection(n,o,this.oldConnectionPointIndex,this.position)},t}(p.HistoryItem);h.DeleteConnectionHistoryItem=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.SetSelectionHistoryItem=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.selectedKeys=t,n.selection=i,n.forceChange=e,n}return P(s,u),s.prototype.redo=function(){this.oldSelection=this.selection.getKeys().slice(0),this.selection.set(this.selectedKeys,this.forceChange)},s.prototype.undo=function(){this.selection.set(this.oldSelection,this.forceChange)},s}(d(8).HistoryItem);h.SetSelectionHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorTextHistoryItem=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.connectorKey=i.key,n.text=e,n.position=t,n}return P(s,u),s.prototype.redo=function(i){var t=i.model.findConnector(this.connectorKey);this.oldText=t.getText(this.position),i.changeConnectorText(t,this.text,this.position)},s.prototype.undo=function(i){var t=i.model.findConnector(this.connectorKey);i.changeConnectorText(t,this.oldText,this.position)},s}(d(8).HistoryItem);h.ChangeConnectorTextHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStyleTextHistoryItem=void 0;var p=function(u){function s(i,t,e){return u.call(this,i,t,e)||this}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey);this.oldStyleValue=t.styleText[this.styleProperty],i.changeStyleText(t,this.styleProperty,this.styleValue)},s.prototype.undo=function(i){var t=i.model.findItem(this.itemKey);i.changeStyleText(t,this.styleProperty,this.oldStyleValue)},s}(d(118).ChangeStyleHistoryItemBase);h.ChangeStyleTextHistoryItem=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Margin=h.EdgeLayout=h.NodeLayout=h.NodeInfo=void 0;var m=d(13),P=function(){return function(i,t,e,n){n===void 0&&(n=[]),this.key=i,this.margin=t,this.size=e,this.connectionPoints=n}}();h.NodeInfo=P;var p=function(){function i(t,e){this.info=t,this.position=e}return Object.defineProperty(i.prototype,"key",{get:function(){return this.info.key},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rectangle",{get:function(){return m.Rectangle.fromGeometry(this.position,this.info.size)},enumerable:!1,configurable:!0}),i}();h.NodeLayout=p;var u=function(){return function(i,t,e){this.key=i,this.beginIndex=t,this.endIndex=e}}();h.EdgeLayout=u;var s=function(){function i(t,e,n,o){e===void 0&&(e=t),n===void 0&&(n=t),o===void 0&&(o=t),this.top=t,this.right=e,this.bottom=n,this.left=o}return i.empty=function(){return new i(0)},i}();h.Margin=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.EllipseShapeDescription=void 0;var p=d(7),u=d(2),s=d(55),i=d(1),t=d(3),e=d(13),n=function(o){function r(a){return o.call(this,new u.Size(p.ShapeDefaultDimension,.75*p.ShapeDefaultDimension),a)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return i.ShapeTypes.Ellipse},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.getTextRectangle=function(a){var c=t.GeometryUtils.getMaxRectangleEnscribedInEllipse(a.size);return e.Rectangle.fromGeometry(a.position.clone().offset((a.size.width-c.width)/2,(a.size.height-c.height)/2),c)},r.prototype.getSizeByText=function(a,c){return t.GeometryUtils.getEllipseByEnscribedRectangle(a)},r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.width,y=c.height,g=c.center,f=g.x,v=g.y;return[new s.EllipsePrimitive(f,v,l/2,y/2,a.style)]},r}(p.ShapeDescription);h.EllipseShapeDescription=n},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Exporter=void 0;var m=d(14),P=d(6),p=d(3),u=function(){function s(){}return s.prototype.export=function(i){var t={page:{},connectors:[],shapes:[]};return t.page={width:i.size.width,height:i.size.height,pageColor:i.pageColor,pageWidth:i.pageSize.width,pageHeight:i.pageSize.height,pageLandscape:i.pageLandscape},this.exportItemsCore(i.items,t),JSON.stringify(t)},s.prototype.exportItems=function(i){var t={connectors:[],shapes:[]};return this.exportItemsCore(i,t),JSON.stringify(t)},s.prototype.exportItemsCore=function(i,t){var e=this;i.forEach(function(n){if(n instanceof m.Shape)t.shapes.push(e.exportShape(n));else if(n instanceof P.Connector){var o=e.exportConnector(n);n.beginItem&&(o.beginItemKey=n.beginItem.key,o.beginConnectionPointIndex=n.beginConnectionPointIndex),n.endItem&&(o.endItemKey=n.endItem.key,o.endConnectionPointIndex=n.endConnectionPointIndex),t.connectors.push(o)}})},s.prototype.exportItem=function(i){return{key:i.key,dataKey:i.dataKey,customData:p.ObjectUtils.cloneObject(i.customData),locked:i.locked,zIndex:i.zIndex}},s.prototype.exportShape=function(i){var t=this.exportItem(i);t.type=i.description.key,t.text=i.text,i.image.isEmpty||(t.imageUrl=i.image.exportUrl),t.x=i.position.x,t.y=i.position.y,t.width=i.size.width,t.height=i.size.height;var e=i.parameters.toObject();e&&(t.parameters=e);var n=i.style.toObject();n&&(t.style=n);var o=i.styleText.toObject();return o&&(t.styleText=o),i.children.length&&(t.childKeys=i.children.map(function(r){return r.key})),i.expanded||(t.expanded=!1),i.expandedSize&&(t.expandedWidth=i.expandedSize.width,t.expandedHeight=i.expandedSize.height),t},s.prototype.exportConnector=function(i){var t=this.exportItem(i);t.points=i.points.map(function(a){return{x:a.x,y:a.y}});var e=i.texts.toObject();e&&(t.texts=e);var n=i.properties.toObject();n&&(t.properties=n);var o=i.style.toObject();o&&(t.style=o);var r=i.styleText.toObject();return r&&(t.styleText=r),t},s.prototype.exportSvg=function(i,t,e,n){e.exportSvgImage(i,t,n)},s.prototype.exportPng=function(i,t,e,n,o){e.exportPngImage(i,t,n,o)},s.prototype.exportJpg=function(i,t,e,n,o){e.exportJpgImage(i,t,n,o)},s}();h.Exporter=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleStyleTextPropertyCommand=void 0;var p=d(134),u=d(70),s=d(26),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentTextStylePropertyValue(this.getStyleProperty())===this.getStylePropertyValue()},e.prototype.executeCore=function(n){var o=this;this.control.history.beginTransaction();var r=this.getStyleProperty(),a=n.value?s.TextStyle.defaultInstance[r]:this.getStylePropertyValue();return this.control.selection.getSelectedItems().forEach(function(c){o.control.history.addAndRedo(new u.ChangeStyleTextHistoryItem(c.key,r,a))}),this.control.selection.inputPosition.setTextStylePropertyValue(this.getStyleProperty(),a),this.control.history.endTransaction(),!0},e.prototype.getStyleObj=function(n){return n.styleText},e.prototype.getDefaultStyleObj=function(){return new s.TextStyle},e}(p.StylePropertyCommandBase);h.ToggleStyleTextPropertyCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStylePropertyCommand=void 0;var p=d(135),u=d(89),s=d(26),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentStylePropertyValue(this.getStyleProperty())},e.prototype.getStyleObj=function(n){return n.style},e.prototype.getDefaultStyleObj=function(){return new s.Style},e.prototype.createHistoryItem=function(n,o,r){return new u.ChangeStyleHistoryItem(n.key,o,r)},e.prototype.updateInputPosition=function(n){this.control.selection.inputPosition.setStylePropertyValue(this.getStyleProperty(),n)},e}(p.ChangeStylePropertyCommandBase);h.ChangeStylePropertyCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutCommandBase=void 0;var p=d(4),u=d(10),s=d(14),i=d(6),t=d(3),e=d(13),n=d(251),o=function(r){function a(){return r!==null&&r.apply(this,arguments)||this}return P(a,r),a.prototype.executeCore=function(c,l){var y=this;this.control.history.beginTransaction();var g=this.getAffectedShapes(),f=this.getAffectedConnectors(),v=this.createLayoutSettings(),C=p.ModelUtils.getGraphInfoByItems(this.control.model,g,f,!1);if(C.length){var b,S=this.control.model,x=t.GeometryUtils.getCommonRectangle(t.Utils.flatten(C.map(function(I){return I.graph.items.map(function(w){return S.findItem(w.key)})})).concat(C.map(function(I){return I.container})).filter(function(I){return I}).map(function(I){return I.rectangle}));this.control.history.addAndRedo(new n.ScrollIntoViewOnUndoHistoryItem(this.control.view,x)),C.forEach(function(I){var w=y.createLayout(v,I.graph),_=p.ModelUtils.getNonGraphItems(y.control.model,I.container,w.nodeToLayout,g,f),T=p.ModelUtils.applyLayout(y.control.history,y.control.model,I.container,I.graph,w,_,v,y.control.settings.snapToGrid,y.control.settings.gridSize,!1);b=b&&e.Rectangle.union(b,T)||T}),p.ModelUtils.tryUpdateModelRectangle(this.control.history),this.control.history.addAndRedo(new n.ScrollIntoViewOnRedoHistoryItem(this.control.view,b))}return this.control.history.endTransaction(),!0},a.prototype.getAffectedShapes=function(){return this.control.selection.isEmpty()?this.control.model.items.filter(function(c){return c instanceof s.Shape&&!c.locked}):this.control.selection.getSelectedShapes(!1,!0)},a.prototype.getAffectedConnectors=function(){return this.control.selection.isEmpty()?this.control.model.items.filter(function(c){return c instanceof i.Connector&&!c.locked}):this.control.selection.getSelectedConnectors(!1,!0)},a}(u.SimpleCommandBase);h.AutoLayoutCommandBase=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePagePropertyCommand=void 0;var p=d(4),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.executeCore=function(t,e){var n=this;return this.control.history.beginTransaction(),this.createHistoryItems(e).forEach(function(o){n.control.history.addAndRedo(o)}),p.ModelUtils.tryUpdateModelRectangle(this.control.history),this.control.history.endTransaction(),!0},i.prototype.getItems=function(){return null},i}(d(10).SimpleCommandBase);h.ChangePagePropertyCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(c,l){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var f in g)g.hasOwnProperty(f)&&(y[f]=g[f])})(c,l)},function(c,l){function y(){this.constructor=c}m(c,l),c.prototype=l===null?Object.create(l):(y.prototype=l.prototype,new y)});Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasItemsManager=h.CONNECTOR_CAN_MOVE=h.NOT_VALID_CSSCLASS=void 0;var p=d(99),u=d(11),s=d(39),i=d(17),t=d(14),e=d(6),n=d(27),o=d(140),r=d(4);h.NOT_VALID_CSSCLASS="not-valid",h.CONNECTOR_CAN_MOVE="can-move";var a=function(c){function l(y,g,f){var v=c.call(this,g,f)||this;return v.itemSelectorGroupContainers={},v.itemSelectorElements={},v.itemGroupContainers={},v.itemElements={},v.itemChildElements={},v.primitives={},v.selectorPrimitives={},v.selectedItems={},v.initializeContainerElements(y),v}return P(l,c),l.prototype.initializeContainerElements=function(y){this.itemSelectorsContainer=this.createAndChangePrimitiveElement(new s.GroupPrimitive([],null),y),this.itemsContainer=this.createAndChangePrimitiveElement(new s.GroupPrimitive([],null),y)},l.prototype.clear=function(){this.primitives={},this.selectorPrimitives={},i.RenderUtils.removeContent(this.itemSelectorsContainer),i.RenderUtils.removeContent(this.itemsContainer),this.itemSelectorGroupContainers={},this.itemSelectorElements={},this.itemGroupContainers={},this.itemElements={},this.itemChildElements={},this.selectedItems={}},l.prototype.applyChange=function(y){var g=y.item;return!!this.getItemParent(g.zIndex,g.container&&g.container.key)&&(g instanceof t.Shape?this.applyShapeChange(g,y.type,y.isValid):g instanceof e.Connector&&this.applyConnectorChange(g,y.type,y.isValid),!0)},l.prototype.setPointerEventsNone=function(y,g){var f=y.style;f!==void 0&&f.pointerEvents!==void 0&&(f.pointerEvents=g?"none":"");for(var v=y.childNodes,C=0;C<v.length;C++)this.setPointerEventsNone(v[C],g)},l.prototype.notifyDragStart=function(y){var g=this;y.forEach(function(f){g.itemElements[f]&&g.setPointerEventsNone(g.itemElements[f],!0),g.itemChildElements[f]&&g.setPointerEventsNone(g.itemChildElements[f],!0),g.itemSelectorElements[f]&&g.setPointerEventsNone(g.itemSelectorElements[f],!0)})},l.prototype.notifyDragEnd=function(y){var g=this;y.forEach(function(f){g.itemElements[f]&&g.setPointerEventsNone(g.itemElements[f],!1),g.itemChildElements[f]&&g.setPointerEventsNone(g.itemChildElements[f],!1),g.itemSelectorElements[f]&&g.setPointerEventsNone(g.itemSelectorElements[f],!1)})},l.prototype.notifyDragScrollStart=function(){},l.prototype.notifyDragScrollEnd=function(){},l.prototype.notifyTextInputStart=function(y,g,f,v){var C=this.itemElements[y.key];n.DomUtils.addClassName(C,"text-input")},l.prototype.notifyTextInputEnd=function(y,g){var f=this.itemElements[y.key];n.DomUtils.removeClassName(f,"text-input")},l.prototype.notifyTextInputPermissionsCheck=function(y,g){var f=this.itemElements[y.key];g?n.DomUtils.removeClassName(f,h.NOT_VALID_CSSCLASS):n.DomUtils.addClassName(f,h.NOT_VALID_CSSCLASS)},l.prototype.notifyActualZoomChanged=function(y){var g="scale("+y+")";this.dom.changeByFunc(this.itemsContainer,function(f){return f.setAttribute("transform",g)}),this.dom.changeByFunc(this.itemSelectorsContainer,function(f){return f.setAttribute("transform",g)}),this.actualZoom=y},l.prototype.notifyViewAdjusted=function(y){},l.prototype.invalidatePrimitives=function(y){this.primitives[y.key]&&(this.primitives[y.key].forEach(function(g){g.dispose()}),delete this.primitives[y.key]),this.selectorPrimitives[y.key]&&(this.selectorPrimitives[y.key].forEach(function(g){g.dispose()}),delete this.selectorPrimitives[y.key])},l.prototype.getPrimitives=function(y){return this.primitives[y.key]||(this.primitives[y.key]=y.createPrimitives()),this.primitives[y.key]},l.prototype.getSelectorPrimitives=function(y){return this.selectorPrimitives[y.key]||(this.selectorPrimitives[y.key]=y.createSelectorPrimitives()),this.selectorPrimitives[y.key]},l.prototype.getShapeSelectorClassName=function(y){var g="shape";return y.enableChildren&&(g+=" container"),y.isLocked&&(g+=" locked"),g},l.prototype.getShapeClassName=function(y,g){var f=this.getShapeSelectorClassName(y);return g?f:f+" "+h.NOT_VALID_CSSCLASS},l.prototype.applyShapeChange=function(y,g,f){var v=y.key,C=y.container&&y.container.key,b=this.getItemSelectorGroupContainer(y.zIndex,C),S=this.getItemGroupContainer(y.zIndex,C),x=this.getShapeClassName(y,f);switch(g){case p.ItemChangeType.Create:this.itemSelectorElements[v]=this.createItemElements(v,this.getSelectorPrimitives(y),b,this.getShapeSelectorClassName(y),u.MouseEventElementType.Shape),this.itemElements[v]=this.createItemElements(v,this.getPrimitives(y),S,x,u.MouseEventElementType.Shape),y.enableChildren&&(this.itemChildElements[v]=this.createItemElements(v,[],S,"container-children",u.MouseEventElementType.Undefined),this.changeItemChildrenVisibility(this.itemChildElements[v],y.expanded));break;case p.ItemChangeType.Remove:this.removeItemCustomContent(this.itemSelectorElements[v],this.getSelectorPrimitives(y)),this.removeItemCustomContent(this.itemElements[v],this.getPrimitives(y)),this.invalidatePrimitives(y),this.removeItemElements(this.itemSelectorElements[v]),delete this.itemSelectorElements[v],this.removeItemElements(this.itemElements[v]),delete this.itemElements[v],this.itemChildElements[v]&&(this.removeItemElements(this.itemChildElements[v]),delete this.itemChildElements[v],delete this.itemGroupContainers[v],delete this.itemSelectorGroupContainers[v]);break;case p.ItemChangeType.UpdateStructure:case p.ItemChangeType.UpdateProperties:case p.ItemChangeType.Update:g!==p.ItemChangeType.Update&&(g===p.ItemChangeType.UpdateStructure&&(this.removeItemCustomContent(this.itemSelectorElements[v],this.getSelectorPrimitives(y)),this.removeItemCustomContent(this.itemElements[v],this.getPrimitives(y))),this.invalidatePrimitives(y)),this.changeItemElements(this.getSelectorPrimitives(y),this.itemSelectorElements[v],g===p.ItemChangeType.UpdateStructure),this.changeItemElements(this.getPrimitives(y),this.itemElements[v],g===p.ItemChangeType.UpdateStructure),this.changeItemClassName(this.itemElements[v],x),this.itemChildElements[v]&&this.changeItemChildrenVisibility(this.itemChildElements[v],y.expanded),b!==(this.itemSelectorElements[v]&&this.itemSelectorElements[v].parentNode)&&this.moveItemElements(b,this.itemSelectorElements[v]),S!==(this.itemElements[v]&&this.itemElements[v].parentNode)&&this.moveItemElements(S,this.itemElements[v]),this.itemChildElements[v]&&S!==this.itemChildElements[v].parentNode&&this.moveItemElements(S,this.itemChildElements[v]);break;case p.ItemChangeType.UpdateClassName:this.changeItemClassName(this.itemElements[v],x)}},l.prototype.getConnectorSelectorClassName=function(y){return r.ModelUtils.canMoveConnector(this.selectedItems,y)?"connector "+h.CONNECTOR_CAN_MOVE:"connector"},l.prototype.getConnectorClassName=function(y,g){var f=this.getConnectorSelectorClassName(y);return g?f:f+" "+h.NOT_VALID_CSSCLASS},l.prototype.applyConnectorChange=function(y,g,f){var v=y.key,C=y.container&&y.container.key,b=this.getItemSelectorGroupContainer(y.zIndex,C),S=this.getItemGroupContainer(y.zIndex,C),x=this.getConnectorClassName(y,f);switch(g){case p.ItemChangeType.Create:this.itemSelectorElements[v]=this.createItemElements(v,this.getSelectorPrimitives(y),b,this.getConnectorSelectorClassName(y),u.MouseEventElementType.Connector),this.itemElements[v]=this.createItemElements(v,this.getPrimitives(y),S,x,u.MouseEventElementType.Connector);break;case p.ItemChangeType.Remove:this.removeItemCustomContent(this.itemSelectorElements[v],this.getSelectorPrimitives(y)),this.removeItemCustomContent(this.itemElements[v],this.getPrimitives(y)),this.invalidatePrimitives(y),this.removeItemElements(this.itemSelectorElements[v]),delete this.itemSelectorElements[v],this.removeItemElements(this.itemElements[v]),delete this.itemElements[v];break;case p.ItemChangeType.UpdateStructure:case p.ItemChangeType.UpdateProperties:case p.ItemChangeType.Update:g!==p.ItemChangeType.Update&&(g===p.ItemChangeType.UpdateStructure&&(this.removeItemCustomContent(this.itemSelectorElements[v],this.getSelectorPrimitives(y)),this.removeItemCustomContent(this.itemElements[v],this.getPrimitives(y))),this.invalidatePrimitives(y)),this.changeItemElements(this.getSelectorPrimitives(y),this.itemSelectorElements[v],g===p.ItemChangeType.UpdateStructure),this.changeItemClassName(this.itemSelectorElements[v],this.getConnectorSelectorClassName(y)),this.changeItemElements(this.getPrimitives(y),this.itemElements[v],g===p.ItemChangeType.UpdateStructure),this.changeItemClassName(this.itemElements[v],x),b!==(this.itemSelectorElements[v]&&this.itemSelectorElements[v].parentNode)&&this.moveItemElements(b,this.itemSelectorElements[v]),S!==(this.itemElements[v]&&this.itemElements[v].parentNode)&&this.moveItemElements(S,this.itemElements[v]);break;case p.ItemChangeType.UpdateClassName:this.changeItemClassName(this.itemSelectorElements[v],this.getConnectorSelectorClassName(y)),this.changeItemClassName(this.itemElements[v],x)}},l.prototype.createItemElements=function(y,g,f,v,C){var b=this.createAndChangePrimitiveElement(new s.GroupPrimitive([],v,void 0,void 0,function(S){return i.RenderUtils.setElementEventData(S,C,y)}),f);return this.createAndChangePrimitivesElements(g,b),b},l.prototype.changeItemElements=function(y,g,f){f||y.length!==g.childNodes.length?(i.RenderUtils.removeContent(g),this.createAndChangePrimitivesElements(y,g)):this.dom.changeChildrenByPrimitives(y,g)},l.prototype.changeItemClassName=function(y,g){g&&y&&this.changePrimitiveElement(new s.GroupPrimitive([],g),y)},l.prototype.removeItemElements=function(y){y&&y.parentNode&&y.parentNode.removeChild(y)},l.prototype.removeItemCustomContent=function(y,g){y&&g&&g.length===y.childNodes.length&&g.forEach(function(f,v){f.destroyCustomContent(y.childNodes[v])})},l.prototype.moveItemElements=function(y,g,f){g&&y&&(f?y.insertBefore(g,f):y.appendChild(g))},l.prototype.changeItemChildrenVisibility=function(y,g){y.style.display=g?"":"none"},l.prototype.getItemGroupContainerKey=function(y,g){return g!==void 0?y+"_"+g:y.toString()},l.prototype.getItemGroupContainer=function(y,g){var f=g!==void 0?this.getItemParent(y,g):this.itemsContainer,v=g||"Main";if(this.itemGroupContainers[v]===void 0||this.itemGroupContainers[v][y]===void 0){this.itemGroupContainers[v]===void 0&&(this.itemGroupContainers[v]=[]);var C=Object.keys(this.itemGroupContainers[v]).map(function(b){return+b}).sort().filter(function(b){return b>y})[0];this.itemGroupContainers[v][y]=this.createAndChangePrimitiveElement(new s.GroupPrimitive([],null,y),f,this.itemGroupContainers[v][C])}return this.itemGroupContainers[v][y]},l.prototype.getItemSelectorGroupContainer=function(y,g){var f=g!==void 0?this.getItemSelectorParent(y,g):this.itemSelectorsContainer,v=g||"Main";if(this.itemSelectorGroupContainers[v]===void 0||this.itemSelectorGroupContainers[v][y]===void 0){this.itemSelectorGroupContainers[v]===void 0&&(this.itemSelectorGroupContainers[v]=[]);var C=Object.keys(this.itemSelectorGroupContainers[v]).map(function(b){return+b}).sort().filter(function(b){return b>y})[0];this.itemSelectorGroupContainers[v][y]=this.createAndChangePrimitiveElement(new s.GroupPrimitive([],null,y),f,this.itemSelectorGroupContainers[v][C])}return this.itemSelectorGroupContainers[v][y]},l.prototype.getItemParent=function(y,g){return g!==void 0?this.itemChildElements[g]:this.getItemGroupContainer(y)},l.prototype.getItemSelectorParent=function(y,g){return g!==void 0?this.itemChildElements[g]:this.getItemSelectorGroupContainer(y)},l.prototype.notifySelectionChanged=function(y){var g=this,f=r.ModelUtils.createSelectedItems(y),v=[];this.populateItems(v,f,this.selectedItems),this.populateItems(v,this.selectedItems,f),this.selectedItems=f,v.forEach(function(C){C instanceof e.Connector&&g.applyOrPostponeChanges([new p.ItemChange(C,p.ItemChangeType.UpdateClassName,!0)])})},l.prototype.populateItems=function(y,g,f){Object.keys(g).forEach(function(v){f[v]||y.push(g[v])})},l}(o.CanvasManager);h.CanvasItemsManager=a},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.TextMeasurer=void 0;var m=d(2),P=d(17),p=d(14),u=d(6),s=d(43),i=d(15),t=d(64),e=function(){function n(o){this.cache={},this.fontSizeCache={},this.containers={},this.parent=o,this.createNodes()}return n.prototype.measureWords=function(o,r,a){var c=this,l={words:{},fontSize:-1},y=typeof o=="string"?this.splitToWords(o,!1):o.reduce(function(C,b){return C.concat(c.splitToWords(b,!1))},[]);y.push(" ");var g=this.getStyleHash(r,a),f=this.tryLoadWordsToMeasurer(y,r,g,a,void 0,void 0,void 0,void 0,l);if(f){var v=this.containers[a];this.putElementsInDOM(v,f),this.beforeMeasureInDOM(),this.measureElementsInDOM(f,l),this.afterMeasureInDOM()}return l},n.prototype.measureTextLine=function(o,r,a){var c=this.measureWords(o,r,a);return t.getTextLineSize(o,c)},n.prototype.onNewModel=function(o,r){var a=this;r.changeByFunc(null,function(){return a.onNewModelCore(o)})},n.prototype.onNewModelCore=function(o){var r=o.filter(function(y){return y instanceof p.Shape}),a=o.filter(function(y){return y instanceof u.Connector}),c=this.tryLoadShapeTexts(r),l=this.tryLoadConnectorTexts(a);(c||l)&&(c&&this.putElementsInDOM(this.containers[s.TextOwner.Shape],c),l&&this.putElementsInDOM(this.containers[s.TextOwner.Connector],l),this.beforeMeasureInDOM(),c&&this.measureElementsInDOM(c),l&&this.measureElementsInDOM(l),this.afterMeasureInDOM())},n.prototype.replaceParent=function(o){this.parent!==o&&(this.mainElement.parentNode&&o.appendChild(this.mainElement),this.parent=o)},n.prototype.clean=function(){P.RenderUtils.removeElement(this.mainElement)},n.prototype.tryLoadShapeTexts=function(o){var r=this,a={},c=[],l=[],y=[];return o.forEach(function(g){var f=r.getStyleHash(g.styleText,s.TextOwner.Shape);r.tryLoadWordsToMeasurer(r.splitToWords(g.text,!0),g.styleText,f,s.TextOwner.Shape,a,c,l,y)}),c.length?{elements:c,hashes:l,styleHashes:y}:null},n.prototype.tryLoadConnectorTexts=function(o){var r=this,a={},c=[],l=[],y=[];return o.forEach(function(g){var f=g.texts.map(function(C){return C.value}).reduce(function(C,b){return C.concat(r.splitToWords(b,!1))},[]);if(f.length){f.push(" ");var v=r.getStyleHash(g.styleText,s.TextOwner.Connector);r.tryLoadWordsToMeasurer(f,g.styleText,v,s.TextOwner.Connector,a,c,l,y)}}),c.length?{elements:c,hashes:l,styleHashes:y}:null},n.prototype.tryLoadWordsToMeasurer=function(o,r,a,c,l,y,g,f,v){var C=this,b=[];return y=y||[],g=g||[],f=f||[],l=l||{},o.forEach(function(S){return C.tryLoadWordToMeasurer(S,r,a,c,l,y,g,f,b,v)}),y.length?{elements:y,hashes:g,styleHashes:f,newWords:b}:null},n.prototype.putElementsInDOM=function(o,r){for(o.parentNode&&o.parentNode.removeChild(o);o.firstChild;)o.removeChild(o.firstChild);r.elements.forEach(function(a){return o.appendChild(a)}),this.svgElement.appendChild(o)},n.prototype.measureElementsInDOM=function(o,r){for(var a=o.hashes,c=o.elements,l=o.newWords,y=a.length,g=0;g<y;g++){var f=this.getDomElementSize(c[g]);f&&(f.isEmpty()||(this.cache[a[g]]=f),r&&(r.words[l[g]]=f));var v=o.styleHashes[g];this.fontSizeCache[v]===void 0&&(this.fontSizeCache[v]=this.getDomFontSize(c[g])),r&&r.fontSize<0&&(r.fontSize=this.fontSizeCache[v])}},n.prototype.beforeMeasureInDOM=function(){this.parent.appendChild(this.mainElement)},n.prototype.afterMeasureInDOM=function(){this.mainElement.parentNode&&this.mainElement.parentNode.removeChild(this.mainElement)},n.prototype.tryLoadWordToMeasurer=function(o,r,a,c,l,y,g,f,v,C){var b=this.getHash(o,r,c),S=this.cache[b];S||l[b]?S&&C&&(C.words[o]=S,C.fontSize=this.fontSizeCache[a]):(l[b]=!0,g.push(b),y.push(this.createElement(o,r)),f.push(a),v.push(o))},n.prototype.getHash=function(o,r,a){return a+"|"+(r&&r.toHash())+"|"+o},n.prototype.getStyleHash=function(o,r){return this.getHash(" ",o,r)},n.prototype.createElement=function(o,r){var a=document.createElementNS(i.svgNS,"text");return o===" "&&a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),a.textContent=o,r&&P.RenderUtils.applyStyleToElement(r,a),a},n.prototype.splitToWords=function(o,r){var a=t.textToWords(o);return r&&a.push(" "),a},n.prototype.getDomFontSize=function(o){return parseFloat(window.getComputedStyle(o).fontSize)},n.prototype.getDomElementSize=function(o){var r;try{r=o.getBBox()}catch{}return r?new m.Size(r.width,r.height):new m.Size(0,0)},n.prototype.createNodes=function(){this.mainElement=i.RenderHelper.createMainElement(void 0,!0),this.svgElement=i.RenderHelper.createSvgElement(this.mainElement,!1),this.createContainer(s.TextOwner.Shape,"shape"),this.createContainer(s.TextOwner.Connector,"connector"),this.createContainer(s.TextOwner.ExtensionLine,"extension-line"),this.createContainer(s.TextOwner.Resize,"resize-info")},n.prototype.createContainer=function(o,r){var a=document.createElementNS(i.svgNS,"g");a.setAttribute("class",r),this.containers[o]=a},n}();h.TextMeasurer=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(S,x){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,w){I.__proto__=w}||function(I,w){for(var _ in w)w.hasOwnProperty(_)&&(I[_]=w[_])})(S,x)},function(S,x){function I(){this.constructor=S}m(S,x),S.prototype=x===null?Object.create(x):(I.prototype=x.prototype,new I)});Object.defineProperty(h,"__esModule",{value:!0}),h.EdgeOnLayer=h.NodeOnLayer=h.SugiyamaNodesOrderer=h.SugiyamaLayerDistributor=h.SugiyamaLayoutBuilder=void 0;var p=d(139),u=d(54),s=d(71),i=d(38),t=d(90),e=d(41),n=d(0),o=d(20),r=d(138),a=d(6),c=d(270),l=function(S){function x(){return S!==null&&S.apply(this,arguments)||this}return P(x,S),x.prototype.build=function(){var I=this,w=0,_=new r.GraphLayout,T=new g;return this.graph.getConnectedComponents().forEach(function(R){var E=c.CycleRemover.removeCycles(R),D=y.getLayers(E.graph),L=T.orderNodes(E.graph,D),H=Object.keys(E.removedEdges).map(function(K){return R.getEdge(K)}),O=T.assignAbsCoordinates(L),z=I.createInfoGraphLayout(O,E.reversedEdges,H);_.extend(I.setComponentOffset(z,w)),w+=I.getComponentOffset(z)}),_},x.prototype.createInfoGraphLayout=function(I,w,_){for(var T=this,R=new n.Point(0,0),E=I.items,D=new t.HashSet(E.map(function(G){return G.layer}).sort(function(G,Y){return G-Y})),L=this.getAbsOffsetInfo(I.items),H={},O=0,z=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,K=Number.MIN_SAFE_INTEGER||Number.MAX_VALUE,A=function(G){var Y=D.item(G),tt=0;E.filter(function(W){return W.layer===Y}).sort(function(W,N){return W.position-N.position}).forEach(function(W){var N=T.getDepthNodeSize(W),k=T.chooseDirectionValue(0,N),B=T.getAbsPosition(W.position,T.getBreadthNodeSize(W),L);R=T.setBreadth(R,B);var F=T.setDepthOffset(R,-k);if(H[W.key]=F,!W.isDummy){var Z=T.settings.orientation===o.DataLayoutOrientation.Horizontal?F.y:F.x;z=Math.min(z,Z),K=Math.max(K,Z+T.getBreadthNodeSize(W)),tt=Math.max(tt,T.getDepthNodeSize(W))}}),O+=tt,R=M.setBreadth(R,0),R=M.setDepthOffset(R,M.getDirectionValue(tt+M.settings.layerSpacing))},M=this,U=0;U<D.length;U++)A(U);O+=(D.length-1)*this.settings.layerSpacing;var V=new r.GraphLayout;return this.createNodesLayout(I,V,z,O,H),this.createEdgesLayout(I,V,w,_),V},x.prototype.createNodesLayout=function(I,w,_,T,R){var E=this,D=this.settings.orientation===o.DataLayoutOrientation.Vertical?new n.Point(-_,this.chooseDirectionValue(0,T)):new n.Point(this.chooseDirectionValue(0,T),-_);I.items.forEach(function(L){if(!L.isDummy){var H=E.graph.getNode(L.key);w.addNode(new s.NodeLayout(H,R[L.key].clone().offset(D.x,D.y)))}})},x.prototype.createEdgesLayout=function(I,w,_,T){var R=this.getDirectEdgeLayout(),E=this.getDiffLevelEdgeLayout(!0),D=this.getDiffLevelEdgeLayout(!1),L=this.getSameLevelEdgeLayout(!0),H=this.getSameLevelEdgeLayout(!1),O={};I.edges.filter(function(z){return!z.isDummy}).concat(T.map(function(z){return new C(z.key,!1,z.from,z.to)})).sort(function(z,K){return I.getNode(z.originFrom).layer-I.getNode(K.originFrom).layer||I.getNode(z.to).layer-I.getNode(K.to).layer}).forEach(function(z){var K=_[z.key],A=I.getNode(K?z.to:z.originFrom),M=I.getNode(K?z.originFrom:z.to);if(M.layer-A.layer==1)w.addEdge(new s.EdgeLayout(z.key,R.from,R.to));else{var U=[];if(M.position-A.position>=1)U.push(E),U.push({from:R.from,to:E.to}),U.push({from:E.from,to:R.to});else if(M.position-A.position<=-1)U.push(D),U.push({from:R.from,to:D.to}),U.push({from:D.from,to:R.to});else{var V=A.position===M.position&&M.position===0?[L,H]:[H,L];V.forEach(function(N){return U.push(N)}),V.forEach(function(N){U.push({from:N.from,to:R.to}),U.push({from:R.from,to:N.to})})}U.push(R);for(var G=0,Y=void 0;Y=U[G];G++){var tt=A.key+"_"+Y.from,W=M.key+"_"+Y.to;if(O[tt]!==a.ConnectorPosition.End&&O[W]!==a.ConnectorPosition.Begin){w.addEdge(new s.EdgeLayout(z.key,Y.from,Y.to)),O[tt]=a.ConnectorPosition.Begin,O[W]=a.ConnectorPosition.End;break}}}})},x.prototype.getDirectEdgeLayout=function(){return this.settings.orientation===o.DataLayoutOrientation.Horizontal?this.settings.direction===o.LogicalDirectionKind.Forward?{from:1,to:3}:{from:3,to:1}:this.settings.direction===o.LogicalDirectionKind.Forward?{from:2,to:0}:{from:0,to:2}},x.prototype.getDiffLevelEdgeLayout=function(I){return this.settings.orientation===o.DataLayoutOrientation.Horizontal?I?{from:2,to:0}:{from:0,to:2}:I?{from:3,to:1}:{from:1,to:3}},x.prototype.getSameLevelEdgeLayout=function(I){return this.settings.orientation===o.DataLayoutOrientation.Horizontal?I?{from:0,to:0}:{from:2,to:2}:I?{from:3,to:3}:{from:1,to:1}},x.prototype.getAbsOffsetInfo=function(I){var w=this,_={},T=function(D,L){_[L]===void 0&&(_[L]=w.getBreadthNodeSize(D)),_[L]=Math.max(_[L],w.getBreadthNodeSize(D))};I.forEach(function(D){var L=b(D.position);T(D,L),_[L]%1!=0&&T(D,L+1)});var R={},E=0;return Object.keys(_).sort(function(D,L){return parseFloat(D)-parseFloat(L)}).forEach(function(D){R[D]={leftOffset:E,width:_[D]},E+=_[D]+w.settings.columnSpacing}),R},x.prototype.setBreadth=function(I,w){return this.settings.orientation===o.DataLayoutOrientation.Vertical?new n.Point(w,I.y):new n.Point(I.x,w)},x.prototype.setDepthOffset=function(I,w){return this.settings.orientation===o.DataLayoutOrientation.Horizontal?new n.Point(I.x+w,I.y):new n.Point(I.x,I.y+w)},x.prototype.getAbsPosition=function(I,w,_){var T=b(I),R=_[T].leftOffset,E=_[T].width;return I%1==0?R+(E-w)/2:R+E-(w-this.settings.columnSpacing)/2},x.prototype.getBreadthNodeSize=function(I){return I.isDummy?0:this.getBreadthNodeSizeCore(this.graph.getNode(I.key))},x.prototype.getDepthNodeSize=function(I){return I.isDummy?0:this.getDepthNodeSizeCore(this.graph.getNode(I.key))},x}(p.LayoutBuilder);h.SugiyamaLayoutBuilder=l;var y=function(){function S(){}return S.getLayers=function(x){var I=this.getFeasibleTree(x);return this.calcNodesLayers(I)},S.getFeasibleTree=function(x){var I=this.initLayerAssignment(x);return x.getSpanningGraph(x.nodes[0],i.ConnectionMode.OutgoingAndIncoming,function(w){return I[w.to]-I[w.from]})},S.initLayerAssignment=function(x){for(var I={},w=0,_={},T=x.nodes.filter(function(E){return!x.getAdjacentEdges(E,i.ConnectionMode.Incoming).length}),R=function(){T.forEach(function(D){I[D]=w,_[D]=!0}),Object.keys(_).forEach(function(D){x.getAdjacentEdges(D,i.ConnectionMode.Outgoing).filter(function(L){return I[L.to]===void 0}).length===0&&delete _[D]});var E={};Object.keys(_).forEach(function(D){x.getAdjacentEdges(D,i.ConnectionMode.Outgoing).map(function(L){return L.to}).filter(function(L){return I[L]===void 0&&x.getAdjacentEdges(L,i.ConnectionMode.Incoming).reduce(function(H,O){return H&&I[O.from]!==void 0},!0)}).forEach(function(L){return E[L]=!0})}),T=Object.keys(E),w++};T.length;)R();return I},S.calcNodesLayers=function(x){var I={},w=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,_=0,T=x.createIterator(i.ConnectionMode.OutgoingAndIncoming);for(var R in T.visitEachEdgeOnce=!1,T.onNode=function(E){I[E.key]=_,w=Math.min(w,_)},T.skipNode=function(E){return I[E.key]!==void 0},T.skipEdge=function(E){return I[E.from]!==void 0&&I[E.to]!==void 0},T.onEdge=function(E,D){_=D?I[E.from]+1:I[E.to]-1},T.iterate(x.nodes[0]),I)Object.prototype.hasOwnProperty.call(I,R)&&(I[R]-=w);return I},S}();h.SugiyamaLayerDistributor=y;var g=function(){function S(){this.idCounter=-1e4}return S.prototype.orderNodes=function(x,I){for(var w=1,_=this.initGraphInfo(x,I),T=_.items,R=this.initOrder(T),E=this.getNodeToPositionMap(T),D=this.getCrossCount(R,_),L=!0;w<14&&D!==0;){R=this.getNodesOrder(R,_,L);var H=this.getCrossCount(R,_);H<D&&(E=this.getNodeToPositionMap(_.items),D=H),L=!L,w++}return _.items.forEach(function(O){return O.position=E[O.key]}),_},S.prototype.getNodesOrder=function(x,I,w){var _=this,T={},R=function(L){if(!Object.prototype.hasOwnProperty.call(x,L))return"continue";var H={},O=[];x[L].forEach(function(z){var K=(w?I.getChildren(z.key):I.getParents(z.key)).map(function(A){return I.getNode(A).position});O.push(z.key),H[z.key]=_.getNodePosition(K)}),T[L]=E.sortNodes(O,H,I)},E=this;for(var D in x)R(D);return T},S.prototype.sortNodes=function(x,I,w){return x.sort(function(_,T){return I[_]-I[T]}).map(function(_,T){var R=w.getNode(_);return R.position=T,R})},S.prototype.getNodePosition=function(x){if(!(x=x.sort(function(T,R){return T-R})).length)return 0;var I=Math.floor(x.length/2);if(x.length===2||x.length%2==1)return x[I];var w=x[I-1]-x[0],_=x[x.length-1]-x[I];return Math.floor((x[I-1]*_+x[I]*w)/(w+_))},S.prototype.initOrder=function(x){var I={};return x.forEach(function(w){return(I[w.layer]||(I[w.layer]=[])).push(w)}),I},S.prototype.getCrossCount=function(x,I){var w=0,_=function(R){if(!Object.prototype.hasOwnProperty.call(x,R))return"continue";var E=[];x[R].forEach(function(D){var L=I.getChildren(D.key).map(function(H){return I.getNode(H).position});L.forEach(function(H){w+=E.filter(function(O){return H<O}).length}),E=E.concat(L)})};for(var T in x)_(T);return w},S.prototype.initGraphInfo=function(x,I){var w=this,_={},T={},R=[],E=[];return x.nodes.forEach(function(D){var L=I[D];_[L]===void 0&&(_[L]=0);var H=new f(D,!1,L,_[L]++);T[D]=H,R.push(H)}),x.edges.forEach(function(D){var L=I[D.to]-I[D.from];if(L>1){for(var H=T[D.from],O=1;O<L;O++){var z=new f(w.createDummyID(),!0,I[D.from]+O,_[I[D.from]+O]++);E.push(new C(w.createDummyID(),!0,H.key,z.key)),R.push(z),H=z}E.push(new C(D.key,!1,H.key,T[D.to].key,T[D.from].key))}else E.push(new C(D.key,!1,T[D.from].key,T[D.to].key))}),new u.FastGraph(R,E)},S.prototype.createDummyID=function(){return"dummy_"+--this.idCounter},S.prototype.getNodeToPositionMap=function(x){return x.reduce(function(I,w){return I[w.key]=w.position,I},{})},S.prototype.assignAbsCoordinates=function(x){var I=this.getAbsCoodinate(x);return new u.FastGraph(x.items.map(function(w){return new f(w.key,w.isDummy,w.layer,I[w.key])}),x.edges.slice(0))},S.prototype.getAbsCoodinate=function(x){var I=this,w=x.items.reduce(function(R,E){R[E.layer]=R[E.layer]||[];var D=e.SearchUtils.binaryIndexOf(R[E.layer],function(L){return L.position-E.position});return R[E.layer].splice(D<0?~D:D,0,E),R},{}),_=[v.TopLeft,v.TopRight,v.BottomLeft,v.BottomRight].map(function(R){return I.getPositionByMedian(x,R,w)}),T={};return x.items.forEach(function(R){var E=_.map(function(D){return D[R.key]}).sort(function(D,L){return D-L});T[R.key]=(E[1]+E[2])/2}),T},S.prototype.getPositionByMedian=function(x,I,w){var _=x.items,T=this.getNodeToPositionMap(_),R=this.getMedians(x,_,I);return R=this.resolveMedianConflicts(x,w,R,I),this.getSortedBlocks(x,_,R,I).forEach(function(E){var D=E.reduce(function(L,H){return T[H.key]>L?T[H.key]:L},-2);E.forEach(function(L){var H=D-T[L.key];H>0&&w[L.layer].filter(function(O){return O.position>L.position}).forEach(function(O){return T[O.key]+=H}),T[L.key]=D})}),T},S.prototype.getSortedBlocks=function(x,I,w,_){for(var T=[],R=_===v.BottomLeft||_===v.BottomRight,E=new t.HashSet(I.slice(0).sort(function(H,O){return R?H.layer-O.layer:O.layer-H.layer}),function(H){return H.key});E.length;){var D=E.item(0),L=this.getBlock(x,D,w,_);T.push(L),L.forEach(function(H){return E.remove(H)})}return T.sort(function(H,O){var z=H.reduce(function(U,V){return V.position<U.position?V:U},H[0]),K=O.filter(function(U){return U.layer===z.layer})[0];if(K)return z.position>K.position?1:-1;var A=O.reduce(function(U,V){return V.position<U.position?V:U},O[0]),M=H.filter(function(U){return U.layer===A.layer})[0];return M?M.position>A.position?1:-1:z.layer>A.layer?1:-1}),T},S.prototype.getBlock=function(x,I,w,_){var T=[],R=null;do R&&(I=_===v.TopLeft||_===v.TopRight?x.getNode(R.from):x.getNode(R.to)),T.push(I),R=w[I.key];while(R);return T},S.prototype.resolveMedianConflicts=function(x,I,w,_){var T=this,R={},E=function(L){if(!Object.prototype.hasOwnProperty.call(I,L))return"continue";var H,O,z=I[L];_!==v.TopRight&&_!==v.BottomRight||(z=z.slice(0).sort(function(K,A){return A.position-K.position})),z.forEach(function(K){var A=w[K.key];if(A){var M=_===v.TopLeft||_===v.TopRight?A.from:A.to,U=x.getNode(M).position;T.checkMedianConfict(H,O,U,_)?R[K.key]=null:(H=H===void 0?U:Math.min(H,U),O=O===void 0?U:Math.max(O,U),R[K.key]=A)}else R[K.key]=null})};for(var D in I)E(D);return R},S.prototype.checkMedianConfict=function(x,I,w,_){return x!==void 0&&I!==void 0&&(_===v.TopLeft||_===v.BottomLeft?I>=w:x<=w)},S.prototype.getMedians=function(x,I,w){var _=this,T={};return I.forEach(function(R){var E=_.getActualAdjacentEdges(x,R,w),D=_.getMedianPosition(E.length,w);T[R.key]=E[D]}),T},S.prototype.getMedianPosition=function(x,I){if(x===0)return-1;if(x%2!=0)return Math.floor(x/2);if(I===v.TopLeft||I===v.BottomLeft)return Math.floor(x/2)-1;if(I===v.TopRight||I===v.BottomRight)return Math.floor(x/2);throw new Error("Invalid Operation")},S.prototype.getActualAdjacentEdges=function(x,I,w){return w===v.TopLeft||w===v.TopRight?x.getAdjacentEdges(I.key,i.ConnectionMode.Incoming).sort(function(_,T){return x.getNode(_.from).position-x.getNode(T.from).position}):x.getAdjacentEdges(I.key,i.ConnectionMode.Outgoing).sort(function(_,T){return x.getNode(_.to).position-x.getNode(T.to).position})},S}();h.SugiyamaNodesOrderer=g;var f=function(){function S(x,I,w,_){this.key=x,this.isDummy=I,this.layer=w,this.position=_}return S.prototype.getHashCode=function(){return this.key.toString()},S}();h.NodeOnLayer=f;var v,C=function(){function S(x,I,w,_,T){this.key=x,this.isDummy=I,this.from=w,this.to=_,this._originFrom=T}return S.prototype.getHashCode=function(){return this.from+"-"+this.to},Object.defineProperty(S.prototype,"originFrom",{get:function(){return this._originFrom!==void 0?this._originFrom:this.from},enumerable:!1,configurable:!0}),S}();function b(S){return Math.trunc?Math.trunc(S):isFinite(S)?S-S%1||(S<0?-0:S===0?S:0):S}h.EdgeOnLayer=C,function(S){S[S.TopLeft=0]="TopLeft",S[S.TopRight=1]="TopRight",S[S.BottomLeft=2]="BottomLeft",S[S.BottomRight=3]="BottomRight"}(v||(v={}))},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function p(){this.suspendUpdateCount=0,this.occurredEvents=0}return p.prototype.beginUpdate=function(){this.suspendUpdateCount===0&&this.onUpdateLocked(),this.suspendUpdateCount<0?this.suspendUpdateCount--:this.suspendUpdateCount++},p.prototype.endUpdate=function(){if(this.suspendUpdateCount<0?this.suspendUpdateCount++:this.suspendUpdateCount>0&&this.suspendUpdateCount--,!this.isUpdateLocked()){var u=this.occurredEvents;this.occurredEvents=0,this.onUpdateUnlocked(u)}},p.prototype.suspendUpdate=function(){if(this.suspendUpdateCount>0){this.suspendUpdateCount*=-1;var u=this.occurredEvents;this.occurredEvents=0,this.onUpdateUnlocked(u)}},p.prototype.continueUpdate=function(){this.suspendUpdateCount<0&&(this.suspendUpdateCount*=-1)},p.prototype.isUpdateLocked=function(){return this.suspendUpdateCount>0},p.prototype.onUpdateLocked=function(){},p.prototype.registerOccurredEvent=function(u){this.occurredEvents|=u},p.prototype.resetOccurredEvents=function(){this.occurredEvents=0},p.prototype.isLocked=function(){return this.suspendUpdateCount!==0},p}();h.BatchUpdatableObject=m;var P=function(){function p(){}return p.prototype.beginUpdate=function(){},p.prototype.endUpdate=function(){},p}();h.EmptyBatchUpdatableObject=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.CommandManager=h.DiagramCommand=void 0;var m,P=d(162),p=d(199),u=d(200),s=d(201),i=d(238),t=d(239),e=d(240),n=d(241),o=d(242),r=d(243),a=d(244),c=d(245),l=d(246),y=d(247),g=d(248),f=d(249),v=d(250),C=d(25),b=d(137),S=d(253),x=d(254),I=d(255),w=d(257),_=d(259),T=d(261),R=d(262),E=d(263),D=d(264),L=d(265),H=d(268),O=d(271),z=d(272),K=d(142),A=d(273),M=d(274),U=d(275),V=d(276),G=d(143),Y=d(144),tt=d(277),W=d(278),N=d(279),k=d(280),B=d(282),F=d(284),Z=d(285),q=d(286),J=d(287),$=d(288),Q=d(289),nt=d(290),ot=d(292),it=d(293),rt=d(294),st=d(295),ct=d(296),ht=d(297),pt=d(298),lt=d(299),dt=d(300);(function(X){X[X.Undo=0]="Undo",X[X.Redo=1]="Redo",X[X.Cut=2]="Cut",X[X.Copy=3]="Copy",X[X.Paste=4]="Paste",X[X.PasteInPosition=5]="PasteInPosition",X[X.SelectAll=6]="SelectAll",X[X.Delete=7]="Delete",X[X.Import=8]="Import",X[X.ImportBPMN=9]="ImportBPMN",X[X.Export=10]="Export",X[X.ExportSvg=11]="ExportSvg",X[X.ExportPng=12]="ExportPng",X[X.ExportJpg=13]="ExportJpg",X[X.BindDocument=14]="BindDocument",X[X.UnbindDocument=15]="UnbindDocument",X[X.Bold=16]="Bold",X[X.Italic=17]="Italic",X[X.Underline=18]="Underline",X[X.FontName=19]="FontName",X[X.FontSize=20]="FontSize",X[X.FontColor=21]="FontColor",X[X.FillColor=22]="FillColor",X[X.StrokeColor=23]="StrokeColor",X[X.TextLeftAlign=24]="TextLeftAlign",X[X.TextCenterAlign=25]="TextCenterAlign",X[X.TextRightAlign=26]="TextRightAlign",X[X.ConnectorLineOption=27]="ConnectorLineOption",X[X.ConnectorStartLineEnding=28]="ConnectorStartLineEnding",X[X.ConnectorEndLineEnding=29]="ConnectorEndLineEnding",X[X.BringToFront=30]="BringToFront",X[X.SendToBack=31]="SendToBack",X[X.MoveLeft=32]="MoveLeft",X[X.MoveStepLeft=33]="MoveStepLeft",X[X.MoveRight=34]="MoveRight",X[X.MoveStepRight=35]="MoveStepRight",X[X.MoveUp=36]="MoveUp",X[X.MoveStepUp=37]="MoveStepUp",X[X.MoveDown=38]="MoveDown",X[X.MoveStepDown=39]="MoveStepDown",X[X.CloneLeft=40]="CloneLeft",X[X.CloneRight=41]="CloneRight",X[X.CloneUp=42]="CloneUp",X[X.CloneDown=43]="CloneDown",X[X.AutoLayoutTree=44]="AutoLayoutTree",X[X.AutoLayoutFlow=45]="AutoLayoutFlow",X[X.AutoLayoutTreeVertical=46]="AutoLayoutTreeVertical",X[X.AutoLayoutTreeHorizontal=47]="AutoLayoutTreeHorizontal",X[X.AutoLayoutLayeredVertical=48]="AutoLayoutLayeredVertical",X[X.AutoLayoutLayeredHorizontal=49]="AutoLayoutLayeredHorizontal",X[X.Lock=50]="Lock",X[X.Unlock=51]="Unlock",X[X.Units=52]="Units",X[X.ViewUnits=53]="ViewUnits",X[X.PageSize=54]="PageSize",X[X.PageLandscape=55]="PageLandscape",X[X.PageColor=56]="PageColor",X[X.GridSize=57]="GridSize",X[X.ShowGrid=58]="ShowGrid",X[X.SnapToGrid=59]="SnapToGrid",X[X.ZoomLevel=60]="ZoomLevel",X[X.Fullscreen=61]="Fullscreen",X[X.ToggleSimpleView=62]="ToggleSimpleView",X[X.ToggleReadOnly=63]="ToggleReadOnly",X[X.EditShapeImage=64]="EditShapeImage",X[X.FitToScreen=65]="FitToScreen",X[X.SwitchAutoZoom=66]="SwitchAutoZoom",X[X.ToggleAutoZoom=67]="ToggleAutoZoom",X[X.FitToWidth=68]="FitToWidth",X[X.ZoomLevelItems=69]="ZoomLevelItems",X[X.GridSizeItems=70]="GridSizeItems",X[X.PageSizeItems=71]="PageSizeItems",X[X.ImportXML=72]="ImportXML",X[X.InsertShapeImage=73]="InsertShapeImage",X[X.DeleteShapeImage=74]="DeleteShapeImage",X[X.StrokeStyle=75]="StrokeStyle",X[X.StrokeWidth=76]="StrokeWidth",X[X.AutoLayoutTreeVerticalBottomToTop=77]="AutoLayoutTreeVerticalBottomToTop",X[X.AutoLayoutTreeHorizontalRightToLeft=78]="AutoLayoutTreeHorizontalRightToLeft",X[X.AutoLayoutLayeredVerticalBottomToTop=79]="AutoLayoutLayeredVerticalBottomToTop",X[X.AutoLayoutLayeredHorizontalRightToLeft=80]="AutoLayoutLayeredHorizontalRightToLeft",X[X.Zoom25=81]="Zoom25",X[X.Zoom50=82]="Zoom50",X[X.Zoom75=83]="Zoom75",X[X.Zoom100=84]="Zoom100",X[X.Zoom125=85]="Zoom125",X[X.Zoom150=86]="Zoom150",X[X.Zoom200=87]="Zoom200",X[X.AutoZoomToContent=88]="AutoZoomToContent",X[X.AutoZoomToWidth=89]="AutoZoomToWidth",X[X.ZoomLevelInPercentage=90]="ZoomLevelInPercentage",X[X.ConnectorRoutingMode=91]="ConnectorRoutingMode"})(m=h.DiagramCommand||(h.DiagramCommand={}));var gt=function(){function X(et){this.commands={},this.shortcutsToCommand={},this.lastCommandsChain=[],this.executingCommandsChain=[],this.executingCommandCounter=0,this.isPublicApiCall=!1,this.createCommand(et,m.Undo,p.UndoCommand,C.ModifierKey.Ctrl|C.KeyCode.Key_z,C.ModifierKey.Meta|C.KeyCode.Key_z),this.createCommand(et,m.Redo,u.RedoCommand,C.ModifierKey.Ctrl|C.KeyCode.Key_y,C.ModifierKey.Ctrl|C.ModifierKey.Shift|C.KeyCode.Key_z,C.ModifierKey.Meta|C.ModifierKey.Shift|C.KeyCode.Key_z),this.createCommand(et,m.Cut,D.CutSelectionCommand,C.KeyCode.Key_x|C.ModifierKey.Ctrl,C.KeyCode.Key_x|C.ModifierKey.Meta,C.KeyCode.Delete|C.ModifierKey.Shift),this.createCommand(et,m.Copy,E.CopySelectionCommand,C.KeyCode.Key_c|C.ModifierKey.Ctrl,C.KeyCode.Key_c|C.ModifierKey.Meta,C.KeyCode.Insert|C.ModifierKey.Ctrl),this.createCommand(et,m.Paste,L.PasteSelectionCommand),this.createCommand(et,m.PasteInPosition,Q.PasteSelectionInPositionCommand),this.createCommand(et,m.SelectAll,v.SelectAllCommand,C.KeyCode.Key_a|C.ModifierKey.Ctrl,C.KeyCode.Key_a|C.ModifierKey.Meta),this.createCommand(et,m.Delete,P.DeleteCommand,C.KeyCode.Delete,C.KeyCode.Backspace),this.createCommand(et,m.Import,s.ImportCommand),this.createCommand(et,m.ImportBPMN,H.ImportBPMNCommand),this.createCommand(et,m.ImportXML,nt.ImportXMLCommand),this.createCommand(et,m.Export,i.ExportCommand),this.createCommand(et,m.ExportSvg,T.ExportSvgCommand),this.createCommand(et,m.ExportPng,_.ExportPngCommand),this.createCommand(et,m.ExportJpg,R.ExportJpgCommand),this.createCommand(et,m.BindDocument,U.BindDocumentCommand),this.createCommand(et,m.UnbindDocument,V.UnbindDocumentCommand),this.createCommand(et,m.Bold,t.ToggleFontBoldCommand,C.ModifierKey.Ctrl|C.KeyCode.Key_b,C.ModifierKey.Meta|C.KeyCode.Key_b),this.createCommand(et,m.Italic,e.ToggleFontItalicCommand,C.ModifierKey.Ctrl|C.KeyCode.Key_i,C.ModifierKey.Meta|C.KeyCode.Key_i),this.createCommand(et,m.Underline,n.ToggleFontUnderlineCommand,C.ModifierKey.Ctrl|C.KeyCode.Key_u,C.ModifierKey.Meta|C.KeyCode.Key_u),this.createCommand(et,m.FontName,o.ChangeFontNameCommand),this.createCommand(et,m.FontSize,r.ChangeFontSizeCommand),this.createCommand(et,m.FontColor,a.ChangeFontColorCommand),this.createCommand(et,m.FillColor,c.ChangeFillColorCommand),this.createCommand(et,m.StrokeColor,l.ChangeStrokeColorCommand),this.createCommand(et,m.StrokeStyle,rt.ChangeStrokeStyleCommand),this.createCommand(et,m.StrokeWidth,st.ChangeStrokeWidthCommand),this.createCommand(et,m.TextLeftAlign,y.TextLeftAlignCommand),this.createCommand(et,m.TextCenterAlign,y.TextCenterAlignCommand),this.createCommand(et,m.TextRightAlign,y.TextRightAlignCommand),this.createCommand(et,m.ConnectorLineOption,f.ChangeConnectorLineOptionCommand),this.createCommand(et,m.ConnectorStartLineEnding,g.ChangeConnectorStartLineEndingCommand),this.createCommand(et,m.ConnectorEndLineEnding,g.ChangeConnectorEndLineEndingCommand),this.createCommand(et,m.BringToFront,z.BringToFrontCommand),this.createCommand(et,m.SendToBack,O.SendToBackCommand),this.createCommand(et,m.MoveLeft,A.MoveLeftCommand,C.ModifierKey.Ctrl|C.KeyCode.Left,C.ModifierKey.Ctrl|C.ModifierKey.Shift|C.KeyCode.Left),this.createCommand(et,m.MoveRight,A.MoveRightCommand,C.ModifierKey.Ctrl|C.KeyCode.Right,C.ModifierKey.Ctrl|C.ModifierKey.Shift|C.KeyCode.Right),this.createCommand(et,m.MoveUp,A.MoveUpCommand,C.ModifierKey.Ctrl|C.KeyCode.Up,C.ModifierKey.Ctrl|C.ModifierKey.Shift|C.KeyCode.Up),this.createCommand(et,m.MoveDown,A.MoveDownCommand,C.ModifierKey.Ctrl|C.KeyCode.Down,C.ModifierKey.Ctrl|C.ModifierKey.Shift|C.KeyCode.Down),this.createCommand(et,m.MoveStepLeft,A.MoveStepLeftCommand,C.KeyCode.Left,C.ModifierKey.Shift|C.KeyCode.Left),this.createCommand(et,m.MoveStepRight,A.MoveStepRightCommand,C.KeyCode.Right,C.ModifierKey.Shift|C.KeyCode.Right),this.createCommand(et,m.MoveStepUp,A.MoveStepUpCommand,C.KeyCode.Up,C.ModifierKey.Shift|C.KeyCode.Up),this.createCommand(et,m.MoveStepDown,A.MoveStepDownCommand,C.KeyCode.Down,C.ModifierKey.Shift|C.KeyCode.Down),this.createCommand(et,m.CloneLeft,N.CloneLeftCommand,C.ModifierKey.Alt|C.KeyCode.Left,C.ModifierKey.Alt|C.ModifierKey.Shift|C.KeyCode.Left),this.createCommand(et,m.CloneRight,N.CloneRightCommand,C.ModifierKey.Alt|C.KeyCode.Right,C.ModifierKey.Alt|C.ModifierKey.Shift|C.KeyCode.Right),this.createCommand(et,m.CloneUp,N.CloneUpCommand,C.ModifierKey.Alt|C.KeyCode.Up,C.ModifierKey.Alt|C.ModifierKey.Shift|C.KeyCode.Up),this.createCommand(et,m.CloneDown,N.CloneDownCommand,C.ModifierKey.Alt|C.KeyCode.Down,C.ModifierKey.Alt|C.ModifierKey.Shift|C.KeyCode.Down),this.createCommand(et,m.Lock,tt.LockCommand),this.createCommand(et,m.Unlock,W.UnLockCommand),this.createCommand(et,m.AutoLayoutTree,b.AutoLayoutTreeVerticalCommand),this.createCommand(et,m.AutoLayoutFlow,K.AutoLayoutLayeredHorizontalCommand),this.createCommand(et,m.Units,k.ChangeUnitsCommand),this.createCommand(et,m.ViewUnits,k.ChangeViewUnitsCommand),this.createCommand(et,m.PageSize,w.ChangePageSizeCommand),this.createCommand(et,m.PageLandscape,I.ChangePageLandscapeCommand),this.createCommand(et,m.PageColor,B.ChangePageColorCommand),this.createCommand(et,m.GridSize,x.ChangeGridSizeCommand),this.createCommand(et,m.ShowGrid,F.ChangeShowGridCommand),this.createCommand(et,m.SnapToGrid,S.ChangeSnapToGridCommand),this.createCommand(et,m.ZoomLevel,M.ChangeZoomLevelCommand),this.createCommand(et,m.ZoomLevelInPercentage,M.ChangeZoomLevelInPercentageCommand),this.createCommand(et,m.AutoLayoutTreeVertical,b.AutoLayoutTreeVerticalCommand),this.createCommand(et,m.AutoLayoutTreeVerticalBottomToTop,ct.AutoLayoutTreeVerticalBottomToTopCommand),this.createCommand(et,m.AutoLayoutTreeHorizontal,G.AutoLayoutTreeHorizontalCommand),this.createCommand(et,m.AutoLayoutTreeHorizontalRightToLeft,ht.AutoLayoutTreeHorizontalRightToLeftCommand),this.createCommand(et,m.AutoLayoutLayeredVertical,Y.AutoLayoutLayeredVerticalCommand),this.createCommand(et,m.AutoLayoutLayeredVerticalBottomToTop,pt.AutoLayoutLayeredVerticalBottomToTopCommand),this.createCommand(et,m.AutoLayoutLayeredHorizontal,K.AutoLayoutLayeredHorizontalCommand),this.createCommand(et,m.AutoLayoutLayeredHorizontalRightToLeft,lt.AutoLayoutLayeredHorizontalRightToLeftCommand),this.createCommand(et,m.Fullscreen,Z.ToggleFullscreenCommand,C.KeyCode.F11),this.createCommand(et,m.ToggleSimpleView,q.ToggleSimpleViewCommand),this.createCommand(et,m.ToggleReadOnly,J.ToggleReadOnlyCommand),this.createCommand(et,m.InsertShapeImage,ot.InsertShapeImageCommand),this.createCommand(et,m.EditShapeImage,$.EditShapeImageCommand),this.createCommand(et,m.DeleteShapeImage,it.DeleteShapeImageCommand),this.createCommand(et,m.FitToScreen,M.FitToScreenCommand),this.createCommand(et,m.FitToWidth,M.FitToWidthCommand),this.createCommand(et,m.SwitchAutoZoom,M.SwitchAutoZoomCommand),this.createCommand(et,m.ToggleAutoZoom,M.ToggleAutoZoomCommand),this.createCommand(et,m.ZoomLevelItems,M.ChangeZoomLevelItemsCommand),this.createCommand(et,m.GridSizeItems,x.ChangeGridSizeItemsCommand),this.createCommand(et,m.PageSizeItems,w.ChangePageSizeItemsCommand),this.createCommand(et,m.Zoom25,M.ChangeZoomLevelTo25Command),this.createCommand(et,m.Zoom50,M.ChangeZoomLevelTo50Command),this.createCommand(et,m.Zoom75,M.ChangeZoomLevelTo75Command),this.createCommand(et,m.Zoom100,M.ChangeZoomLevelTo100Command),this.createCommand(et,m.Zoom125,M.ChangeZoomLevelTo125Command),this.createCommand(et,m.Zoom150,M.ChangeZoomLevelTo150Command),this.createCommand(et,m.Zoom200,M.ChangeZoomLevelTo200Command),this.createCommand(et,m.AutoZoomToContent,M.ToggleAutoZoomToContentCommand),this.createCommand(et,m.AutoZoomToWidth,M.ToggleAutoZoomToWidthCommand),this.createCommand(et,m.ConnectorRoutingMode,dt.ChangeConnectorRoutingModeCommand)}return X.prototype.getCommand=function(et){return this.commands[et]},X.prototype.beforeExecuting=function(et){this.executingCommandsChain.push(et),this.executingCommandCounter++},X.prototype.afterExecuting=function(){this.executingCommandCounter--,this.executingCommandCounter===0&&(this.lastCommandsChain=this.executingCommandsChain,this.executingCommandsChain=[])},X.prototype.processShortcut=function(et){var at=this.shortcutsToCommand[et];return!!at&&at.execute()},X.prototype.processPaste=function(et){var at=this.getCommand(m.Paste);return at&&at.isEnabled()&&at.execute(et),!0},X.prototype.notifySelectionChanged=function(et){this.lastCommandsChain=[]},X.prototype.notifyScrollPositionChanged=function(){},X.prototype.createCommand=function(et,at,ft){for(var Pt=[],yt=3;yt<arguments.length;yt++)Pt[yt-3]=arguments[yt];this.commands[at]=new ft(et);for(var Ct=0;Ct<Pt.length;Ct++){var St=Pt[Ct];typeof St=="number"&&(this.shortcutsToCommand[St]=this.commands[at])}},X}();h.CommandManager=gt},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(177),P=d(178),p=function(){function u(){}return u.normalizeToDataUrl=function(s,i){return u.checkPrependDataUrl(s)||(s=u.prependByDataUrl(s,i)),s},u.prependByDataUrl=function(s,i){return"data:"+i+";base64,"+s},u.checkPrependDataUrl=function(s){return u.dataUrl.test(s)},u.deleteDataUrlPrefix=function(s){return s.replace(u.dataUrl,"")},u.getUint8Array=function(s){for(var i=(s=atob(s)).length,t=new Uint8Array(i);i--;)t[i]=s.charCodeAt(i);return t},u.fromArrayBuffer=function(s){for(var i=[],t=new Uint8Array(s),e=t.byteLength,n=0;n<e;n++)i.push(String.fromCharCode(t[n]));return window.btoa(i.join(""))},u.getFileFromBase64=function(s,i,t){i===void 0&&(i="");var e=u.getUint8Array(s);return m.FileUtils.createFile([e],i,t)},u.getMimeTypeAsString=function(s){var i=s.match(u.dataUrl);return i?i[1]:null},u.getKnownMimeType=function(s){var i=s.match(u.dataUrl);return i?P.MimeTypeUtils.stringTypeToType(i[1]):P.DxMimeType.Unknown},u.fromBlobAsArrayBuffer=function(s,i){var t=new FileReader;t.onloadend=function(){return i(u.fromArrayBuffer(t.result))},t.readAsArrayBuffer(s)},u.fromBlobAsDataUrl=function(s,i){var t=new FileReader;t.onloadend=function(){return i(t.result)},t.readAsDataURL(s)},u.dataUrl=/^data:(.*?)(;(.*?))??(;base64)?,/,u}();h.Base64Utils=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.NativeConnector=h.NativeShape=h.NativeItem=void 0;var p=d(4),u=function(){function t(e,n){this.id=e,this.key=n,this.unitsApplied=!1}return t.prototype.applyUnits=function(e){this.unitsApplied||e===void 0||(this.applyUnitsCore(e),this.unitsApplied=!0)},t}();h.NativeItem=u;var s=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.applyUnitsCore=function(n){this.position.x=p.ModelUtils.getlUnitValue(n,this.position.x),this.position.y=p.ModelUtils.getlUnitValue(n,this.position.y),this.size.width=p.ModelUtils.getlUnitValue(n,this.size.width),this.size.height=p.ModelUtils.getlUnitValue(n,this.size.height)},e}(u);h.NativeShape=s;var i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.applyUnitsCore=function(n){this.points.forEach(function(o){o.x=p.ModelUtils.getlUnitValue(n,o.x),o.y=p.ModelUtils.getlUnitValue(n,o.y)})},e}(u);h.NativeConnector=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorRenderPointsContext=void 0;var m=function(){return function(P,p,u){this.renderPoints=P,this.lockCreateRenderPoints=p,this.actualRoutingMode=u}}();h.ConnectorRenderPointsContext=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ReplaceConnectorPointsHistoryItem=h.ChangeConnectorPointsHistoryItem=h.UpdateConnectorPointsHistoryItem=void 0;var p=function(i){function t(e,n){var o=i.call(this)||this;return o.connectorKey=e,o.newPoints=n,o}return P(t,i),t.prototype.redo=function(e){var n=this,o=e.model.findConnector(this.connectorKey);this.oldRenderContext=o.tryCreateRenderPointsContext(),this.oldPoints=o.points.map(function(r){return r.clone()}),e.changeConnectorPoints(o,function(r){r.points=n.newPoints,n.updateRenderPoints(r)})},t.prototype.undo=function(e){var n=this,o=e.model.findConnector(this.connectorKey);e.changeConnectorPoints(o,function(r){r.points=n.oldPoints,r.replaceRenderPoints(n.oldRenderContext)})},t}(d(8).HistoryItem);h.UpdateConnectorPointsHistoryItem=p;var u=function(i){function t(e,n,o){var r=i.call(this,e,n)||this;return r.connectorKey=e,r.newPoints=n,r.newRenderContext=o,r}return P(t,i),t.prototype.updateRenderPoints=function(e){e.replaceRenderPoints(this.newRenderContext)},t}(p);h.ChangeConnectorPointsHistoryItem=u;var s=function(i){function t(e,n){var o=i.call(this,e,n)||this;return o.connectorKey=e,o.newPoints=n,o}return P(t,i),t.prototype.updateRenderPoints=function(e){e.clearRenderPoints()},t}(p);h.ReplaceConnectorPointsHistoryItem=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(p,u,s,i){this.left=p,this.right=u,this.top=s,this.bottom=i}return P.empty=function(){return new P(0,0,0,0)},Object.defineProperty(P.prototype,"horizontal",{get:function(){return this.left+this.right},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"vertical",{get:function(){return this.top+this.bottom},enumerable:!0,configurable:!0}),P.fromNumber=function(p){return new P(p,p,p,p)},P.fromOffsets=function(p){return new P(p.left,p.right,p.top,p.bottom)},P.fromSide=function(p,u){return new P(p,p,u,u)},P.prototype.normalize=function(){return this.left=Math.max(0,this.left),this.right=Math.max(0,this.right),this.top=Math.max(0,this.top),this.bottom=Math.max(0,this.bottom),this},P.prototype.toString=function(){return JSON.stringify(this)},P.prototype.isEmpty=function(){return this.left===0&&this.right===0&&this.top===0&&this.bottom===0},P.prototype.offset=function(p){return this.left+=p.left,this.right+=p.right,this.top+=p.top,this.bottom+=p.bottom,this},P.prototype.multiply=function(p,u,s,i){switch(arguments.length){case 1:return this.left*=p,this.right*=p,this.top*=p,this.bottom*=p,this;case 2:return this.left*=p,this.right*=p,this.top*=u,this.bottom*=u,this;case 4:return this.left*=p,this.right*=u,this.top*=s,this.bottom*=i,this}return this},P.prototype.clone=function(){return new P(this.left,this.right,this.top,this.bottom)},P.prototype.copyFrom=function(p){this.left=p.left,this.right=p.right,this.top=p.top,this.bottom=p.bottom},P.prototype.equals=function(p){return this.top===p.top&&this.bottom===p.bottom&&this.right===p.right&&this.left===p.left},P.prototype.applyConverter=function(p){return this.left=p(this.left),this.right=p(this.right),this.top=p(this.top),this.bottom=p(this.bottom),this},P}();h.Offsets=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorPropertyHistoryItem=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.connectorKey=i,n.propertyName=t,n.value=e,n}return P(s,u),s.prototype.redo=function(i){var t=i.model.findConnector(this.connectorKey);this.oldValue=t.properties[this.propertyName],i.changeConnectorProperty(t,this.propertyName,this.value)},s.prototype.undo=function(i){var t=i.model.findConnector(this.connectorKey);i.changeConnectorProperty(t,this.propertyName,this.oldValue)},s}(d(8).HistoryItem);h.ChangeConnectorPropertyHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStyleHistoryItem=void 0;var p=function(u){function s(i,t,e){return u.call(this,i,t,e)||this}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey);this.oldStyleValue=t.style[this.styleProperty],i.changeStyle(t,this.styleProperty,this.styleValue)},s.prototype.undo=function(i){var t=i.model.findItem(this.itemKey);i.changeStyle(t,this.styleProperty,this.oldStyleValue)},s}(d(118).ChangeStyleHistoryItemBase);h.ChangeStyleHistoryItem=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.HashSet=void 0;var m=function(){function P(p,u){var s=this;p===void 0&&(p=[]),u===void 0&&(u=function(i){return i.toString()}),this.items=[],this.map={},this.getHashCode=u,p.forEach(function(i){return s.tryPush(i)})}return P.prototype.tryPush=function(p){var u=this.getHashCode(p);return this.map[u]===void 0&&(this.map[u]=this.items.push(p)-1,!0)},P.prototype.contains=function(p){return this.map[this.getHashCode(p)]!==void 0},P.prototype.forEach=function(p){this.items.forEach(p)},P.prototype.filter=function(p){return this.items.filter(p)},P.prototype.list=function(){return this.items.slice(0)},P.prototype.item=function(p){return this.items[p]},P.prototype.first=function(){return this.items[0]},P.prototype.remove=function(p){var u=this.getHashCode(p),s=this.map[u];if(typeof s!="number")throw"Item not found";delete this.map[u],this.items.splice(s,1);for(var i=s;i<this.items.length;i++)this.map[this.getHashCode(this.items[i])]--},Object.defineProperty(P.prototype,"length",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),P}();h.HashSet=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeDescriptionManager=void 0;var m=d(202),P=d(203),p=d(204),u=d(205),s=d(206),i=d(207),t=d(208),e=d(209),n=d(210),o=d(211),r=d(120),a=d(72),c=d(212),l=d(19),y=d(121),g=d(122),f=d(123),v=d(213),C=d(214),b=d(215),S=d(216),x=d(217),I=d(124),w=d(125),_=d(218),T=d(219),R=d(220),E=d(221),D=d(222),L=d(223),H=d(224),O=d(225),z=d(226),K=d(227),A=d(228),M=d(229),U=d(230),V=d(126),G=d(232),Y=d(233),tt=d(234),W=d(1),N=d(236),k=d(3),B=d(237),F=function(){function Z(){this.descriptions={},this.descriptionTypes={},this.descriptionCategories={},this.onShapeDecriptionChanged=new k.EventDispatcher,this.register(new y.TextShapeDescription,W.ShapeCategories.General),this.register(new l.RectangleShapeDescription,W.ShapeCategories.General),this.register(new a.EllipseShapeDescription,W.ShapeCategories.General),this.register(new o.CrossShapeDescription,W.ShapeCategories.General),this.register(new I.TriangleShapeDescription,W.ShapeCategories.General),this.register(new r.DiamondShapeDescription,W.ShapeCategories.General),this.register(new c.HeartShapeDescription,W.ShapeCategories.General),this.register(new g.PentagonShapeDescription,W.ShapeCategories.General),this.register(new f.HexagonShapeDescription,W.ShapeCategories.General),this.register(new v.OctagonShapeDescription,W.ShapeCategories.General),this.register(new C.StarShapeDescription,W.ShapeCategories.General),this.register(new n.ArrowUpShapeDescription,W.ShapeCategories.General),this.register(new b.ArrowDownShapeDescription,W.ShapeCategories.General),this.register(new x.ArrowLeftShapeDescription,W.ShapeCategories.General),this.register(new e.ArrowRightShapeDescription,W.ShapeCategories.General),this.register(new t.ArrowUpDownShapeDescription,W.ShapeCategories.General),this.register(new S.ArrowLeftRightShapeDescription,W.ShapeCategories.General),this.register(new m.ProcessShapeDescription,W.ShapeCategories.Flowchart),this.register(new P.DecisionShapeDescription,W.ShapeCategories.Flowchart),this.register(new s.TerminatorShapeDescription,W.ShapeCategories.Flowchart),this.register(new i.PredefinedProcessShapeDescription,W.ShapeCategories.Flowchart),this.register(new w.DocumentShapeDescription,W.ShapeCategories.Flowchart),this.register(new _.MultipleDocumentsShapeDescription,W.ShapeCategories.Flowchart),this.register(new p.ManualInputShapeDescription,W.ShapeCategories.Flowchart),this.register(new T.PreparationShapeDescription,W.ShapeCategories.Flowchart),this.register(new u.DataShapeDescription,W.ShapeCategories.Flowchart),this.register(new E.DatabaseShapeDescription,W.ShapeCategories.Flowchart),this.register(new R.HardDiskShapeDescription,W.ShapeCategories.Flowchart),this.register(new D.InternalStorageShapeDescription,W.ShapeCategories.Flowchart),this.register(new L.PaperTapeShapeDescription,W.ShapeCategories.Flowchart),this.register(new H.ManualOperationShapeDescription,W.ShapeCategories.Flowchart),this.register(new O.DelayShapeDescription,W.ShapeCategories.Flowchart),this.register(new z.StoredDataShapeDescription,W.ShapeCategories.Flowchart),this.register(new A.DisplayShapeDescription,W.ShapeCategories.Flowchart),this.register(new K.MergeShapeDescription,W.ShapeCategories.Flowchart),this.register(new N.ConnectorShapeDescription,W.ShapeCategories.Flowchart),this.register(new M.OrShapeDescription,W.ShapeCategories.Flowchart),this.register(new U.SummingJunctionShapeDescription,W.ShapeCategories.Flowchart),this.register(new B.CardWithImageOnLeftDescription,W.ShapeCategories.OrgChart),this.register(new B.CardWithImageOnRightDescription,W.ShapeCategories.OrgChart),this.register(new tt.CardWithImageOnTopDescription,W.ShapeCategories.OrgChart),this.register(new G.VerticalContainerDescription,W.ShapeCategories.Containers),this.register(new Y.HorizontalContainerDescription,W.ShapeCategories.Containers)}return Object.defineProperty(Z,"default",{get:function(){return Z.defaultInstance},enumerable:!1,configurable:!0}),Object.defineProperty(Z,"defaultContainer",{get:function(){return Z.defaultContainerInstance},enumerable:!1,configurable:!0}),Z.prototype.get=function(q){return this.descriptions[q]},Z.prototype.getTypesByCategory=function(q){return this.descriptionTypes[q]||[]},Z.prototype.getCategoryByType=function(q){return this.descriptionCategories[q]},Z.prototype.getCategoryByDescription=function(q){return this.getCategoryByType(q.key)},Z.prototype.register=function(q,J,$){if($===void 0&&($=q.key),this.descriptions[$]!==void 0)throw Error("Description key is duplicated");this.descriptions[$]=q,this.descriptionTypes[J]||(this.descriptionTypes[J]=[]),this.descriptionTypes[J].push($),this.descriptionCategories[$]=J,q.onChanged.add(this)},Z.prototype.registerCustomShape=function(q){if(q.type===void 0)throw Error("Custom shape type is not defined");if(this.descriptions[q.type]!==void 0)throw Error("Custom shape type is duplicated");var J=q.baseType&&this.descriptions[q.baseType];q.minWidth>q.maxWidth&&(q.maxWidth=q.minWidth),q.minHeight>q.maxHeight&&(q.maxHeight=q.minHeight),this.register(new V.CustomShapeDescription(q,J),q.category||W.ShapeCategories.Custom)},Z.prototype.unregisterCustomShape=function(q){var J=this.descriptions[q];if(J instanceof V.CustomShapeDescription){J.onChanged.remove(this);var $=this.descriptionCategories[q];delete this.descriptions[q],delete this.descriptionCategories[q];var Q=this.descriptionTypes[$].indexOf(q);this.descriptionTypes[$].splice(Q,1),this.descriptionTypes[$].length===0&&delete this.descriptionTypes[$]}},Z.prototype.unregisterAllCustomShapes=function(){var q=this;Object.keys(this.descriptions).forEach(function(J){q.unregisterCustomShape(J)})},Z.prototype.notifyShapeDescriptionChanged=function(q){this.onShapeDecriptionChanged.raise1(function(J){return J.notifyShapeDescriptionChanged(q)})},Z.defaultInstance=new l.RectangleShapeDescription,Z.defaultContainerInstance=new G.VerticalContainerDescription,Z}();h.ShapeDescriptionManager=F},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowVerticalShapeDescription=h.ArrowVerticalLineWidthParameterName=h.ArrowVerticalTriangleHeightParameterName=void 0;var p=d(7),u=d(2),s=d(37),i=d(9);h.ArrowVerticalTriangleHeightParameterName="th",h.ArrowVerticalLineWidthParameterName="lw";var t=function(e){function n(){return e.call(this,new u.Size(.375*p.ShapeDefaultDimension,p.ShapeDefaultDimension))||this}return P(n,e),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createParameters=function(o){o.addRange([new s.ShapeParameter(h.ArrowVerticalTriangleHeightParameterName,Math.sqrt(Math.pow(this.defaultSize.width,2)-Math.pow(this.defaultSize.width/2,2))),new s.ShapeParameter(h.ArrowVerticalLineWidthParameterName,this.defaultSize.width/3)])},n.prototype.normalizeParameters=function(o,r){this.changeParameterValue(r,h.ArrowVerticalTriangleHeightParameterName,function(a){return Math.max(0,Math.min(o.size.height,a.value))}),this.changeParameterValue(r,h.ArrowVerticalLineWidthParameterName,function(a){return Math.max(0,Math.min(o.size.width,a.value))})},n.prototype.processConnectionPoint=function(o,r){var a=(o.size.width-o.parameters.get(h.ArrowVerticalLineWidthParameterName).value)/2,c=o.getConnectionPointSide(r);c===i.ConnectionPointSide.East?r.x-=a:c===i.ConnectionPointSide.West&&(r.x+=a)},n.prototype.getTextRectangle=function(o){return o.rectangle.clone().inflate(-p.ShapeTextPadding,-p.ShapeTextPadding)},n.prototype.getSizeByText=function(o,r){return o.clone().offset(2*p.ShapeTextPadding,2*p.ShapeTextPadding)},n}(p.ShapeDescription);h.ArrowVerticalShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowHorizontalShapeDescription=h.ArrowVerticalLineHeightParameterName=h.ArrowVerticalTriangleWidthParameterName=void 0;var p=d(7),u=d(2),s=d(37),i=d(9);h.ArrowVerticalTriangleWidthParameterName="tw",h.ArrowVerticalLineHeightParameterName="lh";var t=function(e){function n(){return e.call(this,new u.Size(p.ShapeDefaultDimension,.375*p.ShapeDefaultDimension))||this}return P(n,e),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createParameters=function(o){o.addRange([new s.ShapeParameter(h.ArrowVerticalTriangleWidthParameterName,Math.sqrt(Math.pow(this.defaultSize.height,2)-Math.pow(this.defaultSize.height/2,2))),new s.ShapeParameter(h.ArrowVerticalLineHeightParameterName,this.defaultSize.height/3)])},n.prototype.normalizeParameters=function(o,r){this.changeParameterValue(r,h.ArrowVerticalTriangleWidthParameterName,function(a){return Math.max(0,Math.min(o.size.width,a.value))}),this.changeParameterValue(r,h.ArrowVerticalLineHeightParameterName,function(a){return Math.max(0,Math.min(o.size.height,a.value))})},n.prototype.processConnectionPoint=function(o,r){var a=(o.size.height-o.parameters.get(h.ArrowVerticalLineHeightParameterName).value)/2,c=o.getConnectionPointSide(r);c===i.ConnectionPointSide.North?r.y+=a:c===i.ConnectionPointSide.South&&(r.y-=a)},n.prototype.getTextRectangle=function(o){return o.rectangle.clone().inflate(-p.ShapeTextPadding,-p.ShapeTextPadding)},n.prototype.getSizeByText=function(o,r){return o.clone().offset(2*p.ShapeTextPadding,2*p.ShapeTextPadding)},n}(p.ShapeDescription);h.ArrowHorizontalShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.PolygonShapeDescription=void 0;var p=d(7),u=function(s){function i(t){var e=s.call(this,void 0,t)||this;return e.defaultSize.height=e.calculateHeight(p.ShapeDefaultDimension),e}return P(i,s),Object.defineProperty(i.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return Math.PI*(this.angleCount-2)/this.angleCount},enumerable:!1,configurable:!0}),i}(p.ShapeDescription);h.PolygonShapeDescription=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ImportUtils=void 0;var m=function(){function P(){}return P.parseJSON=function(p){if(!p||p==="")return{};try{return JSON.parse(p)}catch{return{}}},P.createDocument=function(p){return new DOMParser().parseFromString(p,"application/xml")},P}();h.ImportUtils=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStyleTextPropertyCommand=void 0;var p=d(135),u=d(70),s=d(26),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentTextStylePropertyValue(this.getStyleProperty())},e.prototype.getStyleObj=function(n){return n.styleText},e.prototype.getDefaultStyleObj=function(){return new s.TextStyle},e.prototype.createHistoryItem=function(n,o,r){return new u.ChangeStyleTextHistoryItem(n.key,o,r)},e.prototype.updateInputPosition=function(n){this.control.selection.inputPosition.setTextStylePropertyValue(this.getStyleProperty(),n)},e}(p.ChangeStylePropertyCommandBase);h.ChangeStyleTextPropertyCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.TreeLayoutBuilder=void 0;var p=d(138),u=d(252),s=d(71),i=d(3),t=d(0),e=d(139),n=d(38),o=d(9),r=d(20),a=d(54),c=function(l){function y(){var g=l!==null&&l.apply(this,arguments)||this;return g.nodeToLevel={},g.levelDepthSize={},g}return P(y,l),y.prototype.build=function(){var g=this,f=new p.GraphLayout,v=0;return this.graph.getConnectedComponents().forEach(function(C){for(var b=u.Tree.createSpanningTree(C),S=g.processTree(b),x=g.getComponentOffset(S);S.nodeKeys.length<C.nodes.length;){var I=new a.Graph(C.nodes.filter(function(T){return!S.nodeToLayout[T]}).map(function(T){return C.getNode(T)}),C.edges.filter(function(T){return!S.edgeToPosition[T.key]})),w=u.Tree.createSpanningTree(I),_=g.processTree(w);S.extend(g.setComponentOffset(_,x)),x+=g.getComponentOffset(_)}f.extend(g.setComponentOffset(S,v)),v+=g.getComponentOffset(S)}),f},y.prototype.preProcessTree=function(g,f,v){var C=this;if((f=f.filter(function(S){return(C.nodeToLevel[S.key]===void 0?C.nodeToLevel[S.key]=v:-1)>=0})).length){var b=this.getMaxDepthSize(f);this.levelDepthSize[v]=b,this.preProcessTree(g,[].concat.apply([],f.map(function(S){return g.getChildren(S)})),v+1)}},y.prototype.loadNodes=function(g,f,v){return v?g.getChildren(v.info).map(function(C){return f.hasNode(C.key)?void 0:f.addNode(new s.NodeLayout(C,t.Point.zero()))}).filter(function(C){return C}):[f.addNode(new s.NodeLayout(g.root,t.Point.zero()))]},y.prototype.processTree=function(g){var f=this,v=new p.GraphLayout;if(this.preProcessTree(g,[g.root],0),this.processLevel(g,v,0,new i.Range(0),0),this.settings.direction===r.LogicalDirectionKind.Backward){var C=Object.keys(this.levelDepthSize).map(function(S){return f.levelDepthSize[S]}),b=C.reduce(function(S,x){return S+x},0)+(C.length-1)*this.settings.layerSpacing;v.forEachNode(function(S){return f.setDepthPos(S,f.getDepthPos(S)+b)})}return v},y.prototype.processLevel=function(g,f,v,C,b,S){var x,I=this,w=this.addNodes(g,f,b,S),_=S?this.graph.getAdjacentEdges(S.key,n.ConnectionMode.Outgoing):[],T=this.getDirectionValue(this.levelDepthSize[b]),R=this.getDirectionValue(this.settings.layerSpacing);if(w.forEach(function(L){var H=i.Range.fromLength(x?x.to+I.settings.columnSpacing:C.from,I.getBreadthNodeSizeCore(L.info));L.position=I.getNodePosition(H.from,v,T).clone().offset(L.info.margin.left,L.info.margin.top),I.processLevel(g,f,v+T+R,H,b+1,L),I.updateEdgeConnections(f,_,L),C.extend(H),x=H}),S&&w.length){var E=w[w.length-1],D=new i.Range(this.getBreadthPos(w[0]),this.getBreadthPos(E)+this.getBreadthNodeSizeCore(E.info,!0));this.alignParent(S,D,C)}},y.prototype.addNodes=function(g,f,v,C){var b=this;return v===0?[f.addNode(new s.NodeLayout(g.root,t.Point.zero()))]:g.getChildren(C.info).reduce(function(S,x){return b.nodeToLevel[x.key]!==v||f.hasNode(x.key)||S.push(f.addNode(new s.NodeLayout(x,t.Point.zero()))),S},[])},y.prototype.getMaxDepthSize=function(g){var f=this;return g.reduce(function(v,C){return Math.max(v,f.getDepthNodeSizeCore(C))},0)},y.prototype.getNodePosition=function(g,f,v){return this.settings.direction===r.LogicalDirectionKind.Forward?this.settings.orientation===r.DataLayoutOrientation.Vertical?new t.Point(g,f):new t.Point(f,g):this.settings.orientation===r.DataLayoutOrientation.Vertical?new t.Point(g,f+v):new t.Point(f+v,g)},y.prototype.updateEdgeConnections=function(g,f,v){var C=this;f.filter(function(b){return b.to===v.key}).forEach(function(b){var S=C.getBeginEdgeIndex(),x=C.getEndEdgeIndex();g.addEdge(new s.EdgeLayout(b.key,S,x))})},y.prototype.getBeginEdgeIndex=function(){return this.settings.direction===r.LogicalDirectionKind.Forward?this.isVertical()?o.ConnectionPointSide.South:o.ConnectionPointSide.East:this.isVertical()?o.ConnectionPointSide.North:o.ConnectionPointSide.West},y.prototype.getEndEdgeIndex=function(){return this.settings.direction===r.LogicalDirectionKind.Forward?this.isVertical()?o.ConnectionPointSide.North:o.ConnectionPointSide.West:this.isVertical()?o.ConnectionPointSide.South:o.ConnectionPointSide.East},y.prototype.alignParent=function(g,f,v){if(this.settings.alignment===r.Alignment.Center){var C=f.from+f.length/2-this.getBreadthNodeSizeCore(g.info,!0)/2;this.settings.orientation===r.DataLayoutOrientation.Vertical?(g.position.x=Math.max(v.from+g.info.margin.left,C),g.position.x=Math.min(v.to-g.info.size.width-g.info.margin.right,g.position.x)):(g.position.y=Math.max(v.from+g.info.margin.top,C),g.position.y=Math.min(v.to-g.info.size.height-g.info.margin.bottom,g.position.y))}},y.prototype.getDepthPos=function(g){return this.settings.orientation===r.DataLayoutOrientation.Vertical?g.position.y:g.position.x},y.prototype.getBreadthPos=function(g){return this.settings.orientation===r.DataLayoutOrientation.Vertical?g.position.x:g.position.y},y.prototype.setDepthPos=function(g,f){this.settings.orientation===r.DataLayoutOrientation.Vertical?g.position.y=f:g.position.x=f},y.prototype.isVertical=function(){return this.settings.orientation===r.DataLayoutOrientation.Vertical},y}(e.LayoutBuilder);h.TreeLayoutBuilder=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(a,c){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var g in y)y.hasOwnProperty(g)&&(l[g]=y[g])})(a,c)},function(a,c){function l(){this.constructor=a}m(a,c),a.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportImageCommand=void 0;var p=d(78),u=d(260),s=d(57),i=d(73),t=d(15),e=d(79),n=d(100),o=d(46),r=function(a){function c(l){var y=a.call(this,l)||this;return y.exporter=new i.Exporter,y}return P(c,a),c.prototype.isEnabled=function(){return!o.ImageCache.instance.hasNonLoadedImages()},c.prototype.executeCore=function(l,y){var g=this;try{var f=this.getExportManager();this.getExportFunc()(this.control.model.size.clone(),this.control.model.pageColor,f,function(v){y(v,g.getExtension()),g.tryDispose()},this.control.settings.useCanvgForExportToImage)}catch(v){throw this.tryDispose(),v}return!0},c.prototype.getExportManager=function(){var l=this.getOrCreateMeasurer(),y=this.control.render&&this.control.render.items||this.createItemsManager(l);return this.exportManager||(this.exportManager=new u.CanvasExportManager(y.itemsContainer,l))},c.prototype.createItemsManager=function(l){this.svgElement=t.RenderHelper.createSvgElement(document.body,!0);var y=new p.CanvasItemsManager(this.svgElement,1,new n.ExportDOMManipulator(l));return this.control.modelManipulator.onModelChanged.add(y),this.control.modelManipulator.commitItemsCreateChanges(),y},c.prototype.tryDispose=function(){this.svgElement&&(document.body.removeChild(this.svgElement),delete this.svgElement),this.tempMeasurer&&(this.tempMeasurer.clean(),this.tempMeasurer=void 0),this.exportManager=void 0},c.prototype.getOrCreateMeasurer=function(){return this.control.measurer||(this.tempMeasurer=new e.TextMeasurer(document.body))},c}(s.ExportImportCommandBase);h.ExportImageCommand=r},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ItemChange=h.ItemChangeType=void 0,function(P){P[P.Create=0]="Create",P[P.UpdateProperties=1]="UpdateProperties",P[P.UpdateStructure=2]="UpdateStructure",P[P.Update=3]="Update",P[P.Remove=4]="Remove",P[P.UpdateClassName=5]="UpdateClassName"}(h.ItemChangeType||(h.ItemChangeType={}));var m=function(){function P(p,u,s){s===void 0&&(s=!0),this.item=p,this.type=u,this.isValid=s}return Object.defineProperty(P.prototype,"key",{get:function(){return this.item.key},enumerable:!1,configurable:!0}),P}();h.ItemChange=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportDOMManipulator=h.DOMManipulator=void 0;var p=d(61),u=function(){function i(t){this.measurer=t,this.queue=[]}return i.prototype.createElement=function(t,e,n){return t.createElement(function(o){e!=null&&(n!==void 0?e.insertBefore(o,n):e.appendChild(o))})},i.prototype.changeChildrenByPrimitives=function(t,e){var n=this;t.forEach(function(o,r){var a=e.childNodes[r];n.changeByPrimitive(a,o)})},i.prototype.changeByFunc=function(t,e){this.doChange(t,e)},i.prototype.changeByPrimitive=function(t,e){this.doChange(t,e)},i.prototype.cancelAnimation=function(){this.rafId!==void 0&&(cancelAnimationFrame(this.rafId),this.queue=[])},i.prototype.doChange=function(t,e){p.Diagnostics.optimizeUsingRAF?(this.queue.push([t,e]),this.requestAnimation()):this.doChangeSync(t,e)},i.prototype.doChangeSync=function(t,e){typeof e=="function"?e(t):e.applyElementProperties(t,this.measurer)},i.prototype.requestAnimation=function(){var t=this;if(!this.rafRequested){this.rafRequested=!0;var e=function(){t.queue.splice(0,2e3).forEach(function(n){return t.doChangeSync(n[0],n[1])}),t.queue.length?t.rafId=requestAnimationFrame(e):(t.rafRequested=!1,t.rafId=void 0)};this.rafId=requestAnimationFrame(e)}},i}();h.DOMManipulator=u;var s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.doChange=function(e,n){this.doChangeSync(e,n)},t}(u);h.ExportDOMManipulator=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ClipboardCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.setClipboardData=function(i){this.control.render&&this.control.render.input.setClipboardData(i),s.clipboardData=i},s.prototype.getClipboardData=function(i){this.control.render&&this.isPasteSupportedByBrowser()?this.control.render.input.getClipboardData(i):i(s.clipboardData)},s.prototype.isPasteSupportedByBrowser=function(){return this.control.render&&this.control.render.input.isPasteSupportedByBrowser()},s}(d(10).SimpleCommandBase);h.ClipboardCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeZindexHistoryItem=void 0;var p=function(u){function s(i,t){var e=u.call(this)||this;return e.itemKey=i.key,e.zIndex=t,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey);this.oldZIndex=t.zIndex,i.changeZIndex(t,this.zIndex)},s.prototype.undo=function(i){var t=i.model.findItem(this.itemKey);i.changeZIndex(t,this.oldZIndex)},s}(d(8).HistoryItem);h.ChangeZindexHistoryItem=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DataLayoutParameters=h.DataLayoutType=void 0;var m,P=d(20),p=d(97),u=d(80);(function(i){i[i.Tree=0]="Tree",i[i.Sugiyama=1]="Sugiyama"})(m=h.DataLayoutType||(h.DataLayoutType={}));var s=function(){function i(t,e){this.sizeSettings=t,e&&(e.type!==void 0&&(this.layoutType=e.type,this.layoutSettings=this.layoutType===m.Sugiyama?new P.LayoutSettings:new P.TreeLayoutSettings),e.orientation!==void 0&&(this.layoutSettings.orientation=e.orientation),this.skipPointIndices=e.skipPointIndices,this.autoSizeEnabled=e.autoSizeEnabled)}return Object.defineProperty(i.prototype,"needAutoLayout",{get:function(){return this.layoutType!==void 0},enumerable:!1,configurable:!0}),i.prototype.getLayoutBuilder=function(t){return this.layoutType===m.Tree?new p.TreeLayoutBuilder(this.layoutSettings,t):new u.SugiyamaLayoutBuilder(this.layoutSettings,t)},i}();h.DataLayoutParameters=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.EditShapeImageCommandBase=void 0;var p=d(146),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabled=function(){var t=this.getSelectedShape();return s.prototype.isEnabled.call(this)&&!!t&&!t.locked&&t.enableImage&&t.allowEditImage},i.prototype.getValue=function(){var t=this.getSelectedShape();return t?t.image.exportUrl:void 0},i.prototype.getSelectedShape=function(){var t=this.control.selection.getSelectedShapes(!0);return t.length===1?t[0]:void 0},i.prototype.executeCore=function(t,e){this.control.history.beginTransaction();var n=this.control.selection.getSelectedShapes(!1);return this.control.history.addAndRedo(new p.ChangeShapeImageHistoryItem(n[0],e)),this.control.history.endTransaction(),!0},i}(d(10).SimpleCommandBase);h.EditShapeImageCommandBase=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(165),P=d(166),p=function(){function u(){}return u.remove=function(s,i){var t=s.indexOf(i,0);t>=0&&s.splice(t,1)},u.removeBy=function(s,i){for(var t=s.length,e=0;e<t;e++)if(i(s[e],e))return s.splice(e,1)[0];return null},u.shallowCopy=function(s){return s.slice()},u.deepCopy=function(s){return u.map(s,function(i){return i.clone()})},u.initByValue=function(s,i){for(var t=[];s>0;s--)t.push(i);return t},u.initByCallback=function(s,i){for(var t=[],e=0;e<s;e++)t.push(i(e));return t},u.forEachOnInterval=function(s,i){for(var t=s.end,e=s.start;e<t;e++)i(e)},u.reverseForEachOnInterval=function(s,i){for(var t=s.start,e=s.end-1;e>=t;e--)i(e)},u.reducedMap=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=[],o=t;o<e;o++){var r=i(s[o],o);r!==null&&n.push(r)}return n},u.filter=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=[],o=t;o<e;o++){var r=s[o];i(r,o)&&n.push(r)}return n},u.map=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=[],o=t;o<e;o++)n.push(i(s[o],o));return n},u.indexBy=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=t;n<e;n++)if(i(s[n],n))return n;return-1},u.reverseIndexBy=function(s,i,t,e){t===void 0&&(t=s.length-1),e===void 0&&(e=0);for(var n=t;n>=e;n--)if(i(s[n],n))return n;return-1},u.elementBy=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);var n=u.indexBy(s,i,t,e);return n<0?null:s[n]},u.reverseElementBy=function(s,i,t,e){t===void 0&&(t=s.length-1),e===void 0&&(e=0);var n=u.reverseIndexBy(s,i,t,e);return n<0?null:s[n]},u.last=function(s){return s[s.length-1]},u.setLast=function(s,i){return s[s.length-1]=i},u.incLast=function(s){return++s[s.length-1]},u.decLast=function(s){return--s[s.length-1]},u.equals=function(s,i){return s.length===i.length&&u.allOf2(s,i,function(t,e){return t.equals(e)})},u.equalsByReference=function(s,i){var t=s.length;if(t!==s.length)return!1;for(var e=0;e<t;e++)if(s[e]!==i[e])return!1;return!0},u.unique=function(s,i,t,e){t===void 0&&(t=i),e===void 0&&(e=function(){});var n=s.length;if(n===0)return[];var o=(s=s.sort(i))[0],r=u.reducedMap(s,function(a){return t(o,a)!==0?(o=a,a):(e(a),null)},1,n);return r.unshift(s[0]),r},u.uniqueNumber=function(s){s=s.sort(P.Comparers.number);for(var i=Number.NaN,t=s.length-1;t>=0;t--)i===s[t]?s.splice(t,1):i=s[t];return s},u.forEach=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=t;n<e;n++)i(s[n],n)},u.forEach2=function(s,i,t,e,n){e===void 0&&(e=0),n===void 0&&(n=s.length);for(var o=e;o<n;o++)t(s[o],i[o],o)},u.reverseForEach=function(s,i,t,e){t===void 0&&(t=s.length-1),e===void 0&&(e=0);for(var n=t;n>=e;n--)i(s[n],n)},u.reverseIndexOf=function(s,i,t,e){t===void 0&&(t=s.length-1),e===void 0&&(e=0);for(var n=t;n>=e;n--)if(s[n]===i)return n;return-1},u.accumulate=function(s,i,t,e,n){e===void 0&&(e=0),n===void 0&&(n=s.length);for(var o=i,r=e;r<n;r++)o=t(o,s[r],r);return o},u.accumulateNumber=function(s,i,t,e,n){t===void 0&&(t=0),e===void 0&&(e=0),n===void 0&&(n=s.length);for(var o=t,r=e;r<n;r++)o+=i(s[r],r,o);return o},u.anyOf=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=t;n<e;n++)if(i(s[n],n))return!0;return!1},u.unsafeAnyOf=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=t;n<e;n++){var o=i(s[n],n);if(o)return o}return null},u.reverseAnyOf=function(s,i,t,e){t===void 0&&(t=s.length-1),e===void 0&&(e=0);for(var n=t;n>=e;n--)if(i(s[n],n))return!0;return!1},u.unsafeReverseAnyOf=function(s,i,t,e){t===void 0&&(t=s.length-1),e===void 0&&(e=0);for(var n=t;n>=e;n--){var o=i(s[n],n);if(o)return o}return null},u.anyOf2=function(s,i,t,e,n){e===void 0&&(e=0),n===void 0&&(n=s.length);for(var o=e;o<n;o++)if(t(s[o],i[o],o))return!0;return!1},u.allOf=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);for(var n=t;n<e;n++)if(!i(s[n],n))return!1;return!0},u.allOf2=function(s,i,t,e,n){e===void 0&&(e=0),n===void 0&&(n=s.length);for(var o=e;o<n;o++)if(!t(s[o],i[o],o))return!1;return!0},u.allOfOnInterval=function(s,i){for(var t=s.end,e=s.start;e<t;e++)if(!i(e))return!1;return!0},u.addListOnTail=function(s,i){for(var t=0,e=void 0;e=i[t];t++)s.push(e);return s},u.joinLists=function(s){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return u.accumulate(i,[],function(e,n){return u.addListOnTail(e,s(n)),e})},u.push=function(s,i){return s.push(i),s},u.countIf=function(s,i){return u.accumulateNumber(s,function(t,e){return i(t,e)?1:0})},u.clear=function(s){s.splice(0)},u.merge=function(s,i,t,e,n,o){if(n===void 0&&(n=0),o===void 0&&(o=s.length),s=s.slice(n,o),o-n<2)return s;for(var r=(s=s.sort(i))[n],a=[r],c=n+1;c<o;c++){var l=s[c];t(r,l)?e(r,l):(r=l,a.push(r))}return a},u.min=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);var n=u.minExtended(s,i,t,e);return n?n.minElement:null},u.max=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);var n=u.maxExtended(s,i,t,e);return n?n.maxElement:null},u.minMax=function(s,i,t,e){t===void 0&&(t=0),e===void 0&&(e=s.length);var n=u.minMaxExtended(s,i,t,e);return n?new m.MinMax(n.minElement,n.maxElement):null},u.minExtended=function(s,i,t,e){if(t===void 0&&(t=0),e===void 0&&(e=s.length),s.length===0)return null;for(var n=s[t],o=i(n),r=t+1;r<e;r++){var a=s[r],c=i(a);c<o&&(o=c,n=a)}return new m.ExtendedMin(n,o)},u.maxExtended=function(s,i,t,e){if(t===void 0&&(t=0),e===void 0&&(e=s.length),s.length===0)return null;for(var n=s[t],o=i(n),r=t+1;r<e;r++){var a=s[r],c=i(a);c>o&&(o=c,n=a)}return new m.ExtendedMax(n,o)},u.minMaxExtended=function(s,i,t,e){if(t===void 0&&(t=0),e===void 0&&(e=s.length),s.length===0)return null;for(var n=s[t],o=n,r=i(n),a=r,c=t+1;c<e;c++){var l=s[c],y=i(l);y<r?(r=y,n=l):y>a&&(a=y,o=l)}return new m.ExtendedMinMax(n,r,o,a)},u.minByCmp=function(s,i,t,e){if(t===void 0&&(t=0),e===void 0&&(e=s.length),s.length===0)return null;for(var n=s[t],o=t+1;o<e;o++){var r=s[o];i(r,n)<0&&(n=r)}return n},u.maxByCmp=function(s,i,t,e){if(t===void 0&&(t=0),e===void 0&&(e=s.length),s.length===0)return null;for(var n=s[t],o=t+1;o<e;o++){var r=s[o];i(r,n)>0&&(n=r)}return n},u.minMaxByCmp=function(s,i,t,e){if(t===void 0&&(t=0),e===void 0&&(e=s.length),s.length===0)return null;for(var n=s[t],o=n,r=t+1;r<e;r++){var a=s[r],c=i(a,n);c>0?o=a:c<0&&(n=a)}return new m.MinMax(n,o)},u}();h.ListUtils=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(59),P=function(p){function u(s,i){var t=p.call(this)||this;return t.start=s,t.length=i,t}return m.__extends(u,p),Object.defineProperty(u.prototype,"end",{get:function(){return this.start+this.length},set:function(s){this.length=s-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"center",{get:function(){return this.start+this.length/2},enumerable:!0,configurable:!0}),u.prototype.copyFrom=function(s){this.start=s.start,this.length=s.length},u.prototype.equals=function(s){return s&&this.start===s.start&&this.length===s.length},u.prototype.clone=function(){return new u(this.start,this.length)},u.prototype.makeByStartEnd=function(s,i){return new u(s,i-s)},u.prototype.makeByStartLength=function(s,i){return new u(s,i)},u.prototype.makeByLengthEnd=function(s,i){return new u(i-s,s)},u.fromPositions=function(s,i){return new u(s,i-s)},u.makeByConstInterval=function(s){return new u(s.start,s.length)},u.prototype.expand=function(s){var i=Math.max(s.end,this.end);return this.start=Math.min(s.start,this.start),this.end=i,this},u}(d(167).MutableInterval);h.FixedInterval=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(p){this.sparseIntervals=p,this.intervalIndex=-1}return Object.defineProperty(P.prototype,"isStarted",{get:function(){return!!this.curr},enumerable:!0,configurable:!0}),P.prototype.moveNext=function(){return this.curr&&this.posInInterval+1<this.curr.length?(this.posInInterval++,this.index++,this.initObject(),!0):this.intervalIndex+1<this.sparseIntervals.numIntervals&&(this.intervalIndex++,this.curr=this.sparseIntervals.getInterval(this.intervalIndex),this.curr.length?(this.posInInterval=0,this.index=this.curr.start,this.initObject(),!0):this.moveNext())},P.prototype.movePrev=function(){return this.curr&&this.posInInterval-1>=this.curr.start?(this.posInInterval--,this.index--,this.initObject(),!0):(this.isStarted||(this.intervalIndex=this.sparseIntervals.numIntervals),this.intervalIndex-1>=0&&(this.intervalIndex--,this.curr=this.sparseIntervals.getInterval(this.intervalIndex),this.posInInterval=Math.max(this.curr.length-1,this.curr.start),this.index=this.curr.start,this.initObject(),!0))},P.prototype.initObject=function(){},P}();h.SparseIntervalsIterator=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.FilterPrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r){var a=s.call(this)||this;return a.id=t,a.x=e,a.y=n,a.width=o,a.height=r,a}return P(i,s),i.prototype.createMainElement=function(){var t=document.createElementNS(p.svgNS,"filter");return t.setAttribute("id",this.id),t},i.prototype.applyElementProperties=function(t,e){this.id&&t.setAttribute("id",this.id),this.setUnitAttribute(t,"x",this.x),this.setUnitAttribute(t,"y",this.y),this.setUnitAttribute(t,"width",this.width),this.setUnitAttribute(t,"height",this.height),this.setPositionCorrectionAttribute(t),s.prototype.applyElementProperties.call(this,t,e)},i}(d(24).SvgPrimitive);h.FilterPrimitive=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PrimitiveObject=void 0;var m=d(12),P=function(){function p(u){this.style=u}return Object.defineProperty(p.prototype,"strokeWidthPx",{get:function(){return this.style?this.style.strokeWidthPx:0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"strokeOffset",{get:function(){return this.style?this.style.strokeOffset:0},enumerable:!1,configurable:!0}),p.prototype.getUnitVaue=function(u){return typeof u=="number"?m.UnitConverter.twipsToPixels(u).toString():u},p.prototype.setUnitAttribute=function(u,s,i){i!=null&&u.setAttribute(s,this.getUnitVaue(i))},p.prototype.setPositionCorrectionAttribute=function(u){var s=this.strokeWidthPx%2==1?"translate("+this.strokeOffset+", "+this.strokeOffset+")":"";u.setAttribute("transform",s)},p}();h.PrimitiveObject=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.isColorProperty=void 0;var m={stroke:!0,fill:!0};h.isColorProperty=function(P){return m[P]}},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsCalculatorBase=void 0;var m=function(){return function(P){this.connector=P}}();h.ConnectorPointsCalculatorBase=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeShapeParametersHistoryItem=void 0;var p=function(u){function s(i,t){var e=u.call(this)||this;return e.shapeKey=i,e.parameters=t,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findShape(this.shapeKey);this.oldParameters=t.parameters.clone(),i.changeShapeParameters(t,this.parameters)},s.prototype.undo=function(i){var t=i.model.findShape(this.shapeKey);i.changeShapeParameters(t,this.oldParameters)},s}(d(8).HistoryItem);h.ChangeShapeParametersHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteConnectorHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.connectorKey=i,t}return P(s,u),s.prototype.redo=function(i){var t=i.model.findConnector(this.connectorKey);this.connector=t.clone(),i.deleteConnector(t)},s.prototype.undo=function(i){i.addConnector(this.connector,this.connector.key)},s}(d(8).HistoryItem);h.DeleteConnectorHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteShapeHistoryItem=void 0;var p=function(u){function s(i,t){t===void 0&&(t=!0);var e=u.call(this)||this;return e.shapeKey=i,e.allowed=t,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findShape(this.shapeKey);this.shape=t.clone(),i.deleteShape(t,this.allowed)},s.prototype.undo=function(i){i.addShape(this.shape,this.shape.key)},s}(d(8).HistoryItem);h.DeleteShapeHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ResizeShapeHistoryItem=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.shapeKey=i,n.position=t,n.size=e,n}return P(s,u),s.prototype.redo=function(i){var t=i.model.findShape(this.shapeKey);this.oldPosition=t.position.clone(),this.oldSize=t.size.clone(),i.resizeShape(t,this.position,this.size)},s.prototype.undo=function(i){var t=i.model.findShape(this.shapeKey);i.resizeShape(t,this.oldPosition,this.oldSize)},s}(d(8).HistoryItem);h.ResizeShapeHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeCustomDataHistoryItem=void 0;var p=d(8),u=d(3),s=function(i){function t(e,n){var o=i.call(this)||this;return o.itemKey=e,o.customData=u.ObjectUtils.cloneObject(n),o}return P(t,i),t.prototype.redo=function(e){var n=e.model.findItem(this.itemKey);this.oldCustomData=u.ObjectUtils.cloneObject(n.customData),e.changeCustomData(n,this.customData)},t.prototype.undo=function(e){var n=e.model.findItem(this.itemKey);e.changeCustomData(n,this.oldCustomData)},t}(p.HistoryItem);h.ChangeCustomDataHistoryItem=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeLockedHistoryItem=void 0;var p=function(u){function s(i,t){var e=u.call(this)||this;return e.itemKey=i.key,e.locked=t,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey);this.oldLocked=t.locked,i.changeLocked(t,this.locked)},s.prototype.undo=function(i){var t=i.model.findItem(this.itemKey);i.changeLocked(t,this.oldLocked)},s}(d(8).HistoryItem);h.ChangeLockedHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStyleHistoryItemBase=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.itemKey=i,n.styleProperty=t,n.styleValue=e,n}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey);this.oldStyleValue=t.style[this.styleProperty],i.changeStyle(t,this.styleProperty,this.styleValue)},s.prototype.undo=function(i){var t=i.model.findItem(this.itemKey);i.changeStyle(t,this.styleProperty,this.oldStyleValue)},s}(d(8).HistoryItem);h.ChangeStyleHistoryItemBase=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.Importer=void 0;var p=d(14),u=d(3),s=d(2),i=d(0),t=d(91),e=d(6),n=d(51),o=d(133),r=d(95),a=d(22),c=function(l){function y(g,f){var v=l.call(this,g)||this;return v.obj=r.ImportUtils.parseJSON(f),v}return P(y,l),y.prototype.getObject=function(){return this.obj},y.prototype.getPageObject=function(g){return g.page},y.prototype.getShapeObjects=function(g){return g.shapes},y.prototype.getConnectorObjects=function(g){return g.connectors},y.prototype.importPageSettings=function(g,f){f&&(this.assert(f.width,"number"),this.assert(f.height,"number"),typeof f.width=="number"&&(g.size.width=f.width),typeof f.height=="number"&&(g.size.height=f.height),typeof f.pageColor=="number"?g.pageColor=f.pageColor:typeof f.pageColor=="string"&&(g.pageColor=a.ColorUtils.fromString(f.pageColor)),typeof f.pageWidth=="number"&&(g.pageSize.width=f.pageWidth),typeof f.pageHeight=="number"&&(g.pageSize.height=f.pageHeight),typeof f.pageLandscape=="boolean"&&(g.pageLandscape=f.pageLandscape))},y.prototype.importShape=function(g){this.assert(g.key,"string"),this.assert(g.x,"number"),this.assert(g.y,"number"),this.assert(g.type,"string");var f=g.type,v=this.shapeDescriptionManager.get(f),C=new i.Point(g.x,g.y),b=new p.Shape(v||t.ShapeDescriptionManager.default,C);return b.key=g.key,typeof g.dataKey!="string"&&typeof g.dataKey!="number"||(b.dataKey=g.dataKey),typeof g.customData=="object"&&(b.customData=u.ObjectUtils.cloneObject(g.customData)),typeof g.locked=="boolean"&&(b.locked=g.locked),typeof g.width=="number"&&(b.size.width=g.width),typeof g.height=="number"&&(b.size.height=g.height),typeof g.text=="string"&&(b.text=g.text),typeof g.imageUrl=="string"&&(b.image=new n.ImageInfo(g.imageUrl)),g.parameters&&(b.parameters.fromObject(g.parameters),b.description.normalizeParameters(b,b.parameters)),g.style&&b.style.fromObject(g.style),g.styleText&&b.styleText.fromObject(g.styleText),typeof g.zIndex=="number"&&(b.zIndex=g.zIndex),Array.isArray(g.childKeys)&&(b.childKeys=g.childKeys.slice()),typeof g.expanded=="boolean"&&(b.expanded=g.expanded),typeof g.expandedWidth=="number"&&typeof g.expandedHeight=="number"&&(b.expandedSize=new s.Size(g.expandedWidth,g.expandedHeight)),b},y.prototype.importShapeChildren=function(g,f){return[]},y.prototype.importConnector=function(g){var f=this;if(this.assert(g.key,"string"),!Array.isArray(g.points))throw Error("Invalid Format");var v=g.points.map(function(b){return f.assert(b.x,"number"),f.assert(b.y,"number"),new i.Point(b.x,b.y)}),C=new e.Connector(v);return C.key=g.key,typeof g.dataKey!="string"&&typeof g.dataKey!="number"||(C.dataKey=g.dataKey),typeof g.customData=="object"&&(C.customData=u.ObjectUtils.cloneObject(g.customData)),typeof g.locked=="boolean"&&(C.locked=g.locked),C.endConnectionPointIndex=typeof g.endConnectionPointIndex=="number"?g.endConnectionPointIndex:-1,C.beginConnectionPointIndex=typeof g.beginConnectionPointIndex=="number"?g.beginConnectionPointIndex:-1,g.endItemKey!==void 0&&this.assert(g.endItemKey,"string"),g.beginItemKey!==void 0&&this.assert(g.beginItemKey,"string"),C.endItemKey=g.endItemKey,C.beginItemKey=g.beginItemKey,g.texts&&C.texts.fromObject(g.texts),g.properties&&C.properties.fromObject(g.properties),g.style&&C.style.fromObject(g.style),g.styleText&&C.styleText.fromObject(g.styleText),typeof g.zIndex=="number"&&(C.zIndex=g.zIndex),C},y}(o.ImporterBase);h.Importer=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.DiamondShapeDescription=void 0;var p=d(7),u=d(5),s=d(1),i=function(t){function e(n,o){return n===void 0&&(n=p.ShapeDefaultSize.clone()),t.call(this,n,o)||this}return P(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return s.ShapeTypes.Diamond},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(n){var o=n.rectangle,r=o.x,a=o.y,c=o.right,l=o.bottom,y=o.center,g=y.x,f=y.y;return[new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(g,a),new u.PathPrimitiveLineToCommand(c,f),new u.PathPrimitiveLineToCommand(g,l),new u.PathPrimitiveLineToCommand(r,f),new u.PathPrimitiveClosePathCommand],n.style)]},e.prototype.getTextRectangle=function(n){return n.rectangle.clone().inflate(-n.size.width/4,-n.size.height/4)},e.prototype.getSizeByText=function(n,o){return n.clone().multiply(2,2)},e}(p.ShapeDescription);h.DiamondShapeDescription=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.TextShapeDescription=void 0;var p=d(7),u=d(2),s=d(1),i=d(56),t=d(21),e=d(17),n=function(o){function r(){var a=o.call(this,new u.Size(p.ShapeDefaultDimension,.5*p.ShapeDefaultDimension),!0)||this;return a.textClipPathId=e.RenderUtils.generateSvgElementId("clipRect"),a}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return s.ShapeTypes.Text},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a,c){if(c){var l=a.rectangle,y=l.x,g=l.y,f=l.width,v=l.height;return[new i.ClipPathPrimitive(this.getTextClipPathId(c),[new t.RectanglePrimitive(y,g,f,v)])]}return[]},r.prototype.getTextClipPathId=function(a){return a?this.textClipPathId:void 0},r.prototype.getSizeByTextRectangle=function(a){return a},r.prototype.getSizeByText=function(a,c){return a.clone()},r.prototype.getTextRectangle=function(a){return a.rectangle},r}(p.ShapeDescription);h.TextShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.PentagonShapeDescription=void 0;var p=d(5),u=d(1),s=d(94),i=d(9),t=d(3),e=d(13),n=function(o){function r(a){var c=o.call(this,a)||this;return c.defaultRatio=c.defaultSize.height/c.defaultSize.width,c}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.Pentagon},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"angleCount",{get:function(){return 5},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.height,b=c.center.x,S=C/v/this.defaultRatio,x=Math.PI-this.angle,I=v/2*Math.tan(x/2)*S,w=y+I,_=(C-I)/Math.tan(x)/S,T=l+_,R=g-_;return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(b,y),new p.PathPrimitiveLineToCommand(g,w),new p.PathPrimitiveLineToCommand(R,f),new p.PathPrimitiveLineToCommand(T,f),new p.PathPrimitiveLineToCommand(l,w),new p.PathPrimitiveClosePathCommand],a.style)]},r.prototype.processConnectionPoint=function(a,c){var l=a.getConnectionPointSide(c);if(l===i.ConnectionPointSide.East||l===i.ConnectionPointSide.West){var y=a.rectangle,g=y.y,f=y.width,v=y.height/f/this.defaultRatio,C=Math.PI-this.angle,b=g+f/2*Math.tan(C/2)*v;(l===i.ConnectionPointSide.East||l===i.ConnectionPointSide.West)&&(c.y=b)}},r.prototype.calculateHeight=function(a){var c=Math.PI-this.angle;return a/2*Math.tan(c/2)+a/2/Math.cos(c/2)*Math.sin(c)},r.prototype.getTextRectangle=function(a){var c=t.GeometryUtils.getMaxRectangleEnscribedInEllipse(a.size);return e.Rectangle.fromGeometry(a.position.clone().offset((a.size.width-c.width)/2,(a.size.height-c.height)/2),c)},r.prototype.getSizeByText=function(a,c){return t.GeometryUtils.getEllipseByEnscribedRectangle(a)},r}(s.PolygonShapeDescription);h.PentagonShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.HexagonShapeDescription=void 0;var p=d(5),u=d(1),s=d(94),i=d(3),t=d(13),e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return u.ShapeTypes.Hexagon},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"angleCount",{get:function(){return 6},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.width,v=a.center.y,C=Math.PI-this.angle,b=f/(1+2*Math.cos(C)),S=c+(f-b)/2,x=S+b;return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(S,l),new p.PathPrimitiveLineToCommand(x,l),new p.PathPrimitiveLineToCommand(y,v),new p.PathPrimitiveLineToCommand(x,g),new p.PathPrimitiveLineToCommand(S,g),new p.PathPrimitiveLineToCommand(c,v),new p.PathPrimitiveClosePathCommand],r.style)]},o.prototype.calculateHeight=function(r){var a=Math.PI-this.angle;return 2*(r/(1+2*Math.cos(a)))*Math.sin(a)},o.prototype.getTextRectangle=function(r){var a=i.GeometryUtils.getMaxRectangleEnscribedInEllipse(r.size);return t.Rectangle.fromGeometry(r.position.clone().offset((r.size.width-a.width)/2,(r.size.height-a.height)/2),a)},o.prototype.getSizeByText=function(r,a){return i.GeometryUtils.getEllipseByEnscribedRectangle(r)},o}(s.PolygonShapeDescription);h.HexagonShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.TriangleShapeDescription=void 0;var p=d(7),u=d(5),s=d(1),i=d(45),t=d(9),e=d(13),n=d(2),o=function(r){function a(c){var l=r.call(this,void 0,c)||this;return l.defaultSize.height=l.calculateHeight(p.ShapeDefaultDimension),l}return P(a,r),Object.defineProperty(a.prototype,"key",{get:function(){return s.ShapeTypes.Triangle},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),a.prototype.createConnectionPoints=function(){return[new i.ConnectionPoint(.5,0,t.ConnectionPointSide.North),new i.ConnectionPoint(.75,.5,t.ConnectionPointSide.East),new i.ConnectionPoint(.5,1,t.ConnectionPointSide.South),new i.ConnectionPoint(.25,.5,t.ConnectionPointSide.West)]},a.prototype.createShapePrimitives=function(c){var l=c.rectangle,y=l.x,g=l.y,f=l.right,v=l.bottom;return[new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(l.center.x,g),new u.PathPrimitiveLineToCommand(f,v),new u.PathPrimitiveLineToCommand(y,v),new u.PathPrimitiveClosePathCommand],c.style)]},a.prototype.calculateHeight=function(c){return Math.sqrt(Math.pow(c,2)-Math.pow(c/2,2))},a.prototype.getTextRectangle=function(c){return new e.Rectangle(c.position.x+c.size.width/4,c.position.y+c.size.height/2,c.size.width/2,c.size.height/2-p.ShapeTextPadding).nonNegativeSize()},a.prototype.getSizeByText=function(c,l){return new n.Size(2*c.width,2*c.height+p.ShapeTextPadding)},a}(p.ShapeDescription);h.TriangleShapeDescription=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.DocumentShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(9),t=function(e){function n(){return e.call(this,void 0,!0)||this}return P(n,e),Object.defineProperty(n.prototype,"key",{get:function(){return u.ShapeTypes.Document},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(o){return this.createDocumentPrimitives(o.rectangle,o.style)},n.prototype.createDocumentPrimitives=function(o,r){var a=o.x,c=o.y,l=o.right,y=o.bottom,g=o.width,f=o.height,v=o.center.x,C=f*n.curveOffsetRatio;return[].concat([new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(a,c),new s.PathPrimitiveLineToCommand(l,c),new s.PathPrimitiveLineToCommand(l,y),new s.PathPrimitiveQuadraticCurveToCommand(l-.25*g,y-2*C,v,y-C),new s.PathPrimitiveQuadraticCurveToCommand(a+.25*g,y+C,a,y-C),new s.PathPrimitiveClosePathCommand],r)])},n.prototype.processConnectionPoint=function(o,r){o.getConnectionPointSide(r)===i.ConnectionPointSide.South&&(r.y-=o.size.height*n.curveOffsetRatio)},n.prototype.getTextRectangle=function(o){var r=o.rectangle;return r.clone().resize(0,-r.height*n.curveOffsetRatio)},n.curveOffsetRatio=.1,n}(p.RectangleShapeDescription);h.DocumentShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(g,f){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,C){v.__proto__=C}||function(v,C){for(var b in C)C.hasOwnProperty(b)&&(v[b]=C[b])})(g,f)},function(g,f){function v(){this.constructor=g}m(g,f),g.prototype=f===null?Object.create(f):(v.prototype=f.prototype,new v)});Object.defineProperty(h,"__esModule",{value:!0}),h.CustomShapeDescription=void 0;var p=d(127),u=d(13),s=d(2),i=d(0),t=d(45),e=d(9),n=d(128),o=d(7),r=d(51),a=d(46),c=d(130),l=d(231),y=function(g){function f(v,C){var b=g.call(this,new s.Size(v.defaultWidth||C&&C.defaultSize.width||o.ShapeDefaultDimension,v.defaultHeight||C&&C.defaultSize.height||o.ShapeDefaultDimension))||this;if(b.properties=v,b.baseDescription=C,b.imageLoader=new c.ImageLoader(b.updateSvgImage.bind(b)),b.defaultText=v.defaultText!==void 0?v.defaultText:C&&C.getDefaultText(),b.defaultImageUrl=v.defaultImageUrl||C&&C.getDefaultImageUrl(),b.title=v.title||C&&C.getTitle()||b.defaultText||"",b.connectionPoints=b.createConnectionPoints(),v.svgUrl){b.svgImage=new r.ImageInfo(v.svgUrl);var S=a.ImageCache.instance.createUnloadedInfoByShapeImageInfo(b.svgImage);b.imageLoader.load(S)}return v.svgToolboxUrl&&(b.svgToolboxImage=new r.ImageInfo(v.svgToolboxUrl),S=a.ImageCache.instance.createUnloadedInfoByShapeImageInfo(b.svgToolboxImage),b.imageLoader.load(S)),b}return P(f,g),Object.defineProperty(f.prototype,"key",{get:function(){return this.properties.type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"allowEditText",{get:function(){return this.properties.allowEditText!==!1},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"allowEditImage",{get:function(){return this.baseDescription?this.baseDescription.allowEditImage:this.properties.allowEditImage===!0},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"enableChildren",{get:function(){return this.baseDescription&&this.baseDescription.enableChildren},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"hasTemplate",{get:function(){return!!this.properties.createTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"minWidth",{get:function(){return this.properties.minWidth||this.baseDescription&&this.baseDescription.minWidth},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"minHeight",{get:function(){return this.properties.minHeight||this.baseDescription&&this.baseDescription.minHeight},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"maxWidth",{get:function(){return this.properties.maxWidth||this.baseDescription&&this.baseDescription.maxWidth},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"maxHeight",{get:function(){return this.properties.maxHeight||this.baseDescription&&this.baseDescription.maxHeight},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"keepRatioOnAutoSize",{get:function(){return this.properties.keepRatioOnAutoSize},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"toolboxSize",{get:function(){return this.properties.toolboxWidthToHeightRatio?new s.Size(this.defaultSize.width,this.defaultSize.width/this.properties.toolboxWidthToHeightRatio):this.defaultSize},enumerable:!1,configurable:!0}),f.prototype.getTextAngle=function(){return this.baseDescription&&this.baseDescription.getTextAngle()||g.prototype.getTextAngle.call(this)},f.prototype.getTitle=function(){return this.title!==void 0?this.title:g.prototype.getTitle.call(this)},f.prototype.getDefaultText=function(){return this.defaultText!==void 0?this.defaultText:g.prototype.getDefaultText.call(this)},f.prototype.getDefaultImageUrl=function(){return this.defaultImageUrl!==void 0?this.defaultImageUrl:g.prototype.getDefaultImageUrl.call(this)},f.prototype.allowResizeHorizontally=function(v){return this.properties.allowResize!==!1&&(this.baseDescription?this.baseDescription.allowResizeHorizontally(v):g.prototype.allowResizeHorizontally.call(this,v))},f.prototype.allowResizeVertically=function(v){return this.properties.allowResize!==!1&&(this.baseDescription?this.baseDescription.allowResizeVertically(v):g.prototype.allowResizeVertically.call(this,v))},f.prototype.createConnectionPoints=function(){return this.properties&&this.properties.connectionPoints&&this.properties.connectionPoints.length?this.properties.connectionPoints.map(function(v){if(v&&typeof v.x=="number"&&typeof v.y=="number"){var C=typeof v.side=="number"?v.side:e.ConnectionPointSide.Undefined;return new t.ConnectionPoint(v.x,v.y,C)}}).filter(function(v){return v}):g.prototype.createConnectionPoints.call(this)},f.prototype.getConnectionPointSides=function(){for(var v={},C=0;C<this.connectionPoints.length;C++){var b=o.ShapeDescription.getConnectionPointSideByGeometry(this.connectionPoints[C]);v[b]||(v[b]=[]),v[b].push(C)}return v},f.prototype.getConnectionPointIndexForSide=function(v){var C=this.getConnectionPointSides(),b=C[v];if(b){var S=Math.floor(b.length/2);return b.length%2==0&&S--,b[S]}return(b=C[(v+1)%4])?b[0]:(b=C[(v+3)%4])?b[b.length-1]:(b=C[(v+2)%4])?b[0]:v},f.prototype.createImagePrimitives=function(v,C){return this.baseDescription?this.baseDescription.createImagePrimitives(v,C):g.prototype.createImagePrimitives.call(this,v,C)},f.prototype.createShapePrimitives=function(v,C){var b=[],S=v.rectangle,x=S.x,I=S.y,w=S.width,_=S.height;if(this.baseDescription)b=this.baseDescription.createShapePrimitives(v,C);else{var T=C&&this.svgToolboxImage?this.svgToolboxImage:this.svgImage;if(T){var R=x+(this.properties.svgLeft&&!C?this.properties.svgLeft*w:0),E=I+(this.properties.svgTop&&!C?this.properties.svgTop*_:0),D=this.properties.svgWidth&&!C?this.properties.svgWidth*w:w,L=this.properties.svgHeight&&!C?this.properties.svgHeight*_:_;b=b.concat([new p.ImagePrimitive(R,E,D,L,T.exportUrl)])}}var H=C&&this.properties.createToolboxTemplate||this.properties.createTemplate;if(H){var O=x+(this.properties.templateLeft&&!C?this.properties.templateLeft*w:0),z=I+(this.properties.templateTop&&!C?this.properties.templateTop*_:0),K=this.properties.templateWidth&&!C?this.properties.templateWidth*w:w,A=this.properties.templateHeight&&!C?this.properties.templateHeight*_:_,M=this.properties.apiController?this.properties.apiController.createNativeShape(v):v.toNative();b=b.concat([new l.SvgElementPrimitive(O,z,K,A,H,this.properties.destroyTemplate,M)])}return b},f.prototype.createParameters=function(v){return this.baseDescription?this.baseDescription.createParameters(v):g.prototype.createParameters.call(this,v)},f.prototype.normalizeParameters=function(v,C){this.baseDescription?this.baseDescription.normalizeParameters(v,C):g.prototype.normalizeParameters.call(this,v,C)},f.prototype.modifyParameters=function(v,C,b,S){this.baseDescription?this.baseDescription.modifyParameters(v,C,b,S):g.prototype.modifyParameters.call(this,v,C,b,S)},f.prototype.getParameterPoints=function(v){return this.baseDescription?this.baseDescription.getParameterPoints(v):g.prototype.getParameterPoints.call(this,v)},f.prototype.getTextRectangle=function(v){if(this.baseDescription)return this.baseDescription.getTextRectangle(v);var C=v.rectangle,b=C.x,S=C.y,x=C.width,I=C.height;return new u.Rectangle(b+(this.properties.textLeft?this.properties.textLeft*x:0),S+(this.properties.textTop?this.properties.textTop*I:0),this.properties.textWidth?this.properties.textWidth*x:x,this.properties.textHeight?this.properties.textHeight*I:I)},f.prototype.getSizeByText=function(v,C){if(this.baseDescription)return this.baseDescription.getSizeByText(v,C);var b=this.properties.textWidth;b||(b=1);var S=this.properties.textHeight;return S||(S=1),new s.Size(v.width/b,v.height/S)},f.prototype.getImageSize=function(v,C,b){return this.baseDescription?this.baseDescription instanceof n.ShapeWithImageDescription?this.baseDescription.getImageSize(v,C,b):s.Size.empty():new s.Size(this.properties.imageWidth?this.properties.imageWidth*v.width:v.width,this.properties.imageHeight?this.properties.imageHeight*v.height:v.height).nonNegativeSize()},f.prototype.getImagePlacementRectangle=function(v,C){if(this.baseDescription)return this.baseDescription instanceof n.ShapeWithImageDescription?this.baseDescription.getImagePlacementRectangle(v,C):u.Rectangle.fromGeometry(i.Point.zero(),s.Size.empty());var b=v.x,S=v.y,x=v.width,I=v.height;return new u.Rectangle(b+(this.properties.imageLeft&&!C?this.properties.imageLeft*x:0),S+(this.properties.imageTop&&!C?this.properties.imageTop*I:0),this.properties.imageWidth&&!C?this.properties.imageWidth*x:x,this.properties.imageHeight&&!C?this.properties.imageHeight*I:I)},f.prototype.updateSvgImage=function(v){var C=v.imageUrl&&v.imageUrl===this.properties.svgToolboxUrl,b=C?this.svgToolboxImage:this.svgImage;v.base64?b.loadBase64Content(v.base64):b.setUnableToLoadFlag(),C||this.raiseShapeDescriptionChanged(this)},f}(n.ShapeWithImageDescription);h.CustomShapeDescription=y},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ImagePrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a,c,l){a===void 0&&(a="none");var y=s.call(this,c,l)||this;return y.x=t,y.y=e,y.width=n,y.height=o,y.url=r,y.preserveAspectRatio=a,y}return P(i,s),i.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"image")},i.prototype.applyElementProperties=function(t,e){this.setUnitAttribute(t,"x",this.x),this.setUnitAttribute(t,"y",this.y),this.setUnitAttribute(t,"width",this.width),this.setUnitAttribute(t,"height",this.height),this.setPositionCorrectionAttribute(t),t.setAttribute("href",this.url),t.setAttribute("preserveAspectRatio",this.preserveAspectRatio),s.prototype.applyElementProperties.call(this,t,e)},i}(d(24).SvgPrimitive);h.ImagePrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(y,g){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,v){f.__proto__=v}||function(f,v){for(var C in v)v.hasOwnProperty(C)&&(f[C]=v[C])})(y,g)},function(y,g){function f(){this.constructor=y}m(y,g),y.prototype=g===null?Object.create(g):(f.prototype=g.prototype,new f)});Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeWithImageDescription=h.SHAPE_IMAGE_CLASSNAMES=h.ShapeDefaultSize=h.ShapeDefaultDimension=void 0;var p=d(7),u=d(13),s=d(2),i=d(0),t=d(12),e=d(127),n=d(21),o=d(39),r=d(17),a=d(56),c=d(129);h.ShapeDefaultDimension=1440,h.ShapeDefaultSize=new s.Size(h.ShapeDefaultDimension,h.ShapeDefaultDimension),h.SHAPE_IMAGE_CLASSNAMES={IMAGE:"dxdi-image",IMAGE_PLACEHOLDER:"dxdi-image-placeholder",LOADING_INDICATOR:"dxdi-spinner",USER_PIC:"dxdi-user",WARNING_MARK:"dxdi-warning"};var l=function(y){function g(f,v){f===void 0&&(f=h.ShapeDefaultSize.clone());var C=y.call(this,f,v)||this;return C.hasDefaultText=v,C.defaultIconSize=480,C}return P(g,y),Object.defineProperty(g.prototype,"enableImage",{get:function(){return!0},enumerable:!1,configurable:!0}),g.prototype.getImageMargin=function(f){return f?t.UnitConverter.pixelsToTwips(2):t.UnitConverter.pixelsToTwips(3)},g.prototype.createImagePrimitives=function(f,v){if(!this.enableImage)return[];var C=this.getImagePlacementRectangle(f.rectangle,v);if(v)return this.createImagePlaceholder(C);var b=[];if(b=f.image.isEmpty||f.image.unableToLoad?b.concat(this.createEmptyImagePrimitives(C,f.image.unableToLoad)):f.image.renderUrl===""?b.concat(this.createLoadingImagePrimitives(C)):b.concat(this.createLoadedImagePrimitives(C,f.image.renderUrl)),f.image.renderUrl===""){var S=r.RenderUtils.generateSvgElementId("clipImage");return[].concat([new o.GroupPrimitive(b,h.SHAPE_IMAGE_CLASSNAMES.IMAGE,void 0,S),new a.ClipPathPrimitive(S,[new n.RectanglePrimitive(C.x,C.y,C.width,C.height)])])}return b},g.prototype.createImagePlaceholder=function(f){return[]},g.prototype.createLoadedImagePrimitives=function(f,v){return[new e.ImagePrimitive(f.x,f.y,f.width,f.height,v,g.imageScalingRule,void 0,h.SHAPE_IMAGE_CLASSNAMES.IMAGE)]},g.prototype.createLoadingImagePrimitives=function(f){var v=this.getIconPlacementRectangle(f);return[c.ShapeImageIndicator.createLoadingIndicatorPrimitives(v.x,v.y,this.defaultIconSize,t.UnitConverter.pixelsToTwips(5),h.SHAPE_IMAGE_CLASSNAMES.LOADING_INDICATOR)]},g.prototype.createEmptyImagePrimitives=function(f,v){var C=this.getIconPlacementRectangle(f),b=[];return b=b.concat(this.createEmptyImagePrimitive(C)),v&&(b=b.concat(this.createWarningPrimitive(C))),b},g.prototype.createEmptyImagePrimitive=function(f){return new o.GroupPrimitive([])},g.prototype.createWarningPrimitive=function(f){return new o.GroupPrimitive([])},g.prototype.getIconPlacementRectangle=function(f){var v=u.Rectangle.fromGeometry(new i.Point(f.x,f.y),new s.Size(this.defaultIconSize,this.defaultIconSize));return v.width<f.width&&(v.x=f.x+(f.width-v.width)/2),v.height<f.height&&(v.y=f.y+(f.height-v.height)/2),v},g.imageScalingRule="xMidYMid meet",g}(p.ShapeDescription);h.ShapeWithImageDescription=l},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ShapeImageIndicator=void 0;var m=d(55),P=d(5),p=d(39),u=d(18),s=d(21),i=d(12),t=function(){function e(n,o,r,a,c){this.x=n,this.y=o,this.size=r,this.borderThickness=a,this.className=c,this.animationStarted=!1}return e.createLoadingIndicatorPrimitives=function(n,o,r,a,c){return new e(n,o,r,a,c).createLoadingIndicatorPrimitive()},e.createUserIconPrimitives=function(n,o,r,a,c){return new e(n,o,r,a,c).createUserIconPrimitive()},e.createWarningIconPrimitives=function(n,o,r,a){return new e(n,o,r,void 0,a).createWarningIconPrimitive()},e.prototype.rotate=function(n,o,r,a){if(this.animationStarted){var c="rotate("+Math.round(a)%1080/3+" "+o+" "+r+")";n.setAttribute("transform",c),this.animationRequestId=requestAnimationFrame((function(l){this.rotate(n,o,r,l)}).bind(this))}},e.prototype.onApplyLoadingIndicatorElementProperties=function(n){var o=[i.UnitConverter.twipsToPixelsF(this.x+this.size/2),i.UnitConverter.twipsToPixelsF(this.y+this.size/2)],r=o[0],a=o[1];u.Browser.IE?(this.animationRequestId=requestAnimationFrame((function(c){this.rotate(n,r,a,c)}).bind(this)),this.animationStarted=!0):n.style.setProperty("transform-origin",r+"px "+a+"px")},e.prototype.center=function(){return[i.UnitConverter.twipsToPixelsF(this.x+this.size/2),i.UnitConverter.twipsToPixelsF(this.y+this.size/2)]},e.prototype.createLoadingIndicatorPrimitive=function(){var n=this.center(),o=n[0],r=n[1],a=i.UnitConverter.twipsToPixelsF(this.size/2-this.borderThickness/2);return new p.GroupPrimitive([new m.EllipsePrimitive(o+"",r+"",a+"",a+""),new P.PathPrimitive([new P.PathPrimitiveMoveToCommand(o+a+"",r+""),new P.PathPrimitiveArcToCommand(a+"",a+"",0,!1,!1,o+"",r-a+"")])],this.className,void 0,void 0,this.onApplyLoadingIndicatorElementProperties.bind(this),this.onBeforeDispose.bind(this))},e.prototype.createUserIconPrimitive=function(){var n=this.center(),o=n[0],r=n[1],a=i.UnitConverter.twipsToPixelsF(this.size/2-this.borderThickness/2),c=i.UnitConverter.twipsToPixelsF(this.size);return new p.GroupPrimitive([new m.EllipsePrimitive(o+"",r+"",a+"",a+"",void 0,"dxdi-background"),new m.EllipsePrimitive(o+"",r-c/8+"",c/8+"",c/8+""),new P.PathPrimitive([new P.PathPrimitiveMoveToCommand(o+"",r+c/16+""),new P.PathPrimitiveCubicCurveToCommand(o+.1375*c+"",r+c/16+"",o+c/4+"",r+.11875*c+"",o+c/4+"",r+.1875*c+""),new P.PathPrimitiveLineToCommand(o+c/4+"",r+c/4+""),new P.PathPrimitiveLineToCommand(o-c/4+"",r+c/4+""),new P.PathPrimitiveLineToCommand(o-c/4+"",r+.1875*c+""),new P.PathPrimitiveCubicCurveToCommand(o-c/4+"",r+.11875*c+"",o-.1375*c+"",r+c/16+"",o+"",r+c/16+""),new P.PathPrimitiveClosePathCommand])],this.className)},e.prototype.createWarningIconPrimitive=function(){var n=this.center(),o=n[0],r=n[1],a=i.UnitConverter.twipsToPixelsF(this.size/2)-1,c=i.UnitConverter.twipsToPixelsF(this.size/8);return new p.GroupPrimitive([new m.EllipsePrimitive(o+"",r+"",a+"",a+""),new s.RectanglePrimitive(o-c/2+.5+"",r+a-i.UnitConverter.twipsToPixelsF(this.size/4)+"",c+"",c+""),new s.RectanglePrimitive(o-c/2+.5+"",r-a+i.UnitConverter.twipsToPixelsF(this.size/4)-c+"",c+"",a+"")],this.className)},e.prototype.onBeforeDispose=function(){this.animationRequestId&&cancelAnimationFrame(this.animationRequestId),this.animationStarted=!1},e}();h.ShapeImageIndicator=t},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ImageLoader=void 0;var m=d(46),P=function(){function p(u){this.loadedCallback=u}return p.prototype.load=function(u){u.isLoaded?this.loadedCallback(u):u.isLoading||this.loadInner(u)},p.prototype.loadInner=function(u){var s=this;return u.imageUrl?this.loadPictureByUrl(u,function(){return s.finalizeLoading(u,u)}):u.base64&&this.loadPictureByBase64(u,function(){return s.finalizeLoading(u,u)}),u},p.prototype.finalizeLoading=function(u,s){s||(s=m.ImageCache.instance.getImageData(u.actualId)),s.isLoaded||m.ImageCache.instance.finalizeLoading(s,u),this.loadedCallback(s)},p.prototype.loadPictureByBase64=function(u,s){var i=new Image;i.onload=function(){s(u)},i.src=u.base64},p.prototype.loadPictureByUrl=function(u,s){var i=this,t=new XMLHttpRequest;try{t.onload=function(){var e=new FileReader;e.onloadend=function(){u.base64=e.result,i.loadPictureByBase64(u,function(n){return s(n)})},e.readAsDataURL(t.response)},t.onerror=function(){return s(u)},t.onloadend=function(){t.status===404&&s(u)},t.open("GET",u.imageUrl,!0),t.responseType="blob",u.startLoading(),t.send()}catch{}},p}();h.ImageLoader=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(y,g){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,v){f.__proto__=v}||function(f,v){for(var C in v)v.hasOwnProperty(C)&&(f[C]=v[C])})(y,g)},function(y,g){function f(){this.constructor=y}m(y,g),y.prototype=g===null?Object.create(g):(f.prototype=g.prototype,new f)});Object.defineProperty(h,"__esModule",{value:!0}),h.ContainerDescription=h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO=h.CONTAINER_EXPAND_BUTTON_RECT_RATIO=h.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO=h.CONTAINER_HEADER_SIZE=void 0;var p=d(7),u=d(2),s=d(1),i=d(21),t=d(5),e=d(17),n=d(11),o=d(39),r=d(45),a=d(9),c=d(36);h.CONTAINER_HEADER_SIZE=360,h.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO=.2,h.CONTAINER_EXPAND_BUTTON_RECT_RATIO=.5,h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO=.3;var l=function(y){function g(f){return f===void 0&&(f=new u.Size(2*p.ShapeDefaultDimension,1.5*p.ShapeDefaultDimension)),y.call(this,f,!0)||this}return P(g,y),Object.defineProperty(g.prototype,"enableChildren",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),g.prototype.getDefaultText=function(){return c.DiagramLocalizationService.shapeTexts[s.ShapeTypes.Container]},g.prototype.createConnectionPoints=function(){return[new r.ConnectionPoint(.25,0,a.ConnectionPointSide.North),new r.ConnectionPoint(.5,0,a.ConnectionPointSide.North),new r.ConnectionPoint(.75,0,a.ConnectionPointSide.North),new r.ConnectionPoint(1,.25,a.ConnectionPointSide.East),new r.ConnectionPoint(1,.5,a.ConnectionPointSide.East),new r.ConnectionPoint(1,.75,a.ConnectionPointSide.East),new r.ConnectionPoint(.75,1,a.ConnectionPointSide.South),new r.ConnectionPoint(.5,1,a.ConnectionPointSide.South),new r.ConnectionPoint(.25,1,a.ConnectionPointSide.South),new r.ConnectionPoint(0,.75,a.ConnectionPointSide.West),new r.ConnectionPoint(0,.5,a.ConnectionPointSide.West),new r.ConnectionPoint(0,.25,a.ConnectionPointSide.West)]},g.prototype.getConnectionPointIndexForItem=function(f,v){return(f&&f.getConnectionPoints()).length===4?3*v+1:v},g.prototype.getConnectionPointIndexForSide=function(f){return 3*f+1},g.prototype.createShapePrimitives=function(f,v){var C=f.rectangle,b=C.x,S=C.y,x=C.width,I=C.height,w=[];return f.expanded&&(w=w.concat([new i.RectanglePrimitive(b,S,x,I,f.style)])),w.concat(this.createHeaderPrimitives(f,v))},g.prototype.createExpandButtonPrimitives=function(f,v){var C=[new t.PathPrimitiveMoveToCommand(v.x+v.width*((1-h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2),v.center.y),new t.PathPrimitiveLineToCommand(v.x+v.width*((1-h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2+h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO),v.center.y)];f.expanded||(C=C.concat([new t.PathPrimitiveMoveToCommand(v.center.x,v.y+v.height*((1-h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2)),new t.PathPrimitiveLineToCommand(v.center.x,v.y+v.height*((1-h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2+h.CONTAINER_EXPAND_BUTTON_SIGN_RATIO))]));var b=v.clone().inflate(-v.width*(1-h.CONTAINER_EXPAND_BUTTON_RECT_RATIO)/2,-v.height*(1-h.CONTAINER_EXPAND_BUTTON_RECT_RATIO)/2);return[new o.GroupPrimitive([new i.RectanglePrimitive(b.x,b.y,b.width,b.height,f.style),new t.PathPrimitive(C,f.style)],"shape-expand-btn",null,null,function(S){e.RenderUtils.setElementEventData(S,n.MouseEventElementType.ShapeExpandButton,f.key)})]},g}(p.ShapeDescription);h.ContainerDescription=l},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(g,f){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,C){v.__proto__=C}||function(v,C){for(var b in C)C.hasOwnProperty(b)&&(v[b]=C[b])})(g,f)},function(g,f){function v(){this.constructor=g}m(g,f),g.prototype=f===null?Object.create(f):(v.prototype=f.prototype,new v)});Object.defineProperty(h,"__esModule",{value:!0}),h.CardBaseDescription=void 0;var p=d(7),u=d(13),s=d(2),i=d(128),t=d(235),e=d(5),n=d(39),o=d(129),r=d(1),a=d(36),c=d(12),l=d(0),y=function(g){function f(v){return v===void 0&&(v=new s.Size(p.ShapeDefaultDimension,26/46*p.ShapeDefaultDimension)),g.call(this,v,!0)||this}return P(f,g),Object.defineProperty(f.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),f.prototype.getDefaultText=function(){return a.DiagramLocalizationService.shapeTexts[r.ShapeTypes.Card]},f.prototype.createShapePrimitives=function(v,C){var b=v.rectangle,S=b.x,x=b.y,I=b.width,w=b.height;return[new t.RoundedRectanglePrimitive(S,x,I,w,C?30:60,C?30:60,v.style)]},f.prototype.createImagePlaceholder=function(v){return[new t.RoundedRectanglePrimitive(v.x,v.y,v.width,v.height,c.UnitConverter.pixelsToTwips(2),c.UnitConverter.pixelsToTwips(2),void 0,i.SHAPE_IMAGE_CLASSNAMES.IMAGE_PLACEHOLDER)]},f.prototype.createEmptyImagePrimitive=function(v){return o.ShapeImageIndicator.createUserIconPrimitives(v.x,v.y,this.defaultIconSize,c.UnitConverter.pixelsToTwips(1),i.SHAPE_IMAGE_CLASSNAMES.USER_PIC)},f.prototype.createWarningPrimitive=function(v){return o.ShapeImageIndicator.createWarningIconPrimitives(v.x+this.defaultIconSize/2,v.y+this.defaultIconSize/2,this.defaultIconSize/2,i.SHAPE_IMAGE_CLASSNAMES.WARNING_MARK)},f.prototype.getTextRectangle=function(v){var C=v.rectangle,b=C.clone().inflate(-p.ShapeTextPadding,-p.ShapeTextPadding),S=this.getImageSize(C.createSize(),!0);return this.isTextAfterImage&&b.moveRectangle(this.isHorizontal?S.width:0,this.isHorizontal?0:S.height),b.resize(this.isHorizontal?-S.width:0,this.isHorizontal?0:-S.height),b.nonNegativeSize()},f.prototype.getSizeByText=function(v,C){var b=v.clone().offset(2*p.ShapeTextPadding,2*p.ShapeTextPadding),S=this.getImageSizeByTextBlockSize(b);return this.isHorizontal?b.width+=S.width:b.height+=S.height,b},f.prototype.createTextPrimitives=function(v,C){return C?this.createGraphicalTextRepresentation(v.rectangle):g.prototype.createTextPrimitives.call(this,v,C)},f.prototype.createGraphicalTextRepresentation=function(v){var C=new u.Rectangle(0,0,0,0),b=this.getImageSize(v.createSize(),!0,!0);if(this.isHorizontal){var S=this.isTextAfterImage?v.width/2-c.UnitConverter.pixelsToTwips(2):0;C.x=v.x+S+c.UnitConverter.pixelsToTwips(4),C.y=v.y+c.UnitConverter.pixelsToTwips(5),C.width=b.width-c.UnitConverter.pixelsToTwips(4),C.height=v.height-c.UnitConverter.pixelsToTwips(6)}else{var x=this.isTextAfterImage?v.height/2-c.UnitConverter.pixelsToTwips(2):0;C.x=v.x+v.width/4,C.y=v.y+x+c.UnitConverter.pixelsToTwips(4),C.width=v.width/2,C.height=b.height-c.UnitConverter.pixelsToTwips(2)}return this.createTextRepresentationPrimitives(C)},f.prototype.getImagePlacementRectangle=function(v,C){var b=this.getImageSize(v.createSize(),!1,C),S=u.Rectangle.fromGeometry(new l.Point(v.x,v.y),b),x=this.getImageSize(v.createSize(),!0,C);return this.isHorizontal&&this.isTextAfterImage?S.x+=this.getImageMargin(C):this.isHorizontal&&(S.x=v.right-x.width-this.getImageMargin(C)),this.isHorizontal||this.isTextAfterImage?S.y+=this.getImageMargin(C):S.y=v.bottom-x.height-this.getImageMargin(C),this.isHorizontal||(S.x+=(v.width-S.width)/2),S},f.prototype.createTextRepresentationPrimitives=function(v){var C=c.UnitConverter.pixelsToTwips(c.UnitConverter.twipsToPixels(v.height/3));return[new n.GroupPrimitive([new e.PathPrimitive([new e.PathPrimitiveMoveToCommand(v.x,v.y),new e.PathPrimitiveLineToCommand(v.x+v.width,v.y)]),new e.PathPrimitive([new e.PathPrimitiveMoveToCommand(v.x,v.y+C),new e.PathPrimitiveLineToCommand(v.x+v.width,v.y+C)]),new e.PathPrimitive([new e.PathPrimitiveMoveToCommand(v.x,v.y+2*C),new e.PathPrimitiveLineToCommand(v.x+.66*v.width,v.y+2*C)])],"dxdi-shape-text")]},f}(i.ShapeWithImageDescription);h.CardBaseDescription=y},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ImporterBase=void 0;var m=d(62),P=d(14),p=function(){function u(s){this.shapeDescriptionManager=s}return u.prototype.import=function(){var s=new m.DiagramModel,i=this.getObject();this.importPageSettings(s,this.getPageObject(i));for(var t=this.importShapes(this.getShapeObjects(i)),e=0;e<t.length;e++){var n=t[e];if(s.findItem(n.key))throw Error("Item key is duplicated");s.pushItem(n)}var o=this.importConnectors(this.getConnectorObjects(i));for(e=0;e<o.length;e++){var r=o[e];if(r.endItem=s.findItem(r.endItemKey)||void 0,delete r.endItemKey,r.beginItem=s.findItem(r.beginItemKey)||void 0,delete r.beginItemKey,s.findItem(r.key))throw Error("Item key is duplicated");s.pushItem(r),this.updateConnections(r)}return this.updateChildren(s.items,function(a){return s.findItem(a)}),s},u.prototype.importItems=function(s){for(var i,t=[],e=this.getObject(),n={},o=this.importShapes(this.getShapeObjects(e)),r=0;r<o.length;r++){var a=o[r],c=a.key;i=s.getNextKey(),a.key=i,n[c]=a,a.dataKey!==void 0&&(a.dataKey=void 0),t.push(a)}var l=this.importConnectors(this.getConnectorObjects(e));for(r=0;r<l.length;r++){var y=l[r];c=y.key,i=s.getNextKey(),y.key=i,n[c]=y,y.dataKey!==void 0&&(y.dataKey=void 0);var g=y.endItemKey;y.endItem=n[g],delete y.endItemKey;var f=y.beginItemKey;y.beginItem=n[f],delete y.beginItemKey,t.push(y),this.updateConnections(y)}return this.updateChildren(t,function(v){return n[v]}),t},u.prototype.importItemsData=function(s){for(var i=this.getObject(),t=this.importShapes(this.getShapeObjects(i)),e={},n=0;n<t.length;n++){var o=t[n],r=void 0;o.dataKey!==void 0&&(r=s.findShapeByDataKey(o.dataKey)),r&&(r.dataKey=o.dataKey,e[o.key]=o.dataKey,r.locked=o.locked,r.position=o.position.clone(),r.expanded=o.expanded,o.expandedSize&&(r.expandedSize=o.expandedSize.clone()),r.size=o.size.clone(),r.parameters=o.parameters.clone(),r.style=o.style.clone(),r.styleText=o.styleText.clone(),r.zIndex=o.zIndex,r.text=o.text,r.description=o.description,r.image=o.image.clone())}var a=this.importConnectors(this.getConnectorObjects(i));for(n=0;n<a.length;n++){var c=a[n],l=void 0;c.dataKey!==void 0&&(l=s.findConnectorByDataKey(c.dataKey)),l||(l=s.findConnectorByBeginEndDataKeys(e[c.beginItemKey],e[c.endItemKey])),l&&(l.dataKey=c.dataKey,l.locked=c.locked,l.points=c.points.slice(),l.properties=c.properties.clone(),l.style=c.style.clone(),l.endConnectionPointIndex=c.endConnectionPointIndex,l.beginConnectionPointIndex=c.beginConnectionPointIndex,l.texts=c.texts.clone(),l.styleText=c.styleText.clone(),l.zIndex=c.zIndex)}},u.prototype.importShapes=function(s){var i=[];if(!s)return i;if(!Array.isArray(s))throw Error("Invalid Format");for(var t=0;t<s.length;t++){var e=s[t],n=this.importShape(e);i.push(n),i=i.concat(this.importShapeChildren(e,n))}return i},u.prototype.importConnectors=function(s){var i=[];if(!s)return i;if(!Array.isArray(s))throw Error("Invalid Format");for(var t=0;t<s.length;t++){var e=s[t];i.push(this.importConnector(e))}return i},u.prototype.updateChildren=function(s,i){s.forEach(function(t){t instanceof P.Shape&&t.childKeys&&(t.childKeys.forEach(function(e){var n=i(e);n&&(t.children.indexOf(n)===-1&&t.children.push(n),n.container=t)}),delete t.childKeys)})},u.prototype.updateConnections=function(s){s.endItem&&(s.endItem instanceof P.Shape?(s.endItem.attachedConnectors.push(s),s.points[s.points.length-1]=s.endItem.getConnectionPointPosition(s.endConnectionPointIndex,s.points[s.points.length-2])):(s.endItem=void 0,s.endConnectionPointIndex=-1)),s.beginItem&&(s.beginItem instanceof P.Shape?(s.beginItem.attachedConnectors.push(s),s.points[0]=s.beginItem.getConnectionPointPosition(s.beginConnectionPointIndex,s.points[1])):(s.beginItem=void 0,s.beginConnectionPointIndex=-1))},u.prototype.assert=function(s,i){if(s===void 0||i!==void 0&&typeof s!==i)throw Error("Invalid Format")},u}();h.ImporterBase=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.StylePropertyCommandBase=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.lockInputPositionUpdating=function(){return!0},s}(d(10).SimpleCommandBase);h.StylePropertyCommandBase=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStylePropertyCommandBase=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.executeCore=function(i,t){var e=this;this.control.history.beginTransaction();var n=this.control.selection.getSelectedItems();return t=this.processParameter(t),n.forEach(function(o){var r=e.getStyleProperty();e.control.history.addAndRedo(e.createHistoryItem(o,r,t))}),this.updateInputPosition(t),this.control.history.endTransaction(),!0},s.prototype.getDefaultValue=function(){return this.getDefaultStyleObj()[this.getStyleProperty()]},s.prototype.processParameter=function(i){return i},s}(d(134).StylePropertyCommandBase);h.ChangeStylePropertyCommandBase=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorPropertyCommand=void 0;var p=d(88),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentConnectorPropertyValue(this.getPropertyName())},i.prototype.getDefaultValue=function(){return this.getPropertyDefaultValue()},i.prototype.executeCore=function(t,e){var n=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedConnectors().forEach(function(o){var r=n.getPropertyName();n.control.history.addAndRedo(new p.ChangeConnectorPropertyHistoryItem(o.key,r,e))}),this.control.selection.inputPosition.setConnectorPropertyValue(this.getPropertyName(),e),this.control.history.endTransaction(),!0},i.prototype.lockInputPositionUpdating=function(){return!0},i.prototype.isEnabled=function(){var t=this.control.selection.getSelectedConnectors();return s.prototype.isEnabled.call(this)&&t.length>0},i}(d(10).SimpleCommandBase);h.ChangeConnectorPropertyCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutTreeVerticalCommand=void 0;var p=d(76),u=d(97),s=d(20),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.createLayoutSettings=function(){var n=this.control.settings.snapToGrid?this.control.settings.gridSize:void 0,o=new s.TreeLayoutSettings(n);return o.orientation=s.DataLayoutOrientation.Vertical,o},e.prototype.createLayout=function(n,o){return new u.TreeLayoutBuilder(n,o).build()},e}(p.AutoLayoutCommandBase);h.AutoLayoutTreeVerticalCommand=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.GraphLayout=void 0;var m=d(3),P=d(71),p=function(){function u(){this.nodeKeys=[],this.nodeToLayout={},this.edgeToPosition={}}return u.prototype.forEachNode=function(s){var i=this;this.nodeKeys.forEach(function(t){return s(i.nodeToLayout[t],t)})},u.prototype.reduce=function(s,i){var t=this;return this.nodeKeys.reduce(function(e,n,o){return s(e,t.nodeToLayout[n],o)},i)},u.prototype.addNode=function(s){if(this.nodeToLayout[s.key])throw Error("Node layout is already registered");return this.nodeKeys.push(s.key),this.nodeToLayout[s.key]=s,s},u.prototype.hasNode=function(s){return!!this.nodeToLayout[s]},u.prototype.addEdge=function(s){if(this.edgeToPosition[s.key])throw Error("Edge layout is already registered");this.edgeToPosition[s.key]=s},u.prototype.getRectangle=function(s){var i=this;return m.GeometryUtils.getCommonRectangle(this.nodeKeys.map(function(t){return i.nodeToLayout[t].rectangle}))},u.prototype.offsetNodes=function(s,i){var t=this;s===void 0&&(s=0),i===void 0&&(i=0);var e=new u;return this.nodeKeys.forEach(function(n){var o=t.nodeToLayout[n];e.addNode(new P.NodeLayout(o.info,o.position.clone().offset(s,i)))}),e.copyEdges(this),e},u.prototype.extend=function(s){var i=this;s.forEachNode(function(t){return i.addNode(t)}),this.copyEdges(s)},u.prototype.copyEdges=function(s){var i=this;Object.keys(s.edgeToPosition).forEach(function(t){var e=s.edgeToPosition[t];i.addEdge(new P.EdgeLayout(e.key,e.beginIndex,e.endIndex))})},u}();h.GraphLayout=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.LayoutBuilder=void 0;var m=d(20),P=function(){function p(u,s){this.settings=u,this.graph=s}return p.prototype.getBreadthNodeSizeCore=function(u,s){var i=this.settings.orientation===m.DataLayoutOrientation.Vertical?u.size.width:u.size.height;return s||(i+=this.settings.orientation===m.DataLayoutOrientation.Vertical?u.margin.left+u.margin.right:u.margin.top+u.margin.bottom),i},p.prototype.getDepthNodeSizeCore=function(u){return this.settings.orientation===m.DataLayoutOrientation.Horizontal?u.size.width+u.margin.left+u.margin.right:u.size.height+u.margin.top+u.margin.bottom},p.prototype.chooseDirectionValue=function(u,s){return this.settings.direction===m.LogicalDirectionKind.Forward?u:s},p.prototype.getDirectionValue=function(u){return this.settings.direction===m.LogicalDirectionKind.Forward?u:-u},p.prototype.getComponentOffset=function(u){var s=u.getRectangle(!0);return(this.settings.orientation===m.DataLayoutOrientation.Vertical?s.width:s.height)+this.settings.componentSpacing},p.prototype.setComponentOffset=function(u,s){return this.settings.orientation===m.DataLayoutOrientation.Vertical?u.offsetNodes(s):u.offsetNodes(0,s)},p}();h.LayoutBuilder=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasManager=void 0;var p=d(99),u=function(s){function i(){var t=s!==null&&s.apply(this,arguments)||this;return t.pendingChanges={},t.pendingRemoveChanges={},t.updatesLock=0,t}return P(i,s),i.prototype.beginUpdate=function(){this.updatesLock++},i.prototype.endUpdate=function(){this.updatesLock--,this.updatesLock===0&&this.applyPendingChanges()},i.prototype.getPendingChanges=function(){var t=this;return Object.keys(this.pendingChanges).map(function(e){return t.pendingChanges[e]})},i.prototype.getPendingRemoveChanges=function(){var t=this;return Object.keys(this.pendingRemoveChanges).map(function(e){return t.pendingRemoveChanges[e]})},i.prototype.applyPendingChanges=function(){var t=this.getPendingRemoveChanges();t.length&&(this.applyChangesCore(t),this.pendingRemoveChanges={});var e=this.getPendingChanges();e.length&&(this.applyChangesCore(e),this.pendingChanges={})},i.prototype.applyChangesCore=function(t){var e=this,n=[];t.forEach(function(o){e.applyChange(o)||n.push(o)}),n.length&&n.length!==t.length&&this.applyChangesCore(n)},i.prototype.postponeChanges=function(t){var e=this;t.forEach(function(n){if(n.type===p.ItemChangeType.Remove)e.pendingRemoveChanges[n.key]=n,delete e.pendingChanges[n.key];else if(e.pendingChanges[n.key])n.type===p.ItemChangeType.Create?e.pendingChanges[n.key]=n:n.type===p.ItemChangeType.UpdateStructure?e.pendingChanges[n.key].type===p.ItemChangeType.UpdateProperties&&(e.pendingChanges[n.key]=n):n.type===p.ItemChangeType.UpdateProperties?e.pendingChanges[n.key].type===p.ItemChangeType.Update&&(e.pendingChanges[n.key]=n):n.type===p.ItemChangeType.UpdateClassName&&e.pendingChanges[n.key].type===p.ItemChangeType.UpdateClassName&&(e.pendingChanges[n.key]=n);else{if(e.pendingRemoveChanges[n.key]&&n.type!==p.ItemChangeType.Create)throw new Error("Incorrect model changes sequence.");e.pendingChanges[n.key]=n}})},i.prototype.applyOrPostponeChanges=function(t){this.updatesLock===0?this.applyChangesCore(t):this.postponeChanges(t)},i.prototype.notifyModelChanged=function(t){this.applyOrPostponeChanges(t)},i.prototype.notifyPageColorChanged=function(t){},i.prototype.notifyPageSizeChanged=function(t,e){},i}(d(42).CanvasManagerBase);h.CanvasManager=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.PasteSelectionCommandBase=void 0;var p=d(101),u=d(119),s=d(14),i=d(266),t=d(6),e=d(267),n=d(4),o=d(68),r=d(0),a=d(12),c=function(l){function y(){return l!==null&&l.apply(this,arguments)||this}return P(y,l),y.prototype.isEnabled=function(){return l.prototype.isEnabled.call(this)&&(this.isPasteSupportedByBrowser()||p.ClipboardCommand.clipboardData!==void 0)},y.prototype.isVisible=function(){return this.isPasteSupportedByBrowser()||p.ClipboardCommand.clipboardData!==void 0},y.prototype.parseClipboardData=function(g){var f;f=new u.Importer(this.control.shapeDescriptionManager,g).importItems(this.control.model);var v=this.getEventPositionOffset(f,this.control.contextMenuPosition);v=this.getCorrectedOffsetByModel(f,v);for(var C=0;C<f.length;C++){var b=f[C];b instanceof s.Shape?b.position.offsetByPoint(v):b instanceof t.Connector&&b.points.forEach(function(S){return S.offsetByPoint(v)})}return f},y.prototype.getCorrectedOffsetByModel=function(g,f){var v=g.reduce(function(S,x){var I=x instanceof s.Shape?x.position.x:x instanceof t.Connector?x.getMinX():Number.MAX_VALUE,w=x instanceof s.Shape?x.position.y:x instanceof t.Connector?x.getMinY():Number.MAX_VALUE;return(w<S.y||w===S.y&&I<S.x)&&(S.topLeftItem=x,S.x=I,S.y=w),S},{topLeftItem:g[0],x:Number.MAX_VALUE,y:Number.MAX_VALUE}).topLeftItem;if(v instanceof s.Shape){var C=this.getShapeCorrectedPosition(this.control.model,v,f);return new r.Point(C.x-v.position.x,C.y-v.position.y)}if(v instanceof t.Connector){var b=this.getConnectorCorrectedPoints(this.control.model,v,f);return new r.Point(v.points[0].x-b[0].x,v.points[0].y-b[0].y)}},y.prototype.executeCore=function(g,f){var v=this,C=!0;return f?this.performPaste(f):this.getClipboardData(function(b){C=v.execute(b)}),C},y.prototype.addItemForSortingRecursive=function(g,f){if(g[f.key])return g[f.key];if(f instanceof t.Connector)return f.endItem?g[f.key]=this.addItemForSortingRecursive(g,f.endItem)-.5:f.beginItem?g[f.key]=this.addItemForSortingRecursive(g,f.beginItem)+.5:g[f.key]=-1,g[f.key];if(f.attachedConnectors.length===0)return g[f.key]=0;for(var v=0;v<f.attachedConnectors.length;v++){var C=f.attachedConnectors[v].beginItem;return f.attachedConnectors[v].endItem===f&&C&&C!==f.attachedConnectors[v].endItem?g[f.key]=this.addItemForSortingRecursive(g,C)+1:g[f.key]=0}},y.prototype.getSortedPasteItems=function(g){for(var f=[],v=[],C={},b=0;b<g.length;b++){var S=g[b];S instanceof s.Shape?f.push(S):S instanceof t.Connector&&(v.push(S),this.addItemForSortingRecursive(C,S))}return v.sort(function(x,I){return C[I.key]-C[x.key]}),f.concat(v)},y.prototype.performPaste=function(g){this.control.beginUpdateCanvas(),this.control.history.beginTransaction();var f={},v=this.parseClipboardData(g);v=this.getSortedPasteItems(v);for(var C=0;C<v.length;C++){var b=v[C];b instanceof s.Shape?this.control.history.addAndRedo(new i.ImportShapeHistoryItem(b)):b instanceof t.Connector&&this.control.history.addAndRedo(new e.ImportConnectorHistoryItem(b));var S=b.container&&b.container.key;S&&f[S]!==void 0?S&&f[S]!==void 0&&(f[b.key]=!1):f[b.key]=!0}n.ModelUtils.tryUpdateModelRectangle(this.control.history),this.control.history.addAndRedo(new o.SetSelectionHistoryItem(this.control.selection,Object.keys(f).filter(function(x){return f[x]}))),this.control.history.endTransaction(),this.control.endUpdateCanvas(),this.control.barManager.updateItemsState()},y.prototype.getShapeCorrectedPosition=function(g,f,v){for(var C=f.position.clone().offsetByPoint(v);g.findShapeAtPosition(C);)C.offset(y.positionOffset,y.positionOffset);return C},y.prototype.getConnectorCorrectedPoints=function(g,f,v){for(var C=f.points.map(function(b){return b.clone().offsetByPoint(v)});g.findConnectorAtPoints(C);)C.forEach(function(b){b.x+=y.positionOffset,b.y+=y.positionOffset});return C},Object.defineProperty(y.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),y.positionOffset=a.UnitConverter.pixelsToTwips(10),y}(p.ClipboardCommand);h.PasteSelectionCommandBase=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutLayeredHorizontalCommand=void 0;var p=d(76),u=d(80),s=d(20),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.createLayoutSettings=function(){var n=new s.LayoutSettings;return n.orientation=s.DataLayoutOrientation.Horizontal,n},e.prototype.createLayout=function(n,o){return new u.SugiyamaLayoutBuilder(n,o).build()},e}(p.AutoLayoutCommandBase);h.AutoLayoutLayeredHorizontalCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutTreeHorizontalCommand=void 0;var p=d(76),u=d(97),s=d(20),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.createLayoutSettings=function(){var n=this.control.settings.snapToGrid?this.control.settings.gridSize:void 0,o=new s.TreeLayoutSettings(n);return o.orientation=s.DataLayoutOrientation.Horizontal,o},e.prototype.createLayout=function(n,o){return new u.TreeLayoutBuilder(n,o).build()},e}(p.AutoLayoutCommandBase);h.AutoLayoutTreeHorizontalCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutLayeredVerticalCommand=void 0;var p=d(76),u=d(80),s=d(20),i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.createLayoutSettings=function(){var n=new s.LayoutSettings;return n.orientation=s.DataLayoutOrientation.Vertical,n},e.prototype.createLayout=function(n,o){return new u.SugiyamaLayoutBuilder(n,o).build()},e}(p.AutoLayoutCommandBase);h.AutoLayoutLayeredVerticalCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeLockedCommand=void 0;var p=d(4),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabled=function(){var t=this,e=this.control.selection.getSelectedItems(!0),n=!1;return e.forEach(function(o){o.locked!==t.getLockState()&&(n=!0)}),s.prototype.isEnabled.call(this)&&n},i.prototype.executeCore=function(t,e){return p.ModelUtils.changeSelectionLocked(this.control.history,this.control.model,this.control.selection,this.getLockState()),!0},i}(d(10).SimpleCommandBase);h.ChangeLockedCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeShapeImageHistoryItem=void 0;var p=d(8),u=d(51),s=function(i){function t(e,n){var o=i.call(this)||this;return o.shapeKey=e.key,o.imageUrl=n,o}return P(t,i),t.prototype.redo=function(e){var n=e.model.findShape(this.shapeKey);this.oldImage=n.image,e.changeShapeImage(n,new u.ImageInfo(this.imageUrl))},t.prototype.undo=function(e){var n=e.model.findShape(this.shapeKey);e.changeShapeImage(n,this.oldImage)},t}(p.HistoryItem);h.ChangeShapeImageHistoryItem=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(f,v){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,b){C.__proto__=b}||function(C,b){for(var S in b)b.hasOwnProperty(S)&&(C[S]=b[S])})(f,v)},function(f,v){function C(){this.constructor=f}m(f,v),f.prototype=v===null?Object.create(v):(C.prototype=v.prototype,new C)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDefaultState=void 0;var p=d(11),u=d(305),s=d(306),i=d(307),t=d(308),e=d(309),n=d(310),o=d(311),r=d(312),a=d(149),c=d(319),l=d(6),y=d(320),g=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.finish=function(){this.visualizerManager.resetConnectionPoints(),f.prototype.finish.call(this)},v.prototype.onMouseDownCore=function(C){this.handler.canScrollPage(C)?this.startScrolling(C):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ConnectorText?(this.handler.changeSingleSelection(C.source.key),this.handler.switchState(new r.MouseHandlerMoveConnectorTextState(this.handler,this.history,this.model))):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ShapeResizeBox?this.handler.switchState(new s.MouseHandlerResizeShapeState(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.settings)):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ShapeParameterBox?this.handler.switchState(new t.MouseHandlerDragParameterPointState(this.handler,this.history,this.model)):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ConnectorPoint?this.handler.switchState(new u.MouseHandlerMoveConnectorPointState(this.handler,this.history,this.model,this.visualizerManager)):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ConnectorSide?this.handler.switchState(new i.MouseHandlerMoveConnectorSideState(this.handler,this.history,this.model)):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ConnectorOrthogonalSide?this.handler.switchState(new n.MouseHandlerMoveConnectorOrthogonalSideState(this.handler,this.history,this.model)):C.button===p.MouseButton.Left&&C.source.type===p.MouseEventElementType.ShapeConnectionPoint?this.handler.switchState(new e.MouseHandlerCreateConnectorState(this.handler,this.history,this.model,this.visualizerManager,this.shapeDescriptionManager,this.selection)):f.prototype.onMouseDownCore.call(this,C)},v.prototype.onDragDiagramItemOnMouseDown=function(C){this.handler.canAddDiagramItemToSelection(C)?C.source.type===p.MouseEventElementType.Shape?this.handler.switchState(new c.MouseHandlerMoveShapeState(this.handler,this.history,this.model,this.selection,this.visualizerManager)):C.source.type===p.MouseEventElementType.Connector&&this.handler.switchState(new y.MouseHandlerMoveConnectorState(this.handler,this.history,this.model,this.selection,this.visualizerManager)):f.prototype.onDragDiagramItemOnMouseDown.call(this,C)},v.prototype.onDragStart=function(C){this.handler.switchState(new o.MouseHandlerBeforeToolboxDraggingState(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.shapeDescriptionManager)),this.handler.state.onDragStart(C)},v.prototype.onMouseMoveCore=function(C){this.updateConnectionsOnMouseMove(C),f.prototype.onMouseMoveCore.call(this,C)},v.prototype.onMouseUp=function(C){this.handler.canRemoveDiagramItemToSelection(C)?this.handler.removeDiagramItemFromSelection(C.button,C.source.key):f.prototype.onMouseUp.call(this,C)},v.prototype.updateConnectionsOnMouseMove=function(C){var b=this.model.findItem(C.source.key);this.visualizerManager.updateConnections(b,C.source.type,C.source.value)},v.prototype.canDragObjectOnMouseDown=function(C){return!0},v.prototype.canExpandContainerOnMouseDown=function(C){return!0},v.prototype.canClearSelectionOnMouseDown=function(){return!1},v.prototype.canSelectOnMouseUp=function(C){return!1},v.prototype.canClearSelectionOnMouseUp=function(){return!0},v.prototype.onConnectionPointsShow=function(C,b){var S=this,x=this.model.findShape(C);x&&b.forEach(function(I,w){I.allowed=S.handler.canPerformChangeConnectionOnUpdateUI(void 0,{item:x,position:l.ConnectorPosition.Begin,connectionPointIndex:w})})},v}(a.MouseHandlerDefaultStateBase);h.MouseHandlerDefaultState=g},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveConnectorPointStateBase=void 0;var p=d(6),u=d(11),s=d(34),i=d(67),t=d(48),e=d(4),n=function(o){function r(a,c,l,y){var g=o.call(this,a,c)||this;return g.model=l,g.visualizerManager=y,g}return P(r,o),r.prototype.finish=function(){this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints(),o.prototype.finish.call(this)},r.prototype.onMouseDown=function(a){o.prototype.onMouseDown.call(this,a),this.connector&&this.handler.addInteractingItem(this.connector)},r.prototype.onMouseMove=function(a){if(o.prototype.onMouseMove.call(this,a),this.allowAttachToObjects(a,!1,!1)){if(this.connector){var c=this.connector.getExtremeItem(this.pointPosition);this.visualizerManager.setConnectionTarget(c,a.source.type);var l=this.connector.getExtremeConnectionPointIndex(this.pointPosition);(c||this.oppositeConnectionPointIndex===-1)&&this.allowAttachToObjects(a,!0,!1)||(c=this.model.findItem(a.source.key)),this.visualizerManager.setConnectionPoints(c,a.source.type,l,!0)}}else this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints()},r.prototype.onApplyChanges=function(a){var c=this.getSnappedPoint(a,a.modelPoint);if(this.pointPosition!==void 0){this.oppositePointPosition===void 0&&(this.oppositePointPosition=this.getOppositePointPosition(),this.oppositeItem=this.connector.getExtremeItem(this.oppositePointPosition),this.oppositeConnectionPointIndex=this.connector.getExtremeConnectionPointIndex(this.oppositePointPosition)),this.targetItem=this.model.findItem(a.source.key);var l=this.allowAttachToObjects(a,!0,!0)?this.targetItem:void 0,y=-1;a.source.type===u.MouseEventElementType.ShapeConnectionPoint&&(y=parseInt(a.source.value)),!l||a.source.type!==u.MouseEventElementType.Shape&&a.source.type!==u.MouseEventElementType.ShapeConnectionPoint||this.connector.getExtremeItem(this.oppositePointPosition)===l&&(y===-1||this.oppositeConnectionPointIndex===-1||y===this.oppositeConnectionPointIndex)?this.connector.getExtremeItem(this.pointPosition)&&(this.history.addAndRedo(new i.DeleteConnectionHistoryItem(this.connector,this.pointPosition)),this.oppositeItem&&this.updateOppositeItemConnectionPointIndex(this.oppositeConnectionPointIndex)):(this.connector.getExtremeItem(this.pointPosition)===l&&this.connector.getExtremeConnectionPointIndex(this.pointPosition)===y||(this.connector.getExtremeItem(this.pointPosition)&&this.history.addAndRedo(new i.DeleteConnectionHistoryItem(this.connector,this.pointPosition)),this.history.addAndRedo(new t.AddConnectionHistoryItem(this.connector,l,y,this.pointPosition)),this.oppositeItem&&this.updateOppositeItemConnectionPointIndex(y)),c=l.getConnectionPointPosition(y,this.connector.points[this.pointIndex+(this.pointPosition===p.ConnectorPosition.End?-1:1)]),this.visualizerManager.setConnectionPointIndex(y))}e.ModelUtils.moveConnectorPoint(this.history,this.connector,this.pointIndex,c),e.ModelUtils.updateConnectorAttachedPoints(this.history,this.model,this.connector),this.handler.tryUpdateModelSize()},r.prototype.updateOppositeItemConnectionPointIndex=function(a){var c=a===-1?-1:this.oppositeConnectionPointIndex;c!==this.connector.getExtremeConnectionPointIndex(this.oppositePointPosition)&&(this.history.addAndRedo(new i.DeleteConnectionHistoryItem(this.connector,this.oppositePointPosition)),this.history.addAndRedo(new t.AddConnectionHistoryItem(this.connector,this.oppositeItem,c,this.oppositePointPosition)))},r.prototype.onFinishWithChanges=function(){e.ModelUtils.updateConnectorContainer(this.history,this.model,this.connector),e.ModelUtils.deleteConnectorUnnecessaryPoints(this.history,this.connector),this.handler.tryUpdateModelSize()},r.prototype.getDraggingElementKeys=function(){return this.connector?[this.connector.key]:[]},r.prototype.getOppositePointPosition=function(){return this.pointPosition===p.ConnectorPosition.Begin?p.ConnectorPosition.End:p.ConnectorPosition.Begin},r.prototype.allowAttachToObjects=function(a,c,l){if(this.handler.canMultipleSelection(a))return!1;var y=this.connector;if(y&&a.source.type===u.MouseEventElementType.Shape){var g=this.model.findItem(a.source.key);if(c&&this.model.findItemContainerCore(y,function(f){return f===g})||c&&this.oppositeItem&&this.model.findItemContainerCore(this.oppositeItem,function(f){return f===g})||l&&this.oppositeItem===g&&this.oppositeConnectionPointIndex===-1)return!1}return!0},r.prototype.onConnectionPointsShow=function(a,c){var l=this;if(this.connector&&this.pointPosition!==void 0&&(this.connector.endItem&&this.connector.endItem.key===a||this.connector.beginItem&&this.connector.beginItem.key===a)){var y=this.connector.beginItem&&this.connector.beginItem.key===a?p.ConnectorPosition.Begin:p.ConnectorPosition.End;c.forEach(function(g,f){g.allowed=l.handler.canPerformChangeConnectionOnUpdateUI(l.connector,{item:l.connector.getExtremeItem(y),position:y,connectionPointIndex:f})})}},r.prototype.onConnectionTargetShow=function(a,c){if(this.connector&&this.pointPosition!==void 0&&(this.connector.endItem&&this.connector.endItem.key===a||this.connector.beginItem&&this.connector.beginItem.key===a)){var l=this.connector.beginItem&&this.connector.beginItem.key===a?p.ConnectorPosition.Begin:p.ConnectorPosition.End;c.allowed=this.handler.canPerformChangeConnectionOnUpdateUI(this.connector,{item:this.connector.getExtremeItem(l),position:l,connectionPointIndex:-1})}},r}(s.MouseHandlerDraggingState);h.MouseHandlerMoveConnectorPointStateBase=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(a,c){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var g in y)y.hasOwnProperty(g)&&(l[g]=y[g])})(a,c)},function(a,c){function l(){this.constructor=a}m(a,c),a.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDefaultStateBase=void 0;var p=d(40),u=d(11),s=d(314),i=d(316),t=d(317),e=d(150),n=d(12),o=d(318),r=function(a){function c(l,y,g,f,v,C,b,S){var x=a.call(this,l)||this;return x.history=y,x.selection=g,x.model=f,x.view=v,x.visualizerManager=C,x.shapeDescriptionManager=b,x.settings=S,x}return P(c,a),c.prototype.onKeyDown=function(l){this.handler.onStartScrollPageByKeyboard(l)},c.prototype.onKeyUp=function(l){this.handler.onFinishScrollPageByKeyboard(l)},c.prototype.onMouseDown=function(l){this.handler.canFinishTextEditing()&&(this.onMouseDownCore(l),this.handler.state!==this&&this.handler.state.onMouseDown(l))},c.prototype.onMouseDownCore=function(l){this.handler.canScrollPage(l)?this.startScrolling(l):this.hasDiagramItem(l)&&this.canDragObjectOnMouseDown(l.source.key)?this.onDragDiagramItemOnMouseDown(l):l.button===u.MouseButton.Left&&l.source.type===u.MouseEventElementType.ShapeExpandButton&&this.canExpandContainerOnMouseDown(l.source.key)?this.onShapeExpandBtnMouseDown(l):(!this.hasDiagramItem(l)&&this.canClearSelectionOnMouseDown()&&this.clearSelection(),this.startPoint=l.modelPoint)},c.prototype.onDragDiagramItemOnMouseDown=function(l){this.replaceSelection(l)},c.prototype.onMouseMove=function(l){this.onMouseMoveCore(l),this.handler.state!==this&&(this.handler.state.onMouseDown(this.handler.mouseDownEvent),this.handler.state.onMouseMove(l))},c.prototype.onMouseMoveCore=function(l){this.startPoint&&(Math.abs(this.startPoint.x-l.modelPoint.x)>c.startLimit||Math.abs(this.startPoint.y-l.modelPoint.y)>c.startLimit)&&(this.processOnMouseMoveAfterLimit(l),this.startPoint=void 0)},c.prototype.processOnMouseMoveAfterLimit=function(l){l.isTouchMode?l.touches.length>1?this.startZooming(l):this.startScrolling(l):this.startSelection(l)},c.prototype.onMouseUp=function(l){this.onMouseUpCore(l),this.handler.state!==this&&this.handler.state.onMouseUp(l)},c.prototype.onMouseUpCore=function(l){l.source.type===u.MouseEventElementType.Shape&&this.canSelectOnMouseUp(l.source.key)?this.replaceSelection(l):l.source.type===u.MouseEventElementType.Connector&&this.canSelectOnMouseUp(l.source.key)?this.replaceSelection(l):l.source.type===u.MouseEventElementType.ShapeExpandButton&&this.canSelectOnMouseUp(l.source.key)?this.replaceSelection(l):this.startPoint&&this.canClearSelectionOnMouseUp()&&this.clearSelection(),this.startPoint=void 0},c.prototype.onMouseWheel=function(l){return!!this.handler.canStartZoomOnWheel(l)&&(this.handler.switchState(new t.MouseHandlerZoomOnWheelState(this.handler,this.settings,this.view)),this.handler.state.onMouseWheel(l),!0)},c.prototype.onLongTouch=function(l){this.replaceMultipleSelection(l.source.key)},c.prototype.finish=function(){this.startPoint=void 0},c.prototype.startSelection=function(l){l.button===u.MouseButton.Left&&this.handler.switchState(new i.MouseHandlerSelectionState(this.handler,this.selection,this.visualizerManager))},c.prototype.startScrolling=function(l){l.button===u.MouseButton.Left&&(this.handler.raiseDragScrollStart(),this.handler.switchState(new e.MouseHandlerScrollingState(this.handler,this.view,this.selection)))},c.prototype.startZooming=function(l){this.handler.switchState(new o.MouseHandlerZoomOnPinchState(this.handler,this.selection,this.settings,this.view))},c.prototype.inSelection=function(l){return this.selection.hasKey(l)},c.prototype.hasDiagramItem=function(l){return l.source.type===u.MouseEventElementType.Shape||l.source.type===u.MouseEventElementType.Connector},c.prototype.onShapeExpandBtnMouseDown=function(l){this.handler.addDiagramItemToSelection(l),this.handler.switchState(new s.MouseHandlerToggleShapeExpandedState(this.handler,this.history,this.model,this.selection))},c.prototype.replaceSelection=function(l){this.handler.canMultipleSelection(l)?this.replaceMultipleSelection(l.source.key):this.handler.changeSingleSelection(l.source.key)},c.prototype.replaceMultipleSelection=function(l){this.selection.hasKey(l)?this.selection.remove(l):this.selection.add(l)},c.prototype.clearSelection=function(){this.selection.set([])},c.startLimit=n.UnitConverter.pixelsToTwips(1),c}(p.MouseHandlerStateBase);h.MouseHandlerDefaultStateBase=r},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerScrollingState=void 0;var p=d(40),u=d(11),s=d(0),i=function(t){function e(n,o,r){var a=t.call(this,n)||this;return a.view=o,a.selection=r,a.lastOffset=new s.Point(0,0),a}return P(e,t),e.prototype.onKeyUp=function(n){this.handler.onFinishScrollPageByKeyboard(n)},e.prototype.onMouseDown=function(n){n.preventDefault=!0,this.startPoint=this.getPointByEvent(n)},e.prototype.onMouseMove=function(n){if(n.button===u.MouseButton.Left){var o=this.currentPoint||this.startPoint;n.preventDefault=!0;var r=this.getPointByEvent(n),a=this.view.scrollBy(new s.Point(r.x-o.x,r.y-o.y));this.lastOffset=this.lastOffset.clone().offset(a.x,a.y),this.currentPoint=r}else this.handler.onFinishScrollPageByMouse(n)},e.prototype.onMouseUp=function(n){n.button===u.MouseButton.Left&&this.handler.onFinishScrollPageByMouse(n),this.handler.switchToDefaultState()},e.prototype.cancelChanges=function(){this.currentPoint&&this.view.scrollBy(this.lastOffset.clone().multiply(-1,-1))},e.prototype.finish=function(){this.currentPoint&&this.startPoint&&!this.currentPoint.equals(this.startPoint)||this.selection.set([]),t.prototype.finish.call(this)},e.prototype.getPointByEvent=function(n){return n.offsetPoint},e}(p.MouseHandlerCancellableState);h.MouseHandlerScrollingState=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDragDiagramItemStateBase=h.DraggingConnector=void 0;var p=d(60),u=d(86),s=d(29),i=d(85),t=d(4),e=d(16),n=d(11),o=d(34),r=function(){return function(l){this.connector=l,this.startPoints=l.points.map(function(y){return y.clone()}),this.startRenderContext=l.tryCreateRenderPointsContext()}}();h.DraggingConnector=r;var a=function(){return function(l){this.shape=l,this.startPosition=l.position.clone()}}(),c=function(l){function y(g,f,v,C,b){var S=l.call(this,g,f)||this;return S.model=v,S.selection=C,S.visualizerManager=b,S.startScrollLeft=0,S.startScrollTop=0,S}return P(y,l),y.prototype.finish=function(){this.visualizerManager.resetExtensionLines(),this.visualizerManager.resetContainerTarget(),this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints(),l.prototype.finish.call(this)},y.prototype.onMouseDown=function(g){var f=this;this.handler.addDiagramItemToSelection(g),this.shouldClone=this.handler.canCopySelectedItems(g),this.startPoint=g.modelPoint,this.initDrag(),this.lockInitDrag=!1,this.shouldClone||this.draggingShapes.forEach(function(v){return f.handler.addInteractingItem(v.shape,e.DiagramModelOperation.MoveShape)}),l.prototype.onMouseDown.call(this,g)},y.prototype.onMouseMove=function(g){this.mouseMoveEvent=g,g.button!==n.MouseButton.Left&&(this.cancelChanges(),this.handler.switchToDefaultState()),this.canApplyChangesOnMouseMove(this.startPoint,g.modelPoint)&&(this.handler.canCopySelectedItems(g)&&(this.lockInitDrag||(this.cancelChanges(),this.shouldClone=!0,this.copySelection(),this.initDrag(),this.lockInitDrag=!0)),this.onApplyChanges(g),this.onAfterApplyChanges(),this.updateContainers(g))},y.prototype.updateContainers=function(g){this.visualizerManager.setExtensionLines(this.selection.getSelectedShapes(!1,!0));var f=t.ModelUtils.findContainerByEventKey(this.model,this.selection,g.source.key);f&&this.allowInsertToContainer(g,f)?this.visualizerManager.setContainerTarget(f,g.source.type):this.visualizerManager.resetContainerTarget()},y.prototype.onMouseUp=function(g){l.prototype.onMouseUp.call(this,g),this.handler.canRemoveDiagramItemToSelection(g)&&this.handler.canMultipleSelection(g)&&this.handler.removeDiagramItemFromSelection(g.button,g.source.key)},y.prototype.onApplyChanges=function(g){var f=this;if(this.calculateFixedPosition(g),this.draggingShapes.length){var v=this.draggingShapes.map(function(x){return x.shape});this.draggingShapes.forEach(function(x){for(var I=x.shape;I.container;){if(v.indexOf(I.container)!==-1)return!1;I=I.container}f.moveShape(x,g)});var C=this.draggingShapes[0],b=p.Vector.fromPoints(C.startPosition.clone(),C.shape.position.clone());(b.x||b.y)&&this.draggingConnectors.forEach(function(x){return f.moveConnectorCore(x.connector,x.startPoints,x.startRenderContext,b)})}else this.draggingConnectors.forEach(function(x){return f.moveConnector(x,g)});var S=t.ModelUtils.findContainerByEventKey(this.model,this.selection,g.source.key);S&&this.allowInsertToContainer(g,S)?t.ModelUtils.insertSelectionToContainer(this.history,this.model,this.selection,S):t.ModelUtils.removeSelectionFromContainer(this.history,this.model,this.selection),this.handler.tryUpdateModelSize(function(x,I){f.modelConnectorsWithoutBeginItemInfo.forEach(function(w){w.point.x+=x,w.point.y+=I}),f.modelConnectorsWithoutEndItemInfo.forEach(function(w){w.point.x+=x,w.point.y+=I})})},y.prototype.getDraggingElementKeys=function(){return this.draggingShapes.map(function(g){return g.shape.key}).concat(this.draggingConnectors.map(function(g){return g.connector.key}))},y.prototype.getSnappedPoint=function(g,f){return this.handler.getSnappedPointOnDragDiagramItem(g,f,this.fixedX,this.fixedY,this.startPoint)},y.prototype.initDrag=function(){this.selectedItems=t.ModelUtils.createSelectedItems(this.selection),this.initDraggingShapes(),this.areValidDraggingShapes?(this.initDraggingConnectors(),this.areValidDraggingConnectors?(this.modelConnectorsWithoutBeginItemInfo=this.createModelConnectorsWithoutBeginItemInfo(),this.modelConnectorsWithoutEndItemInfo=this.createModelConnectorsWithoutEndItemInfo()):this.handler.switchToDefaultState()):this.handler.switchToDefaultState()},y.prototype.initDraggingShapes=function(){this.draggingShapes=this.selection.getSelectedShapes(!1,!0).map(function(g){return new a(g)})},y.prototype.initDraggingConnectors=function(){var g=this;this.draggingConnectors=[],this.draggingConnectorsIndexByKey={},this.selection.getSelectedConnectors(!1,!0).forEach(function(f){return g.registerConnector(f)}),this.shouldClone||this.draggingShapes.forEach(function(f){var v=f.shape.attachedConnectors;v&&v.forEach(function(C){g.containsDraggingConnectorByKey(C.key)||g.registerConnector(C)})})},y.prototype.copySelection=function(){var g=this;t.ModelUtils.cloneSelectionToOffset(this.history,this.model,function(f){var v=g.model.findItem(f);v&&g.handler.addInteractingItem(v,e.DiagramModelOperation.AddShape)},this.selection,0,0)},y.prototype.calculateFixedPosition=function(g){this.fixedX=!1,this.fixedY=!1,this.handler.canCalculateFixedPosition(g)&&(Math.abs(this.startPoint.x-g.modelPoint.x)<Math.abs(this.startPoint.y-g.modelPoint.y)?this.fixedX=!0:this.fixedY=!0)},y.prototype.containsDraggingConnectorByKey=function(g){return this.draggingConnectorsIndexByKey[g]!==void 0},y.prototype.allowInsertToContainer=function(g,f){return!this.handler.canMultipleSelection(g)&&f&&f.expanded&&t.ModelUtils.canInsertSelectionToContainer(this.model,this.selection,f)},y.prototype.registerConnector=function(g){this.draggingConnectorsIndexByKey[g.key]=this.draggingConnectors.push(new r(g))-1},y.prototype.createModelConnectorsWithoutBeginItemInfo=function(){var g=this;return this.model.findConnectorsCore(function(f){return!f.beginItem&&!g.containsDraggingConnectorByKey(f.key)}).map(function(f){return{connector:f,point:f.points[0].clone()}})},y.prototype.createModelConnectorsWithoutEndItemInfo=function(){var g=this;return this.model.findConnectorsCore(function(f){return!f.endItem&&!g.containsDraggingConnectorByKey(f.key)}).map(function(f){return{connector:f,point:f.points[f.points.length-1].clone()}})},y.prototype.moveConnector=function(g,f){var v=g.startPoints,C=p.Vector.fromPoints(v[0].clone(),this.getSnappedPoint(f,v[0]).clone());(C.x||C.y)&&this.moveConnectorCore(g.connector,v,g.startRenderContext,C)},y.prototype.moveConnectorCore=function(g,f,v,C){this.shouldClone||t.ModelUtils.canMoveConnector(this.selectedItems,g)?this.offsetConnector(g,f,v,C):this.changeConnector(g)},y.prototype.moveShape=function(g,f){var v=this,C=g.shape,b=this.getSnappedPoint(f,g.startPosition);t.ModelUtils.setShapePosition(this.history,this.model,C,b),t.ModelUtils.updateMovingShapeConnections(this.history,C,this.modelConnectorsWithoutBeginItemInfo,this.modelConnectorsWithoutEndItemInfo,function(){v.visualizerManager.resetConnectionTarget(),v.visualizerManager.resetConnectionPoints()},function(S,x){v.visualizerManager.setConnectionTarget(S,n.MouseEventElementType.Shape),v.visualizerManager.setConnectionPoints(S,n.MouseEventElementType.Shape,x,!0)},function(S){return v.handler.addInteractingItem(S)}),this.draggingConnectors.filter(function(S){return!!v.selectedItems[S.connector.key]}).length||t.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,C)},y.prototype.offsetConnector=function(g,f,v,C){var b=this,S=f.map(function(x){return b.offsetPoint(x,C)});S[0].equals(g.points[0])||this.history.addAndRedo(new u.ChangeConnectorPointsHistoryItem(g.key,S,this.offsetRenderContext(v,C)))},y.prototype.offsetRenderContext=function(g,f){var v=this;if(g!==void 0)return new i.ConnectorRenderPointsContext(g.renderPoints.map(function(C){var b=v.offsetPoint(C,f);return new s.ConnectorRenderPoint(b.x,b.y,C.pointIndex,C.skipped)}),!0,g.actualRoutingMode)},y.prototype.offsetPoint=function(g,f){var v=p.Vector.fromPoints(g,this.startPoint);return this.startPoint.clone().offset(f.x-v.x,f.y-v.y)},y.prototype.changeConnector=function(g){t.ModelUtils.tryRemoveConnectorIntermediatePoints(this.history,g),t.ModelUtils.updateConnectorAttachedPoints(this.history,this.model,g)},y}(o.MouseHandlerDraggingState);h.MouseHandlerDragDiagramItemStateBase=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDefaultReadOnlyState=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.canDragObjectOnMouseDown=function(i){return!1},s.prototype.canExpandContainerOnMouseDown=function(i){return!1},s.prototype.canClearSelectionOnMouseDown=function(){return!1},s.prototype.canSelectOnMouseUp=function(i){return!0},s.prototype.canClearSelectionOnMouseUp=function(){return!0},s.prototype.updateConnectionsOnMouseMove=function(i){},s}(d(149).MouseHandlerDefaultStateBase);h.MouseHandlerDefaultReadOnlyState=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeShapeTextHistoryItem=void 0;var p=function(u){function s(i,t){var e=u.call(this)||this;return e.shapeKey=i.key,e.text=t,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findShape(this.shapeKey);this.oldText=t.text,i.changeShapeText(t,this.text)},s.prototype.undo=function(i){var t=i.model.findShape(this.shapeKey);i.changeShapeText(t,this.oldText)},s}(d(8).HistoryItem);h.ChangeShapeTextHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ContextMenuHandler=void 0;var p=d(3),u=d(11),s=d(25),i=d(81),t=d(18),e=function(n){function o(){var r=n!==null&&n.apply(this,arguments)||this;return r.contextMenuVisible=!1,r.textInputStarted=!1,r.canHideContextMenu=!0,r.onVisibilityChanged=new p.EventDispatcher,r}return P(o,n),o.prototype.onMouseDown=function(r){r.button===u.MouseButton.Left&&r.source.type!==u.MouseEventElementType.Undefined&&this.hideContextMenu()},o.prototype.onMouseUp=function(r){(!t.Browser.MacOSPlatform||t.Browser.MacOSPlatform&&this.canHideContextMenu)&&this.hideContextMenu(),this.canHideContextMenu=!0},o.prototype.onContextMenu=function(r){t.Browser.MacOSPlatform&&(this.canHideContextMenu=!1),this.showContextMenu(r.eventPoint,r.modelPoint)},o.prototype.onFocus=function(r){},o.prototype.onBlur=function(r){},o.prototype.onTextInputFocus=function(r){},o.prototype.onTextInputBlur=function(r){},o.prototype.onLongTouch=function(r){},o.prototype.onKeyDown=function(r){r.keyCode===s.KeyCode.Esc&&this.hideContextMenu()},o.prototype.onShortcut=function(r){this.hideContextMenu()},o.prototype.showContextMenu=function(r,a){var c=this;this.textInputStarted||window.setTimeout(function(){c.onVisibilityChanged.raise1(function(l){return l.notifyShowContextMenu(r,a)}),c.contextMenuVisible=!0},0)},o.prototype.hideContextMenu=function(){var r=this;this.contextMenuVisible&&window.setTimeout(function(){r.onVisibilityChanged.raise1(function(a){return a.notifyHideContextMenu()}),r.contextMenuVisible=!1},0)},o.prototype.notifyDragStart=function(r){},o.prototype.notifyDragEnd=function(r){},o.prototype.notifyDragScrollStart=function(){},o.prototype.notifyDragScrollEnd=function(){},o.prototype.notifyShowContextToolbox=function(r,a,c,l,y){},o.prototype.notifyHideContextToolbox=function(){},o.prototype.notifyTextInputStart=function(r,a,c,l){this.textInputStarted=!0},o.prototype.notifyTextInputEnd=function(r,a){this.textInputStarted=!1},o.prototype.notifyTextInputPermissionsCheck=function(r,a){},o.prototype.onUpdateUnlocked=function(r){},o}(i.BatchUpdatableObject);h.ContextMenuHandler=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(C,b){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,x){S.__proto__=x}||function(S,x){for(var I in x)x.hasOwnProperty(I)&&(S[I]=x[I])})(C,b)},function(C,b){function S(){this.constructor=C}m(C,b),C.prototype=b===null?Object.create(b):(S.prototype=b.prototype,new S)});Object.defineProperty(h,"__esModule",{value:!0}),h.VisualizerManager=void 0;var p=d(325),u=d(326),s=d(157),i=d(11),t=d(327),e=d(14),n=d(3),o=d(33),r=d(0),a=d(158),c=d(4),l=d(328),y=d(329),g=d(81),f=d(36),v=function(C){function b(S,x,I,w,_){_===void 0&&(_=w.readOnly);var T=C.call(this)||this;return T.selection=S,T.model=x,T.eventManager=I,T.settings=w,T.readOnly=_,T.onVisualizersUpdate=new n.EventDispatcher,T.connectionPointsVisualizer=new t.ConnectionPointsVisualizer(T.onVisualizersUpdate),T.connectionPointsVisualizer=new t.ConnectionPointsVisualizer(T.onVisualizersUpdate),T.connectionTargetVisualizer=new p.ConnectionTargetVisualizer(T.onVisualizersUpdate),T.containerTargetVisualizer=new u.ContainerTargetVisualizer(T.onVisualizersUpdate),T.extensionLinesVisualizer=new s.ExtensionLinesVisualizer(T.onVisualizersUpdate),T.resizeInfoVisualizer=new l.ResizeInfoVisualizer(T.onVisualizersUpdate),T.selectionRectangleVisualizer=new y.SelectionRectVisualizer(T.onVisualizersUpdate),T}return P(b,C),b.prototype.initialize=function(S){this.model=S},b.prototype.onMouseDown=function(S){},b.prototype.onMouseUp=function(S){},b.prototype.onMouseEnter=function(S){},b.prototype.onMouseLeave=function(S){this.resetConnectionPoints(),this.resetConnectionTarget(),this.resetExtensionLines(),this.resetContainerTarget(),this.resetResizeInfo(),this.resetSelectionRectangle()},b.prototype.onBlur=function(S){},b.prototype.onFocus=function(S){},b.prototype.updateConnections=function(S,x,I){var w=-1;I&&x===i.MouseEventElementType.ShapeConnectionPoint&&(w=parseInt(I));var _=S&&(!S.allowResizeHorizontally&&!S.allowResizeVertically||S.isLocked);this.setConnectionPoints(S,x,w,_)},b.prototype.setConnectionPoints=function(S,x,I,w){if(this.eventManager.isFocused())if(!S||x!==i.MouseEventElementType.Shape&&x!==i.MouseEventElementType.ShapeResizeBox&&x!==i.MouseEventElementType.ShapeConnectionPoint||S===void 0)this.connectionPointsVisualizer.reset();else{var _=S.key,T=this.selection.hasKey(_),R=S.getConnectionPoints();this.connectionPointsVisualizer.setPoints(_,R.map(function(E){return new t.ConnectionPointInfo(E,S.getConnectionPointSide(E))}),I,T&&!w&&S.rectangle)}},b.prototype.setConnectionPointIndex=function(S){this.connectionPointsVisualizer.setPointIndex(S)},b.prototype.updateConnectionPoints=function(){this.model.findItem(this.connectionPointsVisualizer.getKey())!==void 0?this.connectionPointsVisualizer.update():this.connectionPointsVisualizer.reset()},b.prototype.resetConnectionPoints=function(){this.connectionPointsVisualizer.reset()},b.prototype.setConnectionTarget=function(S,x){!S||x!==i.MouseEventElementType.Shape&&x!==i.MouseEventElementType.ShapeConnectionPoint?this.connectionTargetVisualizer.reset():this.connectionTargetVisualizer.setTargetRect(S.key,S.rectangle,S.strokeWidth)},b.prototype.resetConnectionTarget=function(){this.connectionTargetVisualizer.reset()},b.prototype.setContainerTarget=function(S,x){S&&!S.isLocked&&x===i.MouseEventElementType.Shape&&S.enableChildren?this.containerTargetVisualizer.setTargetRect(S.key,S.rectangle,S.strokeWidth):this.containerTargetVisualizer.reset()},b.prototype.resetContainerTarget=function(){this.containerTargetVisualizer.reset()},b.prototype.setExtensionLines=function(S){var x=this;if(this.eventManager.isFocused()){this.extensionLinesVisualizer.reset();var I=c.ModelUtils.createRectangle(S.filter(function(w){return w}));this.addPageExtensionLines(I),this.model.items.forEach(function(w){S.indexOf(w)>-1||w instanceof e.Shape&&x.addShapeExtensionLines(w,I)})}},b.prototype.addPageExtensionLines=function(S){for(var x=Math.round(this.model.size.width/this.model.pageWidth),I=Math.round(this.model.size.height/this.model.pageHeight),w=0;w<x;w++)for(var _=0;_<I;_++){var T=new r.Point(w*this.model.pageWidth+this.model.pageWidth/2,_*this.model.pageHeight+this.model.pageHeight/2);if(Math.abs(S.center.x-T.x)<this.settings.gridSize/2){var R=new o.Segment(new r.Point(S.center.x,0),new r.Point(S.center.x,this.model.size.height));this.extensionLinesVisualizer.addSegment(s.ExtensionLineType.HorizontalCenterToPageCenter,R,"")}Math.abs(S.center.y-T.y)<this.settings.gridSize/2&&(R=new o.Segment(new r.Point(0,S.center.y),new r.Point(this.model.size.width,S.center.y)),this.extensionLinesVisualizer.addSegment(s.ExtensionLineType.VerticalCenterToPageCenter,R,"")),Math.abs(S.x-T.x)<this.settings.gridSize/2&&(R=new o.Segment(new r.Point(S.x,0),new r.Point(S.x,this.model.size.height)),this.extensionLinesVisualizer.addSegment(s.ExtensionLineType.LeftToPageCenter,R,"")),Math.abs(S.y-T.y)<this.settings.gridSize/2&&(R=new o.Segment(new r.Point(0,S.y),new r.Point(this.model.size.width,S.y)),this.extensionLinesVisualizer.addSegment(s.ExtensionLineType.TopToPageCenter,R,"")),Math.abs(S.right-T.x)<this.settings.gridSize/2&&(R=new o.Segment(new r.Point(S.right,0),new r.Point(S.right,this.model.size.height)),this.extensionLinesVisualizer.addSegment(s.ExtensionLineType.RightToPageCenter,R,"")),Math.abs(S.bottom-T.y)<this.settings.gridSize/2&&(R=new o.Segment(new r.Point(0,S.bottom),new r.Point(this.model.size.width,S.bottom)),this.extensionLinesVisualizer.addSegment(s.ExtensionLineType.BottomToPageCenter,R,""))}},b.prototype.addShapeExtensionLines=function(S,x){var I,w,_,T,R,E,D,L,H=S.rectangle,O=S.strokeWidth-a.CanvasSelectionManager.extensionLineWidth,z=!0;if(x.right<H.x?(I=x.right,_=H.x,R=I+O+a.CanvasSelectionManager.extensionLineOffset,D=_-a.CanvasSelectionManager.extensionLineOffset):x.x>H.right&&(I=x.x,_=H.right,R=I-a.CanvasSelectionManager.extensionLineOffset,D=_+O+a.CanvasSelectionManager.extensionLineOffset),x.bottom<H.y?(w=x.bottom,T=H.y,E=w+O+a.CanvasSelectionManager.extensionLineOffset,L=T-a.CanvasSelectionManager.extensionLineOffset):x.y>H.bottom&&(w=x.y,T=H.bottom,E=w-a.CanvasSelectionManager.extensionLineOffset,L=T+O+a.CanvasSelectionManager.extensionLineOffset),R!==void 0&&D!==void 0){var K=this.getViewUnitText(Math.abs(I-_));if(x.center.y===H.center.y){var A=new o.Segment(new r.Point(R,x.center.y),new r.Point(D,H.center.y));this.extensionLinesVisualizer.addSegment(R>D?s.ExtensionLineType.VerticalCenterAfter:s.ExtensionLineType.VerticalCenterBefore,A,z?K:""),z=!1}x.y===H.y&&(A=new o.Segment(new r.Point(R,x.y),new r.Point(D,H.y)),this.extensionLinesVisualizer.addSegment(R>D?s.ExtensionLineType.TopToTopAfter:s.ExtensionLineType.TopToTopBefore,A,z?K:"")),x.bottom===H.bottom&&(A=new o.Segment(new r.Point(R,x.bottom+O),new r.Point(D,H.bottom+O)),this.extensionLinesVisualizer.addSegment(R>D?s.ExtensionLineType.BottomToBottomAfter:s.ExtensionLineType.BottomToBottomBefore,A,z?K:"")),x.y===H.bottom&&(A=new o.Segment(new r.Point(R,x.y),new r.Point(D,H.bottom+O)),this.extensionLinesVisualizer.addSegment(R>D?s.ExtensionLineType.TopToBottomAfter:s.ExtensionLineType.TopToBottomBefore,A,z?K:"")),x.bottom===H.y&&(A=new o.Segment(new r.Point(R,x.bottom+O),new r.Point(D,H.y)),this.extensionLinesVisualizer.addSegment(R>D?s.ExtensionLineType.BottomToTopAfter:s.ExtensionLineType.BottomToTopBefore,A,z?K:""))}E!==void 0&&L!==void 0&&(K=this.getViewUnitText(Math.abs(w-T)),x.center.x===H.center.x&&(A=new o.Segment(new r.Point(x.center.x,E),new r.Point(H.center.x,L)),this.extensionLinesVisualizer.addSegment(E>L?s.ExtensionLineType.HorizontalCenterBelow:s.ExtensionLineType.HorizontalCenterAbove,A,z?K:""),z=!1),x.x===H.x&&(A=new o.Segment(new r.Point(x.x,E),new r.Point(H.x,L)),this.extensionLinesVisualizer.addSegment(E>L?s.ExtensionLineType.LeftToLeftBelow:s.ExtensionLineType.LeftToLeftAbove,A,z?K:"")),x.right===H.right&&(A=new o.Segment(new r.Point(x.right+O,E),new r.Point(H.right+O,L)),this.extensionLinesVisualizer.addSegment(E>L?s.ExtensionLineType.RightToRightBelow:s.ExtensionLineType.RightToRightAbove,A,z?K:"")),x.x===H.right&&(A=new o.Segment(new r.Point(x.x,E),new r.Point(H.right+O,L)),this.extensionLinesVisualizer.addSegment(E>L?s.ExtensionLineType.LeftToRightBelow:s.ExtensionLineType.LeftToRightAbove,A,z?K:"")),x.right===H.x&&(A=new o.Segment(new r.Point(x.right+O,E),new r.Point(H.x,L)),this.extensionLinesVisualizer.addSegment(E>L?s.ExtensionLineType.RightToLeftBelow:s.ExtensionLineType.RightToLeftAbove,A,z?K:"")))},b.prototype.resetExtensionLines=function(){this.extensionLinesVisualizer.reset()},b.prototype.setResizeInfo=function(S){var x=c.ModelUtils.createRectangle(S),I=new r.Point(x.center.x,x.bottom+a.CanvasSelectionManager.resizeInfoOffset),w=this.getViewUnitText(x.width)+" x "+this.getViewUnitText(x.height);this.resizeInfoVisualizer.set(I,w)},b.prototype.resetResizeInfo=function(){this.resizeInfoVisualizer.reset()},b.prototype.setSelectionRectangle=function(S){this.selectionRectangleVisualizer.setRectangle(S)},b.prototype.resetSelectionRectangle=function(){this.selectionRectangleVisualizer.reset()},b.prototype.getViewUnitText=function(S){return c.ModelUtils.getUnitText(this.settings.viewUnits,f.DiagramLocalizationService.unitItems,f.DiagramLocalizationService.formatUnit,S)},b.prototype.notifyReadOnlyChanged=function(S){this.readOnly=S,this.readOnly&&(this.resetConnectionPoints(),this.resetConnectionTarget(),this.resetExtensionLines(),this.resetContainerTarget(),this.resetResizeInfo(),this.resetSelectionRectangle())},b.prototype.notifyDragStart=function(S){},b.prototype.notifyDragEnd=function(S){},b.prototype.notifyDragScrollStart=function(){},b.prototype.notifyDragScrollEnd=function(){},b.prototype.onUpdateUnlocked=function(S){},b}(g.BatchUpdatableObject);h.VisualizerManager=v},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.TargetVisualizerBase=void 0;var m=function(){function P(p){this.dispatcher=p}return P.prototype.getKey=function(){return this.key},P.prototype.setTargetRect=function(p,u,s){this.key!==p&&(this.key=p,this.targetRect=u,this.targetStrokeWidth=s,this.raiseShow())},P.prototype.reset=function(){this.key!=="-1"&&(this.key="-1",this.targetRect=void 0,this.targetStrokeWidth=0,this.raiseHide())},P}();h.TargetVisualizerBase=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ExtensionLinesVisualizer=h.ExtensionLine=h.ExtensionLineType=void 0,function(p){p[p.LeftToLeftAbove=0]="LeftToLeftAbove",p[p.LeftToLeftBelow=1]="LeftToLeftBelow",p[p.RightToRightAbove=2]="RightToRightAbove",p[p.RightToRightBelow=3]="RightToRightBelow",p[p.LeftToRightAbove=4]="LeftToRightAbove",p[p.LeftToRightBelow=5]="LeftToRightBelow",p[p.RightToLeftAbove=6]="RightToLeftAbove",p[p.RightToLeftBelow=7]="RightToLeftBelow",p[p.TopToTopBefore=8]="TopToTopBefore",p[p.TopToTopAfter=9]="TopToTopAfter",p[p.BottomToBottomBefore=10]="BottomToBottomBefore",p[p.BottomToBottomAfter=11]="BottomToBottomAfter",p[p.TopToBottomBefore=12]="TopToBottomBefore",p[p.TopToBottomAfter=13]="TopToBottomAfter",p[p.BottomToTopBefore=14]="BottomToTopBefore",p[p.BottomToTopAfter=15]="BottomToTopAfter",p[p.HorizontalCenterAbove=16]="HorizontalCenterAbove",p[p.HorizontalCenterBelow=17]="HorizontalCenterBelow",p[p.VerticalCenterBefore=18]="VerticalCenterBefore",p[p.VerticalCenterAfter=19]="VerticalCenterAfter",p[p.VerticalCenterToPageCenter=20]="VerticalCenterToPageCenter",p[p.HorizontalCenterToPageCenter=21]="HorizontalCenterToPageCenter",p[p.LeftToPageCenter=22]="LeftToPageCenter",p[p.RightToPageCenter=23]="RightToPageCenter",p[p.TopToPageCenter=24]="TopToPageCenter",p[p.BottomToPageCenter=25]="BottomToPageCenter"}(h.ExtensionLineType||(h.ExtensionLineType={}));var m=function(){return function(p,u,s){this.type=p,this.segment=u,this.text=s}}();h.ExtensionLine=m;var P=function(){function p(u){this.dispatcher=u,this.lines=[],this.lineIndexByType={}}return p.prototype.addSegment=function(u,s,i){var t=this.lineIndexByType[u];if(t===void 0){var e=new m(u,s,i),n=this.lines.push(e);this.lineIndexByType[e.type]=n-1,this.raiseShow()}else s.length<this.lines[t].segment.length&&(e=new m(u,s,i),this.lines.splice(t,1,e),this.raiseShow())},p.prototype.update=function(){this.raiseShow()},p.prototype.reset=function(){this.lines.length&&(this.lines=[],this.lineIndexByType={},this.raiseHide())},p.prototype.raiseShow=function(){var u=this;this.dispatcher.raise1(function(s){return s.notifyExtensionLinesShow(u.lines)})},p.prototype.raiseHide=function(){this.dispatcher.raise1(function(u){return u.notifyExtensionLinesHide()})},p}();h.ExtensionLinesVisualizer=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(K,A){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,U){M.__proto__=U}||function(M,U){for(var V in U)U.hasOwnProperty(V)&&(M[V]=U[V])})(K,A)},function(K,A){function M(){this.constructor=K}m(K,A),K.prototype=A===null?Object.create(A):(M.prototype=A.prototype,new M)});Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasSelectionManager=h.ACTIVE_SELECTION_CSSCLASS=h.SELECTION_ELEMENT_CLASSNAMES=void 0;var p=d(42),u=d(39),s=d(17),i=d(11),t=d(9),e=d(3),n=d(0),o=d(157),r=d(14),a=d(6),c=d(32),l=d(21),y=d(5),g=d(63),f=d(55),v=d(26),C=d(12),b=d(43),S=d(18),x=d(27),I=d(78),w=d(140),_=d(35),T=d(31),R=d(4);h.SELECTION_ELEMENT_CLASSNAMES={SELECTION_RECTANGLE:"selection-rect",CONNECTION_POINT:"connection-point",ACTIVE:"active",CONTAINER_TARGET:"container-target",CONNECTION_TARGET:"connection-target",EXTENSION_LINE:"extension-line",CONNECTION_MARK:"connection-mark",SELECTION_MARK:"selection-mark",LOCKED_SELECTION_MARK:"locked-selection-mark",ITEMS_SELECTION_RECT:"items-selection-rect",CONNECTOR_MULTI_SELECTION:"connector-multi-selection",CONNECTOR_SELECTION:"connector-selection",CONNECTOR_POINT_MARK:"connector-point-mark",CONNECTOR_SELECTION_MASK:"connector-selection-mask",CONNECTOR_SIDE_MARK:"connector-side-mark",ITEM_SELECTION_RECT:"item-selection-rect",ITEM_MULTI_SELECTION:"item-multi-selection-rect"},h.ACTIVE_SELECTION_CSSCLASS="dxdi-active-selection";var E=function(K){function A(M,U,V,G){var Y=K.call(this,U,G)||this;return Y.readOnly=V,Y.connectionPointElements=[],Y.extensionLineElements=[],Y.selectionMap={},Y.parentContainer=M,Y.initializeContainerElements(M),Y}return P(A,K),A.prototype.initializeContainerElements=function(M){this.itemSelectionContainer=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null),M),this.visualizersContainer=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null),M),this.selectionMarksContainer=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null),M)},A.prototype.clear=function(){s.RenderUtils.removeContent(this.itemSelectionContainer),s.RenderUtils.removeContent(this.selectionMarksContainer),s.RenderUtils.removeContent(this.visualizersContainer),this.selectionRectElement=void 0,this.resizeInfoElement=void 0,this.connectionPointElements=[],this.connectionTargetElement=void 0,this.containerTargetElement=void 0,this.extensionLineElements=[],this.selectionMap={}},A.prototype.showSelectionRect=function(M){x.DomUtils.addClassName(this.parentContainer,h.ACTIVE_SELECTION_CSSCLASS);var U=new l.RectanglePrimitive(M.x,M.y,M.width,M.height,v.StrokeStyle.default1pxInstance,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_RECTANGLE),V=this.getSelectionRectElement(U);this.changePrimitiveElement(U,V)},A.prototype.hideSelectionRect=function(){x.DomUtils.removeClassName(this.parentContainer,h.ACTIVE_SELECTION_CSSCLASS),this.selectionRectElement!==void 0&&this.dom.changeByFunc(this.selectionRectElement,function(M){return M.style.display="none"})},A.prototype.getSelectionRectElement=function(M){return this.selectionRectElement!==void 0?this.dom.changeByFunc(this.selectionRectElement,function(U){return U.style.display=""}):this.selectionRectElement=this.createPrimitiveElement(M,this.visualizersContainer),this.selectionRectElement},A.prototype.showResizeInfo=function(M,U){var V=new l.RectanglePrimitive(M.x,M.y,0,0,v.StrokeStyle.default1pxInstance),G=new u.GroupPrimitive([V,new g.TextPrimitive(M.x,M.y,U,b.TextOwner.Resize)],"resize-info"),Y=this.getResizeInfoElement(G);this.changePrimitiveElement(G,Y);var tt=this.dom.measurer.measureTextLine(U,null,b.TextOwner.Resize).applyConverter(C.UnitConverter.pixelsToTwips);V.width=tt.width+2*A.resizeInfoTextOffset,V.height=tt.height+2*A.resizeInfoTextOffset,V.x=M.x-tt.width/2-A.resizeInfoTextOffset,V.y=M.y-tt.height/2-A.resizeInfoTextOffset,this.changePrimitiveElement(G,Y)},A.prototype.hideResizeInfo=function(){this.resizeInfoElement!==void 0&&this.dom.changeByFunc(this.resizeInfoElement,function(M){return M.style.display="none"})},A.prototype.getResizeInfoElement=function(M){return this.resizeInfoElement!==void 0?this.dom.changeByFunc(this.resizeInfoElement,function(U){return U.style.display=""}):this.resizeInfoElement=this.createPrimitiveElement(M,this.visualizersContainer),this.resizeInfoElement},A.prototype.getConnectionPointClassName=function(M,U){var V=h.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_POINT;return M&&(V+=" "+h.SELECTION_ELEMENT_CLASSNAMES.ACTIVE),U||(V+=" "+I.NOT_VALID_CSSCLASS),V},A.prototype.showConnectionPoint=function(M,U,V,G,Y,tt){this.showConnectionPointCore(2*M,U.x,U.y,A.connectionPointLargeSize,A.connectionPointLargeSize,i.MouseEventElementType.ShapeConnectionPoint,V,G,h.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_POINT+" selector"+(tt?"":" "+I.NOT_VALID_CSSCLASS)),this.showConnectionPointCore(2*M+1,U.x,U.y,A.connectionPointSmallSize,A.connectionPointSmallSize,i.MouseEventElementType.ShapeConnectionPoint,V,G,this.getConnectionPointClassName(Y,tt))},A.prototype.showConnectionPointCore=function(M,U,V,G,Y,tt,W,N,k){var B=new f.EllipsePrimitive(U,V,G,Y,null,k,function(Z){return s.RenderUtils.setElementEventData(Z,tt,W,N)}),F=this.getConnectionPointElement(B,M);this.changePrimitiveElement(B,F)},A.prototype.hideConnectionPoints=function(){for(var M=0;M<this.connectionPointElements.length;M++)this.dom.changeByFunc(this.connectionPointElements[M],function(U){return U.style.display="none"})},A.prototype.getConnectionPointElement=function(M,U){var V=this.connectionPointElements[U];return V!==void 0?this.dom.changeByFunc(V,function(G){return G.style.display=""}):(V=this.createPrimitiveElement(M,this.visualizersContainer),this.connectionPointElements[U]=V),V},A.prototype.showContainerTarget=function(M,U){var V=new l.RectanglePrimitive(U.x,U.y,U.width,U.height,null,h.SELECTION_ELEMENT_CLASSNAMES.CONTAINER_TARGET),G=this.getContainerTargetElement(V);this.changePrimitiveElement(V,G)},A.prototype.hideContainerTarget=function(){this.containerTargetElement&&this.dom.changeByFunc(this.containerTargetElement,function(M){return M.style.display="none"})},A.prototype.getContainerTargetElement=function(M){return this.containerTargetElement!==void 0?this.dom.changeByFunc(this.containerTargetElement,function(U){return U.style.display=""}):this.containerTargetElement=this.createPrimitiveElement(M,this.itemSelectionContainer),this.containerTargetElement},A.prototype.showConnectionTarget=function(M,U){var V=new l.RectanglePrimitive(U.x,U.y,U.width,U.height,null,h.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_TARGET),G=this.getConnectionTargetElement(V);this.changePrimitiveElement(V,G)},A.prototype.hideConnectionTarget=function(){this.connectionTargetElement&&this.dom.changeByFunc(this.connectionTargetElement,function(M){return M.style.display="none"})},A.prototype.getConnectionTargetElement=function(M){return this.connectionTargetElement!==void 0?this.dom.changeByFunc(this.connectionTargetElement,function(U){return U.style.display=""}):this.connectionTargetElement=this.createPrimitiveElement(M,this.itemSelectionContainer),this.connectionTargetElement},A.prototype.showExtensionLine=function(M,U,V,G,Y){var tt=h.SELECTION_ELEMENT_CLASSNAMES.EXTENSION_LINE;U!==o.ExtensionLineType.VerticalCenterAfter&&U!==o.ExtensionLineType.VerticalCenterBefore&&U!==o.ExtensionLineType.HorizontalCenterAbove&&U!==o.ExtensionLineType.HorizontalCenterBelow||(tt+=" center"),U!==o.ExtensionLineType.VerticalCenterToPageCenter&&U!==o.ExtensionLineType.HorizontalCenterToPageCenter&&U!==o.ExtensionLineType.LeftToPageCenter&&U!==o.ExtensionLineType.RightToPageCenter&&U!==o.ExtensionLineType.TopToPageCenter&&U!==o.ExtensionLineType.BottomToPageCenter||(tt+=" page");var W=0,N=0,k=0,B=0,F=0,Z=0,q=0,J=0;V.y===G.y?(W=V.x-A.extensionLineWidth,N=V.y-A.extensionLineEndingSize,k=V.x-A.extensionLineWidth,B=V.y+A.extensionLineEndingSize,F=G.x-A.extensionLineWidth,Z=V.y-A.extensionLineEndingSize,q=G.x-A.extensionLineWidth,J=V.y+A.extensionLineEndingSize):V.x===G.x&&(W=V.x-A.extensionLineEndingSize,N=V.y-A.extensionLineWidth,k=V.x+A.extensionLineEndingSize,B=V.y-A.extensionLineWidth,F=V.x-A.extensionLineEndingSize,Z=G.y-A.extensionLineWidth,q=V.x+A.extensionLineEndingSize,J=G.y-A.extensionLineWidth);var $=0,Q=0;U!==o.ExtensionLineType.RightToRightAbove&&U!==o.ExtensionLineType.RightToRightBelow||($-=A.extensionLineWidth),U!==o.ExtensionLineType.BottomToBottomAfter&&U!==o.ExtensionLineType.BottomToBottomBefore||(Q-=A.extensionLineWidth);var nt=[new y.PathPrimitive([y.PathPrimitiveMoveToCommand.fromPoint(V.clone().offset($,Q)),y.PathPrimitiveLineToCommand.fromPoint(G.clone().offset($,Q))],v.StrokeStyle.default1pxInstance,"size-line"),new y.PathPrimitive([new y.PathPrimitiveMoveToCommand(W,N),new y.PathPrimitiveLineToCommand(k,B),new y.PathPrimitiveMoveToCommand(F,Z),new y.PathPrimitiveLineToCommand(q,J)],v.StrokeStyle.default1pxInstance),new g.TextPrimitive((G.x+V.x)/2,(G.y+V.y)/2,Y,b.TextOwner.ExtensionLine,void 0,void 0,void 0,null,void 0,null,p.PAGE_BG_TEXTFLOOR_FILTER_ID)],ot=new u.GroupPrimitive(nt,tt),it=this.getExtensionLineElement(ot,M);this.changePrimitiveElement(ot,it)},A.prototype.hideExtensionLines=function(){for(var M=0;M<this.extensionLineElements.length;M++)this.extensionLineElements[M]&&this.dom.changeByFunc(this.extensionLineElements[M],function(U){return U.style.display="none"})},A.prototype.getExtensionLineElement=function(M,U){var V=this.extensionLineElements[U];return V!==void 0?this.dom.changeByFunc(V,function(G){return G.style.display=""}):(V=this.createPrimitiveElement(M,this.visualizersContainer),this.extensionLineElements[U]=V),V},A.prototype.getOrCreateShapeSelection=function(M,U){var V=this.selectionMap[M.key];return V||(V=new O(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom,M.key,M.isLocked,M.rectangle,M.style,M.allowResizeHorizontally,M.allowResizeVertically,M.description.getParameterPoints(M)),this.selectionMap[M.key]=V),U&&(U[M.key]=!0),V},A.prototype.getOrCreateConnectorSelection=function(M,U){var V=this.selectionMap[M.key],G=M.getRenderPoints();return V||(V=new z(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom,M.key,M.isLocked,M.rectangle,G,M.style,M.styleText,M.enableText,M.texts.map(function(Y){var tt=e.GeometryUtils.getPathPointByPosition(G,Y.position);return{text:M.getText(Y.position),point:tt[0],pointIndex:tt[1],pos:Y.position}}).sort(function(Y,tt){return Y.pos-tt.pos}),M.points,M.properties.lineOption),this.selectionMap[M.key]=V),U&&(U[M.key]=!0),V},A.prototype.getOrCreateMultipleSelection=function(M){var U=this.selectionMap[-1];return U||(U=new H(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom),this.selectionMap[-1]=U),M[-1]=!0,U},A.prototype.getMultipleSelection=function(){return this.selectionMap[-1]},A.prototype.updateShapeSelection=function(M,U){M.key in this.selectionMap&&(this.getOrCreateShapeSelection(M).onModelChanged(M.isLocked,M.rectangle,M.style,M.allowResizeHorizontally,M.allowResizeVertically,M.description.getParameterPoints(M)),U&&U.onModelItemChanged(M.key,M.rectangle))},A.prototype.updateConnectorSelection=function(M,U){if(M.key in this.selectionMap){var V=M.getRenderPoints();this.getOrCreateConnectorSelection(M).onModelChanged(M.isLocked,M.rectangle,V,M.style,M.styleText,M.enableText,M.texts.map(function(G){var Y=e.GeometryUtils.getPathPointByPosition(V,G.position);return{text:M.getText(G.position),pointIndex:Y[1],pos:G.position,point:Y[0]}}).sort(function(G,Y){return G.pos-Y.pos}),M.points,M.properties.lineOption),U&&U.onModelItemChanged(M.key,M.rectangle)}},A.prototype.hideOutdatedSelection=function(M){var U=this;Object.keys(this.selectionMap).filter(function(V){return!M[V]}).forEach(function(V){U.selectionMap[V].destroy(),delete U.selectionMap[V]})},A.prototype.selectionCanBeDrawn=function(M){return!M.container||M.container.expanded&&this.selectionCanBeDrawn(M.container)},A.prototype.notifySelectionChanged=function(M){var U=this,V=M.getSelectedItems(!0).filter(function(B){return U.selectionCanBeDrawn(B)}),G={},Y=V.length>1,tt=M.getSelectedShapes(!0).filter(function(B){return U.selectionCanBeDrawn(B)}),W=M.getSelectedConnectors(!0).filter(function(B){return U.selectionCanBeDrawn(B)});if(tt.forEach(function(B){return U.getOrCreateShapeSelection(B,G).onSelectionChanged(Y)}),W.forEach(function(B){return U.getOrCreateConnectorSelection(B,G).onSelectionChanged(Y)}),Y){var N=V.length>0?V[0].strokeWidth:0,k={};V.filter(function(B){return!B.isLocked}).forEach(function(B){return k[B.key]=B.rectangle}),this.getOrCreateMultipleSelection(G).onSelectionChanged(!!tt.filter(function(B){return!B.isLocked}).length,N,k)}this.hideOutdatedSelection(G)},A.prototype.applyChangesCore=function(M){K.prototype.applyChangesCore.call(this,M);var U=this.getMultipleSelection();U&&U.onModelChanged()},A.prototype.applyChange=function(M){var U=this.getMultipleSelection();M.item instanceof r.Shape?this.updateShapeSelection(M.item,U):M.item instanceof a.Connector&&this.updateConnectorSelection(M.item,U)},A.prototype.notifyPageColorChanged=function(M){},A.prototype.notifyPageSizeChanged=function(M,U){},A.prototype.notifyActualZoomChanged=function(M){var U=this;Object.keys(this.selectionMap).forEach(function(V){return U.selectionMap[V].notifyZoomChanged(M)}),this.actualZoom=M},A.prototype.notifyViewAdjusted=function(M){},A.prototype.notifyReadOnlyChanged=function(M){var U=this;this.readOnly=M,Object.keys(this.selectionMap).forEach(function(V){return U.selectionMap[V].notifyReadOnlyChanged(M)})},A.prototype.notifySelectionRectShow=function(M){this.showSelectionRect(M.clone().multiply(this.actualZoom,this.actualZoom))},A.prototype.notifySelectionRectHide=function(){this.hideSelectionRect()},A.prototype.notifyResizeInfoShow=function(M,U){this.showResizeInfo(M.clone().multiply(this.actualZoom,this.actualZoom),U)},A.prototype.notifyResizeInfoHide=function(){this.hideResizeInfo()},A.prototype.notifyConnectionPointsShow=function(M,U,V,G){var Y=this;this.hideConnectionPoints(),U.forEach(function(tt,W){var N=tt.point.clone().multiply(Y.actualZoom,Y.actualZoom);if(G)switch(tt.side){case t.ConnectionPointSide.North:N.y=G.y*Y.actualZoom-A.connectionPointShift;break;case t.ConnectionPointSide.South:N.y=G.bottom*Y.actualZoom+A.connectionPointShift;break;case t.ConnectionPointSide.West:N.x=G.x*Y.actualZoom-A.connectionPointShift;break;case t.ConnectionPointSide.East:N.x=G.right*Y.actualZoom+A.connectionPointShift}Y.showConnectionPoint(W,N,M,W,W===V,tt.allowed)})},A.prototype.notifyConnectionPointsHide=function(){this.hideConnectionPoints()},A.prototype.notifyConnectionTargetShow=function(M,U){if(U.allowed){var V=A.correctSelectionRect(U.rect.clone().multiply(this.actualZoom,this.actualZoom),U.strokeWidth,A.connectionTargetBorderWidth,this.actualZoom,0);this.showConnectionTarget(0,V)}},A.prototype.notifyConnectionTargetHide=function(){this.hideConnectionTarget()},A.prototype.notifyContainerTargetShow=function(M,U){var V=A.correctSelectionRect(U.rect.clone().multiply(this.actualZoom,this.actualZoom),U.strokeWidth,A.connectionTargetBorderWidth,this.actualZoom,0);this.showContainerTarget(0,V)},A.prototype.notifyContainerTargetHide=function(){this.hideContainerTarget()},A.prototype.notifyExtensionLinesShow=function(M){var U=this;this.hideExtensionLines(),M.forEach(function(V,G){U.showExtensionLine(G,V.type,V.segment.startPoint.clone().multiply(U.actualZoom,U.actualZoom),V.segment.endPoint.clone().multiply(U.actualZoom,U.actualZoom),V.text)})},A.prototype.notifyExtensionLinesHide=function(){this.hideExtensionLines()},A.prototype.notifyDragStart=function(M){this.dom.changeByFunc(this.selectionMarksContainer,function(U){return U.style.display="none"})},A.prototype.notifyDragEnd=function(M){this.dom.changeByFunc(this.selectionMarksContainer,function(U){return U.style.display=""})},A.prototype.notifyDragScrollStart=function(){},A.prototype.notifyDragScrollEnd=function(){},A.prototype.notifyTextInputStart=function(M,U,V,G){this.dom.changeByFunc(this.visualizersContainer,function(Y){return Y.style.display="none"})},A.prototype.notifyTextInputEnd=function(M,U){this.dom.changeByFunc(this.visualizersContainer,function(V){return V.style.display=""})},A.prototype.notifyTextInputPermissionsCheck=function(M,U){},A.correctSelectionRect=function(M,U,V,G,Y){Y===void 0&&(Y=A.selectionOffset);var tt=C.UnitConverter.twipsToPixels(U)%2!=C.UnitConverter.twipsToPixels(V)%2,W=Math.ceil(U/2*G);M=M.clone().inflate(W,W);var N=Math.floor(V/2);if(M.x-=N,M.y-=N,M.width+=V,M.height+=V,tt){var k=A.evenOddSelectionCorrection*(C.UnitConverter.twipsToPixels(V)%2==1?-1:1);M=M.clone().moveRectangle(k,k)}return M.clone().inflate(Y,Y)},A.selectionMarkSize=C.UnitConverter.pixelsToTwips(10),A.lockedSelectionMarkSize=C.UnitConverter.pixelsToTwips(8),A.selectionOffset=C.UnitConverter.pixelsToTwips(2),A.selectionRectLineWidth=C.UnitConverter.pixelsToTwips(1),A.multiSelectionRectLineWidth=C.UnitConverter.pixelsToTwips(1),A.connectionPointSmallSize=C.UnitConverter.pixelsToTwips(5),A.connectionPointLargeSize=C.UnitConverter.pixelsToTwips(12),A.connectionPointShift=C.UnitConverter.pixelsToTwips(16),A.connectionTargetBorderWidth=C.UnitConverter.pixelsToTwips(2),A.geomertyMarkSize=C.UnitConverter.pixelsToTwips(8),A.connectorPointMarkSize=C.UnitConverter.pixelsToTwips(6),A.connectorSideMarkSize=C.UnitConverter.pixelsToTwips(6),A.extensionLineWidth=C.UnitConverter.pixelsToTwips(1),A.extensionLineOffset=C.UnitConverter.pixelsToTwips(1),A.extensionLineEndingSize=C.UnitConverter.pixelsToTwips(6),A.resizeInfoOffset=C.UnitConverter.pixelsToTwips(16),A.resizeInfoTextOffset=C.UnitConverter.pixelsToTwips(2),A.resizeInfoLineWidth=C.UnitConverter.pixelsToTwips(1),A.evenOddSelectionCorrection=C.UnitConverter.pixelsToTwips(1),A}(w.CanvasManager);h.CanvasSelectionManager=E;var D=function(){function K(A,M,U,V,G,Y){this.rectsContainer=A,this.marksContainer=M,this.key=U,this.zoomLevel=V,this.readOnly=G,this.dom=Y,this.elements={},this.updatedElements={}}return K.prototype.notifyZoomChanged=function(A){this.zoomLevel!==A&&(this.zoomLevel=A,this.redraw())},K.prototype.notifyReadOnlyChanged=function(A){this.readOnly=A,this.redraw()},K.prototype.destroy=function(){var A=this;Object.keys(this.elements).forEach(function(M){A.elements[M].parentNode.removeChild(A.elements[M]),delete A.elements[M]})},K.prototype.redraw=function(){var A=this;this.updatedElements={},this.redrawCore(),Object.keys(this.elements).filter(function(M){return!A.updatedElements[M]}).forEach(function(M){A.elements[M].parentNode.removeChild(A.elements[M]),delete A.elements[M]}),this.updatedElements={}},K.prototype.drawSelectionMarks=function(A,M,U){if(!this.readOnly){var V=M&&A.height>3*E.selectionMarkSize,G=U&&A.width>3*E.selectionMarkSize,Y=M||U;Y&&this.drawSelectionMark(0,new n.Point(A.x,A.y),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_NW,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),G&&!S.Browser.TouchUI&&this.drawSelectionMark(1,new n.Point(A.x+A.width/2,A.y),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_N,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),Y&&this.drawSelectionMark(2,new n.Point(A.right,A.y),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_NE,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),V&&!S.Browser.TouchUI&&this.drawSelectionMark(3,new n.Point(A.right,A.y+A.height/2),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_E,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),Y&&this.drawSelectionMark(4,new n.Point(A.right,A.bottom),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_SE,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),G&&!S.Browser.TouchUI&&this.drawSelectionMark(5,new n.Point(A.x+A.width/2,A.bottom),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_S,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),Y&&this.drawSelectionMark(6,new n.Point(A.x,A.bottom),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_SW,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),V&&!S.Browser.TouchUI&&this.drawSelectionMark(7,new n.Point(A.x,A.y+A.height/2),E.selectionMarkSize,i.MouseEventElementType.ShapeResizeBox,i.ResizeEventSource.ResizeBox_W,h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK)}},K.prototype.drawSelectionMark=function(A,M,U,V,G,Y){var tt=this;this.getOrCreateElement("SM"+A,new l.RectanglePrimitive(M.x-U/2,M.y-U/2,U,U,null,Y,void 0,function(W){s.RenderUtils.setElementEventData(W,V,tt.key,G)}),this.marksContainer)},K.prototype.drawSelectionRect=function(A,M,U){var V=new l.RectanglePrimitive(A.x,A.y,A.width,A.height,v.StrokeStyle.default1pxInstance,U,void 0,function(G){s.RenderUtils.setElementEventData(G,M,"-1",-1)});this.getOrCreateElement("shapeSelection",V,this.rectsContainer)},K.prototype.getOrCreateElement=function(A,M,U){var V=this.elements[A];return V||(V=M.createElement(function(G){return U.appendChild(G)}),this.elements[A]=V),this.updatedElements[A]=!0,this.dom.changeByPrimitive(V,M),V},K}(),L=function(K){function A(M,U,V,G,Y,tt,W,N){var k=K.call(this,M,U,V,G,Y,tt)||this;return k.isLocked=W,k.rectangle=N,k}return P(A,K),A.prototype.onSelectionChanged=function(M){this.isMultipleSelection!==M&&(this.isMultipleSelection=M,this.redraw())},A.prototype.isLockedRender=function(){return this.isLocked&&!this.readOnly},A.prototype.drawLockedSelectionMark=function(M,U,V,G){var Y=new y.PathPrimitive([new y.PathPrimitiveMoveToCommand(U.x-V/2,U.y-V/2),new y.PathPrimitiveLineToCommand(U.x+V/2,U.y+V/2),new y.PathPrimitiveMoveToCommand(U.x+V/2,U.y-V/2),new y.PathPrimitiveLineToCommand(U.x-V/2,U.y+V/2)],null,G);this.getOrCreateElement("LSM"+M,Y,this.marksContainer)},A}(D),H=function(K){function A(M,U,V,G,Y){var tt=K.call(this,M,U,"-1",V,G,Y)||this;return tt.rectangles={},tt}return P(A,K),A.prototype.onModelItemChanged=function(M,U){M in this.rectangles&&(this.rectangles[M]=U)},A.prototype.onModelChanged=function(){this.redraw()},A.prototype.onSelectionChanged=function(M,U,V){this.needDrawSelectionMarks=M,this.strokeWidth=U,this.rectangles=V,this.redraw()},A.prototype.redrawCore=function(){var M=this,U=Object.keys(this.rectangles);if(U.length){var V=e.GeometryUtils.getCommonRectangle(U.map(function(Y){return M.rectangles[Y]})).clone().multiply(this.zoomLevel,this.zoomLevel),G=E.correctSelectionRect(V,this.strokeWidth,E.selectionRectLineWidth,this.zoomLevel);this.drawSelectionRect(G,i.MouseEventElementType.SelectionRect,h.SELECTION_ELEMENT_CLASSNAMES.ITEMS_SELECTION_RECT),this.needDrawSelectionMarks&&this.drawSelectionMarks(V,!0,!0)}},A}(D),O=function(K){function A(M,U,V,G,Y,tt,W,N,k,B,F,Z){var q=K.call(this,M,U,tt,V,G,Y,W,N)||this;return q.style=k,q.allowResizeHorizontally=B,q.allowResizeVertically=F,q.shapeParameterPoints=Z,q}return P(A,K),A.prototype.onModelChanged=function(M,U,V,G,Y,tt){this.isLocked=M,this.rectangle=U,this.style=V,this.allowResizeHorizontally=G,this.allowResizeVertically=Y,this.shapeParameterPoints=tt,this.redraw()},A.prototype.redrawCore=function(){var M=this.rectangle.clone().multiply(this.zoomLevel,this.zoomLevel);this.isLockedRender()?this.drawLockedSelection(M):this.drawUnlockedSelection(M)},A.prototype.drawLockedSelection=function(M){this.drawLockedSelectionMark(0,new n.Point(M.x,M.y),E.lockedSelectionMarkSize,h.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK),this.drawLockedSelectionMark(1,new n.Point(M.right,M.y),E.lockedSelectionMarkSize,h.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK),this.drawLockedSelectionMark(2,new n.Point(M.right,M.bottom),E.lockedSelectionMarkSize,h.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK),this.drawLockedSelectionMark(3,new n.Point(M.x,M.bottom),E.lockedSelectionMarkSize,h.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK)},A.prototype.drawUnlockedSelection=function(M){var U=E.correctSelectionRect(M,this.style.strokeWidth,E.selectionRectLineWidth,this.zoomLevel);this.drawSelectionRect(U,i.MouseEventElementType.SelectionRect,this.isMultipleSelection?h.SELECTION_ELEMENT_CLASSNAMES.ITEM_MULTI_SELECTION:h.SELECTION_ELEMENT_CLASSNAMES.ITEM_SELECTION_RECT),this.isMultipleSelection||this.drawSelectionMarks(M,this.allowResizeHorizontally,this.allowResizeVertically),this.drawShapeParameterPoints()},A.prototype.drawShapeParameterPoints=function(){var M=this;this.readOnly||this.shapeParameterPoints.forEach(function(U,V){var G=U.point.clone().multiply(M.zoomLevel,M.zoomLevel);M.drawShapeParameterPoint(G,V,U.key)})},A.prototype.drawShapeParameterPoint=function(M,U,V){var G=this,Y=E.geomertyMarkSize,tt=new l.RectanglePrimitive(M.x-Y/2,M.y-Y/2,Y,Y,null,"geometry-mark",void 0,function(W){s.RenderUtils.setElementEventData(W,i.MouseEventElementType.ShapeParameterBox,G.key,V)});this.getOrCreateElement("pp"+U.toString(),tt,this.marksContainer)},A}(L),z=function(K){function A(M,U,V,G,Y,tt,W,N,k,B,F,Z,q,J,$){var Q=K.call(this,M,U,tt,V,G,Y,W,N)||this;return Q.renderPoints=k,Q.style=B,Q.styleText=F,Q.enableText=Z,Q.texts=q,Q.points=J,Q.lineType=$,Q}return P(A,K),A.prototype.onModelChanged=function(M,U,V,G,Y,tt,W,N,k){this.isLocked=M,this.rectangle=U,this.renderPoints=V,this.style=G,this.styleText=Y,this.enableText=tt,this.texts=W,this.points=N,this.lineType=k,this.redraw()},A.prototype.redrawCore=function(){this.isLockedRender()?this.drawLockedSelection():this.drawUnlockedSelection()},A.prototype.drawLockedSelection=function(){var M=this;this.renderPoints.forEach(function(U,V){M.drawLockedSelectionMark(V,U,E.lockedSelectionMarkSize,h.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK)})},A.prototype.drawUnlockedSelection=function(){this.drawConnectorSelection(),this.isMultipleSelection||this.readOnly||this.drawConnectorSelectionMarks()},A.prototype.drawConnectorSelection=function(){var M=[],U=[],V=this.isMultipleSelection?h.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_MULTI_SELECTION:h.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_SELECTION;this.populateSelectionPrimitiveCommands(M,U);var G=new y.PathPrimitive(M.concat(U.reverse()),v.StrokeStyle.default1pxInstance,V);this.getOrCreateElement("CS",G,this.rectsContainer)},A.prototype.populateSelectionPrimitiveCommands=function(M,U){for(var V,G,Y,tt,W=this.texts,N=this.styleText.getAlignment(),k=this.createNotSkippedRenderPoints(),B=this.zoomLevel,F=this.style.strokeWidthPx,Z=this.getSelectionOffset(F),q=F%2==0,J=k[0],$=0,Q=1,nt=void 0;nt=k[Q];Q++){var ot=k[Q+1];if(V===void 0){if(G=_.Metrics.euclideanDistance(J,nt),T.MathUtils.numberCloseTo(G,0))continue;V=e.GeometryUtils.getSelectionOffsetPoint(J,nt,G).multiply(Z,Z)}if(ot){if(tt=_.Metrics.euclideanDistance(nt,ot),T.MathUtils.numberCloseTo(tt,0))continue;Y=e.GeometryUtils.getSelectionOffsetPoint(nt,ot,tt).multiply(Z,Z)}var it=V.x,rt=V.y,st=-it,ct=-rt,ht=Y&&Y.x,pt=Y&&Y.y,lt=Y&&-Y.x,dt=Y&&-Y.y;for(q&&(st>0?st-=E.evenOddSelectionCorrection:it>0&&(it-=E.evenOddSelectionCorrection),ct>0?ct-=E.evenOddSelectionCorrection:rt>0&&(rt-=E.evenOddSelectionCorrection),lt>0?lt-=E.evenOddSelectionCorrection:ht>0&&(ht-=E.evenOddSelectionCorrection),dt>0?dt-=E.evenOddSelectionCorrection:pt>0&&(pt-=E.evenOddSelectionCorrection));W[$]&&W[$].pointIndex<=Q;){var gt=W[$],X=this.getConnectorSelectionTextSize(gt.text,Z),et=e.GeometryUtils.getSelectionTextStartEndPoints(J,nt,G,gt.point,X,N);W[$].pointIndex<Q?(J=et[1],M.push(y.PathPrimitiveMoveToCommand.fromPoint(J.clone().offset(it,rt).multiply(B,B))),U.push(y.PathPrimitiveLineToCommand.fromPoint(J.clone().offset(st,ct).multiply(B,B)))):(M.length||(M.push(y.PathPrimitiveMoveToCommand.fromPoint(J.clone().offset(it,rt).multiply(B,B))),U.push(y.PathPrimitiveLineToCommand.fromPoint(J.clone().offset(st,ct).multiply(B,B)))),M.push(y.PathPrimitiveLineToCommand.fromPoint(et[0].clone().offset(it,rt).multiply(B,B))),M.push(y.PathPrimitiveMoveToCommand.fromPoint(et[1].clone().offset(it,rt).multiply(B,B))),U.push(y.PathPrimitiveMoveToCommand.fromPoint(et[0].clone().offset(st,ct).multiply(B,B))),U.push(y.PathPrimitiveLineToCommand.fromPoint(et[1].clone().offset(st,ct).multiply(B,B))),J=et[1]),$++}M.length||(M.push(y.PathPrimitiveMoveToCommand.fromPoint(J.clone().offset(it,rt).multiply(B,B))),U.push(y.PathPrimitiveLineToCommand.fromPoint(J.clone().offset(st,ct).multiply(B,B)))),ot?(e.GeometryUtils.addSelectedLinesTo(J,nt,ot,it,rt,st,ct,ht,pt,lt,dt,function(at,ft){return M.push(new y.PathPrimitiveLineToCommand(at*B,ft*B))},function(at,ft){return U.push(new y.PathPrimitiveLineToCommand(at*B,ft*B))}),V=Y,G=tt):(M.push(y.PathPrimitiveLineToCommand.fromPoint(nt.clone().offset(it,rt).multiply(B,B))),U.push(y.PathPrimitiveMoveToCommand.fromPoint(nt.clone().offset(st,ct).multiply(B,B)))),J=nt}},A.prototype.createNotSkippedRenderPoints=function(){var M=this.renderPoints.map(function(U){return U.clone()});return this.lineType===c.ConnectorLineOption.Straight?(R.ModelUtils.removeUnnecessaryRenderPoints(M),M.filter(function(U){return!U.skipped})):(R.ModelUtils.removeUnnecessaryRightAngleRenderPoints(M),M.filter(function(U){return!U.skipped}))},A.prototype.getSelectionOffset=function(M){return E.selectionOffset+C.UnitConverter.pixelsToTwips(Math.round(M/2)+(M+1)%2)},A.prototype.getConnectorSelectionTextSize=function(M,U){return this.dom.measurer.measureTextLine(M,this.styleText,b.TextOwner.Connector).applyConverter(C.UnitConverter.pixelsToTwips).clone().offset(U,U).nonNegativeSize()},A.prototype.drawConnectorSelectionMarks=function(){var M=this,U=this.points.length-1;this.points.forEach(function(V,G){var Y=G===0||G===U,tt=Y?h.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK:h.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_POINT_MARK,W=Y?E.selectionMarkSize:E.connectorPointMarkSize;Y||M.lineType===c.ConnectorLineOption.Straight?M.drawSelectionMark(G,V.clone().multiply(M.zoomLevel,M.zoomLevel),W,i.MouseEventElementType.ConnectorPoint,G,tt):M.drawSelectionMark(G,V.clone().multiply(M.zoomLevel,M.zoomLevel),W,i.MouseEventElementType.Undefined,-1,tt+" disabled")}),this.drawConnectorSideMarks()},A.prototype.drawConnectorSideMarks=function(){var M,U,V=this,G=this.lineType===c.ConnectorLineOption.Straight?i.MouseEventElementType.ConnectorSide:i.MouseEventElementType.ConnectorOrthogonalSide;this.renderPoints.forEach(function(Y,tt){if(!Y.skipped){if(M!==void 0&&V.canDrawConnectorSideMark(Y,M)){var W=V.lineType===c.ConnectorLineOption.Orthogonal?Y.x-M.x==0?"vertical":"horizontal":"";V.drawSelectionMark(V.points.length+tt-1,new n.Point(M.x+(Y.x-M.x)/2,M.y+(Y.y-M.y)/2).clone().multiply(V.zoomLevel,V.zoomLevel),E.connectorSideMarkSize,G,U+"_"+tt,h.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_SIDE_MARK+" "+W)}M=Y,U=tt}})},A.prototype.canDrawConnectorSideMark=function(M,U){if(this.lineType===c.ConnectorLineOption.Straight){var V=E.selectionMarkSize+E.connectorSideMarkSize;return _.Metrics.euclideanDistance(M,U)>V}if(this.lineType===c.ConnectorLineOption.Orthogonal){var G=U.pointIndex===0,Y=e.GeometryUtils.areDuplicatedPoints(this.points[this.points.length-1],M);return G&&Y?_.Metrics.euclideanDistance(M,U)>2*a.Connector.minOffset:!G&&Y||G&&!Y?_.Metrics.euclideanDistance(M,U)>a.Connector.minOffset:(V=E.selectionMarkSize+E.connectorSideMarkSize,_.Metrics.euclideanDistance(M,U)>V)}return!1},A}(L)},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramDraggingEvent=h.ToolboxDraggingObject=h.Toolbox=void 0;var m,P=d(3),p=d(0),u=d(65),s=d(44),i=d(27),t=d(18),e=d(15),n=d(78),o=function(){function c(l,y,g,f,v,C){this.readOnly=y,this.allowDragging=g,this.shapeDescriptionManager=f,this.shapeTypes=v,this.getAllowedShapeTypes=C,this.dragPrepareTimeout=-1,this.dragState=m.None,this.emulateDragEvents=t.Browser.WebKitTouchUI,this.onDragOperation=new P.EventDispatcher,this.onClickOperation=new P.EventDispatcher,l&&(this.mainElement=this.createMainElement(l),this.attachHandlers(this.mainElement))}return c.prototype.clean=function(l){this.detachHandlers(this.mainElement),l&&l(this.mainElement)},c.prototype.createMainElement=function(l){var y=document.createElement("div");return y.setAttribute("class","dxdi-toolbox"),y.draggable=!0,this.emulateDragEvents&&(y.tabIndex=0),l.appendChild(y),y},c.prototype.attachHandlers=function(l){this.onElementMouseDownHandler=this.onElementMouseDown.bind(this),this.onElementMouseUpHandler=this.onElementMouseUp.bind(this),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onMouseMoveHandler=this.onMouseMove.bind(this),this.onMouseUpHandler=this.onMouseUp.bind(this),this.onDragStartHandler=this.onDragStart.bind(this),this.onTouchMoveHandler=this.onTouchMove.bind(this),this.emulateDragEvents||e.RenderHelper.addEventListener(l,"dragstart",this.onDragStartHandler),P.EventUtils.isPointerEvents()?(this.mouseDownEventName="pointerdown",this.mouseMoveEventName="pointermove",this.mouseUpEventName="pointerup"):(this.mouseDownEventName=t.Browser.TouchUI?"touchstart":"mousedown",this.mouseMoveEventName=t.Browser.TouchUI?"touchmove":"mousemove",this.mouseUpEventName=t.Browser.TouchUI?"touchend":"mouseup"),e.RenderHelper.addEventListener(l,"touchmove",this.onTouchMoveHandler),e.RenderHelper.addEventListener(l,this.mouseDownEventName,this.onElementMouseDownHandler),e.RenderHelper.addEventListener(l,this.mouseUpEventName,this.onElementMouseUpHandler),e.RenderHelper.addEventListener(l,this.mouseDownEventName,this.onMouseDownHandler),e.RenderHelper.addEventListener(document,this.mouseMoveEventName,this.onMouseMoveHandler),e.RenderHelper.addEventListener(document,this.mouseUpEventName,this.onMouseUpHandler)},c.prototype.detachHandlers=function(l){this.emulateDragEvents||e.RenderHelper.removeEventListener(l,"dragstart",this.onDragStartHandler),e.RenderHelper.removeEventListener(l,"touchmove",this.onTouchMoveHandler),e.RenderHelper.removeEventListener(l,this.mouseDownEventName,this.onElementMouseDownHandler),e.RenderHelper.removeEventListener(l,this.mouseUpEventName,this.onElementMouseUpHandler),e.RenderHelper.removeEventListener(l,this.mouseDownEventName,this.onMouseDownHandler),e.RenderHelper.removeEventListener(document,this.mouseMoveEventName,this.onMouseMoveHandler),e.RenderHelper.removeEventListener(document,this.mouseUpEventName,this.onMouseUpHandler)},c.prototype.render=function(l){this.mainElement.childNodes&&(this.mainElement.innerHTML="");var y=this.shapeTypes;return y=this.getAllowedShapeTypes?this.getAllowedShapeTypes(y):y,(y=l?y.filter(l):y).length&&this.createElements(this.mainElement,y),!!y.length},c.prototype.createDraggingObject=function(l){var y=new a;return y.data=l,y.onFinishDragging=this.resetDragState.bind(this),y.onCaptured=this.capture.bind(this),new r(y)},c.prototype.getDragShapeType=function(l){for(;l&&!i.DomUtils.hasClassName(l,"dxdi-toolbox");){if(l.getAttribute&&l.getAttribute("data-tb-type"))return l.getAttribute("data-tb-type");l=l.parentNode}},c.prototype.getTouchPointFromEvent=function(l){var y,g=l.touches;return g&&g.length>0?y=new p.Point(g[0].clientX,g[0].clientY):l.clientX&&l.clientY&&(y=new p.Point(l.clientX,l.clientY)),y},c.prototype.onElementMouseDown=function(l){this.mouseDownShapeType=this.getDragShapeType(u.EvtUtils.getEventSource(l)),this.touchDownPoint=this.getTouchPointFromEvent(l)},c.prototype.onElementMouseUp=function(l){var y=this.getDragShapeType(u.EvtUtils.getEventSource(l));y&&y===this.mouseDownShapeType&&this.onClickOperation.raise("notifyToolboxClick",y),this.mouseDownShapeType=void 0,this.touchDownPoint=void 0},c.prototype.onMouseDown=function(l){this.setDragState(m.Prepare,l),t.Browser.TouchUI&&P.EventUtils.isMousePointer(l)&&this.setDragState(m.Start,l)},c.prototype.onDragStart=function(l){this.setDragState(m.Start,l),l.preventDefault()},c.prototype.onTouchMove=function(l){this.draggingObject&&l.preventDefault()},c.prototype.isLeftButtonPressed=function(l){return u.EvtUtils.isLeftButtonPressed(l)||l.type==="pointermove"&&t.Browser.TouchUI&&t.Browser.MacOSMobilePlatform&&P.EventUtils.isMousePointer(l)},c.prototype.onMouseMove=function(l){if(t.Browser.TouchUI&&t.Browser.MacOSMobilePlatform){var y=this.getTouchPointFromEvent(l);if(this.touchDownPoint&&y&&this.touchDownPoint.x===y.x&&this.touchDownPoint.y===y.y)return}this.setDragState(this.isLeftButtonPressed(l)?m.Dragging:m.None,l),P.EventUtils.isPointerEvents()&&this.raiseDraggingMouseMove(l)},c.prototype.onMouseUp=function(l){this.setDragState(m.None,l)},c.prototype.updateDraggingElementPosition=function(l,y){var g=this.draggingObject.element,f=l-g.offsetWidth/2,v=y-g.offsetHeight/2;s.SetAbsoluteX(g,f),s.SetAbsoluteY(g,v)},c.prototype.setDragState=function(l,y){if(!this.readOnly&&this.allowDragging&&!(l===m.None&&l===this.dragState||(this.dragPrepareTimeout>-1&&(clearTimeout(this.dragPrepareTimeout),this.dragPrepareTimeout=-1,this.dragPrepareEvent=void 0),l-this.dragState>1||l!==m.None&&l<this.dragState)))switch(this.dragState=l,l){case m.Prepare:this.prepareDragging(y)||this.setDragState(m.None,y),!this.emulateDragEvents&&P.EventUtils.isMousePointer(y)||(this.dragPrepareTimeout=setTimeout(this.onDragPrepareTimeout.bind(this),800),this.dragPrepareEvent=y);break;case m.Start:i.DomUtils.addClassName(document.body,"dxdi-dragging"),this.startDragging(y);break;case m.Dragging:this.doDragging(y);break;case m.None:this.finishDragging(y)}},c.prototype.resetDragState=function(){this.setDragState(m.None,void 0)},c.prototype.onDragPrepareTimeout=function(){this.dragPrepareTimeout=-1,this.dragState===m.Prepare&&this.setDragState(m.Start,this.dragPrepareEvent),this.dragPrepareEvent=void 0},c.prototype.prepareDragging=function(l){return this.dragStartPoint=new p.Point(u.EvtUtils.getEventX(l),u.EvtUtils.getEventY(l)),this.dragStartShapeType=this.getDragShapeType(u.EvtUtils.getEventSource(l)),P.EventUtils.isMousePointer(l)&&i.DomUtils.addClassName(this.mainElement,"dxdi-tb-start-drag-flag"),!this.emulateDragEvents&&P.EventUtils.isMousePointer(l)||P.HtmlFocusUtils.focusWithPreventScroll(this.mainElement),!!this.dragStartShapeType},c.prototype.startDragging=function(l){this.draggingObject=this.createDraggingObject(this.dragStartShapeType),this.dragStartShapeType?(this.raiseDragStart(l),this.draggingObject.element=this.createDraggingElement(this.draggingObject),this.draggingObject.captured!==void 0&&this.capture(this.draggingObject.captured,!0),this.updateDraggingElementPosition(this.dragStartPoint.x,this.dragStartPoint.y)):i.DomUtils.addClassName(document.body,n.NOT_VALID_CSSCLASS)},c.prototype.doDragging=function(l){this.draggingObject.element&&this.updateDraggingElementPosition(u.EvtUtils.getEventX(l),u.EvtUtils.getEventY(l))},c.prototype.finishDragging=function(l){if(this.draggingObject){this.raiseDragEnd(l);var y=this.draggingObject.element;y&&y.parentNode.removeChild(y),delete this.draggingObject}this.dragStartPoint=void 0,this.dragStartShapeType=void 0,i.DomUtils.removeClassName(this.mainElement,"dxdi-tb-start-drag-flag"),i.DomUtils.removeClassName(document.body,n.NOT_VALID_CSSCLASS),setTimeout(function(){return i.DomUtils.removeClassName(document.body,"dxdi-dragging")},500)},c.prototype.capture=function(l,y){this.draggingObject&&(this.draggingObject.captured!==l||y)&&(this.draggingObject.captured=l,this.draggingObject.element&&i.DomUtils.toggleClassName(this.draggingObject.element,"dxdi-tb-drag-captured",l))},c.prototype.raiseDragStart=function(l){this.onDragOperation.raise("notifyToolboxDragStart",l)},c.prototype.raiseDragEnd=function(l){this.onDragOperation.raise("notifyToolboxDragEnd",l)},c.prototype.raiseDraggingMouseMove=function(l){this.onDragOperation.raise("notifyToolboxDraggingMouseMove",l)},c.prototype.notifyReadOnlyChanged=function(l){this.readOnly=l},c}();h.Toolbox=o,function(c){c[c.None=-1]="None",c[c.Prepare=0]="Prepare",c[c.Start=1]="Start",c[c.Dragging=2]="Dragging"}(m||(m={}));var r=function(){return function(c){this.evt=c}}();h.ToolboxDraggingObject=r;var a=function(){return function(){}}();h.DiagramDraggingEvent=a},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.RightAngleConnectorRoutingMathOperations=void 0;var m=d(33),P=d(31),p=d(161),u=d(3),s=d(9),i=function(){function t(){}return t.createUnionSegments=function(e,n){for(var o=[],r=e[0].startPoint,a=e[0].endPoint,c=1;c<e.length;c++){var l=e[c];n(a,l.startPoint)&&(o.push(new m.Segment(r.clone(),a.clone())),r=l.startPoint),a=l.endPoint}return o.push(new m.Segment(r,a)),o},t.unionPoints=function(e){for(var n=0;n<e.length-2;)u.GeometryUtils.isCorner(e[n],e[n+1],e[n+2])?n++:(e.splice(n+1,1),n=Math.max(0,n-1))},t.getTurnDirection=function(e){return P.MathUtils.numberCloseTo(e,0)?p.RightAngleTurnDirection.Straight:P.MathUtils.numberCloseTo(e,Math.PI)?p.RightAngleTurnDirection.Backwards:e<Math.PI?p.RightAngleTurnDirection.Left:p.RightAngleTurnDirection.Right},t.isSegmentNormal=function(e,n){return n?P.MathUtils.numberCloseTo(e.startPoint.y,e.endPoint.y):P.MathUtils.numberCloseTo(e.startPoint.x,e.endPoint.x)},t.isConnectionRectanleLineIntersected=function(e,n,o,r,a,c){switch(o){case s.ConnectionPointSide.North:return u.GeometryUtils.isLineIntersected(c(e.x,e.y),c(e.right,e.y),n,r,a);case s.ConnectionPointSide.South:return u.GeometryUtils.isLineIntersected(c(e.right,e.bottom),c(e.x,e.bottom),n,r,a);case s.ConnectionPointSide.West:return u.GeometryUtils.isLineIntersected(c(e.x,e.y),c(e.x,e.bottom),n,r,a);case s.ConnectionPointSide.East:return u.GeometryUtils.isLineIntersected(c(e.right,e.y),c(e.right,e.bottom),n,r,a);default:return!1}},t.createBeginConnectionSegment=function(e,n,o,r){switch(e){case s.ConnectionPointSide.North:return new m.Segment(n,r(n.x,n.y-o));case s.ConnectionPointSide.South:return new m.Segment(n,r(n.x,n.y+o));case s.ConnectionPointSide.West:return new m.Segment(n,r(n.x-o,n.y));case s.ConnectionPointSide.East:return new m.Segment(n,r(n.x+o,n.y));default:return n}},t.createEndConnectionSegment=function(e,n,o,r){switch(e){case s.ConnectionPointSide.North:return new m.Segment(r(n.x,n.y-o),n);case s.ConnectionPointSide.South:return new m.Segment(r(n.x,n.y+o),n);case s.ConnectionPointSide.West:return new m.Segment(r(n.x-o,n.y),n);case s.ConnectionPointSide.East:return new m.Segment(r(n.x+o,n.y),n);default:return n}},t}();h.RightAngleConnectorRoutingMathOperations=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.IntersectedShapeZone=h.AStarMetrics=h.IntersectedShapesMetrics=h.TurnDirectionMetrics=h.IntersectedShapeMetrics=h.RightAngleTurnDirection=void 0;var m,P=d(0),p=d(35);(function(e){e[e.Straight=0]="Straight",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Backwards=3]="Backwards"})(m=h.RightAngleTurnDirection||(h.RightAngleTurnDirection={}));var u=function(){function e(n,o){this.description=n,this.shapeMargin=o}return e.prototype.penalty=function(n,o,r,a){var c=a.rectangle;if(c.containsPoint(r))return n+this.description.shape*o;var l=this.createRelativeMarginPenalty(r,c,this.shapeMargin);return l>0?n+this.description.margin*l*o:n},e.prototype.createRelativeMarginPenalty=function(n,o,r){var a=this.isTopPosition(n,o,r),c=this.isLeftPosition(n,o,r),l=this.isBottomPosition(n,o,r),y=this.isRightPosition(n,o,r);if(a){if(c){var g=(C=o.clone().inflate(r)).createPosition(),f=o.createPosition(),v=p.Metrics.euclideanDistance(f,g);return 1-p.Metrics.euclideanDistance(f,n)/v}if(y){var C=o.clone().inflate(r),b=new P.Point(C.right,C.y),S=new P.Point(o.right,o.y),x=p.Metrics.euclideanDistance(S,b);return 1-p.Metrics.euclideanDistance(S,n)/x}return 1-(o.y-n.y)/r}if(l){if(c){C=o.clone().inflate(r);var I=new P.Point(C.x,C.bottom),w=new P.Point(o.x,o.bottom),_=p.Metrics.euclideanDistance(w,I);return 1-p.Metrics.euclideanDistance(w,n)/_}if(y){C=o.clone().inflate(r);var T=new P.Point(C.right,C.bottom),R=new P.Point(o.right,o.bottom),E=p.Metrics.euclideanDistance(R,T);return 1-p.Metrics.euclideanDistance(R,n)/E}return 1-(n.y-o.bottom)/r}return c?1-(o.x-n.x)/r:y?1-(n.x-o.right)/r:0},e.prototype.isTopPosition=function(n,o,r){return n.x>o.x-r&&n.x<o.right+r&&n.y>o.y-r&&n.y<o.y},e.prototype.isBottomPosition=function(n,o,r){return n.x>o.x-r&&n.x<o.right+r&&n.y>o.bottom&&n.y<o.bottom+r},e.prototype.isLeftPosition=function(n,o,r){return n.x>o.x-r&&n.x<o.x&&n.y>o.y-r&&n.y<o.bottom+r},e.prototype.isRightPosition=function(n,o,r){return n.x>o.right&&n.x<o.right+r&&n.y>o.y-r&&n.y<o.bottom+r},e}();h.IntersectedShapeMetrics=u;var s=function(){function e(n){this.description=n}return e.prototype.penalty=function(n,o){switch(o){case m.Backwards:return n*this.description.turnBack;case m.Left:return n*this.description.turnLeft;case m.Right:return n*this.description.turnRight}return n},e}();h.TurnDirectionMetrics=s;var i=function(){function e(n){this.shapeMetrics=n}return e.prototype.penalty=function(n,o,r,a){var c=this;if(!a||!a.length)return n;var l=n;return a.forEach(function(y){return l=c.shapeMetrics.penalty(l,o,r,y)}),l},e}();h.IntersectedShapesMetrics=i;var t=function(){function e(n,o){this.turnDirectionMetrics=n,this.shapesMetrics=o}return e.prototype.distance=function(n,o){return p.Metrics.manhattanDistance(n,o)},e.prototype.penalty=function(n,o,r,a){var c=n;return c=this.shapesMetrics.penalty(c,n,o,a),c=this.turnDirectionMetrics.penalty(c,r)},e}();h.AStarMetrics=t,function(e){e[e.None=0]="None",e[e.Shape=1]="Shape",e[e.Margin=2]="Margin"}(h.IntersectedShapeZone||(h.IntersectedShapeZone={}))},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteCommand=void 0;var p=d(4),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabled=function(){var t=this.control.selection.getSelectedItems();return s.prototype.isEnabled.call(this)&&t.length&&(t.length>1||this.permissionsProvider.canDeleteItems(t))},i.prototype.executeCore=function(t){var e=this.control.selection.getSelectedItems(!0,!0);return this.permissionsProvider.beginDeleteItems(e),p.ModelUtils.deleteSelection(this.control.history,this.control.model,this.control.selection),this.permissionsProvider.endDeleteItems(),!0},Object.defineProperty(i.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),i}(d(10).SimpleCommandBase);h.DeleteCommand=u},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(p){p===void 0&&(p=0),this.value=p}return P.prototype.get=function(p){return(this.value&p)===p},P.prototype.set=function(p,u){return(this.value&p)===p!==u&&(u?this.value|=p:this.value^=p),this},P.prototype.add=function(p){this.value|=p},P.prototype.anyOf=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];for(var s=0,i=p;s<i.length;s++){var t=i[s];if((this.value&t)===t)return!0}return!1},P.prototype.getValue=function(){return this.value},P.prototype.clone=function(){return new P(this.value)},P}();h.Flag=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(105),P=d(41),p=d(106),u=d(169),s=function(){function i(){}return i.oneConstainsOtherArraysOfInterval=function(t,e){for(var n=m.ListUtils.deepCopy(e),o=n.pop();o;){if(!m.ListUtils.unsafeAnyOf(t,function(r){return r.containsInterval(o)}))return!1;o=n.pop()}return!0},i.getIntersection=function(t,e){return i.getIntersectionTemplate(t,e,t)},i.getIntersectionTemplate=function(t,e,n){var o=Math.max(t.start,e.start),r=Math.min(t.end,e.end);return o>r?null:n.makeByStartEnd(o,r)},i.getIntersectionNonNullLength=function(t,e){return i.getIntersectionNonNullLengthTemplate(t,e,t)},i.getIntersectionNonNullLengthTemplate=function(t,e,n){var o=i.getIntersectionTemplate(t,e,n);return o&&o.length?o:null},i.getIntersectionsTwoArraysOfInterval=function(t,e){return i.getIntersectionsTwoArraysOfIntervalTemplate(t,e,t[0])},i.getIntersectionsTwoArraysOfIntervalTemplate=function(t,e,n){for(var o=[],r=t.length,a=e.length,c=0,l=0,y=t[c],g=e[l],f=null;c<r&&l<a;){var v=i.getIntersectionTemplate(y,g,n);v&&(f&&f.end===v.start?f.length+=v.length:(f=v,o.push(f))),y.end<g.end?y=t[++c]:g=e[++l]}return o},i.getAffectedObjects=function(t,e,n,o){return n===void 0&&(n=function(r){return P.SearchUtils.normedInterpolationIndexOf(t,function(a){return a.interval.start},r)}),o===void 0&&(o=function(r,a,c){return r.start===c&&a===0}),i.getAffectedObjectsTemplate(t,e,e[0],n,o)},i.getAffectedObjectsTemplate=function(t,e,n,o,r){o===void 0&&(o=function(b){return P.SearchUtils.normedInterpolationIndexOf(t,function(S){return S.interval.start},b)}),r===void 0&&(r=function(b,S,x){return b.start===x&&S===0});for(var a=new u.SparseIntervalsCollector(n),c=0,l=e;c<l.length;c++)for(var y=l[c],g=Math.max(0,o(y.start,t)),f=void 0;f=t[g];g++){var v=f.interval;if(v.start>y.end)break;var C=i.getIntersectionTemplate(v,y,n);C&&(C.length||r(v,y.length,C.start))&&a.add(g)}return a.getIntervals()},i.handleAffectedObjects=function(t,e,n,o){o===void 0&&(o=function(C){return P.SearchUtils.normedInterpolationIndexOf(t,function(b){return b.interval.start},C)});for(var r=new p.FixedInterval(0,0),a=0,c=e;a<c.length;a++)for(var l=c[a],y=Math.max(0,o(l.start,t)),g=void 0;g=t[y];y++){var f=g.interval;if(f.start>l.end)break;var v=i.getIntersectionTemplate(f,l,r);v&&n(g,y,l,v)}},i.getMergedIntervals=function(t,e){return i.getMergedIntervalsTemplate(t,e,t[0])},i.getMergedIntervalsTemplate=function(t,e,n){if(t.length<2)return t.length>0?[n.makeByStartLength(t[0].start,t[0].length)]:[];for(var o=e?[].concat(t).sort(function(g,f){return g.start-f.start}):t,r=[],a=0,c=void 0;c=o[a];){var l=c.start,y=c.end;for(++a;(c=o[a])!==void 0&&c.start<=y;a++)c.end>y&&(y=c.end);r.push(n.makeByStartEnd(l,y))}return r},i.reflectIntervals=function(t,e){return i.reflectIntervalsTemplate(t,e,e)},i.reflectIntervalsTemplate=function(t,e,n){if(!t.length)return[n.makeByStartLength(e.start,e.length)];var o=m.ListUtils.last(t).end,r=m.ListUtils.reducedMap(t,function(a,c){return i.getIntersectionNonNullLengthTemplate(n.makeByStartEnd(t[c-1].end,a.start),e,n)},1);return e.start<t[0].start&&r.unshift(n.makeByStartEnd(e.start,t[0].start)),e.end>o&&r.push(n.makeByStartEnd(o,e.end)),r},i.reflectionOfPointOnInterval=function(t,e,n){return(t-e.start)/e.length*n.length+n.start},i}();h.IntervalAlgorithms=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(59),P=function(){return function(t,e){this.minElement=t,this.maxElement=e}}();h.MinMax=P;var p=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return m.__extends(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.maxElement-this.minElement},enumerable:!0,configurable:!0}),e}(P);h.MinMaxNumber=p;var u=function(){return function(t,e){this.minElement=t,this.minValue=e}}();h.ExtendedMin=u;var s=function(){return function(t,e){this.maxElement=t,this.maxValue=e}}();h.ExtendedMax=s;var i=function(t){function e(n,o,r,a){var c=t.call(this,n,r)||this;return c.minValue=o,c.maxValue=a,c}return m.__extends(e,t),e}(P);h.ExtendedMinMax=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function p(){}return p.number=function(u,s){return u-s},p.string=function(u,s){return u===s?0:u>s?1:-1},p.stringIgnoreCase=function(u,s){return(u=u.toLowerCase())===(s=s.toLowerCase())?0:u>s?1:-1},p}();h.Comparers=m;var P=function(){function p(){}return p.simpleType=function(u,s){return u===s},p.object=function(u,s){return u&&s&&(u===s||u.equals(s))},p}();h.Equals=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(59),P=function(p){function u(){return p!==null&&p.apply(this,arguments)||this}return m.__extends(u,p),u.prototype.normalizeLength=function(){return this.length<0&&(this.length=0),this},u}(d(168).ConstInterval);h.MutableInterval=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return Object.defineProperty(P.prototype,"center",{get:function(){return this.start+this.length/2},enumerable:!0,configurable:!0}),P.prototype.isNormalized=function(){return this.end>=this.start},P.prototype.isCollapsed=function(){return this.length===0},P.prototype.equals=function(p){return this.start===p.start&&this.end===p.end},P.isCollapsed=function(p){return!p[1]&&p[0].isCollapsed()},P.prototype.containsInterval=function(p){return this.start<=p.start&&this.end>=p.end},P.prototype.containsIntervalWithoutEnd=function(p){return this.start<=p.start&&this.end>p.end},P.prototype.contains=function(p){return this.start<=p&&p<this.end},P.prototype.containsWithIntervalEnd=function(p){return this.start<=p&&p<=this.end},P.prototype.containsWithoutIntervalEndAndStart=function(p){return this.start<p&&p<this.end},P}();h.ConstInterval=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(170),P=function(){function p(u){this.intervals=[],this.template=u}return p.prototype.add=function(u){this.curr&&this.curr.end===u?this.curr.length++:(this.curr=this.template.makeByStartLength(u,1),this.intervals.push(this.curr))},p.prototype.getIntervals=function(){return new m.SparseIntervals(this.intervals)},p}();h.SparseIntervalsCollector=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(107),P=d(171),p=function(){function u(s){s===void 0&&(s=[]),this.list=s,this._count=0,this._numIntervals=0;for(var i=0,t=s;i<t.length;i++){var e=t[i];this._count+=e.length,this._numIntervals++}}return Object.defineProperty(u.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"numIntervals",{get:function(){return this._numIntervals},enumerable:!0,configurable:!0}),u.prototype.getInterval=function(s){return this.list[s]},u.prototype.getNativeIterator=function(){return new m.SparseIntervalsIterator(this)},u.prototype.getObjectsIterator=function(s){return new P.SparseObjectsIterator(this,s)},u}();h.SparseIntervals=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(59),P=function(p){function u(s,i){var t=p.call(this,s)||this;return t.objects=i,t}return m.__extends(u,p),u.prototype.initObject=function(){this.obj=this.objects[this.index]},u}(d(107).SparseIntervalsIterator);h.SparseObjectsIterator=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.TextFloodFilterPrimitive=h.TextFilterPrimitive=void 0;var p=d(15),u=d(108),s=d(62),i=d(22),t=function(n){function o(r,a,c,l,y){a===void 0&&(a="-0.05"),c===void 0&&(c="-0.05"),l===void 0&&(l="1.1"),y===void 0&&(y="1.1");var g=n.call(this,r,a,c,l,y)||this;return g.id=r,g.x=a,g.y=c,g.width=l,g.height=y,g}return P(o,n),o.prototype.createChildElements=function(r){var a=document.createElementNS(p.svgNS,"feFlood");r.appendChild(a);var c=document.createElementNS(p.svgNS,"feComposite");c.setAttribute("in","SourceGraphic"),c.setAttribute("operator","atop"),r.appendChild(c)},o}(u.FilterPrimitive);h.TextFilterPrimitive=t;var e=function(n){function o(r,a,c,l,y,g){c===void 0&&(c="-0.05"),l===void 0&&(l="-0.05"),y===void 0&&(y="1.1"),g===void 0&&(g="1.1");var f=n.call(this,r,c,l,y,g)||this;return f.id=r,f.floodColor=a,f.x=c,f.y=l,f.width=y,f.height=g,f}return P(o,n),o.prototype.applyChildrenProperties=function(r){for(var a=void 0,c=0;a=r.childNodes[c];c++)if(a.nodeName&&a.nodeName.toUpperCase()==="FEFLOOD"){this.prepareFEFloodNode(a);break}},o.prototype.prepareFEFloodNode=function(r){var a=i.ColorUtils.colorToHash(this.floodColor);r.setAttribute("flood-color",a),r.setAttribute("class","text-filter-flood"),this.floodColor!==s.DiagramModel.defaultPageColor?r.style.setProperty("flood-color",a):r.style.setProperty("flood-color","")},o}(t);h.TextFloodFilterPrimitive=e},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function P(){}return P.encodeHtml=function(p){return p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},P.decodeHtml=function(p){return p.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},P.prepareTextForRequest=function(p){return p.replace(/%/g,"%25").replace(/&/g,"%26amp;").replace(/\+/g,"%2B").replace(/</g,"%26lt;").replace(/>/g,"%26gt;").replace(/"/g,"%26quot;")},P.prepareTextForCallBackRequest=function(p){return p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},P.decodeViaTextArea=function(p){var u=document.createElement("TEXTAREA");return u.innerHTML=p,u.value},P}();h.EncodeUtils=m},function(j,h,d){"use strict";d(175).polyfill()},function(j,h,d){"use strict";function m(P,p){if(P==null)throw new TypeError("Cannot convert first argument to object");for(var u=Object(P),s=1;s<arguments.length;s++){var i=arguments[s];if(i!=null)for(var t=Object.keys(Object(i)),e=0,n=t.length;e<n;e++){var o=t[e],r=Object.getOwnPropertyDescriptor(i,o);r!==void 0&&r.enumerable&&(u[o]=i[o])}}return u}j.exports={assign:m,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:m})}}},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(18),P=d(50),p=function(){function u(){}return u.onEventAttachingToDocument=function(s,i){return!m.Browser.MacOSMobilePlatform||!u.isTouchEventName(s)||(u.documentTouchHandlers[s]||(u.documentTouchHandlers[s]=[]),u.documentTouchHandlers[s].push(i),u.documentEventAttachingAllowed)},u.isTouchEventName=function(s){return m.Browser.WebKitTouchUI&&(s.indexOf("touch")>-1||s.indexOf("gesture")>-1)},u.isTouchEvent=function(s){return m.Browser.WebKitTouchUI&&P.isDefined(s.changedTouches)},u.getEventX=function(s){return m.Browser.IE?s.pageX:s.changedTouches[0].pageX},u.getEventY=function(s){return m.Browser.IE?s.pageY:s.changedTouches[0].pageY},u.touchMouseDownEventName=m.Browser.WebKitTouchUI?"touchstart":m.Browser.Edge&&m.Browser.MSTouchUI&&window.PointerEvent?"pointerdown":"mousedown",u.touchMouseUpEventName=m.Browser.WebKitTouchUI?"touchend":m.Browser.Edge&&m.Browser.MSTouchUI&&window.PointerEvent?"pointerup":"mouseup",u.touchMouseMoveEventName=m.Browser.WebKitTouchUI?"touchmove":m.Browser.Edge&&m.Browser.MSTouchUI&&window.PointerEvent?"pointermove":"mousemove",u.msTouchDraggableClassName="dxMSTouchDraggable",u.documentTouchHandlers={},u.documentEventAttachingAllowed=!0,u}();h.TouchUtils=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var m=d(18),P=d(83),p=d(50),u=function(){function s(){}return s.loadJavascriptFile=function(i,t){var e,n=document.getElementsByTagName("head")[0];if(!n){n=document.createElement("head");var o=document.getElementsByTagName("body")[0];(e=o.parentNode)===null||e===void 0||e.insertBefore(n,o)}var r=document.createElement("script");return r.onload=t,r.src=i,n.appendChild(r),{htmlScriptElement:r}},s.startDownloadFileLocal=function(i,t){if(i instanceof ArrayBuffer&&(i=P.Base64Utils.fromArrayBuffer(i)),p.isString(i)&&(i=P.Base64Utils.getFileFromBase64(i)),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,t);else{var e=document.createElement("a"),n=URL.createObjectURL(i);e.href=n,e.download=t,document.body.appendChild(e),e.click(),setTimeout(function(){document.body.removeChild(e),window.URL.revokeObjectURL(n)},0)}},s.createFile=function(i,t,e){var n;if(m.Browser.IE||m.Browser.Edge&&m.Browser.MajorVersion<86){var o=new Blob(i,e);return o.lastModifiedDate=(n=e==null?void 0:e.lastModified)!==null&&n!==void 0?n:Date.now(),o.name=t,o}return new File(i,t,e)},s.isFile=function(i){return m.Browser.IE||m.Browser.Edge&&m.Browser.MajorVersion<86?i instanceof File||i instanceof Blob&&p.isDefined(i.name):i instanceof File},s}();h.FileUtils=u},function(j,h,d){"use strict";var m,P,p,u;Object.defineProperty(h,"__esModule",{value:!0}),h.OpenXmlMimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document",h.RtfMimeType="application/rtf",h.PlainTextMimeType="text/plain",h.DocmMimeType="application/vnd.ms-word.document.macroEnabled.12",h.ImagePngMimeType="image/png",h.ImageGifMimeType="image/gif",h.ImageJpegMimeType="image/jpeg",h.ImagePjpegMimeType="image/pjpeg",h.ImageSvgMimeType="image/svg+xml",h.ImageTiffMimeType="image/tiff",h.ImageIcoMimeType="image/vnd.microsoft.icon",h.ImageWbmpMimeType="image/vnd.wap.wbmp",h.ImageWebpMimeType="image/webp",function(i){i[i.Unknown=0]="Unknown",i[i.OpenXml=1]="OpenXml",i[i.Rtf=2]="Rtf",i[i.PlainText=3]="PlainText",i[i.Docm=4]="Docm",i[i.Png=5]="Png",i[i.Gif=6]="Gif",i[i.Jpeg=7]="Jpeg",i[i.Pjpeg=8]="Pjpeg",i[i.Svg=9]="Svg",i[i.Tiff=10]="Tiff",i[i.Ico=11]="Ico",i[i.Wbmp=12]="Wbmp",i[i.Webp=13]="Webp"}(u=h.DxMimeType||(h.DxMimeType={}));var s=function(){function i(){}return i.stringTypeToExtension=function(t){var e=i.stringTypeToTypeMap[t];return e===void 0?"":i.typeToExtensionMap[e]},i.typeToExtension=function(t){var e=i.typeToExtensionMap[t];return e??""},i.extensionToType=function(t){(t=t.toLowerCase())[0]!=="."&&(t+=".");var e=i.extensionToTypeMap[t];return e??u.Unknown},i.typeToStringType=function(t){var e=i.typeToStringTypeMap[t];return e??""},i.stringTypeToType=function(t){var e=i.stringTypeToTypeMap[t];return e===void 0?u.Unknown:e},i.stringTypeToTypeMap=((m={})[h.OpenXmlMimeType]=u.OpenXml,m[h.RtfMimeType]=u.Rtf,m[h.PlainTextMimeType]=u.PlainText,m[h.DocmMimeType]=u.Docm,m[h.ImagePngMimeType]=u.Png,m[h.ImageGifMimeType]=u.Gif,m[h.ImageJpegMimeType]=u.Jpeg,m[h.ImagePjpegMimeType]=u.Pjpeg,m[h.ImageSvgMimeType]=u.Svg,m[h.ImageTiffMimeType]=u.Tiff,m[h.ImageIcoMimeType]=u.Ico,m[h.ImageWbmpMimeType]=u.Wbmp,m[h.ImageWebpMimeType]=u.Webp,m),i.typeToStringTypeMap=((P={})[u.Unknown]=void 0,P[u.OpenXml]=h.OpenXmlMimeType,P[u.Rtf]=h.RtfMimeType,P[u.PlainText]=h.PlainTextMimeType,P[u.Docm]=h.DocmMimeType,P[u.Png]=h.ImagePngMimeType,P[u.Gif]=h.ImageGifMimeType,P[u.Jpeg]=h.ImageJpegMimeType,P[u.Pjpeg]=h.ImagePjpegMimeType,P[u.Svg]=h.ImageSvgMimeType,P[u.Tiff]=h.ImageTiffMimeType,P[u.Ico]=h.ImageIcoMimeType,P[u.Wbmp]=h.ImageWbmpMimeType,P[u.Webp]=h.ImageWebpMimeType,P),i.typeToExtensionMap=((p={})[u.Unknown]=void 0,p[u.OpenXml]=".docx",p[u.Rtf]=".rtf",p[u.PlainText]=".txt",p[u.Docm]=".docm",p[u.Png]=".png",p[u.Gif]=".gif",p[u.Jpeg]=".jpeg",p[u.Pjpeg]=".pjpeg",p[u.Svg]=".svg",p[u.Tiff]=".tiff",p[u.Ico]=".ico",p[u.Wbmp]=".wbmp",p[u.Webp]=".webp",p),i.extensionToTypeMap={".docx":u.OpenXml,".rtf":u.Rtf,".txt":u.PlainText,".docm":u.Docm,".png":u.Png,".gif":u.Gif,".jpeg":u.Jpeg,".pjpeg":u.Pjpeg,".svg":u.Svg,".tiff":u.Tiff,".ico":u.Ico,".wbmp":u.Wbmp,".webp":u.Webp},i}();h.MimeTypeUtils=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsCalculator=void 0;var p=d(111),u=d(29),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.getPoints=function(){return this.connector.points.map(function(e,n){return new u.ConnectorRenderPoint(e.x,e.y,n)})},t}(p.ConnectorPointsCalculatorBase);h.ConnectorPointsCalculator=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalCalculator=void 0;var p=d(13),u=d(9),s=d(111),i=d(181),t=d(182),e=d(183),n=d(184),o=d(185),r=d(29),a=d(4),c=function(l){function y(g){var f=l.call(this,g)||this;return f.sideCalculators={},f.sideCalculators[u.ConnectionPointSide.Undefined]=new i.ConnectorPointsOrthogonalUndefinedSideCalculator(f),f.sideCalculators[u.ConnectionPointSide.South]=new t.ConnectorPointsOrthogonalSouthSideCalculator(f),f.sideCalculators[u.ConnectionPointSide.North]=new e.ConnectorPointsOrthogonalNorthSideCalculator(f),f.sideCalculators[u.ConnectionPointSide.East]=new n.ConnectorPointsOrthogonalEastSideCalculator(f),f.sideCalculators[u.ConnectionPointSide.West]=new o.ConnectorPointsOrthogonalWestSideCalculator(f),f}return P(y,l),Object.defineProperty(y.prototype,"beginRect",{get:function(){return this.connector.beginItem?this.connector.beginItem.rectangle:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"endRect",{get:function(){return this.connector.endItem?this.connector.endItem.rectangle:void 0},enumerable:!1,configurable:!0}),y.prototype.getPoints=function(){var g=this.connector.points.map(function(D,L){return new r.ConnectorRenderPoint(D.x,D.y,L)});a.ModelUtils.removeUnnecessaryRenderPoints(g);var f=0,v=g.length-1,C=this.getPointSide(g,0),b=this.getPointSide(g,1),S=this.getPointSide(g,g.length-1),x=this.getPointSide(g,g.length-1-1),I=this.getSideCalculator(C),w=this.getSideCalculator(S),_=this.beginRect,T=I.getCorrectOriginPoint(g[f],_),R=g[f+1];if(g.length===2&&I.isOnSidePoint(T,R)&&I.isDirectConnectionAllowed(b,T,R))I.getDirectConnectionPoints(T,R).forEach(function(D){g.splice(f+1,0,D),f++,v++});else{var E=I.getBeginOffsetPoints(b,g[f],g[f+1],this.beginRect);E.forEach(function(D){g.splice(f+1,0,D)}),f+=E.length,v+=E.length,w.getEndOffsetPoints(x,g[v],g[v-1],this.endRect).forEach(function(D,L){g.splice(v+L,0,D)}),this.addMiddlePoints(g,f,v)}return a.ModelUtils.removeUnnecessaryRenderPoints(g),g},y.prototype.getSideCalculator=function(g){return this.sideCalculators[g]},y.prototype.getPointSide=function(g,f){if(f===0&&this.connector.beginItem){var v=this.connector.beginConnectionPointIndex;return this.connector.beginItem.getConnectionPointSideByIndex(v,g[1])}return f===g.length-1&&this.connector.endItem?(v=this.connector.endConnectionPointIndex,this.connector.endItem.getConnectionPointSideByIndex(v,g[g.length-2])):u.ConnectionPointSide.Undefined},y.prototype.addMiddlePoints=function(g,f,v){for(var C=f;C<v;C++){var b=C+1,S=this.getMiddlePoint(g[C],g[C-1],C-1==0,g[b],g[b+1],b+1===g.length-1);S!==void 0&&(g.splice(C+1,0,S),C++,v++)}},y.prototype.getMiddlePoints=function(g,f){return g.x===f.x||g.y===f.y?[]:[new r.ConnectorRenderPoint(g.x,f.y),new r.ConnectorRenderPoint(f.x,g.y)]},y.prototype.getMiddlePoint=function(g,f,v,C,b,S){var x,I=this,w=this.getMiddlePoints(g,C);return w.forEach(function(_){var T=I.createPointsRect(g,_),R=I.createPointsRect(_,C),E=I.connector.beginItem?I.connector.beginItem.rectangle:void 0,D=I.connector.endItem?I.connector.endItem.rectangle:void 0;E&&(p.Rectangle.areIntersected(E,T)||p.Rectangle.areIntersected(E,R))||D&&(p.Rectangle.areIntersected(D,T)||p.Rectangle.areIntersected(D,R))||I.isReturnPoint(_,g,f)&&!I.isIntermediatePoints(g,f)||I.isReturnPoint(_,C,b)&&!I.isIntermediatePoints(C,b)||(x===void 0||I.isPriorMiddlePoint(_,g,f,C,b))&&(x=_)}),x===void 0&&w.length>0&&(x=w[0]),x},y.prototype.createPointsRect=function(g,f){var v=p.Rectangle.fromPoints(g,f);return v.width>0&&(v=v.clone().inflate(-1,0)),v.height>0&&(v=v.clone().inflate(0,-1)),v},y.prototype.isPriorMiddlePoint=function(g,f,v,C,b){return!(!v||g.x!==v.x&&g.y!==v.y)||!(!b||g.x!==b.x&&g.y!==b.y)},y.prototype.isReturnPoint=function(g,f,v){return f!==void 0&&v!==void 0&&(g.x===v.x&&(f.y<g.y&&g.y<v.y||f.y>g.y&&g.y>v.y)||g.y===v.y&&(f.x<g.x&&g.x<v.x||f.x>g.x&&g.x>v.x))},y.prototype.isIntermediatePoints=function(g,f){return 0<g.pointIndex&&g.pointIndex<this.connector.points.length-1&&0<f.pointIndex&&f.pointIndex<this.connector.points.length-1},y}(s.ConnectorPointsCalculatorBase);h.ConnectorPointsOrthogonalCalculator=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalUndefinedSideCalculator=void 0;var p=d(52),u=d(29),s=function(i){function t(e){return i.call(this,e)||this}return P(t,i),t.prototype.getCorrectOriginPoint=function(e,n){return e},t.prototype.getSameShapeOffsetPoints=function(e,n,o,r){return[]},t.prototype.getOverlappedPointsOffsetPoints=function(e,n,o,r){return[]},t.prototype.getBeginOverlappedShapeOffsetPoints=function(e,n,o,r){return[]},t.prototype.getEndOverlappedShapeOffsetPoints=function(e,n,o,r){return[]},t.prototype.getBeginOnSideOffsetPoints=function(e,n,o,r){return[]},t.prototype.getEndOnSideOffsetPoints=function(e,n,o,r){return[]},t.prototype.getBeginOffSideOffsetPoints=function(e,n,o,r){return[]},t.prototype.getEndOffSideOffsetPoints=function(e,n,o,r){return[]},t.prototype.isOnSidePoint=function(e,n){return!0},t.prototype.isDirectConnectionAllowed=function(e,n,o){var r=this.getSideCalculator(n,o);return r===void 0||r.isDirectConnectionAllowed(e,n,o)},t.prototype.getDirectConnectionPoints=function(e,n){var o=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y);if(o>r){var a=Math.min(e.x,n.x)+o/2;return[new u.ConnectorRenderPoint(a,e.y),new u.ConnectorRenderPoint(a,n.y)]}var c=Math.min(e.y,n.y)+r/2;return[new u.ConnectorRenderPoint(e.x,c),new u.ConnectorRenderPoint(n.x,c)]},t}(p.ConnectorPointsOrthogonalSideCalculatorBase);h.ConnectorPointsOrthogonalUndefinedSideCalculator=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalSouthSideCalculator=void 0;var p=d(9),u=d(52),s=d(29),i=function(t){function e(n){return t.call(this,n)||this}return P(e,t),e.prototype.getCorrectOriginPoint=function(n,o){return n.y<o.bottom&&(n=n.clone().offset(0,o.bottom-n.y)),n},e.prototype.getSameShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:case p.ConnectionPointSide.West:case p.ConnectionPointSide.South:return[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.North:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.South:return[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.North:return[o.clone().offset(0,-this.getMinOffset())]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return o.y<r.y?o.x>r.x?[]:[o.clone().offset(0,this.getMinOffset())]:o.y>this.endRect.bottom?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.West:return o.y<r.y?o.x<r.x?[]:[o.clone().offset(0,this.getMinOffset())]:o.y>this.endRect.bottom?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.South:return[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.North:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),o.x<r.x)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return r.y<o.y?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):o.x<r.x?[o.clone().offset(0,this.getMinOffset())]:[];case p.ConnectionPointSide.West:return r.y<o.y?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):o.x>r.x?[o.clone().offset(0,this.getMinOffset())]:[];case p.ConnectionPointSide.South:return[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.North:var c=this.getMinOffset();return this.beginRect.bottom>o.y&&(c+=this.beginRect.bottom-o.y),[o.clone().offset(0,c)]}},e.prototype.getBeginOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(0,this.getScaleableOffsetY(o,r,!1))]},e.prototype.getEndOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(0,this.getScaleableOffsetY(o,r,!0))]},e.prototype.getBeginOffSideOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!1);break;case p.ConnectionPointSide.West:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!0);break;case p.ConnectionPointSide.South:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(o,r,a,!1);break;case p.ConnectionPointSide.Undefined:case p.ConnectionPointSide.North:return this.getScaleableAsideOffsetPoints(o,r,a,!1)}return[o.clone().offset(0,this.getScaleableOffsetY(o,r,!1))]},e.prototype.getEndOffSideOffsetPoints=function(n,o,r,a){if(n===p.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(o,r,a,!0);if(this.isBeginEndOverlappedX()){var c=this.beginRect.center.x>this.endRect.center.x;return this.getScaleableAsideOffsetPoints(o,r,a,!0,c)}return[o.clone().offset(0,this.getScaleableOffsetY(o,r,!0))]},e.prototype.getAsideOffsetPoints=function(n,o,r,a,c,l){var y=[];return r!==void 0&&(l===void 0&&(l=o.x<n.x),l?y.push(n.clone().offset(-(n.x-r.x+c),a)):y.push(n.clone().offset(r.right-n.x+c,a))),y.push(n.clone().offset(0,a)),y},e.prototype.getScaleableAsideOffsetPoints=function(n,o,r,a,c){var l=this.getScaleableOffsetY(n,o,a),y=this.getScaleableOffsetX(n,o,a);return this.getAsideOffsetPoints(n,o,r,l,y,c)},e.prototype.getScaleableOffsetX=function(n,o,r){if(this.beginRect&&this.endRect&&!r&&!this.isBeginEndOverlappedX()){var a=void 0;if((a=o.x<n.x?this.beginRect.x-this.endRect.right:this.endRect.x-this.beginRect.right)<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(n,o,r){if(this.beginRect&&this.endRect){var a=r?this.beginRect.y-n.y:this.endRect.y-n.y;if(a>0&&a<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(n,o){return o.y>n.y},e.prototype.isDirectConnectionAllowed=function(n,o,r){return n===p.ConnectionPointSide.North||n===p.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(n,o){var r=n.y+(o.y-n.y)/2;return[new s.ConnectorRenderPoint(n.x,r),new s.ConnectorRenderPoint(o.x,r)]},e}(u.ConnectorPointsOrthogonalSideCalculatorBase);h.ConnectorPointsOrthogonalSouthSideCalculator=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalNorthSideCalculator=void 0;var p=d(9),u=d(52),s=d(29),i=function(t){function e(n){return t.call(this,n)||this}return P(e,t),e.prototype.getCorrectOriginPoint=function(n,o){return n.y>o.y&&(n=n.clone().offset(0,o.y-n.y)),n},e.prototype.getSameShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:case p.ConnectionPointSide.West:case p.ConnectionPointSide.North:return[o.clone().offset(0,-this.getMinOffset())];case p.ConnectionPointSide.South:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.South:return[o.clone().offset(0,this.getMinOffset())];case p.ConnectionPointSide.North:return[o.clone().offset(0,-this.getMinOffset())]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return o.y>r.y?o.x>r.x?[]:[o.clone().offset(0,-this.getMinOffset())]:o.y<this.endRect.y?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):[o.clone().offset(0,-this.getMinOffset())];case p.ConnectionPointSide.West:return o.y>r.y?o.x<r.x?[]:[o.clone().offset(0,-this.getMinOffset())]:o.y<this.endRect.y?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):[o.clone().offset(0,-this.getMinOffset())];case p.ConnectionPointSide.North:return[o.clone().offset(0,-this.getMinOffset())];case p.ConnectionPointSide.South:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),o.x<r.x)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return r.y>o.y?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):o.x<r.x?[o.clone().offset(0,-this.getMinOffset())]:[];case p.ConnectionPointSide.West:return r.y>o.y?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):o.x>r.x?[o.clone().offset(0,-this.getMinOffset())]:[];case p.ConnectionPointSide.North:return[o.clone().offset(0,-this.getMinOffset())];case p.ConnectionPointSide.South:var c=-this.getMinOffset();return this.beginRect.y<o.y&&(c-=o.y-this.beginRect.y),[o.clone().offset(0,c)]}},e.prototype.getBeginOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(0,-this.getScaleableOffsetY(o,r,!1))]},e.prototype.getEndOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(0,-this.getScaleableOffsetY(o,r,!0))]},e.prototype.getBeginOffSideOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!1);break;case p.ConnectionPointSide.West:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!0);break;case p.ConnectionPointSide.North:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(o,r,a,!1);break;case p.ConnectionPointSide.Undefined:case p.ConnectionPointSide.South:return this.getScaleableAsideOffsetPoints(o,r,a,!1)}return[o.clone().offset(0,-this.getScaleableOffsetY(o,r,!1))]},e.prototype.getEndOffSideOffsetPoints=function(n,o,r,a){if(n===p.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(o,r,a,!0);if(this.isBeginEndOverlappedX()){var c=this.beginRect.center.x>this.endRect.center.x;return this.getScaleableAsideOffsetPoints(o,r,a,!0,c)}return[o.clone().offset(0,-this.getScaleableOffsetY(o,r,!0))]},e.prototype.getAsideOffsetPoints=function(n,o,r,a,c,l){var y=[];return r!==void 0&&(l===void 0&&(l=o.x<n.x),l?y.push(n.clone().offset(-(n.x-r.x+c),-a)):y.push(n.clone().offset(r.right-n.x+c,-a))),y.push(n.clone().offset(0,-a)),y},e.prototype.getScaleableAsideOffsetPoints=function(n,o,r,a,c){var l=this.getScaleableOffsetY(n,o,a),y=this.getScaleableOffsetX(n,o,a);return this.getAsideOffsetPoints(n,o,r,l,y,c)},e.prototype.getScaleableOffsetX=function(n,o,r){if(this.beginRect&&this.endRect&&!r&&!this.isBeginEndOverlappedX()){var a=void 0;if((a=o.x<n.x?this.beginRect.x-this.endRect.right:this.endRect.x-this.beginRect.right)<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(n,o,r){if(this.beginRect&&this.endRect){var a=r?n.y-this.beginRect.bottom:n.y-this.endRect.bottom;if(a>0&&a<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(n,o){return o.y<n.y},e.prototype.isDirectConnectionAllowed=function(n,o,r){return n===p.ConnectionPointSide.South||n===p.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(n,o){var r=o.y+(n.y-o.y)/2;return[new s.ConnectorRenderPoint(n.x,r),new s.ConnectorRenderPoint(o.x,r)]},e}(u.ConnectorPointsOrthogonalSideCalculatorBase);h.ConnectorPointsOrthogonalNorthSideCalculator=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalEastSideCalculator=void 0;var p=d(9),u=d(52),s=d(29),i=function(t){function e(n){return t.call(this,n)||this}return P(e,t),e.prototype.getCorrectOriginPoint=function(n,o){return n.x<o.right&&(n=n.clone().offset(o.right-n.x,0)),n},e.prototype.getSameShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.North:case p.ConnectionPointSide.South:case p.ConnectionPointSide.East:return[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.West:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.West:return[o.clone().offset(-this.getMinOffset(),0)]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.North:return o.x<r.x?o.y<r.y?[]:[o.clone().offset(this.getMinOffset(),0)]:o.x>this.endRect.right?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.South:return o.x<r.x?o.y>r.y?[]:[o.clone().offset(this.getMinOffset(),0)]:o.x>this.endRect.right?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.East:return[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.West:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),o.y<r.y)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.West:var c=this.getMinOffset();return this.beginRect.right>o.x&&(c+=this.beginRect.right-o.x),[o.clone().offset(c,0)];case p.ConnectionPointSide.North:return r.x<o.x?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):o.y>r.y?[o.clone().offset(this.getMinOffset(),0)]:[];case p.ConnectionPointSide.South:return r.x<o.x?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):o.y<r.y?[o.clone().offset(this.getMinOffset(),0)]:[]}},e.prototype.getBeginOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(this.getScaleableOffsetX(o,r,!1),0)]},e.prototype.getEndOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(this.getScaleableOffsetX(o,r,!0),0)]},e.prototype.getBeginOffSideOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.South:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!1);break;case p.ConnectionPointSide.North:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!0);break;case p.ConnectionPointSide.East:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(o,r,a,!1);break;case p.ConnectionPointSide.Undefined:case p.ConnectionPointSide.West:return this.getScaleableAsideOffsetPoints(o,r,a,!1)}return[o.clone().offset(this.getScaleableOffsetX(o,r,!1),0)]},e.prototype.getEndOffSideOffsetPoints=function(n,o,r,a){if(n===p.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(o,r,a,!0);if(this.isBeginEndOverlappedY()){var c=this.beginRect.center.y>this.endRect.center.y;return this.getScaleableAsideOffsetPoints(o,r,a,!0,c)}return[o.clone().offset(this.getScaleableOffsetX(o,r,!0),0)]},e.prototype.getAsideOffsetPoints=function(n,o,r,a,c,l){var y=[];return r!==void 0&&(l===void 0&&(l=o.y<n.y),l?y.push(n.clone().offset(a,-(n.y-r.y+c))):y.push(n.clone().offset(a,r.bottom-n.y+c))),y.push(n.clone().offset(a,0)),y},e.prototype.getScaleableAsideOffsetPoints=function(n,o,r,a,c){var l=this.getScaleableOffsetX(n,o,a),y=this.getScaleableOffsetY(n,o,a);return this.getAsideOffsetPoints(n,o,r,l,y,c)},e.prototype.getScaleableOffsetX=function(n,o,r){if(this.beginRect&&this.endRect){var a=r?this.beginRect.x-n.x:this.endRect.x-n.x;if(a>0&&a<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(n,o,r){if(this.beginRect&&this.endRect&&!r&&!this.isBeginEndOverlappedY()){var a=void 0;if((a=o.y<n.y?this.beginRect.y-this.endRect.bottom:this.endRect.y-this.beginRect.bottom)<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(n,o){return o.x>n.x},e.prototype.isDirectConnectionAllowed=function(n,o,r){return n===p.ConnectionPointSide.West||n===p.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(n,o){var r=n.x+(o.x-n.x)/2;return[new s.ConnectorRenderPoint(r,n.y),new s.ConnectorRenderPoint(r,o.y)]},e}(u.ConnectorPointsOrthogonalSideCalculatorBase);h.ConnectorPointsOrthogonalEastSideCalculator=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorPointsOrthogonalWestSideCalculator=void 0;var p=d(9),u=d(52),s=d(29),i=function(t){function e(n){return t.call(this,n)||this}return P(e,t),e.prototype.getCorrectOriginPoint=function(n,o){return n.x>o.x&&(n=n.clone().offset(o.x-n.x,0)),n},e.prototype.getSameShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.North:case p.ConnectionPointSide.South:case p.ConnectionPointSide.West:return[o.clone().offset(-this.getMinOffset(),0)];case p.ConnectionPointSide.East:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:return[o.clone().offset(this.getMinOffset(),0)];case p.ConnectionPointSide.West:return[o.clone().offset(-this.getMinOffset(),0)]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.North:return o.x>r.x?o.y<r.y?[]:[o.clone().offset(-this.getMinOffset(),0)]:o.x<this.endRect.x?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):[o.clone().offset(-this.getMinOffset(),0)];case p.ConnectionPointSide.South:return o.x>r.x?o.y>r.y?[]:[o.clone().offset(-this.getMinOffset(),0)]:o.x<this.endRect.x?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):[o.clone().offset(-this.getMinOffset(),0)];case p.ConnectionPointSide.West:return[o.clone().offset(-this.getMinOffset(),0)];case p.ConnectionPointSide.East:return this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),o.y<r.y)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.East:var c=-this.getMinOffset();return this.beginRect.x<o.x&&(c-=o.x-this.beginRect.x),[o.clone().offset(c,0)];case p.ConnectionPointSide.West:return[o.clone().offset(-this.getMinOffset(),0)];case p.ConnectionPointSide.North:return r.x>o.x?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!0):o.y>r.y?[o.clone().offset(-this.getMinOffset(),0)]:[];case p.ConnectionPointSide.South:return r.x>o.x?this.getAsideOffsetPoints(o,r,a,this.getMinOffset(),this.getMinOffset(),!1):o.y<r.y?[o.clone().offset(-this.getMinOffset(),0)]:[]}},e.prototype.getBeginOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(-this.getScaleableOffsetX(o,!1),0)]},e.prototype.getEndOnSideOffsetPoints=function(n,o,r,a){return[o.clone().offset(-this.getScaleableOffsetX(o,!0),0)]},e.prototype.getBeginOffSideOffsetPoints=function(n,o,r,a){switch(n){case p.ConnectionPointSide.South:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!1);break;case p.ConnectionPointSide.North:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(o,r,a,!1,!0);break;case p.ConnectionPointSide.West:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(o,r,a,!1);break;case p.ConnectionPointSide.Undefined:case p.ConnectionPointSide.East:return this.getScaleableAsideOffsetPoints(o,r,a,!1)}return[o.clone().offset(-this.getScaleableOffsetX(o,!1),0)]},e.prototype.getEndOffSideOffsetPoints=function(n,o,r,a){if(n===p.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(o,r,a,!0);if(this.isBeginEndOverlappedY()){var c=this.beginRect.center.y>this.endRect.center.y;return this.getScaleableAsideOffsetPoints(o,r,a,!0,c)}return[o.clone().offset(-this.getScaleableOffsetX(o,!0),0)]},e.prototype.getAsideOffsetPoints=function(n,o,r,a,c,l){var y=[];return r!==void 0&&(l===void 0&&(l=o.y<n.y),l?y.push(n.clone().offset(-a,-(n.y-r.y+c))):y.push(n.clone().offset(-a,r.bottom-n.y+c))),y.push(n.clone().offset(-a,0)),y},e.prototype.getScaleableAsideOffsetPoints=function(n,o,r,a,c){var l=this.getScaleableOffsetX(n,a),y=this.getScaleableOffsetY(n,o,a);return this.getAsideOffsetPoints(n,o,r,l,y,c)},e.prototype.getScaleableOffsetX=function(n,o){if(this.beginRect&&this.endRect){var r=o?n.x-this.beginRect.right:n.x-this.endRect.right;if(r>0&&r<2*this.getMinOffset())return r/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(n,o,r){if(this.beginRect&&this.endRect&&!r&&!this.isBeginEndOverlappedY()){var a=void 0;if((a=o.y<n.y?this.beginRect.y-this.endRect.bottom:this.endRect.y-this.beginRect.bottom)<2*this.getMinOffset())return a/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(n,o){return o.x<n.x},e.prototype.isDirectConnectionAllowed=function(n,o,r){return n===p.ConnectionPointSide.East||n===p.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(n,o){var r=o.x+(n.x-o.x)/2;return[new s.ConnectorRenderPoint(r,n.y),new s.ConnectorRenderPoint(r,o.y)]},e}(u.ConnectorPointsOrthogonalSideCalculatorBase);h.ConnectorPointsOrthogonalWestSideCalculator=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorLineEndingFilledTriangleStrategy=h.ConnectorLineEndingOutlinedTriangleStrategy=h.ConnectorLineEndingArrowStrategy=h.ConnectorLineEndingNoneStrategy=h.ConnectorLineEndingStrategy=void 0;var p=d(3),u=d(5),s=function(){function o(r){this.style=r}return o.prototype.hasCommands=function(){return!0},o.prototype.needCreateSeparatePrimitive=function(){return!1},o.prototype.createPrimitive=function(){return new u.PathPrimitive([],this.getStyle(),this.getCssClass())},o.prototype.createCommands=function(r,a){return[]},o.prototype.getStyle=function(){var r=this.style.clone();return r.resetStrokeDashArray(),r},o.prototype.getCssClass=function(){},o}();h.ConnectorLineEndingStrategy=s;var i=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),r.prototype.hasCommands=function(){return!1},r}(s);h.ConnectorLineEndingNoneStrategy=i;var t=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),Object.defineProperty(r.prototype,"arrowHeight",{get:function(){return 6*this.style.strokeWidth},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"arrowWidth",{get:function(){return 2*this.style.strokeWidth},enumerable:!1,configurable:!0}),r.prototype.needCreateSeparatePrimitive=function(){return!this.style.isDefaultStrokeDashArray()},r.prototype.createCommands=function(a,c){var l=this.getArrowPoints(a,c),y=[new u.PathPrimitiveMoveToCommand(l.point1.x,l.point1.y),new u.PathPrimitiveLineToCommand(a.x,a.y),new u.PathPrimitiveLineToCommand(l.point2.x,l.point2.y)];return this.style.isDefaultStrokeDashArray()||(y=y.concat([new u.PathPrimitiveMoveToCommand(a.x,a.y),new u.PathPrimitiveLineToCommand(l.point3.x,l.point3.y)])),y},r.prototype.getArrowPoints=function(a,c){var l,y=this.arrowHeight;return a.x===c.x&&(l=Math.abs(a.y-c.y))<y&&(y=l),a.y===c.y&&(l=Math.abs(a.x-c.x))<y&&(y=l),p.GeometryUtils.getArrowPoints(a,c,y,this.arrowWidth)},r}(s);h.ConnectorLineEndingArrowStrategy=t;var e=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),r.prototype.needCreateSeparatePrimitive=function(){return!0},r.prototype.createCommands=function(a,c){var l=this.getArrowPoints(a,c);return[new u.PathPrimitiveMoveToCommand(l.point1.x,l.point1.y),new u.PathPrimitiveLineToCommand(a.x,a.y),new u.PathPrimitiveLineToCommand(l.point2.x,l.point2.y),new u.PathPrimitiveClosePathCommand]},r.prototype.getCssClass=function(){return"outlined-line-ending"},r}(t);h.ConnectorLineEndingOutlinedTriangleStrategy=e;var n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),r.prototype.getStyle=function(){var a=o.prototype.getStyle.call(this);return a.fill=a.stroke,a},r.prototype.getCssClass=function(){return"filled-line-ending"},r}(e);h.ConnectorLineEndingFilledTriangleStrategy=n},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorTexts=h.ConnectorText=void 0;var m=function(){return function(p,u){this.position=p,this.value=u}}();h.ConnectorText=m;var P=function(){function p(){this.items={}}return p.prototype.get=function(u){return this.items[u]},p.prototype.set=function(u,s){this.items[u]=s},p.prototype.remove=function(u){delete this.items[u]},p.prototype.map=function(u){var s=[];return this.forEach(function(i){return s.push(u(i))}),s},p.prototype.forEach=function(u){for(var s in this.items)Object.prototype.hasOwnProperty.call(this.items,s)&&u(this.items[s])},p.prototype.count=function(){return Object.keys(this.items).length},p.prototype.clone=function(){var u=new p;return this.forEach(function(s){u.set(s.position,new m(s.position,s.value))}),u},p.prototype.toObject=function(){var u={},s=!1;return this.forEach(function(i){u[i.position]=i.value,s=!0}),s?u:null},p.prototype.fromObject=function(u){for(var s in u)if(Object.prototype.hasOwnProperty.call(u,s)){var i=parseFloat(s);isNaN(i)||typeof u[s]!="string"||this.set(i,new m(i,u[s]))}},p}();h.ConnectorTexts=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.AddConnectorPointHistoryItem=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.connectorKey=i,n.pointIndex=t,n.point=e,n}return P(s,u),s.prototype.redo=function(i){var t=this,e=i.model.findConnector(this.connectorKey);this.renderContext=e.tryCreateRenderPointsContext(),i.addDeleteConnectorPoint(e,function(n){n.addPoint(t.pointIndex,t.point),n.onAddPoint(t.pointIndex,t.point)})},s.prototype.undo=function(i){var t=this,e=i.model.findConnector(this.connectorKey);i.addDeleteConnectorPoint(e,function(n){n.deletePoint(t.pointIndex),n.replaceRenderPoints(t.renderContext)})},s}(d(8).HistoryItem);h.AddConnectorPointHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.InsertToContainerHistoryItem=void 0;var p=function(u){function s(i,t){var e=u.call(this)||this;return e.containerKey=t.key,e.itemKey=i.key,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey),e=i.model.findShape(this.containerKey);i.insertToContainer(t,e)},s.prototype.undo=function(i){var t=i.model.findItem(this.itemKey);i.removeFromContainer(t)},s}(d(8).HistoryItem);h.InsertToContainerHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.MoveConnectorRightAnglePointsHistoryItem=h.MoveConnectorPointHistoryItem=void 0;var p=d(8),u=function(i){function t(e,n,o){var r=i.call(this)||this;return r.connectorKey=e,r.pointIndex=n,r.newPoint=o,r}return P(t,i),t.prototype.redo=function(e){var n=this,o=e.model.findConnector(this.connectorKey);this.oldPoint=o.points[this.pointIndex].clone(),this.renderContext=o.tryCreateRenderPointsContext(),e.moveConnectorPoint(o,this.pointIndex,function(r){r.movePoint(n.pointIndex,n.newPoint),r.onMovePoint(n.pointIndex,n.newPoint)})},t.prototype.undo=function(e){var n=this,o=e.model.findConnector(this.connectorKey);e.moveConnectorPoint(o,this.pointIndex,function(r){r.movePoint(n.pointIndex,n.oldPoint),r.replaceRenderPoints(n.renderContext)})},t}(p.HistoryItem);h.MoveConnectorPointHistoryItem=u;var s=function(i){function t(e,n,o,r,a){var c=i.call(this)||this;return c.connectorKey=e,c.beginPointIndex=n,c.newBeginPoint=o,c.lastPointIndex=r,c.newLastPoint=a,c}return P(t,i),t.prototype.redo=function(e){var n=this,o=e.model.findConnector(this.connectorKey);this.oldBeginPoint=o.points[this.beginPointIndex].clone(),this.oldLastPoint=o.points[this.lastPointIndex].clone(),this.renderContext=o.tryCreateRenderPointsContext(),e.changeConnectorPoints(o,function(r){r.movePoint(n.beginPointIndex,n.newBeginPoint),r.movePoint(n.lastPointIndex,n.newLastPoint),r.onMovePoints(n.beginPointIndex,n.newBeginPoint,n.lastPointIndex,n.newLastPoint)})},t.prototype.undo=function(e){var n=this,o=e.model.findConnector(this.connectorKey);e.changeConnectorPoints(o,function(r){r.movePoint(n.beginPointIndex,n.oldBeginPoint),r.movePoint(n.lastPointIndex,n.oldLastPoint),r.replaceRenderPoints(n.renderContext)})},t}(p.HistoryItem);h.MoveConnectorRightAnglePointsHistoryItem=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.MoveShapeHistoryItem=void 0;var p=function(u){function s(i,t){var e=u.call(this)||this;return e.shapeKey=i,e.position=t,e}return P(s,u),s.prototype.redo=function(i){var t=i.model.findShape(this.shapeKey);this.oldPosition=t.position.clone(),i.moveShape(t,this.position)},s.prototype.undo=function(i){var t=i.model.findShape(this.shapeKey);i.moveShape(t,this.oldPosition)},s}(d(8).HistoryItem);h.MoveShapeHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.RemoveFromContainerHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.itemKey=i.key,t}return P(s,u),s.prototype.redo=function(i){var t=i.model.findItem(this.itemKey);this.containerKey=t.container&&t.container.key,i.removeFromContainer(t)},s.prototype.undo=function(i){var t=i.model.findContainer(this.containerKey),e=i.model.findItem(this.itemKey);i.insertToContainer(e,t)},s}(d(8).HistoryItem);h.RemoveFromContainerHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ModelResizeHistoryItem=void 0;var p=d(8),u=d(87),s=d(2),i=function(t){function e(n){var o=t.call(this)||this;return o.offset=n,o}return P(e,t),e.prototype.redo=function(n){this.oldSize=n.model.size.clone(),this.backOffset=new u.Offsets(-this.offset.left,-this.offset.right,-this.offset.top,-this.offset.bottom);var o=Math.max(this.oldSize.width+this.offset.left+this.offset.right,n.model.pageWidth),r=Math.max(this.oldSize.height+this.offset.top+this.offset.bottom,n.model.pageHeight);n.changeModelSize(new s.Size(o,r),this.offset)},e.prototype.undo=function(n){n.changeModelSize(this.oldSize,this.backOffset)},e}(p.HistoryItem);h.ModelResizeHistoryItem=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.UpdatePositionsOnPageResizeHistoryItem=void 0;var p=d(6),u=d(14),s=function(i){function t(e){var n=i.call(this)||this;return n.offset=e,n}return P(t,i),t.prototype.redo=function(e){var n=this;e.model.iterateItems(function(o){o instanceof u.Shape&&e.moveShape(o,n.applyOffset(o.position,n.offset.x,n.offset.y)),o instanceof p.Connector&&e.changeConnectorPoints(o,function(r){return r.updatePointsOnPageResize(n.offset.x,n.offset.y)})})},t.prototype.undo=function(e){var n=this;e.model.iterateItems(function(o){o instanceof u.Shape&&e.moveShape(o,n.applyOffset(o.position,-n.offset.x,-n.offset.y)),o instanceof p.Connector&&e.changeConnectorPoints(o,function(r){return r.updatePointsOnPageResize(-n.offset.x,-n.offset.y)})})},t.prototype.applyOffset=function(e,n,o){return e.clone().offset(n,o)},t}(d(8).HistoryItem);h.UpdatePositionsOnPageResizeHistoryItem=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.GraphInfo=void 0;var m=d(196),P=function(){function p(u,s){this.container=u,this.sourceGraph=s}return Object.defineProperty(p.prototype,"graph",{get:function(){return this._graph||(this._graph=this.getNodeInfoGraph())},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"level",{get:function(){return this._level!==void 0?this._level:this._level=this.getLevel()},enumerable:!1,configurable:!0}),p.prototype.getNodeInfoGraph=function(){return this.sourceGraph.cast(m.LayoutUtils.shapeToLayout)},p.prototype.getLevel=function(){var u=0;return this.container&&(u=this.getContainerLevel(this.container)),u},p.prototype.getContainerLevel=function(u){var s=1,i=u.container;return i&&(s+=this.getContainerLevel(i)),s},p}();h.GraphInfo=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.LayoutUtils=void 0;var m=d(71),P=function(){function p(){}return p.shapeToLayout=function(u){var s=new m.Margin(0),i=u.rectangle;u.attachedConnectors.filter(function(e){return!e.beginItem||!e.endItem}).forEach(function(e){var n=e.rectangle;s.left=Math.max(s.left,i.x-n.x),s.right=Math.max(s.right,n.right-i.right),s.top=Math.max(s.top,i.y-n.y),s.bottom=Math.max(s.bottom,n.bottom-i.bottom)});var t=new m.NodeInfo(u.key,s,u.size.clone());return t.connectionPoints=u.description.getConnectionPoints(),t},p}();h.LayoutUtils=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.CommandBase=void 0;var m=function(){function P(p){this.control=p}return P.prototype.execute=function(p){this.isPermissionsRequired&&this.permissionsProvider.lockPermissions();var u=this.getState();if(this.isPermissionsRequired&&this.permissionsProvider.unlockPermissions(),!u.enabled)return!1;this.control.beginUpdate();var s=!1;return s=this.isPermissionsRequired?this.executeWithPermissions(u,p):this.executeCore(u,p),this.control.endUpdate(),s&&this.updateControlState(),s},P.prototype.executeWithPermissions=function(p,u){var s=!1;return this.permissionsProvider.beginStorePermissions(),this.control.history.beginTransaction(),s=this.executeCore(p,u),this.permissionsProvider.isStoredPermissionsGranted()||(this.permissionsProvider.lockPermissions(),this.control.history.undoTransaction(),this.permissionsProvider.unlockPermissions(),s=!1),this.control.history.endTransaction(),this.permissionsProvider.endStorePermissions(),s},P.prototype.updateControlState=function(){this.lockInputPositionUpdating()||this.control.selection.inputPosition.reset(),this.lockUIUpdating()||this.control.barManager.updateItemsState()},Object.defineProperty(P.prototype,"permissionsProvider",{get:function(){return this.control&&this.control.permissionsProvider},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isPermissionsRequired",{get:function(){return!1},enumerable:!1,configurable:!0}),P.prototype.lockUIUpdating=function(){return!1},P.prototype.lockInputPositionUpdating=function(){return!1},P}();h.CommandBase=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.SimpleCommandState=void 0;var m=function(){return function(P,p,u,s,i){this.visible=!0,this.denyUpdateValue=!1,this.enabled=P,this.value=p,this.items=s,this.visible=i,this.defaultValue=u}}();h.SimpleCommandState=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.UndoCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.executeCore=function(i){return this.control.beginUpdateCanvas(),this.permissionsProvider.lockPermissions(),this.control.history.undo(),this.permissionsProvider.unlockPermissions(),this.control.endUpdateCanvas(),!0},s.prototype.isEnabled=function(){return u.prototype.isEnabled.call(this)&&this.control.history.canUndo()},s}(d(10).SimpleCommandBase);h.UndoCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.RedoCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.executeCore=function(i){return this.control.beginUpdateCanvas(),this.permissionsProvider.lockPermissions(),this.control.history.redo(),this.permissionsProvider.unlockPermissions(),this.control.endUpdateCanvas(),!0},s.prototype.isEnabled=function(){return u.prototype.isEnabled.call(this)&&this.control.history.canRedo()},s}(d(10).SimpleCommandBase);h.RedoCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ImportCommand=void 0;var p=d(119),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.executeCore=function(t,e){this.permissionsProvider.lockPermissions();var n=e.data?e.data:e,o=new p.Importer(this.control.shapeDescriptionManager,n);if(e.keepExistingItems===!0)o.importItemsData(this.control.model),this.control.importItemsData();else{var r=o.import();this.control.importModel(r)}return this.permissionsProvider.unlockPermissions(),!0},i}(d(57).ExportImportCommandBase);h.ImportCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ProcessShapeDescription=void 0;var p=d(19),u=d(1),s=function(i){function t(){return i.call(this,void 0,!0)||this}return P(t,i),Object.defineProperty(t.prototype,"key",{get:function(){return u.ShapeTypes.Process},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(p.RectangleShapeDescription);h.ProcessShapeDescription=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.DecisionShapeDescription=void 0;var p=d(120),u=d(1),s=d(2),i=d(7),t=function(e){function n(){return e.call(this,new s.Size(i.ShapeDefaultDimension,.75*i.ShapeDefaultDimension),!0)||this}return P(n,e),Object.defineProperty(n.prototype,"key",{get:function(){return u.ShapeTypes.Decision},enumerable:!1,configurable:!0}),n}(p.DiamondShapeDescription);h.DecisionShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ManualInputShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(9),t=d(7),e=function(n){function o(){return n.call(this,void 0,!0)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return u.ShapeTypes.ManualInput},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=l+a.height*o.slopeHeightRatio;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(c,f),new s.PathPrimitiveLineToCommand(y,l),new s.PathPrimitiveLineToCommand(y,g),new s.PathPrimitiveLineToCommand(c,g),new s.PathPrimitiveClosePathCommand],r.style)]},o.prototype.processConnectionPoint=function(r,a){r.getConnectionPointSide(a)===i.ConnectionPointSide.North&&(a.y+=o.slopeHeightRatio/2*r.size.height)},o.prototype.getTextRectangle=function(r){var a=r.size.height*o.slopeHeightRatio;return r.rectangle.clone().moveRectangle(t.ShapeTextPadding,a).resize(2*-t.ShapeTextPadding,-a-t.ShapeTextPadding).nonNegativeSize()},o.slopeHeightRatio=.1,o}(p.RectangleShapeDescription);h.ManualInputShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.DataShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(9),t=d(7),e=function(n){function o(){return n.call(this,void 0,!0)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return u.ShapeTypes.Data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.width,v=a.height,C=Math.min(Math.max(0,v/Math.tan(o.slopeAngle)),f),b=c+C,S=y-C;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(b,l),new s.PathPrimitiveLineToCommand(y,l),new s.PathPrimitiveLineToCommand(S,g),new s.PathPrimitiveLineToCommand(c,g),new s.PathPrimitiveClosePathCommand],r.style)]},o.prototype.processConnectionPoint=function(r,a){var c=r.size.height/Math.tan(o.slopeAngle),l=r.getConnectionPointSide(a);l===i.ConnectionPointSide.East?a.x-=c/2:l===i.ConnectionPointSide.West&&(a.x+=c/2)},o.prototype.getTextRectangle=function(r){var a=Math.min(Math.max(0,r.size.height/Math.tan(o.slopeAngle)),r.size.width);return r.rectangle.clone().moveRectangle(a,t.ShapeTextPadding).resize(2*-a,2*-t.ShapeTextPadding)},o.slopeAngle=81*Math.PI/180,o}(p.RectangleShapeDescription);h.DataShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.TerminatorShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(2),t=d(7),e=d(13),n=d(3),o=function(r){function a(){return r.call(this,new i.Size(t.ShapeDefaultDimension,.5*t.ShapeDefaultDimension),!0)||this}return P(a,r),Object.defineProperty(a.prototype,"key",{get:function(){return u.ShapeTypes.Terminator},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),a.prototype.createShapePrimitives=function(c){var l=c.rectangle,y=l.x,g=l.y,f=l.right,v=l.bottom,C=l.width,b=l.center.y,S=y+C*a.curveWidthRatio,x=y+C*(1-a.curveWidthRatio);return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(S,g),new s.PathPrimitiveLineToCommand(x,g),new s.PathPrimitiveQuadraticCurveToCommand(f,g,f,b),new s.PathPrimitiveQuadraticCurveToCommand(f,v,x,v),new s.PathPrimitiveLineToCommand(S,v),new s.PathPrimitiveQuadraticCurveToCommand(y,v,y,b),new s.PathPrimitiveQuadraticCurveToCommand(y,g,S,g),new s.PathPrimitiveClosePathCommand],c.style)]},a.prototype.getTextRectangle=function(c){var l=n.GeometryUtils.getMaxRectangleEnscribedInEllipse(c.size);return e.Rectangle.fromGeometry(c.position.clone().offset((c.size.width-l.width)/2,(c.size.height-l.height)/2),l)},a.prototype.getSizeByText=function(c,l){return n.GeometryUtils.getEllipseByEnscribedRectangle(c)},a.curveWidthRatio=.3,a}(p.RectangleShapeDescription);h.TerminatorShapeDescription=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.PredefinedProcessShapeDescription=h.PredefinedProcessEdgeParameterName=void 0;var p=d(19),u=d(1),s=d(37),i=d(30),t=d(0),e=d(5);h.PredefinedProcessEdgeParameterName="e";var n=function(o){function r(){return o.call(this,void 0,!0)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.PredefinedProcess},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=l+a.parameters.get(h.PredefinedProcessEdgeParameterName).value,C=g-a.parameters.get(h.PredefinedProcessEdgeParameterName).value;return o.prototype.createShapePrimitives.call(this,a).concat([new e.PathPrimitive([new e.PathPrimitiveMoveToCommand(v,y),new e.PathPrimitiveLineToCommand(v,f),new e.PathPrimitiveMoveToCommand(C,y),new e.PathPrimitiveLineToCommand(C,f)],a.style)])},r.prototype.createParameters=function(a){a.add(new s.ShapeParameter(h.PredefinedProcessEdgeParameterName,.1*this.defaultSize.width))},r.prototype.normalizeParameters=function(a,c){this.changeParameterValue(c,h.PredefinedProcessEdgeParameterName,function(l){return Math.max(r.minEdge,Math.min(.3*a.size.width,l.value))})},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,h.PredefinedProcessEdgeParameterName,function(g){return g.value+l}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new i.ShapeParameterPoint("c",new t.Point(a.normalizeX(a.position.x+a.parameters.get(h.PredefinedProcessEdgeParameterName).value),a.position.y))]},r.prototype.getTextRectangle=function(a){var c=a.rectangle,l=a.parameters.get(h.PredefinedProcessEdgeParameterName).value;return c.clone().resize(-2*l,0).clone().moveRectangle(l,0)},r.minEdge=72,r}(p.RectangleShapeDescription);h.PredefinedProcessShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowUpDownShapeDescription=void 0;var p=d(5),u=d(30),s=d(0),i=d(92),t=d(1),e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return t.ShapeTypes.ArrowUpDown},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.width,v=a.center.x,C=(f-r.parameters.get(i.ArrowVerticalLineWidthParameterName).value)/2,b=r.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value,S=r.normalizeX(c+C),x=r.normalizeY(l+b),I=r.normalizeX(y-C),w=r.normalizeY(g-b);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(v,l),new p.PathPrimitiveLineToCommand(y,x),new p.PathPrimitiveLineToCommand(I,x),new p.PathPrimitiveLineToCommand(I,w),new p.PathPrimitiveLineToCommand(y,w),new p.PathPrimitiveLineToCommand(v,g),new p.PathPrimitiveLineToCommand(c,w),new p.PathPrimitiveLineToCommand(S,w),new p.PathPrimitiveLineToCommand(S,x),new p.PathPrimitiveLineToCommand(c,x),new p.PathPrimitiveClosePathCommand],r.style)]},o.prototype.normalizeParameters=function(r,a){this.changeParameterValue(a,i.ArrowVerticalTriangleHeightParameterName,function(c){return Math.max(0,Math.min(r.size.height/2-2*r.strokeWidth,c.value))}),this.changeParameterValue(a,i.ArrowVerticalLineWidthParameterName,function(c){return Math.max(0,Math.min(r.size.width,c.value))})},o.prototype.modifyParameters=function(r,a,c,l){this.changeParameterValue(a,i.ArrowVerticalTriangleHeightParameterName,function(y){return y.value+l}),this.changeParameterValue(a,i.ArrowVerticalLineWidthParameterName,function(y){return y.value-2*c}),this.normalizeParameters(r,a)},o.prototype.getParameterPoints=function(r){return[new u.ShapeParameterPoint("c",new s.Point(r.normalizeX(r.position.x+(r.size.width-r.parameters.get(i.ArrowVerticalLineWidthParameterName).value)/2),r.normalizeY(r.position.y+r.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value)))]},o}(i.ArrowVerticalShapeDescription);h.ArrowUpDownShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowRightShapeDescription=void 0;var p=d(5),u=d(93),s=d(30),i=d(0),t=d(1),e=d(9),n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return t.ShapeTypes.ArrowRight},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.height,b=c.center.y,S=v-a.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value,x=(C-a.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2,I=a.normalizeX(l+S),w=a.normalizeY(y+x),_=a.normalizeY(f-x);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(l,w),new p.PathPrimitiveLineToCommand(I,w),new p.PathPrimitiveLineToCommand(I,y),new p.PathPrimitiveLineToCommand(g,b),new p.PathPrimitiveLineToCommand(I,f),new p.PathPrimitiveLineToCommand(I,_),new p.PathPrimitiveLineToCommand(l,_),new p.PathPrimitiveClosePathCommand],a.style)]},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,u.ArrowVerticalTriangleWidthParameterName,function(g){return g.value-l}),this.changeParameterValue(c,u.ArrowVerticalLineHeightParameterName,function(g){return g.value-2*y}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new s.ShapeParameterPoint("c",new i.Point(a.normalizeX(a.position.x+a.size.width-a.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value),a.normalizeY(a.position.y+(a.size.height-a.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2)))]},r.prototype.processConnectionPoint=function(a,c){var l=a.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value;if(c.x>a.position.x+a.size.width-l){var y=a.size.height/2/l,g=(c.x-(a.position.x+a.size.width-l))*y,f=a.getConnectionPointSide(c);f===e.ConnectionPointSide.North?c.y+=g:f===e.ConnectionPointSide.South&&(c.y-=g)}else o.prototype.processConnectionPoint.call(this,a,c)},r}(u.ArrowHorizontalShapeDescription);h.ArrowRightShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowUpShapeDescription=void 0;var p=d(5),u=d(30),s=d(0),i=d(92),t=d(1),e=d(9),n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return t.ShapeTypes.ArrowUp},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.center.x,b=(v-a.parameters.get(i.ArrowVerticalLineWidthParameterName).value)/2,S=a.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value,x=a.normalizeX(l+b),I=a.normalizeY(y+S),w=a.normalizeX(g-b);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(C,y),new p.PathPrimitiveLineToCommand(g,I),new p.PathPrimitiveLineToCommand(w,I),new p.PathPrimitiveLineToCommand(w,f),new p.PathPrimitiveLineToCommand(x,f),new p.PathPrimitiveLineToCommand(x,I),new p.PathPrimitiveLineToCommand(l,I),new p.PathPrimitiveClosePathCommand],a.style)]},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,i.ArrowVerticalTriangleHeightParameterName,function(g){return g.value+y}),this.changeParameterValue(c,i.ArrowVerticalLineWidthParameterName,function(g){return g.value-2*l}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new u.ShapeParameterPoint("c",new s.Point(a.normalizeX(a.position.x+(a.size.width-a.parameters.get(i.ArrowVerticalLineWidthParameterName).value)/2),a.normalizeY(a.position.y+a.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value)))]},r.prototype.processConnectionPoint=function(a,c){var l=a.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value;if(c.y<a.position.y+l){var y=a.size.width/2/l,g=(a.position.y+l-c.y)*y,f=a.getConnectionPointSide(c);f===e.ConnectionPointSide.East?c.x-=g:f===e.ConnectionPointSide.West&&(c.x+=g)}else o.prototype.processConnectionPoint.call(this,a,c)},r}(i.ArrowVerticalShapeDescription);h.ArrowUpShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.CrossShapeDescription=h.CrossVerticalWidthParameterName=h.CrossHorizontalWidthParameterName=void 0;var p=d(7),u=d(0),s=d(37),i=d(30),t=d(5),e=d(1);h.CrossHorizontalWidthParameterName="chw",h.CrossVerticalWidthParameterName="cvw";var n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return e.ShapeTypes.Cross},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.height,b=(v-a.parameters.get(h.CrossHorizontalWidthParameterName).value)/2,S=(C-a.parameters.get(h.CrossVerticalWidthParameterName).value)/2,x=a.normalizeX(l+b),I=a.normalizeY(y+S),w=a.normalizeX(g-b),_=a.normalizeY(f-S);return[new t.PathPrimitive([new t.PathPrimitiveMoveToCommand(l,I),new t.PathPrimitiveLineToCommand(x,I),new t.PathPrimitiveLineToCommand(x,y),new t.PathPrimitiveLineToCommand(w,y),new t.PathPrimitiveLineToCommand(w,I),new t.PathPrimitiveLineToCommand(g,I),new t.PathPrimitiveLineToCommand(g,_),new t.PathPrimitiveLineToCommand(w,_),new t.PathPrimitiveLineToCommand(w,f),new t.PathPrimitiveLineToCommand(x,f),new t.PathPrimitiveLineToCommand(x,_),new t.PathPrimitiveLineToCommand(l,_),new t.PathPrimitiveClosePathCommand],a.style)]},r.prototype.createParameters=function(a){a.addRange([new s.ShapeParameter(h.CrossHorizontalWidthParameterName,.2*this.defaultSize.width),new s.ShapeParameter(h.CrossVerticalWidthParameterName,.2*this.defaultSize.height)])},r.prototype.normalizeParameters=function(a,c){this.changeParameterValue(c,h.CrossHorizontalWidthParameterName,function(l){return Math.max(0,Math.min(a.size.width,l.value))}),this.changeParameterValue(c,h.CrossVerticalWidthParameterName,function(l){return Math.max(0,Math.min(a.size.height,l.value))})},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,h.CrossHorizontalWidthParameterName,function(g){return g.value-2*l}),this.changeParameterValue(c,h.CrossVerticalWidthParameterName,function(g){return g.value-2*y}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new i.ShapeParameterPoint("c",new u.Point(a.normalizeX(a.position.x+(a.size.width-a.parameters.get(h.CrossHorizontalWidthParameterName).value)/2),a.normalizeY(a.position.y+(a.size.height-a.parameters.get(h.CrossVerticalWidthParameterName).value)/2)))]},r.prototype.getTextRectangle=function(a){return a.rectangle.clone().inflate(-p.ShapeTextPadding,-p.ShapeTextPadding)},r.prototype.getSizeByText=function(a,c){return a.clone().offset(2*p.ShapeTextPadding,2*p.ShapeTextPadding)},r}(p.ShapeDescription);h.CrossShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.HeartShapeDescription=void 0;var p=d(7),u=d(5),s=d(1),i=d(45),t=d(9),e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return s.ShapeTypes.Heart},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),o.prototype.createConnectionPoints=function(){return[new i.ConnectionPoint(.5,.15,t.ConnectionPointSide.North),new i.ConnectionPoint(1,.25,t.ConnectionPointSide.East),new i.ConnectionPoint(.5,1,t.ConnectionPointSide.South),new i.ConnectionPoint(0,.25,t.ConnectionPointSide.West)]},o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.width,v=a.height;return[new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(y-.25*f,l),new u.PathPrimitiveCubicCurveToCommand(y-.15*f,l,y,l+.1*v,y,l+.25*v),new u.PathPrimitiveCubicCurveToCommand(y,l+.3*v,y-.02*f,l+.35*v,y-.05*f,l+.4*v),new u.PathPrimitiveLineToCommand(a.center.x,g),new u.PathPrimitiveLineToCommand(c+.05*f,l+.4*v),new u.PathPrimitiveCubicCurveToCommand(c+.02*f,l+.35*v,c,l+.3*v,c,l+.25*v),new u.PathPrimitiveCubicCurveToCommand(c,l+.1*v,c+.15*f,l,c+.25*f,l),new u.PathPrimitiveCubicCurveToCommand(c+.3*f,l,c+.45*f,l+.03*v,c+.5*f,l+.15*v),new u.PathPrimitiveCubicCurveToCommand(y-.45*f,l+.03*v,y-.3*f,l,y-.25*f,l),new u.PathPrimitiveClosePathCommand],r.style)]},o.prototype.getTextRectangle=function(r){return r.rectangle.clone().inflate(-p.ShapeTextPadding,-p.ShapeTextPadding)},o.prototype.getSizeByText=function(r,a){return a.size.clone().offset(2*p.ShapeTextPadding,2*p.ShapeTextPadding)},o}(p.ShapeDescription);h.HeartShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.OctagonShapeDescription=void 0;var p=d(5),u=d(1),s=d(94),i=d(3),t=d(13),e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return u.ShapeTypes.Octagon},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"angleCount",{get:function(){return 8},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.width,v=a.height,C=Math.PI-this.angle,b=f/(1+2*Math.cos(C)),S=v/(1+2*Math.cos(C)),x=c+(f-b)/2,I=x+b,w=l+(v-S)/2,_=w+S;return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(x,l),new p.PathPrimitiveLineToCommand(I,l),new p.PathPrimitiveLineToCommand(y,w),new p.PathPrimitiveLineToCommand(y,_),new p.PathPrimitiveLineToCommand(I,g),new p.PathPrimitiveLineToCommand(x,g),new p.PathPrimitiveLineToCommand(c,_),new p.PathPrimitiveLineToCommand(c,w),new p.PathPrimitiveClosePathCommand],r.style)]},o.prototype.calculateHeight=function(r){return r},o.prototype.getTextRectangle=function(r){var a=i.GeometryUtils.getMaxRectangleEnscribedInEllipse(r.size);return t.Rectangle.fromGeometry(r.position.clone().offset((r.size.width-a.width)/2,(r.size.height-a.height)/2),a)},o.prototype.getSizeByText=function(r,a){return i.GeometryUtils.getEllipseByEnscribedRectangle(r)},o}(s.PolygonShapeDescription);h.OctagonShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.StarShapeDescription=h.StarConvexParameterName=void 0;var p=d(5),u=d(1),s=d(122),i=d(37),t=d(30),e=d(0),n=d(9);h.StarConvexParameterName="sc";var o=function(r){function a(){return r!==null&&r.apply(this,arguments)||this}return P(a,r),Object.defineProperty(a.prototype,"key",{get:function(){return u.ShapeTypes.Star},enumerable:!1,configurable:!0}),a.prototype.createShapePrimitives=function(c){var l=c.rectangle,y=l.x,g=l.y,f=l.right,v=l.width,C=l.height,b=this.getActualBottom(g,l.bottom,v,C),S=l.center.x,x=g+(b-g)/2,I=C/v,w=Math.PI-this.angle,_=v/2*Math.tan(w/2)*I,T=g+_,R=(C-_)/Math.tan(w)/I,E=y+R,D=f-R,L=c.parameters.get(h.StarConvexParameterName).value,H=this.getInnerPointDistance(S,S,f,x,g,T);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(S,g),new p.PathPrimitiveLineToCommand(this.getInnerPointPos(S,S,f,L,H),this.getInnerPointPos(x,g,T,L,H)),new p.PathPrimitiveLineToCommand(f,T),new p.PathPrimitiveLineToCommand(this.getInnerPointPos(S,f,D,L,H),this.getInnerPointPos(x,T,b,L,H)),new p.PathPrimitiveLineToCommand(D,b),new p.PathPrimitiveLineToCommand(this.getInnerPointPos(S,D,E,L,H),this.getInnerPointPos(x,b,b,L,H)),new p.PathPrimitiveLineToCommand(E,b),new p.PathPrimitiveLineToCommand(this.getInnerPointPos(S,E,y,L,H),this.getInnerPointPos(x,b,T,L,H)),new p.PathPrimitiveLineToCommand(y,T),new p.PathPrimitiveLineToCommand(this.getInnerPointPos(S,y,S,L,H),this.getInnerPointPos(x,T,g,L,H)),new p.PathPrimitiveClosePathCommand],c.style)]},a.prototype.createParameters=function(c){c.addRange([new i.ShapeParameter(h.StarConvexParameterName,300)])},a.prototype.normalizeParameters=function(c,l){var y=c.rectangle,g=y.y,f=y.right,v=y.width,C=y.height,b=this.getActualBottom(g,y.bottom,v,C),S=y.center.x,x=g+(b-g)/2,I=C/v,w=Math.PI-this.angle,_=g+v/2*Math.tan(w/2)*I,T=this.getInnerPointDistance(S,S,f,x,g,_);this.changeParameterValue(l,h.StarConvexParameterName,function(R){return Math.max(0,Math.min(T,R.value))})},a.prototype.modifyParameters=function(c,l,y,g){var f=Math.sqrt(Math.pow(y,2)+Math.pow(g,2));(y<0||g>0)&&(f=-f),this.changeParameterValue(l,h.StarConvexParameterName,function(v){return v.value+f}),this.normalizeParameters(c,l)},a.prototype.getParameterPoints=function(c){var l=c.rectangle,y=l.y,g=l.right,f=l.width,v=l.height,C=this.getActualBottom(y,l.bottom,f,v),b=l.center.x,S=y+(C-y)/2,x=v/f,I=Math.PI-this.angle,w=y+f/2*Math.tan(I/2)*x,_=c.parameters.get(h.StarConvexParameterName).value,T=this.getInnerPointDistance(b,b,g,S,y,w),R=this.getInnerPointPos(b,b,g,_,T),E=this.getInnerPointPos(S,y,w,_,T);return[new t.ShapeParameterPoint("c",new e.Point(R,E))]},a.prototype.processConnectionPoint=function(c,l){if(r.prototype.processConnectionPoint.call(this,c,l),c.getConnectionPointSide(l)===n.ConnectionPointSide.South){var y=c.rectangle,g=y.y,f=y.right,v=y.width,C=y.height,b=this.getActualBottom(g,y.bottom,v,C),S=y.center.x,x=g+(b-g)/2,I=C/v,w=Math.PI-this.angle,_=g+v/2*Math.tan(w/2)*I,T=c.parameters.get(h.StarConvexParameterName).value,R=this.getInnerPointDistance(S,S,f,x,g,_);l.y=this.getInnerPointPos(x,b,b,T,R)}},a.prototype.getInnerPointDistanceByAxis=function(c,l,y){return Math.min(l,y)+Math.abs(l-y)/2-c},a.prototype.getInnerPointPos=function(c,l,y,g,f){var v=Math.min(1,g/f);return c+this.getInnerPointDistanceByAxis(c,l,y)*v},a.prototype.getInnerPointDistance=function(c,l,y,g,f,v){var C=this.getInnerPointDistanceByAxis(c,l,y),b=this.getInnerPointDistanceByAxis(g,f,v);return Math.sqrt(Math.pow(C,2)+Math.pow(b,2))},a.prototype.getActualBottom=function(c,l,y,g){var f=c+r.prototype.calculateHeight.call(this,y)*g/y;return f<l?f:l},a.prototype.calculateHeight=function(c){return c},a}(s.PentagonShapeDescription);h.StarShapeDescription=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowDownShapeDescription=void 0;var p=d(5),u=d(30),s=d(0),i=d(92),t=d(1),e=d(9),n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return t.ShapeTypes.ArrowDown},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.height,b=c.center.x,S=(v-a.parameters.get(i.ArrowVerticalLineWidthParameterName).value)/2,x=C-a.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value,I=a.normalizeX(l+S),w=a.normalizeY(y+x),_=a.normalizeX(g-S);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(I,y),new p.PathPrimitiveLineToCommand(_,y),new p.PathPrimitiveLineToCommand(_,w),new p.PathPrimitiveLineToCommand(g,w),new p.PathPrimitiveLineToCommand(b,f),new p.PathPrimitiveLineToCommand(l,w),new p.PathPrimitiveLineToCommand(I,w),new p.PathPrimitiveClosePathCommand],a.style)]},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,i.ArrowVerticalTriangleHeightParameterName,function(g){return g.value-y}),this.changeParameterValue(c,i.ArrowVerticalLineWidthParameterName,function(g){return g.value-2*l}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new u.ShapeParameterPoint("c",new s.Point(a.normalizeX(a.position.x+(a.size.width-a.parameters.get(i.ArrowVerticalLineWidthParameterName).value)/2),a.normalizeY(a.position.y+a.size.height-a.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value)))]},r.prototype.processConnectionPoint=function(a,c){var l=a.parameters.get(i.ArrowVerticalTriangleHeightParameterName).value;if(c.y>a.position.y+a.size.height-l){var y=a.size.width/2/l,g=(c.y-(a.position.y+a.size.height-l))*y,f=a.getConnectionPointSide(c);f===e.ConnectionPointSide.East?c.x-=g:f===e.ConnectionPointSide.West&&(c.x+=g)}else o.prototype.processConnectionPoint.call(this,a,c)},r}(i.ArrowVerticalShapeDescription);h.ArrowDownShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowLeftRightShapeDescription=void 0;var p=d(5),u=d(93),s=d(30),i=d(0),t=d(1),e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return t.ShapeTypes.ArrowLeftRight},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.height,v=a.center.y,C=r.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value,b=(f-r.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2,S=r.normalizeX(c+C),x=r.normalizeY(l+b),I=r.normalizeX(y-C),w=r.normalizeY(g-b);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(c,v),new p.PathPrimitiveLineToCommand(S,l),new p.PathPrimitiveLineToCommand(S,x),new p.PathPrimitiveLineToCommand(I,x),new p.PathPrimitiveLineToCommand(I,l),new p.PathPrimitiveLineToCommand(y,v),new p.PathPrimitiveLineToCommand(I,g),new p.PathPrimitiveLineToCommand(I,w),new p.PathPrimitiveLineToCommand(S,w),new p.PathPrimitiveLineToCommand(S,g),new p.PathPrimitiveClosePathCommand],r.style)]},o.prototype.normalizeParameters=function(r,a){this.changeParameterValue(a,u.ArrowVerticalTriangleWidthParameterName,function(c){return Math.max(0,Math.min(r.size.width/2-2*r.strokeWidth,c.value))}),this.changeParameterValue(a,u.ArrowVerticalLineHeightParameterName,function(c){return Math.max(0,Math.min(r.size.height,c.value))})},o.prototype.modifyParameters=function(r,a,c,l){this.changeParameterValue(a,u.ArrowVerticalTriangleWidthParameterName,function(y){return y.value+c}),this.changeParameterValue(a,u.ArrowVerticalLineHeightParameterName,function(y){return y.value-2*l}),this.normalizeParameters(r,a)},o.prototype.getParameterPoints=function(r){return[new s.ShapeParameterPoint("c",new i.Point(r.normalizeX(r.position.x+r.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value),r.normalizeY(r.position.y+(r.size.height-r.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2)))]},o}(u.ArrowHorizontalShapeDescription);h.ArrowLeftRightShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.ArrowLeftShapeDescription=void 0;var p=d(5),u=d(93),s=d(30),i=d(0),t=d(1),e=d(9),n=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return t.ShapeTypes.ArrowLeft},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.height,C=c.center.y,b=a.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value,S=(v-a.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2,x=a.normalizeX(l+b),I=a.normalizeY(y+S),w=a.normalizeY(f-S);return[new p.PathPrimitive([new p.PathPrimitiveMoveToCommand(l,C),new p.PathPrimitiveLineToCommand(x,y),new p.PathPrimitiveLineToCommand(x,I),new p.PathPrimitiveLineToCommand(g,I),new p.PathPrimitiveLineToCommand(g,w),new p.PathPrimitiveLineToCommand(x,w),new p.PathPrimitiveLineToCommand(x,f),new p.PathPrimitiveClosePathCommand],a.style)]},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,u.ArrowVerticalTriangleWidthParameterName,function(g){return g.value+l}),this.changeParameterValue(c,u.ArrowVerticalLineHeightParameterName,function(g){return g.value-2*y}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new s.ShapeParameterPoint("c",new i.Point(a.normalizeX(a.position.x+a.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value),a.normalizeY(a.position.y+(a.size.height-a.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2)))]},r.prototype.processConnectionPoint=function(a,c){var l=a.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value;if(c.x<a.position.x+l){var y=a.size.height/2/l,g=(a.position.x+l-c.x)*y,f=a.getConnectionPointSide(c);f===e.ConnectionPointSide.North?c.y+=g:f===e.ConnectionPointSide.South&&(c.y-=g)}else o.prototype.processConnectionPoint.call(this,a,c)},r}(u.ArrowHorizontalShapeDescription);h.ArrowLeftShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.MultipleDocumentsShapeDescription=void 0;var p=d(1),u=d(5),s=d(125),i=d(56),t=d(17),e=d(7),n=d(2),o=function(r){function a(){return r!==null&&r.apply(this,arguments)||this}return P(a,r),Object.defineProperty(a.prototype,"key",{get:function(){return p.ShapeTypes.MultipleDocuments},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),a.prototype.createShapePrimitives=function(c,l){var y=c.rectangle,g=c.rectangle,f=g.width,v=g.height,C=l?a.documentsOffsetRatioForToolbox:a.documentsOffsetRatio,b=Math.ceil(f*C),S=Math.ceil(v*C),x=(y=y.clone().inflate(-b,-S).clone().moveRectangle(-b,-S)).clone().moveRectangle(b,S),I=x.clone().moveRectangle(b,S),w=t.RenderUtils.generateSvgElementId("clipRect");return[].concat(this.createDocumentPrimitives(y,c.style,w+"1",x)).concat(this.createDocumentPrimitives(x,c.style,w+"2",I)).concat(this.createDocumentPrimitives(I,c.style))},a.prototype.createDocumentPrimitives=function(c,l,y,g){var f=c.x,v=c.y,C=c.right,b=c.bottom,S=c.width,x=c.height,I=c.center.x,w=x*s.DocumentShapeDescription.curveOffsetRatio,_=[];return _=_.concat([new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(f,v),new u.PathPrimitiveLineToCommand(C,v),new u.PathPrimitiveLineToCommand(C,b),new u.PathPrimitiveQuadraticCurveToCommand(C-.25*S,b-2*w,I,b-w),new u.PathPrimitiveQuadraticCurveToCommand(f+.25*S,b+w,f,b-w),new u.PathPrimitiveClosePathCommand],l,void 0,g&&y)]),g&&y&&(_=_.concat([new i.ClipPathPrimitive(y,[new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(f-l.strokeWidth,v-l.strokeWidth),new u.PathPrimitiveLineToCommand(C+l.strokeWidth,v-l.strokeWidth),new u.PathPrimitiveLineToCommand(C+l.strokeWidth,g.y),new u.PathPrimitiveLineToCommand(g.x,g.y),new u.PathPrimitiveLineToCommand(g.x,b+l.strokeWidth),new u.PathPrimitiveLineToCommand(f-l.strokeWidth,b+l.strokeWidth),new u.PathPrimitiveClosePathCommand])])])),_},a.prototype.getTextRectangle=function(c){var l=c.rectangle,y=l.width*a.documentsOffsetRatio,g=l.height*a.documentsOffsetRatio;return(l=l.clone().inflate(-y,-g).clone().moveRectangle(-y,-g)).clone().moveRectangle(2*y+e.ShapeTextPadding,2*g+e.ShapeTextPadding).clone().resize(-2*e.ShapeTextPadding,-l.height*s.DocumentShapeDescription.curveOffsetRatio-2*e.ShapeTextPadding)},a.prototype.getSizeByText=function(c,l){return new n.Size((c.width+2*e.ShapeTextPadding)/(1-2*a.documentsOffsetRatio),(c.height+2*e.ShapeTextPadding)/((1-s.DocumentShapeDescription.curveOffsetRatio)*(1-a.documentsOffsetRatio))).nonNegativeSize()},a.documentsOffsetRatio=.1,a.documentsOffsetRatioForToolbox=.16,a}(s.DocumentShapeDescription);h.MultipleDocumentsShapeDescription=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.PreparationShapeDescription=void 0;var p=d(1),u=d(2),s=d(7),i=function(t){function e(){var n=t.call(this,!0)||this;return n.defaultSize=new u.Size(s.ShapeDefaultDimension,.75*s.ShapeDefaultDimension),n}return P(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return p.ShapeTypes.Preparation},enumerable:!1,configurable:!0}),e}(d(123).HexagonShapeDescription);h.PreparationShapeDescription=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.HardDiskShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(55),t=d(7),e=d(2),n=function(o){function r(){return o.call(this,void 0,!0)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.HardDisk},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.center.y,b=v*r.arcWidthRatio;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(g-b/2,y),new s.PathPrimitiveLineToCommand(l+b/2,y),new s.PathPrimitiveArcToCommand(b/2,(f-y)/2,0,!1,!1,l+b/2,f),new s.PathPrimitiveLineToCommand(g-b/2,f)],a.style),new i.EllipsePrimitive(g-b/2,C,b/2,(f-y)/2,a.style)]},r.prototype.getTextRectangle=function(a){var c=a.rectangle,l=c.width*r.arcWidthRatio*1.5;return c.clone().resize(-l-2*t.ShapeTextPadding,-2*t.ShapeTextPadding).moveRectangle(t.ShapeTextPadding,t.ShapeTextPadding).nonNegativeSize()},r.prototype.getSizeByText=function(a,c){return new e.Size((a.width+2*t.ShapeTextPadding)/(1-1.5*r.arcWidthRatio),c.size.height+t.ShapeTextPadding)},r.arcWidthRatio=.2,r}(p.RectangleShapeDescription);h.HardDiskShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.DatabaseShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(55),t=function(e){function n(){var o=e.call(this,void 0,!0)||this;return o.defaultSize.width=o.defaultSize.height,o}return P(n,e),Object.defineProperty(n.prototype,"key",{get:function(){return u.ShapeTypes.Database},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(o){var r=o.rectangle,a=r.x,c=r.y,l=r.right,y=r.bottom,g=r.height,f=r.center.x,v=g*n.arcWidthRatio;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(l,c+v/2),new s.PathPrimitiveLineToCommand(l,y-v/2),new s.PathPrimitiveArcToCommand((l-a)/2,v/2,0,!1,!0,a,y-v/2),new s.PathPrimitiveLineToCommand(a,c+v/2)],o.style),new i.EllipsePrimitive(f,c+v/2,(l-a)/2,v/2,o.style)]},n.prototype.getTextRectangle=function(o){var r=o.rectangle,a=r.height*n.arcWidthRatio;return r.clone().resize(0,-a).clone().moveRectangle(0,a)},n.arcWidthRatio=.2,n}(p.RectangleShapeDescription);h.DatabaseShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.InternalStorageShapeDescription=h.InternalStorageVerticalEdgeParameterName=h.InternalStorageHorizontalEdgeParameterName=void 0;var p=d(19),u=d(1),s=d(37),i=d(30),t=d(0),e=d(5);h.InternalStorageHorizontalEdgeParameterName="he",h.InternalStorageVerticalEdgeParameterName="ve";var n=function(o){function r(){return o.call(this,void 0,!0)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.InternalStorage},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=l+a.parameters.get(h.InternalStorageHorizontalEdgeParameterName).value,C=y+a.parameters.get(h.InternalStorageVerticalEdgeParameterName).value;return o.prototype.createShapePrimitives.call(this,a).concat([new e.PathPrimitive([new e.PathPrimitiveMoveToCommand(v,y),new e.PathPrimitiveLineToCommand(v,f),new e.PathPrimitiveMoveToCommand(l,C),new e.PathPrimitiveLineToCommand(g,C)],a.style)])},r.prototype.createParameters=function(a){a.addRange([new s.ShapeParameter(h.InternalStorageHorizontalEdgeParameterName,.1*this.defaultSize.width),new s.ShapeParameter(h.InternalStorageVerticalEdgeParameterName,.1*this.defaultSize.width)])},r.prototype.normalizeParameters=function(a,c){this.changeParameterValue(c,h.InternalStorageHorizontalEdgeParameterName,function(l){return Math.max(r.minEdge,Math.min(.3*a.size.width,l.value))}),this.changeParameterValue(c,h.InternalStorageVerticalEdgeParameterName,function(l){return Math.max(r.minEdge,Math.min(.3*a.size.height,l.value))})},r.prototype.modifyParameters=function(a,c,l,y){this.changeParameterValue(c,h.InternalStorageHorizontalEdgeParameterName,function(g){return g.value+l}),this.changeParameterValue(c,h.InternalStorageVerticalEdgeParameterName,function(g){return g.value+y}),this.normalizeParameters(a,c)},r.prototype.getParameterPoints=function(a){return[new i.ShapeParameterPoint("c",new t.Point(a.normalizeX(a.position.x+a.parameters.get(h.InternalStorageHorizontalEdgeParameterName).value),a.normalizeY(a.position.y+a.parameters.get(h.InternalStorageVerticalEdgeParameterName).value)))]},r.prototype.getTextRectangle=function(a){var c=a.rectangle,l=a.parameters.get(h.InternalStorageHorizontalEdgeParameterName).value;return c.clone().resize(-l,0).clone().moveRectangle(l,0)},r.minEdge=72,r}(p.RectangleShapeDescription);h.InternalStorageShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.PaperTapeShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(9),t=d(7),e=d(2),n=function(o){function r(){return o.call(this,void 0,!0)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.PaperTape},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){return this.createDocumentPrimitives(a.rectangle,a.style)},r.prototype.createDocumentPrimitives=function(a,c){var l=a.x,y=a.y,g=a.right,f=a.bottom,v=a.width,C=a.height,b=a.center.x,S=C*r.curveOffsetRatio;return[].concat([new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(l,y),new s.PathPrimitiveQuadraticCurveToCommand(l+.25*v,y+2*S,b,y+S),new s.PathPrimitiveQuadraticCurveToCommand(g-.25*v,y-S,g,y+S),new s.PathPrimitiveLineToCommand(g,f),new s.PathPrimitiveQuadraticCurveToCommand(g-.25*v,f-2*S,b,f-S),new s.PathPrimitiveQuadraticCurveToCommand(l+.25*v,f+S,l,f-S),new s.PathPrimitiveClosePathCommand],c)])},r.prototype.processConnectionPoint=function(a,c){var l=a.getConnectionPointSide(c);l===i.ConnectionPointSide.North&&(c.y+=a.size.height*r.curveOffsetRatio),l===i.ConnectionPointSide.South&&(c.y-=a.size.height*r.curveOffsetRatio)},r.prototype.getTextRectangle=function(a){var c=a.rectangle;return c.clone().inflate(t.ShapeTextPadding,-c.height*r.curveOffsetRatio)},r.prototype.getSizeByText=function(a,c){return new e.Size(a.width+2*t.ShapeTextPadding,a.height/(1-2*r.curveOffsetRatio))},r.curveOffsetRatio=.1,r}(p.RectangleShapeDescription);h.PaperTapeShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ManualOperationShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(9),t=d(7),e=function(n){function o(){return n.call(this,void 0,!0)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return u.ShapeTypes.ManualOperation},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=r.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.width,C=c.height,b=Math.min(Math.max(0,C/Math.tan(o.slopeAngle)),v),S=a.center.x,x=Math.min(l+b,S),I=Math.max(g-b,S);return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(l,y),new s.PathPrimitiveLineToCommand(g,y),new s.PathPrimitiveLineToCommand(I,f),new s.PathPrimitiveLineToCommand(x,f),new s.PathPrimitiveClosePathCommand],r.style)]},o.prototype.processConnectionPoint=function(r,a){var c=r.size.height/Math.tan(o.slopeAngle),l=r.getConnectionPointSide(a);l===i.ConnectionPointSide.East?a.x-=c/2:l===i.ConnectionPointSide.West&&(a.x+=c/2)},o.prototype.getTextRectangle=function(r){var a=Math.min(Math.max(0,r.size.height/Math.tan(o.slopeAngle)),r.size.width);return r.rectangle.clone().moveRectangle(a,t.ShapeTextPadding).resize(2*-a,2*-t.ShapeTextPadding).nonNegativeSize()},o.slopeAngle=81*Math.PI/180,o}(p.RectangleShapeDescription);h.ManualOperationShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.DelayShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(3),t=d(7),e=d(2),n=function(o){function r(){var a=o.call(this,void 0,!0)||this;return a.defaultSize.width=a.defaultSize.height,a}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.Delay},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom,v=c.center.x;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(l,y),new s.PathPrimitiveLineToCommand(v,y),new s.PathPrimitiveArcToCommand((g-l)/2,(f-y)/2,0,!1,!0,v,f),new s.PathPrimitiveLineToCommand(l,f),new s.PathPrimitiveClosePathCommand],a.style)]},r.prototype.getTextRectangle=function(a){var c=i.GeometryUtils.getMaxRectangleEnscribedInEllipse(a.size);return a.rectangle.clone().moveRectangle(t.ShapeTextPadding,t.ShapeTextPadding).setSize({width:c.width/2+a.size.width/2-t.ShapeTextPadding,height:c.height/2+a.size.height/2-t.ShapeTextPadding}).nonNegativeSize()},r.prototype.getSizeByText=function(a,c){var l=i.GeometryUtils.getEllipseByEnscribedRectangle(a);return new e.Size(l.width/2+a.width/2+t.ShapeTextPadding,l.height/2+a.height/2+t.ShapeTextPadding)},r.arcWidthRatio=.2,r}(p.RectangleShapeDescription);h.DelayShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.StoredDataShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(7),t=d(2),e=function(n){function o(){return n.call(this,void 0,!0)||this}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return u.ShapeTypes.StoredData},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.width*o.arcWidthRatio;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(y,l),new s.PathPrimitiveLineToCommand(c+f/2,l),new s.PathPrimitiveArcToCommand(f/2,(g-l)/2,0,!1,!1,c+f/2,g),new s.PathPrimitiveLineToCommand(y,g),new s.PathPrimitiveArcToCommand(f/2,(g-l)/2,0,!1,!0,y,l)],r.style)]},o.prototype.getTextRectangle=function(r){var a=r.rectangle,c=a.width*o.arcWidthRatio/2;return a.clone().resize(-c-2*i.ShapeTextPadding,-2*i.ShapeTextPadding).moveRectangle(i.ShapeTextPadding,i.ShapeTextPadding).nonNegativeSize()},o.prototype.getSizeByText=function(r,a){return new t.Size((r.width+2*i.ShapeTextPadding)/(1-o.arcWidthRatio/2),r.height+2*i.ShapeTextPadding)},o.arcWidthRatio=.2,o}(p.RectangleShapeDescription);h.StoredDataShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.MergeShapeDescription=void 0;var p=d(1),u=d(13),s=d(124),i=d(5),t=d(7),e=d(2),n=function(o){function r(){return o.call(this,!0)||this}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return p.ShapeTypes.Merge},enumerable:!1,configurable:!0}),r.prototype.createShapePrimitives=function(a){var c=a.rectangle,l=c.x,y=c.y,g=c.right,f=c.bottom;return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(l,y),new i.PathPrimitiveLineToCommand(g,y),new i.PathPrimitiveLineToCommand(c.center.x,f),new i.PathPrimitiveClosePathCommand],a.style)]},r.prototype.calculateHeight=function(a){return .75*a},r.prototype.getTextRectangle=function(a){return u.Rectangle.fromGeometry(a.position.clone().offset(a.size.width/4,t.ShapeTextPadding),new e.Size(a.size.width/2,a.size.height/2-t.ShapeTextPadding))},r.prototype.getSizeByText=function(a,c){return new e.Size(2*a.width,2*(a.height+t.ShapeTextPadding))},r}(s.TriangleShapeDescription);h.MergeShapeDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.DisplayShapeDescription=void 0;var p=d(19),u=d(1),s=d(5),i=d(7),t=function(e){function n(){return e.call(this,void 0,!0)||this}return P(n,e),Object.defineProperty(n.prototype,"key",{get:function(){return u.ShapeTypes.Display},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(o){var r=o.rectangle,a=r.x,c=r.y,l=r.right,y=r.bottom,g=r.width,f=r.center.y,v=g*n.arcWidthRatio;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(l-v/2,c),new s.PathPrimitiveLineToCommand(a+v/2,c),new s.PathPrimitiveLineToCommand(a,f),new s.PathPrimitiveLineToCommand(a+v/2,y),new s.PathPrimitiveLineToCommand(l-v/2,y),new s.PathPrimitiveArcToCommand(v/2,(y-c)/2,0,!1,!1,l-v/2,c)],o.style)]},n.prototype.getTextRectangle=function(o){var r=o.size.width*n.arcWidthRatio;return o.rectangle.clone().moveRectangle(r/2,i.ShapeTextPadding).resize(-r,2*-i.ShapeTextPadding).nonNegativeSize()},n.arcWidthRatio=.2,n}(p.RectangleShapeDescription);h.DisplayShapeDescription=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.OrShapeDescription=void 0;var p=d(1),u=d(2),s=d(7),i=d(72),t=d(5),e=function(n){function o(){var r=n.call(this,!0)||this;return r.defaultSize=new u.Size(.5*s.ShapeDefaultDimension,.5*s.ShapeDefaultDimension),r}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return p.ShapeTypes.Or},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"enableText",{get:function(){return!1},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.x,l=a.y,y=a.right,g=a.bottom,f=a.center,v=f.x,C=f.y;return[].concat(n.prototype.createShapePrimitives.call(this,r)).concat([new t.PathPrimitive([new t.PathPrimitiveMoveToCommand(v,l),new t.PathPrimitiveLineToCommand(v,g),new t.PathPrimitiveMoveToCommand(c,C),new t.PathPrimitiveLineToCommand(y,C)],r.style)])},o}(i.EllipseShapeDescription);h.OrShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.SummingJunctionShapeDescription=void 0;var p=d(1),u=d(2),s=d(7),i=d(72),t=d(5),e=function(n){function o(){var r=n.call(this,!0)||this;return r.defaultSize=new u.Size(.5*s.ShapeDefaultDimension,.5*s.ShapeDefaultDimension),r}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return p.ShapeTypes.SummingJunction},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"enableText",{get:function(){return!1},enumerable:!1,configurable:!0}),o.prototype.createShapePrimitives=function(r){var a=r.rectangle,c=a.width,l=a.height,y=a.center,g=y.x,f=y.y,v=c/2,C=l/2,b=Math.atan(C/v),S=1/Math.sqrt(1/Math.pow(v,2)+Math.pow(Math.tan(b),2)/Math.pow(C,2)),x=S*Math.tan(b);return[].concat(n.prototype.createShapePrimitives.call(this,r)).concat([new t.PathPrimitive([new t.PathPrimitiveMoveToCommand(g-S,f-x),new t.PathPrimitiveLineToCommand(g+S,f+x),new t.PathPrimitiveMoveToCommand(g-S,f+x),new t.PathPrimitiveLineToCommand(g+S,f-x)],r.style)])},o}(i.EllipseShapeDescription);h.SummingJunctionShapeDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.SvgElementPrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a,c,l,y){var g=s.call(this,null,l,void 0,y)||this;return g.x=t,g.y=e,g.width=n,g.height=o,g.createContent=r,g.destroyContent=a,g.data=c,g}return P(i,s),i.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"svg")},i.prototype.applyElementProperties=function(t,e){this.setUnitAttribute(t,"x",this.x),this.setUnitAttribute(t,"y",this.y),this.setUnitAttribute(t,"width",this.width),this.setUnitAttribute(t,"height",this.height),this.setPositionCorrectionAttribute(t),s.prototype.applyElementProperties.call(this,t,e)},i.prototype.createCustomContent=function(t){this.createContent&&this.createContent(t,this.data)},i.prototype.destroyCustomContent=function(t){this.destroyContent&&this.destroyContent(t)},i}(d(24).SvgPrimitive);h.SvgElementPrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.VerticalContainerDescription=void 0;var p=d(0),u=d(2),s=d(21),i=d(13),t=d(1),e=d(7),n=d(131),o=function(r){function a(){return r.call(this,new u.Size(2*e.ShapeDefaultDimension,1.5*e.ShapeDefaultDimension))||this}return P(a,r),Object.defineProperty(a.prototype,"key",{get:function(){return t.ShapeTypes.VerticalContainer},enumerable:!1,configurable:!0}),a.prototype.getExpandedSize=function(c){return new u.Size(c.size.width,c.expandedSize.height)},a.prototype.getCollapsedSize=function(c){return new u.Size(c.size.width,n.CONTAINER_HEADER_SIZE+2*c.strokeWidth)},a.prototype.allowResizeVertically=function(c){return c.expanded},a.prototype.createHeaderPrimitives=function(c,l){var y=c.rectangle,g=y.x,f=y.y,v=y.width,C=this.getHeaderSize(c,l),b=[];return b=b.concat([new s.RectanglePrimitive(g,f,v,C,c.style)]),l||(b=b.concat(this.createExpandButtonPrimitives(c,new i.Rectangle(g,f,C,C)))),b},a.prototype.getClientRectangle=function(c){var l=c.rectangle,y=this.getHeaderSize(c);return i.Rectangle.fromGeometry(new p.Point(l.x,l.y+y),new u.Size(l.width,l.height-y))},a.prototype.getTextRectangle=function(c){var l=c.rectangle,y=this.getHeaderSize(c);return i.Rectangle.fromGeometry(new p.Point(l.x+y,l.y),new u.Size(l.width-y,y))},a.prototype.getSizeByText=function(c,l){var y=this.getHeaderSize(l);return new u.Size(Math.max(l.size.width,c.width+y),l.size.height)},a.prototype.getHeaderSize=function(c,l){var y=c.rectangle;return l?y.height*n.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO:n.CONTAINER_HEADER_SIZE+2*c.strokeWidth},a}(n.ContainerDescription);h.VerticalContainerDescription=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(a,c){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var g in y)y.hasOwnProperty(g)&&(l[g]=y[g])})(a,c)},function(a,c){function l(){this.constructor=a}m(a,c),a.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)});Object.defineProperty(h,"__esModule",{value:!0}),h.HorizontalContainerDescription=void 0;var p=d(7),u=d(13),s=d(2),i=d(0),t=d(1),e=d(131),n=d(21),o=d(63),r=function(a){function c(){return a.call(this,new s.Size(2*p.ShapeDefaultDimension,1.5*p.ShapeDefaultDimension))||this}return P(c,a),Object.defineProperty(c.prototype,"key",{get:function(){return t.ShapeTypes.HorizontalContainer},enumerable:!1,configurable:!0}),c.prototype.getExpandedSize=function(l){return new s.Size(l.expandedSize.width,l.size.height)},c.prototype.getCollapsedSize=function(l){return new s.Size(e.CONTAINER_HEADER_SIZE+2*l.strokeWidth,l.size.height)},c.prototype.allowResizeHorizontally=function(l){return l.expanded},c.prototype.createHeaderPrimitives=function(l,y){var g=l.rectangle,f=g.x,v=g.y,C=g.height,b=this.getHeaderSize(l,y),S=[];return S=S.concat([new n.RectanglePrimitive(f,v,b,C,l.style)]),y||(S=S.concat(this.createExpandButtonPrimitives(l,new u.Rectangle(f,v,b,b)))),S},c.prototype.getClientRectangle=function(l){var y=l.rectangle,g=this.getHeaderSize(l);return u.Rectangle.fromGeometry(new i.Point(y.x+g,y.y),new s.Size(y.width-g,y.height))},c.prototype.getTextRectangle=function(l){var y=l.rectangle,g=this.getHeaderSize(l);return u.Rectangle.fromGeometry(new i.Point(y.x,y.y+g),new s.Size(g,y.height-g)).nonNegativeSize()},c.prototype.getSizeByText=function(l,y){var g=this.getHeaderSize(y);return new s.Size(y.size.width,Math.max(y.size.height,Math.max(l.width+g,y.size.height)))},c.prototype.getTextEditRectangle=function(l){var y=this.getTextRectangle(l);return u.Rectangle.fromGeometry(new i.Point(y.x,y.y+y.height),new s.Size(y.height,y.width))},c.prototype.getTextAngle=function(){return o.TextAngle.Angle270deg},c.prototype.getHeaderSize=function(l,y){var g=l.rectangle;return y?g.height*e.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO:e.CONTAINER_HEADER_SIZE+2*l.strokeWidth},c}(e.ContainerDescription);h.HorizontalContainerDescription=r},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.CardWithImageOnTopDescription=void 0;var p=d(7),u=d(2),s=d(1),i=d(132),t=d(12),e=function(n){function o(){var r=n.call(this,new u.Size(.8*p.ShapeDefaultDimension,p.ShapeDefaultDimension))||this;return r.isTextAfterImage=!0,r.isHorizontal=!1,r}return P(o,n),Object.defineProperty(o.prototype,"key",{get:function(){return s.ShapeTypes.CardWithImageOnTop},enumerable:!1,configurable:!0}),o.prototype.getImageSize=function(r,a,c){var l=r.width/2;t.UnitConverter.twipsToPixels(l)%2==1&&(l-=t.UnitConverter.pixelsToTwips(1));var y=Math.max(0,r.height-(a?0:2*this.getImageMargin(c)));return y=Math.min(l,y),new u.Size(y,y)},o.prototype.getImageSizeByTextBlockSize=function(r){return this.getImageSize(new u.Size(r.width,Number.MAX_VALUE),!0)},o}(i.CardBaseDescription);h.CardWithImageOnTopDescription=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.RoundedRectanglePrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a,c,l,y,g){r===void 0&&(r=0),a===void 0&&(a=0);var f=s.call(this,t,e,n,o,c,l,y,g)||this;return f.x=t,f.y=e,f.width=n,f.height=o,f.rx=r,f.ry=a,f}return P(i,s),i.prototype.createMainElement=function(){return document.createElementNS(p.svgNS,"rect")},i.prototype.applyElementProperties=function(t,e){this.setUnitAttribute(t,"rx",this.rx),this.setUnitAttribute(t,"ry",this.ry),s.prototype.applyElementProperties.call(this,t,e)},i}(d(21).RectanglePrimitive);h.RoundedRectanglePrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorShapeDescription=void 0;var p=d(1),u=d(2),s=d(7),i=function(t){function e(){var n=t.call(this,!1)||this;return n.defaultSize=new u.Size(.5*s.ShapeDefaultDimension,.5*s.ShapeDefaultDimension),n}return P(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return p.ShapeTypes.Connector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),e}(d(72).EllipseShapeDescription);h.ConnectorShapeDescription=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.CardWithImageOnRightDescription=h.CardWithImageOnLeftDescription=void 0;var p=d(7),u=d(1),s=d(132),i=d(2),t=function(o){function r(){var a=o.call(this,new i.Size(1.5*p.ShapeDefaultDimension,.5*p.ShapeDefaultDimension))||this;return a.isHorizontal=!0,a}return P(r,o),r.prototype.getToolboxHeightToWidthRatio=function(a,c){return 26/46},r.prototype.getImageSize=function(a,c,l){var y=Math.min(a.height,a.width);return c||(y=Math.max(0,y-2*this.getImageMargin(l))),new i.Size(y,y)},r.prototype.getImageSizeByTextBlockSize=function(a){return this.getImageSize(new i.Size(Number.MAX_VALUE,a.height),!0)},r}(s.CardBaseDescription),e=function(o){function r(){var a=o!==null&&o.apply(this,arguments)||this;return a.isTextAfterImage=!0,a}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.CardWithImageOnLeft},enumerable:!1,configurable:!0}),r}(t);h.CardWithImageOnLeftDescription=e;var n=function(o){function r(){var a=o!==null&&o.apply(this,arguments)||this;return a.isTextAfterImage=!1,a}return P(r,o),Object.defineProperty(r.prototype,"key",{get:function(){return u.ShapeTypes.CardWithImageOnRight},enumerable:!1,configurable:!0}),r}(t);h.CardWithImageOnRightDescription=n},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportCommand=void 0;var p=d(73),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.executeCore=function(t,e){return e(new p.Exporter().export(this.control.model)),!0},i}(d(57).ExportImportCommandBase);h.ExportCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleFontBoldCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"font-weight"},s.prototype.getStylePropertyValue=function(){return"bold"},s}(d(74).ToggleStyleTextPropertyCommand);h.ToggleFontBoldCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleFontItalicCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"font-style"},s.prototype.getStylePropertyValue=function(){return"italic"},s}(d(74).ToggleStyleTextPropertyCommand);h.ToggleFontItalicCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleFontUnderlineCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"text-decoration"},s.prototype.getStylePropertyValue=function(){return"underline"},s}(d(74).ToggleStyleTextPropertyCommand);h.ToggleFontUnderlineCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeFontNameCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"font-family"},s}(d(96).ChangeStyleTextPropertyCommand);h.ChangeFontNameCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeFontSizeCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"font-size"},s}(d(96).ChangeStyleTextPropertyCommand);h.ChangeFontSizeCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeFontColorCommand=void 0;var p=d(96),u=d(22),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.processParameter=function(e){return u.ColorUtils.stringToHash(e)},t.prototype.getStyleProperty=function(){return"fill"},t}(p.ChangeStyleTextPropertyCommand);h.ChangeFontColorCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeFillColorCommand=void 0;var p=d(75),u=d(22),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.processParameter=function(e){return u.ColorUtils.stringToHash(e)},t.prototype.getStyleProperty=function(){return"fill"},t}(p.ChangeStylePropertyCommand);h.ChangeFillColorCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStrokeColorCommand=void 0;var p=d(75),u=d(22),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.processParameter=function(e){return u.ColorUtils.stringToHash(e)},t.prototype.getStyleProperty=function(){return"stroke"},t}(p.ChangeStylePropertyCommand);h.ChangeStrokeColorCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.TextRightAlignCommand=h.TextCenterAlignCommand=h.TextLeftAlignCommand=h.ChangeTextAlignCommand=void 0;var p=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getStyleProperty=function(){return"text-anchor"},e}(d(74).ToggleStyleTextPropertyCommand);h.ChangeTextAlignCommand=p;var u=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getStylePropertyValue=function(){return"start"},e}(p);h.TextLeftAlignCommand=u;var s=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getStylePropertyValue=function(){return"middle"},e}(p);h.TextCenterAlignCommand=s;var i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getStylePropertyValue=function(){return"end"},e}(p);h.TextRightAlignCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorEndLineEndingCommand=h.ChangeConnectorStartLineEndingCommand=void 0;var p=d(136),u=d(32),s=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getPropertyName=function(){return"startLineEnding"},e.prototype.getPropertyDefaultValue=function(){return u.ConnectorLineEnding.None},e}(p.ChangeConnectorPropertyCommand);h.ChangeConnectorStartLineEndingCommand=s;var i=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return P(e,t),e.prototype.getPropertyName=function(){return"endLineEnding"},e.prototype.getPropertyDefaultValue=function(){return u.ConnectorLineEnding.Arrow},e}(p.ChangeConnectorPropertyCommand);h.ChangeConnectorEndLineEndingCommand=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorLineOptionCommand=void 0;var p=d(136),u=d(32),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.getPropertyName=function(){return"lineOption"},t.prototype.getPropertyDefaultValue=function(){return u.ConnectorLineOption.Straight},t}(p.ChangeConnectorPropertyCommand);h.ChangeConnectorLineOptionCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.SelectAllCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabledInReadOnlyMode=function(){return!0},s.prototype.executeCore=function(i,t){var e=[];return this.control.model.iterateItems(function(n){return e.push(n.key)}),this.control.selection.set(e),!0},s}(d(10).SimpleCommandBase);h.SelectAllCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ScrollIntoViewOnUndoHistoryItem=h.ScrollIntoViewOnRedoHistoryItem=void 0;var p=d(8),u=function(i){function t(e,n){var o=i.call(this)||this;return o.view=e,o.rectangle=n,o.view=e,o.rectangle=n.clone(),o}return P(t,i),t.prototype.redo=function(e){this.view.scrollIntoView(this.rectangle)},t.prototype.undo=function(e){},t}(p.HistoryItem);h.ScrollIntoViewOnRedoHistoryItem=u;var s=function(i){function t(e,n){var o=i.call(this)||this;return o.view=e,o.rectangle=n,o.view=e,o.rectangle=n.clone(),o}return P(t,i),t.prototype.redo=function(e){},t.prototype.undo=function(e){this.view.scrollIntoView(this.rectangle)},t}(p.HistoryItem);h.ScrollIntoViewOnUndoHistoryItem=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Tree=void 0;var m=d(38),P=function(){function p(u,s){var i=this;this.childToParent={},this.root=u,this.parentToChildren=s;var t=function(n){if(!Object.prototype.hasOwnProperty.call(s,n))return"continue";s[n].forEach(function(o){return i.childToParent[o.key]=n})};for(var e in s)t(e)}return p.prototype.getChildren=function(u){return u&&this.parentToChildren[u.key]?this.parentToChildren[u.key]:[]},p.prototype.hasChildren=function(u){return this.parentToChildren[u.key]&&this.parentToChildren[u.key].length>0},p.prototype.iterate=function(u){this.iterateCore(this.root,0,u)},p.createSpanningTree=function(u){var s=p.findRoot(u),i=u.createIterator(m.ConnectionMode.Outgoing),t={};return i.skipEdge=function(e){return e.to===void 0||i.isNodeVisited(e.to)},i.onNode=function(e){return t[e.key]=[]},i.onEdge=function(e){var n=u.getNode(e.to);n&&t[e.from].push(n)},i.iterate(s),new p(u.getNode(s),t)},p.prototype.iterateCore=function(u,s,i){var t=this;i(u,s),this.getChildren(u).forEach(function(e){return t.iterateCore(e,s+1,i)})},p.findRoot=function(u){return u.nodes.reduce(function(s,i){var t=u.getAdjacentEdges(i),e=t.filter(function(o){return o.to===i}).length,n=t.filter(function(o){return o.from===i}).length;return(s.candidate===void 0||e===0&&s.inc>0||s.inc!==0&&s.out-s.inc<n-e)&&(s.candidate=i,s.inc=e,s.out=n),s},{inc:-1,out:-1,candidate:void 0}).candidate},p}();h.Tree=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeSnapToGridCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.executeCore=function(i,t){var e=t===void 0?!this.control.settings.snapToGrid:!!t;return this.control.settings.snapToGrid!==e&&(this.control.settings.snapToGrid=e,!0)},s.prototype.getValue=function(){return this.control.settings.snapToGrid},s}(d(10).SimpleCommandBase);h.ChangeSnapToGridCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeGridSizeItemsCommand=h.ChangeGridSizeCommand=void 0;var p=d(10),u=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.getModelUnit(this.control.settings.gridSize)},t.prototype.executeCore=function(e,n){return this.control.settings.gridSize=this.getModelUnitTwipsValue(n),!0},t.prototype.getItems=function(){var e=this;return this.control.settings.gridSizeItems.map(function(n){return{value:e.getModelUnit(n),text:e.getViewUnitText(n)}})},t}(p.SimpleCommandBase);h.ChangeGridSizeCommand=u;var s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){var e=this;return this.control.settings.gridSizeItems.map(function(n){return e.getModelUnit(n)})},t.prototype.executeCore=function(e,n){var o=this;return this.control.settings.gridSizeItems=n.map(function(r){return o.getModelUnitTwipsValue(r)}),!0},t}(p.SimpleCommandBase);h.ChangeGridSizeItemsCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePageLandscapeCommand=void 0;var p=d(77),u=d(256),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.getValue=function(){return this.control.model.pageLandscape},t.prototype.createHistoryItems=function(e){return[new u.ChangePageLandscapeHistoryItem(e)]},t}(p.ChangePagePropertyCommand);h.ChangePageLandscapeCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePageLandscapeHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.value=i,t}return P(s,u),s.prototype.redo=function(i){this.oldValue=i.model.pageLandscape,i.changePageLandscape(this.value)},s.prototype.undo=function(i){i.changePageLandscape(this.oldValue)},s}(d(8).HistoryItem);h.ChangePageLandscapeHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePageSizeItemsCommand=h.ChangePageSizeCommand=void 0;var p=d(77),u=d(2),s=d(258),i=d(10),t=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.getValue=function(){return this.getModelUnitSize(this.control.model.pageSize)},o.prototype.createHistoryItems=function(r){return[new s.ChangePageSizeHistoryItem(new u.Size(this.getModelUnitTwipsValue(r.width),this.getModelUnitTwipsValue(r.height)))]},o.prototype.getItems=function(){var r=this;return this.control.settings.pageSizeItems.map(function(a){return{value:r.getModelUnitSize(a.size),text:a.text.replace("{width}",r.getViewUnitText(a.size.width)).replace("{height}",r.getViewUnitText(a.size.height))}})},o.prototype.getModelUnitSize=function(r){return new u.Size(this.getModelUnit(r.width),this.getModelUnit(r.height))},o}(p.ChangePagePropertyCommand);h.ChangePageSizeCommand=t;var e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.isEnabled=function(){return!0},o.prototype.getValue=function(){var r=this;return this.control.settings.pageSizeItems.map(function(a){return{size:new u.Size(r.getModelUnit(a.width),r.getModelUnit(a.height)),text:a.text}})},o.prototype.executeCore=function(r,a){var c=this;return this.control.settings.pageSizeItems=a.map(function(l){return{size:new u.Size(c.getModelUnitTwipsValue(l.width),c.getModelUnitTwipsValue(l.height)),text:l.text}}),!0},o}(i.SimpleCommandBase);h.ChangePageSizeItemsCommand=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePageSizeHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.size=i,t}return P(s,u),s.prototype.redo=function(i){this.oldSize=i.model.pageSize,i.changePageSize(this.size)},s.prototype.undo=function(i){i.changePageSize(this.oldSize)},s}(d(8).HistoryItem);h.ChangePageSizeHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportPngCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getExtension=function(){return"png"},s.prototype.getExportFunc=function(){return this.exporter.exportPng},s}(d(98).ExportImageCommand);h.ExportPngCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(c,l){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var f in g)g.hasOwnProperty(f)&&(y[f]=g[f])})(c,l)},function(c,l){function y(){this.constructor=c}m(c,l),c.prototype=l===null?Object.create(l):(y.prototype=l.prototype,new y)}),p=this&&this.__awaiter||function(c,l,y,g){return new(y||(y=Promise))(function(f,v){function C(x){try{S(g.next(x))}catch(I){v(I)}}function b(x){try{S(g.throw(x))}catch(I){v(I)}}function S(x){var I;x.done?f(x.value):(I=x.value,I instanceof y?I:new y(function(w){w(I)})).then(C,b)}S((g=g.apply(c,l||[])).next())})},u=this&&this.__generator||function(c,l){var y,g,f,v,C={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return v={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function b(S){return function(x){return function(I){if(y)throw new TypeError("Generator is already executing.");for(;C;)try{if(y=1,g&&(f=2&I[0]?g.return:I[0]?g.throw||((f=g.return)&&f.call(g),0):g.next)&&!(f=f.call(g,I[1])).done)return f;switch(g=0,f&&(I=[2&I[0],f.value]),I[0]){case 0:case 1:f=I;break;case 4:return C.label++,{value:I[1],done:!1};case 5:C.label++,g=I[1],I=[0];continue;case 7:I=C.ops.pop(),C.trys.pop();continue;default:if(!(f=(f=C.trys).length>0&&f[f.length-1])&&(I[0]===6||I[0]===2)){C=0;continue}if(I[0]===3&&(!f||I[1]>f[0]&&I[1]<f[3])){C.label=I[1];break}if(I[0]===6&&C.label<f[1]){C.label=f[1],f=I;break}if(f&&C.label<f[2]){C.label=f[2],C.ops.push(I);break}f[2]&&C.ops.pop(),C.trys.pop();continue}I=l.call(c,C)}catch(w){I=[6,w],g=0}finally{y=f=0}if(5&I[0])throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}([S,x])}}};Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasExportManager=void 0;var s=d(12),i=d(18),t=d(17),e=d(42),n=d(15),o=d(100),r=d(22),a=function(c){function l(y,g){var f=c.call(this,1,new o.ExportDOMManipulator(g))||this;return f.itemsContainer=y,f}return P(l,c),l.prototype.getSvgImage=function(y,g,f,v){var C=n.RenderHelper.createSvgElement(void 0,!0),b=y.clone().applyConverter(s.UnitConverter.twipsToPixelsF).clone().applyConverter(Math.ceil);t.RenderUtils.updateSvgElementSize(C,b.width,b.height,!0),C.style.backgroundColor=r.ColorUtils.colorToHash(g),this.createTextFloodFilter(void 0,C,g);var S=!f&&!i.Browser.IE&&this.getExportCssRules();if(S){var x=document.createElementNS(n.svgNS,"style");x.innerHTML=S,C.appendChild(x)}if(v){var I=document.createElementNS(n.svgNS,"rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"height",b.height.toString()),I.setAttributeNS(null,"width",b.width.toString()),I.setAttributeNS(null,"fill",C.style.backgroundColor),C.appendChild(I)}for(var w=0;w<this.itemsContainer.childNodes.length;w++){var _=this.itemsContainer.childNodes[w].cloneNode(!0);S||this.inlineStyle(_,this.itemsContainer.childNodes[w]),C.appendChild(_)}return C},l.prototype.getSvgImageUrl=function(y,g,f){var v=this.getSvgImage(y,g,f,!1);return this.getSvgBase64String(v)},l.prototype.getSvgString=function(y){return new XMLSerializer().serializeToString(y)},l.prototype.getSvgBase64String=function(y){var g=this.getSvgString(y);return l.base64Start+this.getBase64EncodeUnicode(g)},l.prototype.getBase64EncodeUnicode=function(y){return btoa(encodeURIComponent(y).replace(/%([0-9A-F]{2})/g,function(g,f){return String.fromCharCode(parseInt("0x"+f,16))}))},l.prototype.getExportCssRules=function(){for(var y=0;y<document.styleSheets.length;y++){var g=this.getRules(document.styleSheets[y]);if(g){for(var f="",v=0;v<g.length;v++){var C=g[v],b=this.isCSSStyleRule(C)?C.selectorText:null;b&&this.checkSelector(b)&&(f+=C.cssText+`
`)}if(f.length>0)return`
`+f}}},l.prototype.checkSelector=function(y){for(var g=0;g<l.exportStyleRules.length;g++)if(y.indexOf(l.exportStyleRules[g])===0)return!0;return!1},l.prototype.getRules=function(y){try{return this.isCSSStyleSheet(y)?y.rules||y.cssRules:null}catch{}},l.prototype.isCSSStyleSheet=function(y){return y.rules!==void 0},l.prototype.isCSSStyleRule=function(y){return y.selectorText!==void 0},l.prototype.inlineStyle=function(y,g){for(var f=0;f<y.childNodes.length;f++){var v=y.childNodes[f];if(v.tagName){if(v.tagName==="g")this.inlineStyle(v,g.childNodes[f]);else if(v.style){var C=window.getComputedStyle(g.childNodes[f]);if(C!==void 0)for(var b=0;b<l.exportStyleAttributes.length;b++){var S=l.exportStyleAttributes[b];v.style.setProperty(S,C.getPropertyValue(S))}this.inlineStyle(v,g.childNodes[f])}}}},l.prototype.exportSvgImage=function(y,g,f){f(this.getSvgImageUrl(y,g,!0))},l.prototype.exportBinaryImage=function(y,g,f,v,C){var b=this.getAbsoluteSize(y).clone().applyConverter(Math.ceil),S=document.createElement("canvas");S.width=b.width,S.height=b.height;var x=S.getContext("2d");if(x.fillStyle=r.ColorUtils.colorToHash(g),x.fillRect(0,0,b.width,b.height),(C||i.Browser.IE)&&typeof canvg=="object")this.exportBinaryImageCanvgAsync(y,g,S,x,f).then(function(w){return v(w)});else if(i.Browser.IE&&typeof canvg=="function")this.exportBinaryImageCanvgOld(y,g,S,x,f,v);else{var I=new Image;I.width=b.width,I.height=b.height,I.setAttribute("crossOrigin","anonymous"),I.onload=function(){x.drawImage(I,0,0),v(S.toDataURL(f,1))},I.src=this.getSvgImageUrl(y,g,!0)}},l.prototype.exportBinaryImageCanvgOld=function(y,g,f,v,C,b){var S=this.getSvgImage(y,g,!0,!1),x=this.getSvgString(S);v.drawSvg(x,0,0,null,null,{renderCallback:function(){b(f.toDataURL(C,1))}})},l.prototype.exportBinaryImageCanvgAsync=function(y,g,f,v,C){return p(this,void 0,void 0,function(){var b,S;return u(this,function(x){switch(x.label){case 0:return b=this.getSvgImage(y,g,!0,!0),S=this.getSvgString(b),[4,canvg.Canvg.fromString(v,S).render()];case 1:return x.sent(),[2,f.toDataURL(C,1)]}})})},l.prototype.exportPngImage=function(y,g,f,v){this.exportBinaryImage(y,g,"image/png",f,v)},l.prototype.exportJpgImage=function(y,g,f,v){this.exportBinaryImage(y,g,"image/jpeg",f,v)},l.prototype.notifyModelChanged=function(y){},l.prototype.notifyPageColorChanged=function(y){},l.prototype.notifyPageSizeChanged=function(y,g){},l.base64Start="data:image/svg+xml;base64,",l.exportStyleRules=[".dxdi-canvas .shape ",".dxdi-canvas .connector ",".dxdi-canvas text",".dxdi-canvas.export"],l.exportStyleAttributes=["fill","stroke","stroke-width","stroke-linejoin","font-family","font-size","font-weight","font-style","text-decoration","text-anchor"],l}(e.CanvasManagerBase);h.CanvasExportManager=a},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportSvgCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getExtension=function(){return"svg"},s.prototype.getExportFunc=function(){return this.exporter.exportSvg},s}(d(98).ExportImageCommand);h.ExportSvgCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ExportJpgCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getExtension=function(){return"jpg"},s.prototype.getExportFunc=function(){return this.exporter.exportJpg},s}(d(98).ExportImageCommand);h.ExportJpgCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.CopySelectionCommand=void 0;var p=d(73),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabled=function(){return s.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty(!0)},i.prototype.isEnabledInReadOnlyMode=function(){return!0},i.prototype.executeCore=function(t){var e=new p.Exporter().exportItems(this.control.selection.getSelectedItems(!0,!0));return this.setClipboardData(e),!0},i}(d(101).ClipboardCommand);h.CopySelectionCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.CutSelectionCommand=void 0;var p=d(73),u=d(4),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.isEnabled=function(){var e=this.control.selection.getSelectedItems();return i.prototype.isEnabled.call(this)&&e.length&&(e.length>1||this.permissionsProvider.canDeleteItems(e))},t.prototype.executeCore=function(e){var n=new p.Exporter,o=this.control.selection.getSelectedItems(!0,!0),r=n.exportItems(o);return this.permissionsProvider.beginDeleteItems(o),this.setClipboardData(r),u.ModelUtils.deleteSelection(this.control.history,this.control.model,this.control.selection),this.permissionsProvider.endDeleteItems(),!0},Object.defineProperty(t.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(d(101).ClipboardCommand);h.CutSelectionCommand=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.PasteSelectionCommand=void 0;var p=d(0),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.getEventPositionOffset=function(t,e){return new p.Point(0,0)},i}(d(141).PasteSelectionCommandBase);h.PasteSelectionCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ImportShapeHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.shape=i,t}return P(s,u),s.prototype.redo=function(i){this.shapeKey=this.shape.key,i.insertShape(this.shape)},s.prototype.undo=function(i){i.removeShape(i.model.findShape(this.shapeKey),!0)},s}(d(8).HistoryItem);h.ImportShapeHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ImportConnectorHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.connector=i,t}return P(s,u),s.prototype.redo=function(i){this.connectorKey=this.connector.key,i.insertConnector(this.connector)},s.prototype.undo=function(i){var t=i.model.findConnector(this.connectorKey);i.removeConnector(t)},s}(d(8).HistoryItem);h.ImportConnectorHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(c,l){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var f in g)g.hasOwnProperty(f)&&(y[f]=g[f])})(c,l)},function(c,l){function y(){this.constructor=c}m(c,l),c.prototype=l===null?Object.create(l):(y.prototype=l.prototype,new y)});Object.defineProperty(h,"__esModule",{value:!0}),h.ImportBPMNCommand=void 0;var p=d(269),u=d(4),s=d(53),i=d(0),t=d(6),e=d(66),n=d(48),o=d(80),r=d(20),a=function(c){function l(){return c!==null&&c.apply(this,arguments)||this}return P(l,c),l.prototype.executeCore=function(y,g){var f=new p.BPMNImporter(g).import();return this.updateModel(f),!0},l.prototype.updateModel=function(y){var g=this,f={},v=[],C=[];this.control.history.beginTransaction(),y.items.forEach(function(S){var x=new s.AddShapeHistoryItem(g.getShapeDescription(S.type),new i.Point(0,0),S.text,S.key);g.control.history.addAndRedo(x),f[S.key]=x.shapeKey;var I=g.control.model.findShape(x.shapeKey);v.push(I)}),y.edges.forEach(function(S){var x=g.control.model.findShape(f[S.from]),I=g.control.model.findShape(f[S.to]),w=new e.AddConnectorHistoryItem([x.getConnectionPointPosition(0),I.getConnectionPointPosition(0)]);g.control.history.addAndRedo(w);var _=g.control.model.findConnector(w.connectorKey);g.control.history.addAndRedo(new n.AddConnectionHistoryItem(_,x,0,t.ConnectorPosition.Begin)),g.control.history.addAndRedo(new n.AddConnectionHistoryItem(_,I,0,t.ConnectorPosition.End)),C.push(_)});var b=new r.LayoutSettings;u.ModelUtils.getGraphInfoByItems(this.control.model,v,C).forEach(function(S){var x=new o.SugiyamaLayoutBuilder(b,S.graph).build(),I=u.ModelUtils.getNonGraphItems(g.control.model,S.container,x.nodeToLayout,v,C);u.ModelUtils.applyLayout(g.control.history,g.control.model,void 0,S.graph,x,I,b,g.control.settings.snapToGrid,g.control.settings.gridSize,!1)}),u.ModelUtils.tryUpdateModelRectangle(this.control.history),this.control.history.endTransaction()},l.prototype.getShapeDescription=function(y){return this.control.shapeDescriptionManager.get(y)},l}(d(57).ExportImportCommandBase);h.ImportBPMNCommand=a},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(o,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)c.hasOwnProperty(l)&&(a[l]=c[l])})(o,r)},function(o,r){function a(){this.constructor=o}m(o,r),o.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)});Object.defineProperty(h,"__esModule",{value:!0}),h.BPMNNode=h.BPMNImporter=void 0;var p=d(54),u=d(1),s=d(38),i=d(95),t=function(){function o(r){this.doc=i.ImportUtils.createDocument(r),this.graph=new p.Graph([],[])}return o.prototype.import=function(){for(var r=void 0,a=0;r=this.doc.children[a];a++)r.nodeName.toUpperCase()==="DEFINITIONS"&&this.onDefinitionsElement(r);return this.validate(),this.graph},o.prototype.validate=function(){var r={};this.graph.nodes.forEach(function(l){return r[l]=!0});for(var a=0,c=void 0;c=this.graph.edges[a];a++)r[c.from]&&r[c.to]||(this.graph.edges.splice(a,1),a--)},o.prototype.onDefinitionsElement=function(r){this.dataSourceKey=r.getAttribute("id");for(var a=void 0,c=0;a=r.children[c];c++)a.nodeName.toUpperCase()==="PROCESS"&&this.onProcessElement(a)},o.prototype.onProcessElement=function(r){for(var a=void 0,c=0;a=r.children[c];c++)switch(a.nodeName.toUpperCase()){case"STARTEVENT":this.onStartEventElement(a);break;case"SEQUENCEFLOW":this.onSequenceFlowElement(a);break;case"SCRIPTTASK":this.onScriptTaskElement(a);break;case"USERTASK":this.onUserTaskElement(a);break;case"SERVICETASK":this.onServiceTaskElement(a);break;case"SENDTASK":this.onSendTaskElement(a);break;case"EXCLUSIVEGATEWAY":this.onExclusiveGateway(a);break;case"ENDEVENT":this.onEndEventGateway(a)}},o.prototype.onStartEventElement=function(r){var a=this.createNode(r);a.type=u.ShapeTypes.Ellipse,a.text=r.getAttribute("name"),this.graph.addNode(a)},o.prototype.onSequenceFlowElement=function(r){var a=r.getAttribute("sourceRef"),c=r.getAttribute("targetRef"),l=this.createEdge(r,a,c);r.hasAttribute("name")&&(l.text=r.getAttribute("name")),this.graph.addEdge(l)},o.prototype.onScriptTaskElement=function(r){var a=this.createNode(r);a.text=r.getAttribute("name"),this.graph.addNode(a)},o.prototype.onUserTaskElement=function(r){var a=this.createNode(r);a.text=r.getAttribute("name"),this.graph.addNode(a)},o.prototype.onServiceTaskElement=function(r){var a=this.createNode(r);a.text=r.getAttribute("name"),this.graph.addNode(a)},o.prototype.onSendTaskElement=function(r){var a=this.createNode(r);a.text=r.getAttribute("name"),this.graph.addNode(a)},o.prototype.onExclusiveGateway=function(r){var a=this.createNode(r);a.text=r.getAttribute("name"),a.type=u.ShapeTypes.Decision,this.graph.addNode(a)},o.prototype.onEndEventGateway=function(r){var a=this.createNode(r);a.text=r.getAttribute("name"),a.type=u.ShapeTypes.Ellipse,this.graph.addNode(a)},o.prototype.createNode=function(r){return new e(this.dataSourceKey,r.getAttribute("id"))},o.prototype.createEdge=function(r,a,c){return new n(this.dataSourceKey,r.getAttribute("id"),a,c)},o}();h.BPMNImporter=t;var e=function(){return function(o,r){this.sourceKey=o,this.key=r,this.type=u.ShapeTypes.Rectangle}}();h.BPMNNode=e;var n=function(o){function r(a,c,l,y){var g=o.call(this,c,l,y)||this;return g.sourceKey=a,g}return P(r,o),r}(s.Edge)},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.CycleRemover=void 0;var m=d(54),P=d(38),p=d(90),u=function(){function s(){}return s.removeCycles=function(i){var t=this.getFeedbackSet(i);return this.reverseEdges(i,t)},s.getFeedbackSet=function(i){for(var t=this,e={},n=this.getNonTrivialStronglyConnectedComponents(i);n.length;)n.forEach(function(o){var r=t.getMaxCyclicEdges(o);r.forEach(function(a){return delete e[a.reverse().getHashKey()]}),r.forEach(function(a){return e[a.getHashKey()]=!0})}),n=this.getNonTrivialStronglyConnectedComponents(this.reverseEdges(i,e).graph);return e},s.getMaxCyclicEdges=function(i){var t={},e={},n={},o=[],r=[],a=i.createIterator(P.ConnectionMode.Outgoing);a.visitEachEdgeOnce=!1,a.onNode=function(l){e[l.key]=!0},a.skipNode=function(l){if(e[l.key]){for(var y=[],g=0;g<o.length;g++){var f=o[g];if(n[f.key]===void 0&&(n[f.key]=0),n[f.key]++,y.push(f),f.from===l.key)break}r.push(y)}return e[l.key]||t[l.key]},a.skipEdge=function(l){return!1},a.onEdge=function(l){o.splice(0,0,l)},a.onAfterEdge=function(l){o.splice(0,1)},a.onAllEdges=function(l){t[l.key]=!0,e[l.key]=!1},a.iterate(i.nodes[0]);var c=new p.HashSet([],function(l){return l.key});return r.forEach(function(l){c.tryPush(l.reduce(function(y,g){return n[g.key]>n[y.key]?g:y},l[0]))}),c.list()},s.reverseEdges=function(i,t){var e=new p.HashSet([],function(r){return r.getHashKey()}),n={},o={};return i.edges.forEach(function(r){t[r.getHashKey()]&&(r=r.reverse(),n[r.key]=!0),e.tryPush(r)||(o[r.key]=!0,delete n[r.key])}),{graph:new m.Graph(i.nodes.map(function(r){return i.getNode(r)}),e.list()),reversedEdges:n,removedEdges:o}},s.getNonTrivialStronglyConnectedComponents=function(i){return this.getStronglyConnectedComponents(i).filter(function(t){return t.edges.length})},s.getStronglyConnectedComponents=function(i){for(var t=this,e=[],n=0,o={},r={},a={},c=[],l={},y=0;y<i.nodes.length;y++){var g=i.nodes[y],f=i.createIterator(P.ConnectionMode.Outgoing);f.visitEachEdgeOnce=!1,f.visitEachNodeOnce=!1,f.onNode=function(v){l[v.key]=!0,e.push(v),a[v.key]=!0,r[v.key]=n,o[v.key]=n,n++},f.skipNode=function(v){return l[v.key]},f.skipEdge=function(v){var C=l[v.to];return C&&a[v.to]&&(r[v.from]=Math.min(r[v.from],o[v.to])),C},f.onAfterEdge=function(v){r[v.from]=Math.min(r[v.from],r[v.to])},f.onAllEdges=function(v,C){C&&r[v.key]===o[v.key]&&c.push(t.getStronglyConnectedComponent(i,v,e,a))},f.iterate(g)}return c},s.getStronglyConnectedComponent=function(i,t,e,n){var o,r={},a=[],c=[];do o=e.pop(),r[o.key]||a.push(o),r[o.key]=!0,n[o.key]=!1;while(o!==t);return a.forEach(function(l){var y=i.getAdjacentEdges(l.key,P.ConnectionMode.Outgoing);c=c.concat(y.filter(function(g){return!r[g.key]&&r[g.to]})),y.forEach(function(g){return r[g.key]=!0})}),new m.Graph(a,c)},s}();h.CycleRemover=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.SendToBackCommand=void 0;var p=d(102),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabled=function(){var t=this.control.selection.getSelectedItems();return s.prototype.isEnabled.call(this)&&t.length>0&&this.needSendToBack(t)},i.prototype.executeCore=function(t,e){var n=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedItems().forEach(function(o){var r=n.control.model.getIntersectItemsMinZIndex(o)-1;n.control.history.addAndRedo(new p.ChangeZindexHistoryItem(o,r))}),this.control.history.endTransaction(),!0},i.prototype.needSendToBack=function(t){for(var e=this,n=function(c){var l=o.control.model.getIntersectItemsMinZIndex(t[c]);if(l<t[c].zIndex)return{value:!0};if(l===t[c].zIndex){var y=!1;return o.control.model.getIntersectItems(t[c]).filter(function(g){return g.zIndex===t[c].zIndex}).forEach(function(g){e.control.model.getItemIndex(g)<e.control.model.getItemIndex(t[c])&&(y=!0)}),{value:y}}},o=this,r=0;r<t.length;r++){var a=n(r);if(typeof a=="object")return a.value}return!1},i}(d(10).SimpleCommandBase);h.SendToBackCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.BringToFrontCommand=void 0;var p=d(102),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabled=function(){var t=this.control.selection.getSelectedItems();return s.prototype.isEnabled.call(this)&&t.length>0&&this.needBringToFront(t)},i.prototype.executeCore=function(t,e){var n=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedItems().forEach(function(o){var r=n.control.model.getIntersectItemsMaxZIndex(o)+1;n.control.history.addAndRedo(new p.ChangeZindexHistoryItem(o,r))}),this.control.history.endTransaction(),!0},i.prototype.needBringToFront=function(t){for(var e=this,n=function(c){var l=o.control.model.getIntersectItemsMaxZIndex(t[c]);if(l>t[c].zIndex)return{value:!0};if(l===t[c].zIndex){var y=!1;return o.control.model.getIntersectItems(t[c]).filter(function(g){return g.zIndex===t[c].zIndex}).forEach(function(g){e.control.model.getItemIndex(g)>e.control.model.getItemIndex(t[c])&&(y=!0)}),{value:y}}},o=this,r=0;r<t.length;r++){var a=n(r);if(typeof a=="object")return a.value}return!1},i}(d(10).SimpleCommandBase);h.BringToFrontCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(f,v){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,b){C.__proto__=b}||function(C,b){for(var S in b)b.hasOwnProperty(S)&&(C[S]=b[S])})(f,v)},function(f,v){function C(){this.constructor=f}m(f,v),f.prototype=v===null?Object.create(v):(C.prototype=v.prototype,new C)});Object.defineProperty(h,"__esModule",{value:!0}),h.MoveStepDownCommand=h.MoveDownCommand=h.MoveStepUpCommand=h.MoveUpCommand=h.MoveStepRightCommand=h.MoveRightCommand=h.MoveStepLeftCommand=h.MoveLeftCommand=h.MoveCommand=void 0;var p=d(0),u=d(4),s=d(12),i=d(10),t=d(58),e=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.isEnabled=function(){return f.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty()},v.prototype.executeCore=function(C,b){var S=this;this.control.history.beginTransaction();var x=this.control.selection,I=x.getSelectedShapes();I.filter(function(_){for(;_.container;){if(I.indexOf(_.container)!==-1)return!1;_=_.container}return!0}).forEach(function(_){S.permissionsProvider.addInteractingItem(_,t.DiagramModelOperation.MoveShape);var T=S.getPosition(_.position);u.ModelUtils.setShapePosition(S.control.history,S.control.model,_,T),u.ModelUtils.updateShapeAttachedConnectors(S.control.history,S.control.model,_),S.permissionsProvider.clearInteractingItems()});var w=u.ModelUtils.createSelectedItems(x);return x.getSelectedConnectors().forEach(function(_){if(u.ModelUtils.canMoveConnector(w,_))for(var T=_.beginItem?1:0,R=_.endItem?_.points.length-2:_.points.length-1,E=T;E<=R;E++){var D=S.getPosition(_.points[E]);u.ModelUtils.moveConnectorPoint(S.control.history,_,E,D)}}),u.ModelUtils.tryUpdateModelRectangle(this.control.history),this.control.history.endTransaction(),!0},Object.defineProperty(v.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),v}(i.SimpleCommandBase);h.MoveCommand=e;var n=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return C.clone().offset(-s.UnitConverter.pixelsToTwips(1),0)},v}(e);h.MoveLeftCommand=n;var o=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return this.control.settings.snapToGrid?new p.Point(u.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,C.x-(this.control.settings.gridSize/2+2),!0),C.y):C.clone().offset(-this.control.settings.gridSize,0)},v}(e);h.MoveStepLeftCommand=o;var r=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return C.clone().offset(s.UnitConverter.pixelsToTwips(1),0)},v}(e);h.MoveRightCommand=r;var a=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return this.control.settings.snapToGrid?new p.Point(u.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,C.x+(this.control.settings.gridSize/2+2),!0),C.y):C.clone().offset(this.control.settings.gridSize,0)},v}(e);h.MoveStepRightCommand=a;var c=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return C.clone().offset(0,-s.UnitConverter.pixelsToTwips(1))},v}(e);h.MoveUpCommand=c;var l=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return this.control.settings.snapToGrid?new p.Point(C.x,u.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,C.y-(this.control.settings.gridSize/2+2),!1)):C.clone().offset(0,-this.control.settings.gridSize)},v}(e);h.MoveStepUpCommand=l;var y=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return C.clone().offset(0,s.UnitConverter.pixelsToTwips(1))},v}(e);h.MoveDownCommand=y;var g=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return P(v,f),v.prototype.getPosition=function(C){return this.control.settings.snapToGrid?new p.Point(C.x,u.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,C.y+(this.control.settings.gridSize/2+2),!1)):C.clone().offset(0,this.control.settings.gridSize)},v}(e);h.MoveStepDownCommand=g},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(I,w){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,T){_.__proto__=T}||function(_,T){for(var R in T)T.hasOwnProperty(R)&&(_[R]=T[R])})(I,w)},function(I,w){function _(){this.constructor=I}m(I,w),I.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleAutoZoomCommand=h.ToggleAutoZoomToWidthCommand=h.ToggleAutoZoomToContentCommand=h.SwitchAutoZoomCommand=h.FitToWidthCommand=h.FitToScreenCommand=h.ChangeZoomLevelItemsCommand=h.ChangeZoomLevelTo200Command=h.ChangeZoomLevelTo150Command=h.ChangeZoomLevelTo125Command=h.ChangeZoomLevelTo100Command=h.ChangeZoomLevelTo75Command=h.ChangeZoomLevelTo50Command=h.ChangeZoomLevelTo25Command=h.ChangeZoomLevelInPercentageCommand=h.ChangeZoomLevelCommand=void 0;var p=d(10),u=d(28),s=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.isEnabledInReadOnlyMode=function(){return!0},w.prototype.getValue=function(){return this.control.view.getZoom()},w.prototype.executeCore=function(_,T){return this.control.settings.zoomLevel=T,this.control.settings.autoZoom=u.AutoZoomMode.Disabled,this.control.updateLayout(!0),!0},w.prototype.getItems=function(){return this.control.settings.zoomLevelItems.map(function(_){return{value:_,text:100*_+"%"}})},w}(p.SimpleCommandBase);h.ChangeZoomLevelCommand=s;var i=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.executeCore=function(_,T){return I.prototype.executeCore.call(this,_,T/100)},w.prototype.getValue=function(){return 100*this.control.view.getZoom()},w}(s);h.ChangeZoomLevelInPercentageCommand=i;var t=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.getValue=function(){return this.control.view.getZoom()===this.exactValue},w.prototype.executeCore=function(_,T){return I.prototype.executeCore.call(this,_,this.exactValue),!0},w.prototype.getItems=function(){},w}(s),e=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=.25,_}return P(w,I),w}(t);h.ChangeZoomLevelTo25Command=e;var n=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=.5,_}return P(w,I),w}(t);h.ChangeZoomLevelTo50Command=n;var o=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=.75,_}return P(w,I),w}(t);h.ChangeZoomLevelTo75Command=o;var r=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=1,_}return P(w,I),w}(t);h.ChangeZoomLevelTo100Command=r;var a=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=1.25,_}return P(w,I),w}(t);h.ChangeZoomLevelTo125Command=a;var c=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=1.5,_}return P(w,I),w}(t);h.ChangeZoomLevelTo150Command=c;var l=function(I){function w(){var _=I!==null&&I.apply(this,arguments)||this;return _.exactValue=2,_}return P(w,I),w}(t);h.ChangeZoomLevelTo200Command=l;var y=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.isEnabledInReadOnlyMode=function(){return!0},w.prototype.getValue=function(){return this.control.settings.zoomLevelItems},w.prototype.executeCore=function(_,T){return this.control.settings.zoomLevelItems=T,!0},w}(p.SimpleCommandBase);h.ChangeZoomLevelItemsCommand=y;var g=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.isEnabled=function(){return I.prototype.isEnabled.call(this)&&!!this.control.render},w.prototype.isEnabledInReadOnlyMode=function(){return!0},w.prototype.executeCore=function(_){var T=this.getZoomLevel();return this.control.settings.zoomLevel=T,this.control.settings.autoZoom=u.AutoZoomMode.Disabled,this.control.updateLayout(!0),!0},w}(p.SimpleCommandBase),f=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.getZoomLevel=function(){return this.control.render.view.getActualAutoZoomLevel(u.AutoZoomMode.FitContent)},w}(g);h.FitToScreenCommand=f;var v=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.getZoomLevel=function(){return this.control.render.view.getActualAutoZoomLevel(u.AutoZoomMode.FitToWidth)},w}(g);h.FitToWidthCommand=v;var C=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.isEnabledInReadOnlyMode=function(){return!0},w.prototype.getValue=function(){return this.control.settings.autoZoom},w.prototype.executeCore=function(_,T){return T=parseInt(T),this.control.settings.autoZoom!==T&&(T===u.AutoZoomMode.Disabled&&(this.control.settings.zoomLevel=this.control.view.getZoom()),this.control.settings.autoZoom=T,this.control.updateLayout(!0),!0)},w}(p.SimpleCommandBase);h.SwitchAutoZoomCommand=C;var b=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.getValue=function(){return this.control.settings.autoZoom===u.AutoZoomMode.FitContent},w.prototype.executeCore=function(_,T){return I.prototype.executeCore.call(this,_,u.AutoZoomMode.FitContent)},w}(C);h.ToggleAutoZoomToContentCommand=b;var S=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.getValue=function(){return this.control.settings.autoZoom===u.AutoZoomMode.FitToWidth},w.prototype.executeCore=function(_,T){return I.prototype.executeCore.call(this,_,u.AutoZoomMode.FitToWidth)},w}(C);h.ToggleAutoZoomToWidthCommand=S;var x=function(I){function w(){return I!==null&&I.apply(this,arguments)||this}return P(w,I),w.prototype.isEnabled=function(){return I.prototype.isEnabled.call(this)&&!!this.control.render},w.prototype.isEnabledInReadOnlyMode=function(){return!0},w.prototype.getValue=function(){return this.control.settings.autoZoom},w.prototype.executeCore=function(_,T){var R;return R=T===void 0?this.control.settings.autoZoom===u.AutoZoomMode.Disabled?u.AutoZoomMode.FitContent:u.AutoZoomMode.Disabled:T?u.AutoZoomMode.FitContent:u.AutoZoomMode.Disabled,this.control.settings.autoZoom!==R&&(R||(this.control.settings.zoomLevel=this.control.view.getZoom()),this.control.settings.autoZoom=R,this.control.updateLayout(!0),!0)},w}(p.SimpleCommandBase);h.ToggleAutoZoomCommand=x},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.BindDocumentCommand=void 0;var p=d(103),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabledInReadOnlyMode=function(){return!0},i.prototype.executeCore=function(t,e){if(!e||!Array.isArray(e.nodeDataSource))throw Error("Format exception");return this.performImportData(e),this.control.updateLayout(!0),!0},i.prototype.performImportData=function(t){var e=this.control.createDocumentDataSource(t.nodeDataSource,t.edgeDataSource,t.dataParameters,t.nodeDataImporter,t.edgeDataImporter);this.control.beginUpdateCanvas(),this.permissionsProvider.lockPermissions();var n=new p.DataLayoutParameters(this.control.settings,t.layoutParameters);e.createModelItems(this.control.history,this.control.model,this.control.shapeDescriptionManager,this.control.selection,n,this.control.settings.snapToGrid,this.control.settings.gridSize,this.control.measurer),this.permissionsProvider.unlockPermissions(),this.control.endUpdateCanvas()},i}(d(10).SimpleCommandBase);h.BindDocumentCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.UnbindDocumentCommand=void 0;var p=d(4),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.isEnabledInReadOnlyMode=function(){return!0},i.prototype.executeCore=function(t){return this.permissionsProvider.lockPermissions(),this.control.deleteDocumentDataSource(),p.ModelUtils.deleteAllItems(this.control.history,this.control.model,this.control.selection),this.control.history.clear(),this.permissionsProvider.unlockPermissions(),!0},i}(d(10).SimpleCommandBase);h.UnbindDocumentCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.LockCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getLockState=function(){return!0},s}(d(145).ChangeLockedCommand);h.LockCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.UnLockCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getLockState=function(){return!1},s}(d(145).ChangeLockedCommand);h.UnLockCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.CloneDownCommand=h.CloneUpCommand=h.CloneRightCommand=h.CloneLeftCommand=h.CloneCommand=void 0;var p=d(4),u=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.isEnabled=function(){var r=this.control.selection.getSelectedItems();return n.prototype.isEnabled.call(this)&&r.length&&r.length>0&&this.permissionsProvider.canAddItems(r)},o.prototype.executeCore=function(r,a){var c=p.ModelUtils.createRectangle(this.control.selection.getSelectedItems());return p.ModelUtils.cloneSelectionToOffset(this.control.history,this.control.model,void 0,this.control.selection,this.getOffsetX(c),this.getOffsetY(c)),!0},Object.defineProperty(o.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),o.prototype.getOffsetX=function(r){return 0},o.prototype.getOffsetY=function(r){return 0},o}(d(10).SimpleCommandBase);h.CloneCommand=u;var s=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.getOffsetX=function(r){return-r.width},o}(u);h.CloneLeftCommand=s;var i=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.getOffsetX=function(r){return r.width},o}(u);h.CloneRightCommand=i;var t=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.getOffsetY=function(r){return-r.height},o}(u);h.CloneUpCommand=t;var e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.getOffsetY=function(r){return r.height},o}(u);h.CloneDownCommand=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeViewUnitsCommand=h.ChangeUnitsCommand=void 0;var p=d(77),u=d(281),s=d(10),i=d(36),t=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.isEnabledInReadOnlyMode=function(){return!0},o.prototype.getValue=function(){return this.control.model.units},o.prototype.createHistoryItems=function(r){return[new u.ChangeUnitsHistoryItem(r)]},o.prototype.getItems=function(){return Object.keys(i.DiagramLocalizationService.unitItems).map(function(r){return{value:parseInt(r),text:i.DiagramLocalizationService.unitItems[r]}})},o}(p.ChangePagePropertyCommand);h.ChangeUnitsCommand=t;var e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.isEnabledInReadOnlyMode=function(){return!0},o.prototype.getValue=function(){return this.control.settings.viewUnits},o.prototype.executeCore=function(r,a){return this.control.settings.viewUnits=a,!0},o.prototype.getItems=function(){return Object.keys(i.DiagramLocalizationService.unitItems).map(function(r){return{value:parseInt(r),text:i.DiagramLocalizationService.unitItems[r]}})},o}(s.SimpleCommandBase);h.ChangeViewUnitsCommand=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeUnitsHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.units=i,t}return P(s,u),s.prototype.redo=function(i){this.oldUnits=i.model.units,i.model.units=this.units},s.prototype.undo=function(i){i.model.units=this.oldUnits},s}(d(8).HistoryItem);h.ChangeUnitsHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePageColorCommand=void 0;var p=d(77),u=d(283),s=d(62),i=d(22),t=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return P(n,e),n.prototype.getValue=function(){return i.ColorUtils.colorToHash(this.control.model.pageColor)},n.prototype.getDefaultValue=function(){return i.ColorUtils.colorToHash(s.DiagramModel.defaultPageColor)},n.prototype.createHistoryItems=function(o){return[new u.ChangePageColorHistoryItem(i.ColorUtils.fromString(o))]},n}(p.ChangePagePropertyCommand);h.ChangePageColorCommand=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangePageColorHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.value=i,t}return P(s,u),s.prototype.redo=function(i){this.oldValue=i.model.pageColor,i.changePageColor(this.value)},s.prototype.undo=function(i){i.changePageColor(this.oldValue)},s}(d(8).HistoryItem);h.ChangePageColorHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeShowGridCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabledInReadOnlyMode=function(){return!0},s.prototype.executeCore=function(i,t){var e=t===void 0?!this.control.settings.showGrid:!!t;return this.control.settings.showGrid!==e&&(this.control.settings.showGrid=e,!0)},s.prototype.getValue=function(){return this.control.settings.showGrid},s}(d(10).SimpleCommandBase);h.ChangeShowGridCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleFullscreenCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabledInReadOnlyMode=function(){return!0},s.prototype.getValue=function(){return this.control.settings.fullscreen},s.prototype.executeCore=function(i,t){var e=typeof t=="boolean"?t:!i.value;return this.control.settings.fullscreen!==e&&(this.control.settings.fullscreen=!i.value,this.control.notifyToggleFullscreen(this.control.settings.fullscreen)),!0},s}(d(10).SimpleCommandBase);h.ToggleFullscreenCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleSimpleViewCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabledInReadOnlyMode=function(){return!0},s.prototype.getValue=function(){return this.control.settings.simpleView},s.prototype.executeCore=function(i,t){return typeof t=="boolean"?this.control.settings.simpleView=t:t===void 0&&(this.control.settings.simpleView=!i.value),this.control.updateLayout(!0),!0},s}(d(10).SimpleCommandBase);h.ToggleSimpleViewCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleReadOnlyCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabledInReadOnlyMode=function(){return!0},s.prototype.getValue=function(){return this.control.settings.readOnly},s.prototype.executeCore=function(i,t){return typeof t=="boolean"?this.control.settings.readOnly=t:t===void 0&&(this.control.settings.readOnly=!i.value),!0},s}(d(10).SimpleCommandBase);h.ToggleReadOnlyCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.EditShapeImageCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabled=function(){var i=this.getSelectedShape();return u.prototype.isEnabled.call(this)&&!i.image.isEmpty},s}(d(104).EditShapeImageCommandBase);h.EditShapeImageCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.PasteSelectionInPositionCommand=void 0;var p=d(141),u=d(14),s=d(6),i=d(0),t=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return P(n,e),n.prototype.getEventPositionOffset=function(o,r){var a=o.reduce(function(l,y){return{x:Math.min(l.x,y instanceof u.Shape?y.position.x:y instanceof s.Connector?y.getMinX():Number.MAX_VALUE),y:Math.min(l.y,y instanceof u.Shape?y.position.y:y instanceof s.Connector?y.getMinY():Number.MAX_VALUE)}},{x:Number.MAX_VALUE,y:Number.MAX_VALUE}),c=this.control.render.getModelPointByEventPoint(r.x,r.y);return new i.Point(c.x-a.x,c.y-a.y)},n}(p.PasteSelectionCommandBase);h.PasteSelectionInPositionCommand=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.ImportXMLCommand=void 0;var p=d(291),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.executeCore=function(t,e){var n=new p.XmlImporter(this.control.shapeDescriptionManager,e).import();return this.control.importModel(n),!0},i}(d(57).ExportImportCommandBase);h.ImportXMLCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.XmlImporter=void 0;var p=d(6),u=d(14),s=d(133),i=d(1),t=d(91),e=d(2),n=d(0),o=d(95),r=d(22),a=d(12),c=function(l){function y(g,f){var v=l.call(this,g)||this;return v.doc=o.ImportUtils.createDocument(f),v}return P(y,l),y.prototype.getObject=function(){return this.doc},y.prototype.getPageObject=function(g){var f=this.doc.querySelectorAll("[ItemKind='DiagramRoot']");return f&&f[0]},y.prototype.getShapeObjects=function(g){var f=[];return this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramShape']").forEach(function(v){f.push(v)}),this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramContainer']").forEach(function(v){f.push(v)}),f},y.prototype.getConnectorObjects=function(g){var f=[];return this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramConnector']").forEach(function(v){f.push(v)}),f},y.prototype.importPageSettings=function(g,f){if(f){var v=f.getAttribute("PageSize"),C=this.getSize(v);C&&(g.size=C.clone(),g.pageSize=C.clone())}},y.prototype.importShape=function(g){var f=g.getAttribute("Position"),v=this.getPoint(f),C=g.getAttribute("Shape"),b=this.getShapeType(C),S=this.shapeDescriptionManager.get(b),x=new u.Shape(S||t.ShapeDescriptionManager.default,v);x.key=this.getItemKey(g);var I=g.getAttribute("Size"),w=this.getSize(I);w&&(x.size=w);var _=g.getAttribute("Content");if(typeof _=="string")x.text=_;else{var T=g.getAttribute("Header");typeof T=="string"&&(x.text=T)}return this.importStyle(g,x),x},y.prototype.importShapeChildren=function(g,f){var v=[];g.setAttribute("dxDiagram",""),this.doc.querySelectorAll("[dxDiagram] > Children > [ItemKind='DiagramShape']").forEach(function(w){v.push(w)}),this.doc.querySelectorAll("[dxDiagram] > Children > [ItemKind='DiagramContainer']").forEach(function(w){v.push(w)}),g.removeAttribute("dxDiagram");var C=[];if(!v)return C;for(var b=0;b<v.length;b++){var S=v[b],x=this.importShape(S);x.key=f.key+","+x.key;var I=f.clientRectangle;x.position=x.position.clone().offset(I.x,I.y),f.childKeys||(f.childKeys=[]),f.childKeys.push(x.key),C.push(x),C=C.concat(this.importShapeChildren(S,x))}return C},y.prototype.importConnector=function(g){var f=this,v=[],C=g.getAttribute("BeginPoint"),b=this.getPoint(C);b&&v.push(b),g.getAttribute("Points").split(" ").forEach(function(H){var O=f.getPoint(H);O&&v.push(O)});var S=g.getAttribute("EndPoint"),x=this.getPoint(S);x&&v.push(x);var I=new p.Connector(v);I.key=this.getItemKey(g);var w=g.getAttribute("EndItemPointIndex"),_=parseInt(w);I.endConnectionPointIndex=isNaN(_)?-1:_;var T=g.getAttribute("BeginItemPointIndex"),R=parseInt(T);I.beginConnectionPointIndex=isNaN(R)?-1:R;var E=g.getAttribute("EndItem");E!==void 0&&this.assert(E,"string");var D=g.getAttribute("BeginItem");D!==void 0&&this.assert(D,"string"),I.endItemKey=E,I.beginItemKey=D;var L=g.getAttribute("Content");return typeof L=="string"&&I.setText(L),this.importStyle(g,I),I},y.prototype.importStyle=function(g,f){var v=g.getAttribute("Background");typeof v=="string"&&(f.style.fill=this.getColor(v));var C=g.getAttribute("Stroke");typeof C=="string"&&(f.style.stroke=this.getColor(C));var b=g.getAttribute("Foreground");typeof b=="string"&&(f.styleText.fill=this.getColor(b));var S=g.getAttribute("FontFamily");typeof S=="string"&&(f.styleText["font-family"]=S);var x=g.getAttribute("FontSize");typeof x=="string"&&(f.styleText["font-size"]=x),g.getAttribute("FontWeight")==="Bold"&&(f.styleText["font-weight"]="bold"),g.getAttribute("FontStyle")==="Italic"&&(f.styleText["font-style"]="italic"),g.getAttribute("TextDecorations")==="Underline"&&(f.styleText["text-decoration"]="underline");var I=g.getAttribute("TextAlignment");I==="Left"?f.styleText["text-anchor"]="start":I==="Right"?f.styleText["text-anchor"]="end":I==="Center"&&(f.styleText["text-anchor"]="middle")},y.prototype.getShapeType=function(g){return y.shapeTypes[g]?y.shapeTypes[g]:g&&g.toLowerCase().indexOf("container")>-1?i.ShapeTypes.VerticalContainer:i.ShapeTypes.Rectangle},y.prototype.getItemKey=function(g){return(parseInt(g.tagName.replace("Item",""))-1).toString()},y.prototype.getNumbers=function(g){var f=g.split(",");return f&&f.length?f.map(function(v){return+v}):[]},y.prototype.getSize=function(g){if(g){var f=this.getNumbers(g);if(f.length>=2)return this.assert(f[0],"number"),this.assert(f[1],"number"),new e.Size(a.UnitConverter.pixelsToTwips(f[0]),a.UnitConverter.pixelsToTwips(f[1]))}},y.prototype.getPoint=function(g){if(g){var f=this.getNumbers(g);if(f.length>=2)return this.assert(f[0],"number"),this.assert(f[1],"number"),new n.Point(a.UnitConverter.pixelsToTwips(f[0]),a.UnitConverter.pixelsToTwips(f[1]))}},y.prototype.getColor=function(g){g=g.charAt(0)==="#"?g.substr(1):g;var f=parseInt(g,16);return isNaN(f)?void 0:r.ColorUtils.colorToHash(f)},y.shapeTypes={"BasicShapes.Rectangle":i.ShapeTypes.Rectangle,"BasicShapes.Ellipse":i.ShapeTypes.Ellipse,"BasicShapes.Triangle":i.ShapeTypes.Triangle,"BasicShapes.Pentagon":i.ShapeTypes.Pentagon,"BasicShapes.Hexagon":i.ShapeTypes.Hexagon,"BasicShapes.Octagon":i.ShapeTypes.Octagon,"BasicShapes.Diamond":i.ShapeTypes.Diamond,"BasicShapes.Cross":i.ShapeTypes.Cross,"BasicShapes.Star5":i.ShapeTypes.Star,"BasicFlowchartShapes.StartEnd":i.ShapeTypes.Terminator,"BasicFlowchartShapes.Data":i.ShapeTypes.Data,"BasicFlowchartShapes.Database":i.ShapeTypes.Database,"BasicFlowchartShapes.ExternalData":i.ShapeTypes.StoredData,"BasicFlowchartShapes.Process":i.ShapeTypes.Process,"BasicFlowchartShapes.Decision":i.ShapeTypes.Decision,"BasicFlowchartShapes.Subprocess":i.ShapeTypes.PredefinedProcess,"BasicFlowchartShapes.Document":i.ShapeTypes.Document,"BasicFlowchartShapes.Custom1":i.ShapeTypes.ManualInput,"BasicFlowchartShapes.Custom2":i.ShapeTypes.ManualOperation,"ArrowShapes.SimpleArrow":i.ShapeTypes.ArrowLeft,"ArrowShapes.SimpleDoubleArrow":i.ShapeTypes.ArrowLeftRight},y}(s.ImporterBase);h.XmlImporter=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.InsertShapeImageCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabled=function(){var i=this.getSelectedShape();return u.prototype.isEnabled.call(this)&&i.image.isEmpty},s}(d(104).EditShapeImageCommandBase);h.InsertShapeImageCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteShapeImageCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.isEnabled=function(){var i=this.getSelectedShape();return u.prototype.isEnabled.call(this)&&!i.image.isEmpty},s.prototype.executeCore=function(i,t){return u.prototype.executeCore.call(this,i,void 0)},s}(d(104).EditShapeImageCommandBase);h.DeleteShapeImageCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStrokeStyleCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"stroke-dasharray"},s}(d(75).ChangeStylePropertyCommand);h.ChangeStrokeStyleCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeStrokeWidthCommand=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.getStyleProperty=function(){return"stroke-width"},s}(d(75).ChangeStylePropertyCommand);h.ChangeStrokeWidthCommand=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutTreeVerticalBottomToTopCommand=void 0;var p=d(20),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.createLayoutSettings=function(){var t=s.prototype.createLayoutSettings.call(this);return t.direction=p.LogicalDirectionKind.Backward,t},i}(d(137).AutoLayoutTreeVerticalCommand);h.AutoLayoutTreeVerticalBottomToTopCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutTreeHorizontalRightToLeftCommand=void 0;var p=d(20),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.createLayoutSettings=function(){var t=s.prototype.createLayoutSettings.call(this);return t.direction=p.LogicalDirectionKind.Backward,t},i}(d(143).AutoLayoutTreeHorizontalCommand);h.AutoLayoutTreeHorizontalRightToLeftCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutLayeredVerticalBottomToTopCommand=void 0;var p=d(20),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.createLayoutSettings=function(){var t=s.prototype.createLayoutSettings.call(this);return t.direction=p.LogicalDirectionKind.Backward,t},i}(d(144).AutoLayoutLayeredVerticalCommand);h.AutoLayoutLayeredVerticalBottomToTopCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.AutoLayoutLayeredHorizontalRightToLeftCommand=void 0;var p=d(20),u=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return P(i,s),i.prototype.createLayoutSettings=function(){var t=s.prototype.createLayoutSettings.call(this);return t.direction=p.LogicalDirectionKind.Backward,t},i}(d(142).AutoLayoutLayeredHorizontalCommand);h.AutoLayoutLayeredHorizontalRightToLeftCommand=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorRoutingModeCommand=void 0;var p=d(10),u=d(28),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.getValue=function(){return this.control.settings.connectorRoutingMode},t.prototype.executeCore=function(e,n){var o=n!==void 0?n:u.ConnectorRoutingMode.None;return this.control.settings.connectorRoutingMode=o,!0},t}(p.SimpleCommandBase);h.ChangeConnectorRoutingModeCommand=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DiagramControl=void 0;var m=d(0),P=d(302),p=d(82),u=d(303),s=d(62),i=d(332),t=d(335),e=d(336),n=d(337),o=d(91),r=d(345),a=d(28),c=d(16),l=d(349),y=d(4),g=d(350),f=d(3),v=d(353),C=d(46),b=d(354),S=d(368),x=d(79),I=d(6),w=d(103),_=d(379),T=d(17),R=d(58),E=function(){function D(){this.updateLockCount=0,this.shouldUpdateItemsByModel=!1,this.reloadContentNeeded=!1,this.reloadContentParameters=new _.ReloadContentParameters,this.reloadContentByExternalChangesParameters=new _.ReloadContentParameters,this.settings=new a.DiagramSettings,this.shapeDescriptionManager=new o.ShapeDescriptionManager,this.shapeDescriptionManager.onShapeDecriptionChanged.add(this),this.model=new s.DiagramModel,this.selection=new i.Selection(this.model),this.onNativeAction=new f.EventDispatcher,this.apiController=new v.ApiController(this.onNativeAction,this.selection,this.model),this.permissionsProvider=new b.PermissionsProvider(this.apiController),this.permissionsProvider.onRequestOperation.add(this),this.routingModel=new S.ConnectorRoutingModel,this.modelManipulator=new P.ModelManipulator(this.model,this.routingModel,this.permissionsProvider),this.modelManipulator.onModelChanged.add(this.permissionsProvider),this.history=new t.History(this.modelManipulator,this),this.barManager=new e.BarManager(this),this.view=new l.ViewController(this.settings,this.barManager),this.commandManager=new p.CommandManager(this),this.eventManager=new u.EventManager(this),this.settings.onReadOnlyChanged.add(this.eventManager.mouseHandler),this.settings.onReadOnlyChanged.add(this.eventManager.visualizersManager),this.selection.onChanged.add(this.barManager),this.selection.onChanged.add(this.apiController),this.selection.onChanged.add(this.permissionsProvider),this.modelManipulator.commitItemsCreateChanges(),this.history.onChanged.add(this),this.toolboxManager=new g.ToolboxManager(this.shapeDescriptionManager),this.settings.onConnectorRoutingModeChanged.add(this.routingModel),C.ImageCache.instance.onReadyStateChanged.add(this)}return Object.defineProperty(D.prototype,"operationSettings",{get:function(){return this.permissionsProvider.operationSettings},enumerable:!1,configurable:!0}),D.prototype.cleanMarkup=function(L){L=L||function(H){T.RenderUtils.removeElement(H)},this.toolboxManager.clean(L),this.barManager.clean(),this.render&&(this.settings.onZoomChanged.remove(this.render.view),this.settings.onViewChanged.remove(this.render.page),this.settings.onViewChanged.remove(this.render.view),this.settings.onReadOnlyChanged.remove(this.render),this.settings.onReadOnlyChanged.remove(this.render.selection),this.eventManager.cleanToolboxes(this.settings.onReadOnlyChanged),this.eventManager.onTextInputOperation.remove(this.render.input),this.eventManager.onTextInputOperation.remove(this.render.items),this.eventManager.onTextInputOperation.remove(this.render.selection),this.eventManager.onMouseOperation.remove(this.render.items),this.eventManager.onMouseOperation.remove(this.render.selection),this.eventManager.onMouseOperation.remove(this.render.view),this.eventManager.onMouseOperation.remove(this.render),this.eventManager.onVisualizersUpdate.remove(this.render.selection),this.modelManipulator.onModelSizeChanged.remove(this.render.view),this.modelManipulator.onModelSizeChanged.remove(this.render.page),this.modelManipulator.onModelChanged.remove(this.render.items),this.modelManipulator.onModelChanged.remove(this.render.page),this.modelManipulator.onModelChanged.remove(this.render.selection),this.selection.onChanged.remove(this.render.selection),this.selection.onChanged.remove(this.render.items),this.render.clean(L),this.render=void 0),this.measurer&&this.measurer instanceof x.TextMeasurer&&this.measurer.clean()},D.prototype.dispose=function(){C.ImageCache.instance.onReadyStateChanged.remove(this)},D.prototype.createDocument=function(L,H,O){this.measurer||this.initMeasurer(L),this.render?this.render.replaceParent(L,H):(this.render=new n.RenderManager(L,this.eventManager,this.measurer,{pageColor:this.model.pageColor,modelSize:this.model.size,pageLandscape:this.model.pageLandscape,pageSize:this.model.pageSize,simpleView:this.settings.simpleView,readOnly:this.settings.readOnly,contextMenuEnabled:this.settings.contextMenuEnabled,gridSize:this.settings.gridSize,gridVisible:this.settings.showGrid,zoomLevel:this.settings.zoomLevel,autoZoom:this.settings.autoZoom,rectangle:this.model.getRectangle(!0)},H,O),this.settings.onZoomChanged.add(this.render.view),this.settings.onViewChanged.add(this.render.page),this.settings.onViewChanged.add(this.render.view),this.settings.onReadOnlyChanged.add(this.render),this.settings.onReadOnlyChanged.add(this.render.selection),this.eventManager.onTextInputOperation.add(this.render.input),this.eventManager.onTextInputOperation.add(this.render.items),this.eventManager.onTextInputOperation.add(this.render.selection),this.eventManager.onTextInputOperation.add(this),this.eventManager.onMouseOperation.add(this.render.items),this.eventManager.onMouseOperation.add(this.render.selection),this.eventManager.onMouseOperation.add(this.render.view),this.eventManager.onMouseOperation.add(this.render),this.eventManager.onVisualizersUpdate.add(this.render.selection),this.modelManipulator.onModelSizeChanged.add(this.render.view),this.modelManipulator.onModelSizeChanged.add(this.render.page),this.modelManipulator.onModelChanged.add(this.render.items),this.modelManipulator.onModelChanged.add(this.render.page),this.modelManipulator.onModelChanged.add(this.render.selection),this.selection.onChanged.add(this.render.selection),this.selection.onChanged.add(this.render.items),this.render.update(!1),this.render.onNewModel(this.model.items),this.modelManipulator.commitItemsCreateChanges(),this.view.initialize(this.render.view),this.settings.zoomLevelWasChanged&&this.raiseCanvasViewActualZoomChanged(),this.selection.raiseSelectionChanged())},D.prototype.createToolbox=function(L,H,O,z){var K=this.toolboxManager.create(L,this.settings.readOnly,!0,H,O,this.getToolboxAllowedShapeTypes.bind(this),z);this.settings.onReadOnlyChanged.add(K),K.onDragOperation.add(this),K.onDragOperation.add(this.apiController),this.eventManager.registerToolbox(K)},D.prototype.createContextToolbox=function(L,H,O,z,K){this.cleanContextToolbox(),this.contextToolbox=this.toolboxManager.create(L,this.settings.readOnly,!1,H,O,this.getToolboxAllowedShapeTypes.bind(this),z),this.contextToolbox.onClickOperation.add(this),this.contextToolboxOnClick=K},D.prototype.getToolboxAllowedShapeTypes=function(L){var H=this,O=[];return this.permissionsProvider.beginUpdateUI(),L.forEach(function(z){H.permissionsProvider.canAddShapeFromToolbox(z)&&O.push(z)}),this.permissionsProvider.endUpdateUI(),O},D.prototype.cleanContextToolbox=function(){this.contextToolbox&&(this.toolboxManager.clean(void 0,this.contextToolbox),this.contextToolbox=void 0,this.contextToolboxOnClick=void 0)},D.prototype.refreshToolbox=function(L){this.permissionsProvider.clearCache(c.DiagramModelOperation.AddShapeFromToolbox),this.toolboxManager.refresh(L)},D.prototype.applyToolboxFilter=function(L,H){return this.toolboxManager.applyFilter(L,H)},D.prototype.notifyToolboxClick=function(L){this.contextToolboxOnClick&&this.contextToolboxOnClick(L)},D.prototype.initMeasurer=function(L){this.measurer=new x.TextMeasurer(L)},D.prototype.onDimensionChanged=function(){R.Browser.TouchUI||this.updateLayout(!0)},D.prototype.updateLayout=function(L){L===void 0&&(L=!1),this.render&&this.render.update(!L)},D.prototype.captureFocus=function(){this.render&&this.render.input.captureFocus()},D.prototype.isFocused=function(){return!this.render||this.render.input.isFocused()},D.prototype.registerBar=function(L){this.barManager.registerBar(L)},D.prototype.updateBarItemsState=function(L,H){this.barManager.updateBarItemsState(L,H)},D.prototype.getCommand=function(L){return this.commandManager.getCommand(L)},D.prototype.getNativeItemByKey=function(L){var H=this.model.findItem(L);return H&&this.apiController.createNativeItem(H)},D.prototype.getNativeItemByDataKey=function(L){var H=this.model.findItemByDataKey(L);return H&&this.apiController.createNativeItem(H)},D.prototype.getNativeItems=function(){var L=this;return this.model.items.map(function(H){return L.apiController.createNativeItem(H)})},D.prototype.getNativeSelectedItems=function(){var L=this;return this.selection.getKeys().map(function(H){return L.apiController.createNativeItem(L.model.findItem(H))})},D.prototype.setSelectedItems=function(L){this.selection.set(L)},D.prototype.scrollToItems=function(L){var H=this,O=f.GeometryUtils.getCommonRectangle(L.map(function(z){return H.model.findItem(z).rectangle}));this.view.scrollIntoView(O)},D.prototype.setInitialStyleProperties=function(L){this.selection.inputPosition.setInitialStyleProperties(L)},D.prototype.setInitialTextStyleProperties=function(L){this.selection.inputPosition.setInitialTextStyleProperties(L)},D.prototype.setInitialConnectorProperties=function(L){this.selection.inputPosition.setInitialConnectorProperties(L)},D.prototype.addCustomShapes=function(L){var H=this;L.forEach(function(O){O.apiController=H.apiController,O.defaultWidth&&(O.defaultWidth=y.ModelUtils.getTwipsValue(H.model.units,O.defaultWidth)),O.defaultHeight&&(O.defaultHeight=y.ModelUtils.getTwipsValue(H.model.units,O.defaultHeight)),O.minWidth&&(O.minWidth=y.ModelUtils.getTwipsValue(H.model.units,O.minWidth)),O.minHeight&&(O.minHeight=y.ModelUtils.getTwipsValue(H.model.units,O.minHeight)),O.maxWidth&&(O.maxWidth=y.ModelUtils.getTwipsValue(H.model.units,O.maxWidth)),O.maxHeight&&(O.maxHeight=y.ModelUtils.getTwipsValue(H.model.units,O.maxHeight)),H.shapeDescriptionManager.registerCustomShape(O)})},D.prototype.removeCustomShapes=function(L){var H=this;L.forEach(function(O){H.shapeDescriptionManager.unregisterCustomShape(O)})},D.prototype.removeAllCustomShapes=function(){this.shapeDescriptionManager.unregisterAllCustomShapes()},D.prototype.importModel=function(L){L.units=this.model.units,this.model=L,this.model.initializeKeyCounter(),this.apiController.model=L,this.onImportData()},D.prototype.importItemsData=function(){this.onImportData()},D.prototype.onImportData=function(){this.render&&(this.render.clear(),this.render.onNewModel(this.model.items)),this.permissionsProvider.clearCache(),this.selection.initialize(this.model),this.modelManipulator.initialize(this.model,this.routingModel),this.history.clear(),this.eventManager.initialize(),this.modelManipulator.commitPageChanges(),this.modelManipulator.commitItemsCreateChanges(),this.notifyViewChanged(),this.notifyHistoryChanged()},D.prototype.createDocumentDataSource=function(L,H,O,z,K){return this.documentDataSource=new r.DocumentDataSource(this,L,H,O,z,K),this.apiController.setDataSource(this.documentDataSource),this.documentDataSource},D.prototype.deleteDocumentDataSource=function(){this.apiController.setDataSource(null),delete this.documentDataSource},D.prototype.applyShapeSizeSettings=function(L){this.settings.applyShapeSizeSettings(L,this.model.units)},D.prototype.applyOperationSettings=function(L){this.permissionsProvider.operationSettings.applySettings(L)},D.prototype.beginUpdateCanvas=function(){this.render&&(this.render.items.beginUpdate(),this.render.selection.beginUpdate())},D.prototype.endUpdateCanvas=function(){this.render&&(this.render.items.endUpdate(),this.render.selection.endUpdate())},D.prototype.beginUpdate=function(){this.barManager.beginUpdate(),this.apiController.beginUpdate(),this.eventManager.beginUpdate()},D.prototype.endUpdate=function(){this.barManager.endUpdate(),this.apiController.endUpdate(),this.eventManager.endUpdate()},D.prototype.notifyEdgeInserted=function(L,H,O){this.onEdgeInserted?this.onEdgeInserted(L,H,O):H(L)},D.prototype.notifyEdgeUpdated=function(L,H,O,z){this.onEdgeUpdated?this.onEdgeUpdated(L,H,O,z):O(L,H)},D.prototype.notifyEdgeRemoved=function(L,H,O,z){this.onEdgeUpdated?this.onEdgeRemoved(L,H,O,z):O(L,H)},D.prototype.notifyNodeInserted=function(L,H,O){this.onNodeInserted?this.onNodeInserted(L,H,O):H(L)},D.prototype.notifyNodeUpdated=function(L,H,O,z){this.onNodeUpdated?this.onNodeUpdated(L,H,O,z):O(L,H)},D.prototype.notifyNodeRemoved=function(L,H,O,z){this.onNodeRemoved?this.onNodeRemoved(L,H,O,z):O(L,H)},D.prototype.reloadInsertedItem=function(L){this.settings.reloadInsertedItemRequired&&this.reloadContent(L)},D.prototype.reloadContent=function(L,H,O,z){if(this.documentDataSource){this.isChangesLocked()&&(this.reloadContentNeeded=!0);var K=z===!0||z===void 0&&!this.reloadContentNeeded,A=K?this.reloadContentByExternalChangesParameters:this.reloadContentParameters;A.add(L,H,O),this.isChangesLocked()||(this.reloadContentCore(A,K),this.barManager.updateItemsState())}},D.prototype.reloadContentCore=function(L,H){var O=this,z=L.getData&&L.getData(),K=this.documentDataSource.refetchData(z&&z.nodeDataSource,z&&z.edgeDataSource);this.beginUpdateCanvas(),this.permissionsProvider.lockPermissions(),this.documentDataSource.updateModelItems(this.history,this.model,this.shapeDescriptionManager,this.selection,new w.DataLayoutParameters(this.settings,L.layoutParameters),H,L.dataKeys,function(A){O.modelManipulator.commitItemUpdateChanges(A)},K,this.settings.snapToGrid,this.settings.gridSize,this.measurer),this.permissionsProvider.unlockPermissions(),this.endUpdateCanvas(),L.clear()},D.prototype.notifyHistoryChanged=function(){this.documentDataSource?(this.shouldUpdateItemsByModel=!0,this.settings.readOnly||this.notifyDataChanges()):this.raiseOnChanged()},D.prototype.notifyViewChanged=function(){this.settings.notifyViewChanged()},D.prototype.notifyToolboxDragStart=function(L){this.render.notifyToolboxDragStart(L),this.onToolboxDragStart&&this.onToolboxDragStart()},D.prototype.notifyToolboxDragEnd=function(L){this.render.notifyToolboxDragEnd(L),this.onToolboxDragEnd&&this.onToolboxDragEnd()},D.prototype.notifyToolboxDraggingMouseMove=function(L){this.render&&this.render.notifyToolboxDraggingMouseMove(L)},D.prototype.notifyTextInputStart=function(L,H,O,z){this.onTextInputStart&&this.onTextInputStart()},D.prototype.notifyTextInputEnd=function(L,H){this.onTextInputEnd&&this.onTextInputEnd()},D.prototype.notifyTextInputPermissionsCheck=function(L,H){},D.prototype.notifyToggleFullscreen=function(L){this.onToggleFullscreen&&this.onToggleFullscreen(L)},D.prototype.notifyShowContextMenu=function(L,H){if(this.onShowContextMenu&&this.render){var O=void 0;if(this.selection.getSelectedItems(!0).length>0){var z=y.ModelUtils.createRectangle(this.selection.getSelectedItems(!0)),K=this.render.getEventPointByModelPoint(z.createPosition()),A=this.render.view.getAbsoluteSize(z.createSize());O={x:K.x,y:K.y,width:A.width,height:A.height}}if(L)this.contextMenuPosition=new m.Point(L.x,L.y),this.onShowContextMenu(L.x,L.y,O);else if(H){var M=this.render.getEventPointByModelPoint(H);this.contextMenuPosition=M.clone(),this.onShowContextMenu(M.x,M.y,O)}}},D.prototype.notifyHideContextMenu=function(){this.onHideContextMenu&&this.render&&this.onHideContextMenu()},D.prototype.notifyShowContextToolbox=function(L,H,O,z,K){if(this.onShowContextToolbox&&this.render){var A=this.render.getEventPointByModelPoint(L);this.onShowContextToolbox(A.x,A.y,O,z,K),this.render.view.notifyShowContextToolbox()}},D.prototype.notifyHideContextToolbox=function(){this.onHideContextToolbox&&this.render&&(this.onHideContextToolbox(),this.render.view.notifyHideContextToolbox()),this.cleanContextToolbox()},D.prototype.notifyShapeDescriptionChanged=function(L){this.modelManipulator.updateShapeDescription(L)},D.prototype.notifyImageCacheReadyStateChanged=function(L){this.barManager.updateItemsState()},D.prototype.raiseCanvasViewActualZoomChanged=function(){this.render.view.raiseActualZoomChanged()},D.prototype.notifyRequestOperation=function(L,H){this.requestOperationByDataSource(L,H)||this.onRequestOperation&&this.onRequestOperation(L,H)},D.prototype.requestOperationByDataSource=function(L,H){if(!this.documentDataSource||!this.documentDataSource.IsNodeParentIdMode()&&!this.documentDataSource.IsNodeItemsMode())return!1;if(L===c.DiagramModelOperation.ChangeConnection){var O=H,z=O.shape&&this.model.findItem(O.shape.id),K=O.connector&&this.model.findItem(O.connector.id);if(!z||!K)return;if(O.position===I.ConnectorPosition.End)for(var A=0;A<z.attachedConnectors.length;A++){var M=z.attachedConnectors[A];if(M!==K&&M.endItem&&M.endItem===z){O.allowed=!1;break}}O.allowed&&K.beginItem&&K.endItem&&this.isShapeParent(K.endItem,K.beginItem)&&(O.allowed=!1)}return!H.allowed},D.prototype.isShapeParent=function(L,H){if(L===H)return!0;for(var O=0;O<L.attachedConnectors.length;O++){var z=L.attachedConnectors[O];if(z.beginItem===L&&z.endItem){var K=z.endItem;if(K===H||this.isShapeParent(K,H))return!0}}return!1},D.prototype.isChangesLocked=function(){return this.updateLockCount>0},D.prototype.beginChangesNotification=function(){this.isChangesLocked()||this.changesLockChanged&&this.changesLockChanged(!0),this.updateLockCount++},D.prototype.endChangesNotification=function(L){var H=this;this.updateLockCount--,this.isChangesLocked()||(this.changesLockChanged(!1),L||setTimeout(function(){H.notifyReloadContent(),H.notifyDataChanges()},0))},D.prototype.changesLockChanged=function(L){L?this.lockedReadOnly=this.settings.readOnly:L=this.lockedReadOnly,this.commandManager.getCommand(p.DiagramCommand.ToggleReadOnly).execute(L)},D.prototype.notifyDataChanges=function(){this.isChangesLocked()||(this.shouldUpdateItemsByModel&&(this.documentDataSource.updateItemsByModel(this.model),this.shouldUpdateItemsByModel=!1),this.raiseOnChanged())},D.prototype.notifyReloadContent=function(){this.reloadContentNeeded&&(this.reloadContentParameters.empty||this.reloadContentCore(this.reloadContentParameters,!1),this.reloadContentByExternalChangesParameters.empty||this.reloadContentCore(this.reloadContentByExternalChangesParameters,!0),this.reloadContentNeeded=!1)},D.prototype.raiseOnChanged=function(){this.onChanged&&this.onChanged()},D}();h.DiagramControl=E},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ModelManipulator=void 0;var m=d(87),P=d(2),p=d(61),u=d(46),s=d(130),i=d(16),t=d(3),e=d(6),n=d(99),o=d(4),r=function(){function a(c,l,y){this.onModelChanged=new t.EventDispatcher,this.onModelSizeChanged=new t.EventDispatcher,this.initializeCore(c,l),this.permissionsProvider=y,this.imageLoader=new s.ImageLoader(this.updateShapeImage.bind(this))}return a.prototype.initialize=function(c,l){this.initializeCore(c,l),this.model.loadAllImages(this.imageLoader),this.updateModelSize()},a.prototype.initializeCore=function(c,l){var y=this;this.model=c,this.routingModel=l,this.routingModel&&(this.routingModel.initialize(c),c.iterateItems(function(g){if(g instanceof e.Connector){var f=y.routingModel.createStrategy(g.properties.lineOption);f?g.changeRoutingStrategy(f):g.invalidateRenderPoints()}}))},a.prototype.commitPageChanges=function(){this.raisePageSizeChanged(this.model.pageSize.clone(),this.model.pageLandscape),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageColorChanged(this.model.pageColor),this.raiseModelRectangleChanged(o.ModelUtils.createRectangle(this.model.items))},a.prototype.commitItemsCreateChanges=function(){p.Diagnostics.timer("new model: model changes"),this.commitItemsChangesCore(n.ItemChangeType.Create,this.model.items),p.Diagnostics.endTimer()},a.prototype.commitItemUpdateChanges=function(c){this.commitItemsChangesCore(n.ItemChangeType.UpdateStructure,[c])},a.prototype.commitItemsChangesCore=function(c,l){var y=[];l.forEach(function(g){y.push(new n.ItemChange(g,c))}),y.length&&this.raiseModelChanged(y)},a.prototype.insertToContainer=function(c,l){if(c.container&&l&&c.container.key!==l.key)throw Error("To insert an item to a container it's necessary to remove it from the current container.");l&&(l.children.indexOf(c)===-1&&l.children.push(c),c.container=l,this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Update)]))},a.prototype.removeFromContainer=function(c){if(c.container){var l=c.container.children.indexOf(c);c.container.children.splice(l,1),c.container=void 0,this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Update)])}},a.prototype.changeStyle=function(c,l,y){this.changeStyleCore(c,c.style,l,y)},a.prototype.changeStyleText=function(c,l,y){this.changeStyleCore(c,c.styleText,l,y)},a.prototype.changeStyleCore=function(c,l,y,g){g!==void 0?l[y]=g:delete l[y],this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties)])},a.prototype.changeZIndex=function(c,l){c.zIndex=l,this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Update)])},a.prototype.changeLocked=function(c,l){c.locked=l,this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateClassName)])},a.prototype.changeCustomData=function(c,l){c.customData=t.ObjectUtils.cloneObject(l),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateStructure)])},a.prototype.addShape=function(c,l){if(c.attachedConnectors.length)throw Error("A creating shape should not contain existing connectors.");return c.key=l!==void 0?l:this.model.getNextKey(),this.insertShape(c)},a.prototype.insertShape=function(c){this.model.pushItem(c);var l=this.permissionsProvider.canAddItems([c]);return this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Create,l)]),this.model.loadAllImages(this.imageLoader),c},a.prototype.resizeShape=function(c,l,y){c.position=l,c.size=y;var g=this.permissionsProvider.isStoredPermissionsGranted(),f=this.getInteractingItem(c,i.DiagramModelOperation.ResizeShape);if(f){var v=f.size.clone(),C=c.size.clone();C.equals(v)||(g=this.permissionsProvider.canResizeShapes([{shape:c,size:C,oldSize:v}]))}var b=this.getInteractingItem(c,i.DiagramModelOperation.MoveShape);if(b){var S=b.position.clone(),x=c.position.clone();x.equals(S)||(g=this.permissionsProvider.canMoveShapes([{shape:c,position:x,oldPosition:S}]))}this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,g)])},a.prototype.moveShape=function(c,l){c.position=l;var y=this.permissionsProvider.isStoredPermissionsGranted();this.getInteractingItem(c,i.DiagramModelOperation.AddShape)&&(y=this.permissionsProvider.canAddItems([c]));var g=this.getInteractingItem(c,i.DiagramModelOperation.MoveShape);if(g){var f=g.position.clone(),v=c.position.clone();v.equals(f)||(y=this.permissionsProvider.canMoveShapes([{shape:c,position:v,oldPosition:f}]))}this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,y)])},a.prototype.changeShapeParameters=function(c,l){c.parameters.forEach(function(y){var g=l.get(y.key);g&&(y.value=g.value)}),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties)])},a.prototype.changeShapeText=function(c,l){c.text=l,this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateStructure)])},a.prototype.changeShapeImage=function(c,l){c.image=l;var y=u.ImageCache.instance.createUnloadedInfoByShapeImageInfo(l);this.imageLoader.load(y),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateStructure)])},a.prototype.changeShapeExpanded=function(c,l){c.expanded=l,c.toggleExpandedSize(),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateStructure)])},a.prototype.deleteShape=function(c,l){if(c.attachedConnectors.length)throw Error("A removing shape should not contain existing connectors.");this.removeShape(c,l)},a.prototype.removeShape=function(c,l){this.model.removeItem(c),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Remove,l)])},a.prototype.updateShapeImage=function(c){if(c.imageUrl){var l=this.model.findShapesByImageUrl(c.imageUrl);l.forEach(function(y){c.base64?y.image.loadBase64Content(c.base64):y.image.setUnableToLoadFlag()}),this.commitItemsChangesCore(n.ItemChangeType.UpdateStructure,l)}},a.prototype.updateShapeDescription=function(c){var l=this.model.findShapesByDescription(c);this.commitItemsChangesCore(n.ItemChangeType.UpdateProperties,l)},a.prototype.addConnector=function(c,l){if(c.beginItem||c.endItem)throw Error("Creating connector should not contain begin/end items");return c.key=l!==void 0?l:this.model.getNextKey(),this.insertConnector(c)},a.prototype.insertConnector=function(c){this.model.pushItem(c);var l=this.routingModel.createStrategy(c.properties.lineOption);l?c.changeRoutingStrategy(l):c.clearRoutingStrategy();var y=this.permissionsProvider.canAddItems([c]);return this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Create,y)]),c},a.prototype.deleteConnector=function(c){if(c.beginItem||c.endItem)throw Error("Creating connector should not contain begin/end items");this.removeConnector(c)},a.prototype.removeConnector=function(c){this.model.removeItem(c);var l=this.permissionsProvider.canDeleteItems([c]);this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.Remove,l)])},a.prototype.addDeleteConnectorPoint=function(c,l){var y=this.getConnectorInteractingPoints(c);l(c),this.addDeleteConnectorPointCore(c,y)},a.prototype.moveConnectorPoint=function(c,l,y){y(c),this.moveConnectorPointCore(c,l)},a.prototype.changeConnectorPoints=function(c,l){var y=this;l(c),c.points.forEach(function(g,f){return y.moveConnectorPointCore(c,f)})},a.prototype.moveConnectorPointCore=function(c,l){var y=this.getInteractingItem(c),g=this.permissionsProvider.isStoredPermissionsGranted();if(y){var f=0<l&&l<c.points.length-1;if(f=(f=f||l===0&&!c.beginItem)||l===c.points.length-1&&!c.endItem){var v=y.points.map(function(b){return b.clone()}),C=c.points.map(function(b){return b.clone()});t.GeometryUtils.arePointsEqual(v,C)||(g=this.permissionsProvider.canChangeConnectorPoints(c,v,C))}}this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,g)])},a.prototype.getConnectorInteractingPoints=function(c){var l=this.getInteractingItem(c);return l?l.points.map(function(y){return y.clone()}):c.points.map(function(y){return y.clone()})},a.prototype.addDeleteConnectorPointCore=function(c,l){var y=this.permissionsProvider.isStoredPermissionsGranted(),g=c.points.map(function(f){return f.clone()});t.GeometryUtils.arePointsEqual(l,g)||(y=this.permissionsProvider.canChangeConnectorPoints(c,l,g)),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,y)])},a.prototype.addConnection=function(c,l,y,g){var f=c.getExtremeItem(g),v=c.getExtremeConnectionPointIndex(g);if(f!==l||v!==y){if(f)throw Error("Connector is already connected");l.attachedConnectors.push(c),g===e.ConnectorPosition.Begin?(c.beginItem=l,c.beginConnectionPointIndex=y):(c.endItem=l,c.endConnectionPointIndex=y),c.invalidateRenderPoints();var C=this.permissionsProvider.canChangeConnection(c,l,void 0,g,y);this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,C)])}},a.prototype.setConnectionPointIndex=function(c,l,y){if(!c.getExtremeItem(y))throw Error("Connection should be connected");y===e.ConnectorPosition.Begin?c.beginConnectionPointIndex=l:c.endConnectionPointIndex=l,c.invalidateRenderPoints();var g=c.getExtremeItem(y),f=this.permissionsProvider.canChangeConnection(c,g,g,y,l);this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,f)])},a.prototype.deleteConnection=function(c,l){var y=c.getExtremeItem(l);if(y){y.attachedConnectors.splice(y.attachedConnectors.indexOf(c),1),l===e.ConnectorPosition.Begin?(c.beginItem=null,c.beginConnectionPointIndex=-1):(c.endItem=null,c.endConnectionPointIndex=-1),c.invalidateRenderPoints();var g=this.permissionsProvider.canChangeConnection(c,void 0,y,l,-1);this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties,g)])}},a.prototype.changeConnectorProperty=function(c,l,y){if(c.properties[l]=y,l==="lineOption"){var g=this.routingModel?this.routingModel.createStrategy(c.properties.lineOption):void 0;g?c.changeRoutingStrategy(g):c.clearRoutingStrategy()}else c.invalidateRenderPoints();this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties)])},a.prototype.changeConnectorText=function(c,l,y){c.setText(l,y),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateStructure)])},a.prototype.changeConnectorTextPosition=function(c,l,y){var g=c.getText(l);c.setText(null,l),c.setText(g,y),this.raiseModelChanged([new n.ItemChange(c,n.ItemChangeType.UpdateProperties)])},a.prototype.changeModelSize=function(c,l){this.model.size.width=c.width,this.model.size.height=c.height,this.raiseModelSizeChanged(this.model.size.clone(),l),(l.left||l.top)&&(this.model.snapStartPoint=this.model.snapStartPoint.clone().offset(l.left,l.top),this.raiseSnapPointChange(this.model.snapStartPoint))},a.prototype.changePageSize=function(c){this.model.pageSize.equals(c)||(this.model.pageSize=c,this.model.size=new P.Size(this.model.pageWidth,this.model.pageHeight),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageSizeChanged(this.model.pageSize,this.model.pageLandscape))},a.prototype.changePageLandscape=function(c){this.model.pageLandscape!==c&&(this.model.pageLandscape=c,this.model.pageSize.width!==this.model.pageSize.height&&(this.model.size=new P.Size(this.model.pageWidth,this.model.pageHeight),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageSizeChanged(this.model.pageSize,this.model.pageLandscape)))},a.prototype.changePageColor=function(c){this.model.pageColor!==c&&(this.model.pageColor=c,this.raisePageColorChanged(c))},a.prototype.updateModelSize=function(){var c=this.getModelSizeUpdateOffset();if(!c.isEmpty()){var l=Math.max(this.model.size.width+c.left+c.right,this.model.pageWidth),y=Math.max(this.model.size.height+c.top+c.bottom,this.model.pageHeight);this.model.size=new P.Size(l,y)}},a.prototype.getModelSizeUpdateOffset=function(){var c=this.model.getRectangle(!1),l=this.model.getRectangle(!0);return l.equals(c)||this.raiseModelRectangleChanged(l),this.createModelRectangleOffset(l)},a.prototype.createModelRectangleOffset=function(c){var l=this.model.pageWidth,y=this.model.pageHeight,g=this.model.size;return new m.Offsets(-Math.floor(c.x/l)*l,-Math.floor((g.width-c.right)/l)*l,-Math.floor(c.y/y)*this.model.pageHeight,-Math.floor((g.height-c.bottom)/y)*y)},a.prototype.raiseModelChanged=function(c){this.onModelChanged.raise1(function(l){return l.notifyModelChanged(c)})},a.prototype.raisePageColorChanged=function(c){this.onModelChanged.raise1(function(l){return l.notifyPageColorChanged(c)})},a.prototype.raisePageSizeChanged=function(c,l){this.onModelChanged.raise1(function(y){return y.notifyPageSizeChanged(c,l)})},a.prototype.raiseModelSizeChanged=function(c,l){this.onModelSizeChanged.raise1(function(y){return y.notifyModelSizeChanged(c,l)})},a.prototype.raiseModelRectangleChanged=function(c){this.onModelSizeChanged.raise1(function(l){return l.notifyModelRectangleChanged(c)})},a.prototype.raiseSnapPointChange=function(c){this.onModelSizeChanged.raise1(function(l){return l.notifySnapPointPositionChanged(c)})},a.prototype.getInteractingItem=function(c,l){return this.permissionsProvider.getInteractingItem(c,l)},a}();h.ModelManipulator=r},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.EventManager=void 0;var m=d(304),P=d(3),p=d(323),u=d(154),s=d(324),i=d(155),t=d(330),e=d(331),n=d(18),o=d(25),r=function(){function a(c){this.onMouseOperation=new P.EventDispatcher,this.onTextInputOperation=new P.EventDispatcher,this.toolboxes=[],this.control=c,this.visualizersManager=P.EventUtils.isTouchMode()?new t.VisualizerTouchManager(c.selection,c.model,this,c.settings):new i.VisualizerManager(c.selection,c.model,this,c.settings),this.onMouseOperation.add(this.visualizersManager),this.contextMenuHandler=n.Browser.TouchUI?new s.ContextMenuTouchHandler(c.selection):new u.ContextMenuHandler,this.contextMenuHandler.onVisibilityChanged.add(c),this.onMouseOperation.add(this.contextMenuHandler),this.onTextInputOperation.add(this.contextMenuHandler),this.contextToolboxHandler=new e.ContextToolboxHandler,this.contextToolboxHandler.onVisibilityChanged.add(c),this.contextToolboxHandler.onVisibilityChanged.add(this.contextMenuHandler),this.mouseHandler=new m.MouseHandler(c.history,c.selection,c.model,this,c.settings.readOnly,c.view,this.visualizersManager,this.contextToolboxHandler,c.shapeDescriptionManager,c.settings,c.permissionsProvider),this.textInputHandler=new p.TextInputHandler(c),this.visualizersManager.onVisualizersUpdate.add(this.mouseHandler)}return Object.defineProperty(a.prototype,"onVisualizersUpdate",{get:function(){return this.visualizersManager.onVisualizersUpdate},enumerable:!1,configurable:!0}),a.prototype.registerToolbox=function(c){this.toolboxes.push(c)},a.prototype.cleanToolboxes=function(c){this.toolboxes.forEach(function(l){c.remove(l)}),this.toolboxes=[]},a.prototype.initialize=function(){this.visualizersManager.initialize(this.control.model),this.mouseHandler.initialize(this.control.model)},a.prototype.beginUpdate=function(c){this.contextMenuHandler.beginUpdate(),this.visualizersManager.beginUpdate()},a.prototype.endUpdate=function(){this.contextMenuHandler.endUpdate(),this.visualizersManager.endUpdate()},a.prototype.onMouseDown=function(c){this.mouseHandler.onMouseDown(c),this.contextMenuHandler.onMouseDown(c),this.visualizersManager.onMouseDown(c),this.contextToolboxHandler.onMouseDown(c)},a.prototype.onMouseMove=function(c){this.processDragging(c),this.mouseHandler.onMouseMove(c)},a.prototype.onMouseUp=function(c){this.contextToolboxHandler.onMouseUp(c),this.mouseHandler.onMouseUp(c),this.contextMenuHandler.onMouseUp(c),this.visualizersManager.onMouseUp(c),this.processDragging(c)},a.prototype.onMouseEnter=function(c){this.visualizersManager.onMouseEnter(c)},a.prototype.onMouseLeave=function(c){this.visualizersManager.onMouseLeave(c)},a.prototype.onDblClick=function(c){this.mouseHandler.onMouseDblClick(c),this.textInputHandler.onDblClick(c),this.control.apiController.notifyDblClick(c)},a.prototype.onClick=function(c){this.mouseHandler.onMouseClick(c),this.control.apiController.notifyClick(c)},a.prototype.onContextMenu=function(c){this.contextMenuHandler.onContextMenu(c)},a.prototype.onLongTouch=function(c){this.mouseHandler.onLongTouch(c),this.contextMenuHandler.onLongTouch(c)},a.prototype.onBlur=function(c){this.contextMenuHandler.onBlur(c),this.contextToolboxHandler.onBlur(c),this.visualizersManager.onBlur(c)},a.prototype.onFocus=function(c){this.contextMenuHandler.onFocus(c),this.contextToolboxHandler.onFocus(c),this.visualizersManager.onFocus(c)},a.prototype.onKeyDown=function(c){var l=c.getShortcutCode();this.onShortcut(l)?(this.visualizersManager.updateConnectionPoints(),this.contextMenuHandler.onShortcut(c),this.contextToolboxHandler.onShortcut(c),c.preventDefault=!0):this.isShortcutForFocusInput(l)&&(c.preventDefault=!0),this.contextMenuHandler.onKeyDown(c),this.contextToolboxHandler.onKeyDown(c),this.mouseHandler.onKeyDown(c)},a.prototype.onKeyUp=function(c){this.mouseHandler.onKeyUp(c)},a.prototype.onTextInputBlur=function(c){this.textInputHandler.onBlur(c),this.contextMenuHandler.onTextInputBlur(c)},a.prototype.onTextInputFocus=function(c){this.textInputHandler.onFocus(c),this.contextMenuHandler.onTextInputFocus(c)},a.prototype.onTextInputKeyDown=function(c){this.textInputHandler.onKeyDown(c)},a.prototype.onShortcut=function(c){return!!this.control.commandManager.processShortcut(c)||!!this.mouseHandler.onShortcut(c)||void 0},a.prototype.isShortcutForFocusInput=function(c){return c===o.KeyCode.Delete||c===(o.KeyCode.Delete|o.ModifierKey.Ctrl)||c===(o.KeyCode.Delete|o.ModifierKey.Meta)||c===o.KeyCode.Backspace||c===(o.KeyCode.Backspace|o.ModifierKey.Ctrl)||c===(o.KeyCode.Backspace|o.ModifierKey.Shift)||c===(o.KeyCode.Backspace|o.ModifierKey.Meta)||c===o.KeyCode.Home||c===o.KeyCode.End||c===o.KeyCode.Up||c===(o.KeyCode.Up|o.ModifierKey.Ctrl)||c===(o.KeyCode.Up|o.ModifierKey.Meta)||c===o.KeyCode.Down||c===(o.KeyCode.Down|o.ModifierKey.Ctrl)||c===(o.KeyCode.Down|o.ModifierKey.Meta)||c===o.KeyCode.Left||c===(o.KeyCode.Left|o.ModifierKey.Ctrl)||c===(o.KeyCode.Left|o.ModifierKey.Meta)||c===o.KeyCode.Right||c===(o.KeyCode.Right|o.ModifierKey.Ctrl)||c===(o.KeyCode.Right|o.ModifierKey.Meta)},a.prototype.onPaste=function(c){!this.textInputHandler.isTextInputActive()&&this.control.commandManager.processPaste(c.clipboardData)&&(this.visualizersManager.updateConnectionPoints(),c.preventDefault=!0)},a.prototype.onMouseWheel=function(c){this.mouseHandler.onWheel(c)&&(c.preventDefault=!0)},a.prototype.isFocused=function(){return this.control.isFocused()},a.prototype.processDragging=function(c){var l=this.getDraggingEvent();l&&this.draggingEvent!==l?(this.draggingEvent=l,this.mouseHandler.onDragStart(this.draggingEvent),this.control.captureFocus()):!l&&this.draggingEvent&&(delete this.draggingEvent,this.mouseHandler.onDragEnd(c))},a.prototype.getDraggingEvent=function(){return this.toolboxes.filter(function(c){return c.draggingObject}).map(function(c){return c.draggingObject.evt})[0]},a.prototype.onDocumentDragStart=function(c){this.control.beginUpdate(),this.control.captureFocus(),this.onMouseOperation.raise("notifyDragStart",c)},a.prototype.onDocumentDragEnd=function(c){this.onMouseOperation.raise("notifyDragEnd",c),this.control.endUpdate(),this.control.barManager.updateItemsState()},a.prototype.onDocumentDragScrollStart=function(){this.onMouseOperation.raise1(function(c){return c.notifyDragScrollStart()})},a.prototype.onDocumentDragScrollEnd=function(){this.onMouseOperation.raise1(function(c){return c.notifyDragScrollEnd()})},a.prototype.onDocumentClick=function(c){this.control.beginUpdate(),this.control.endUpdate(),this.control.barManager.updateItemsState()},a.prototype.raiseTextInputStart=function(c,l,y,g){this.onTextInputOperation.raise("notifyTextInputStart",c,l,y,g)},a.prototype.raiseTextInputEnd=function(c,l){this.onTextInputOperation.raise("notifyTextInputEnd",c,l)},a.prototype.raiseTextInputPermissionsCheck=function(c,l){this.onTextInputOperation.raise("notifyTextInputPermissionsCheck",c,l)},a.prototype.canFinishTextEditing=function(){return this.textInputHandler.canFinishTextEditing()},a}();h.EventManager=r},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandler=void 0;var m=d(147),P=d(11),p=d(0),u=d(4),s=d(321),i=d(152),t=d(322),e=d(25),n=d(3),o=function(){function r(a,c,l,y,g,f,v,C,b,S,x){this.history=a,this.selection=c,this.model=l,this.eventManager=y,this.readOnly=g,this.view=f,this.visualizerManager=v,this.contextToolboxHandler=C,this.shapeDescriptionManager=b,this.settings=S,this.permissionsProvider=x,this.finishStateLock=0,this.initialize(l),this.selection.onChanged.add(this)}return r.prototype.initialize=function(a){this.model=a,this.allowMultipleSelection=!0,this.allowCopyDiagramItems=!0,this.allowSnapToCellOnDragDiagramItem=!0,this.allowSnapToCellOnDragPoint=!0,this.allowSnapToCellOnResizeShape=!0,this.allowFixedDrag=!0,this.allowZoomOnWheel=!0,this.allowScrollPage=!0,this.shouldScrollPage=!1,this.copyDiagramItemsByCtrlAndShift=!1,this.startScrollingPageByCtrl=!1,this.initializeDefaultState()},r.prototype.initializeDefaultState=function(){this.defaultState=this.readOnly?n.EventUtils.isTouchMode()?new s.MouseHandlerDefaultReadOnlyTouchState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings):new i.MouseHandlerDefaultReadOnlyState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings):n.EventUtils.isTouchMode()?new t.MouseHandlerDefaultTouchState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings):new m.MouseHandlerDefaultState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings),this.switchToDefaultState()},r.prototype.onMouseDown=function(a){this.mouseDownEvent=a,this.state.onMouseDown(a)},r.prototype.onMouseMove=function(a){this.state.onMouseMove(a)},r.prototype.onMouseUp=function(a){this.state.onMouseUp(a)},r.prototype.onMouseDblClick=function(a){this.state.onMouseDblClick(a)},r.prototype.onMouseClick=function(a){this.state.onMouseClick(a)},r.prototype.onLongTouch=function(a){if(a.touches&&!(a.touches.length>1)){var c=a.source.key;c===void 0?this.selection.clear():this.selection.hasKey(c)?this.selection.remove(c):this.selection.add(c)}},r.prototype.onShortcut=function(a){return this.state.onShortcut(a)},r.prototype.onWheel=function(a){return this.state.onMouseWheel(a)},r.prototype.onDragStart=function(a){this.state.onDragStart(a)},r.prototype.onDragEnd=function(a){this.state.onDragEnd(a)},r.prototype.onKeyDown=function(a){this.state.onKeyDown(a)},r.prototype.onKeyUp=function(a){this.state.onKeyUp(a)},r.prototype.showContextToolbox=function(a,c,l,y,g,f){this.contextToolboxHandler.showContextToolbox(a,c,l,y,g,f)},r.prototype.hideContextToolbox=function(a){this.contextToolboxHandler.hideContextToolbox(a)},r.prototype.canScrollPage=function(a){return this.startScrollingPageByCtrl?!!this.hasCtrlModifier(a.modifiers)&&(!this.copyDiagramItemsByCtrlAndShift||a.source.type!==P.MouseEventElementType.Shape&&a.source.type!==P.MouseEventElementType.Connector):this.allowScrollPage&&this.shouldScrollPage},r.prototype.canMultipleSelection=function(a){return this.allowMultipleSelection&&this.hasCtrlOrShiftModifier(a.modifiers)},r.prototype.canCopySelectedItems=function(a){return!!this.allowCopyDiagramItems&&(this.copyDiagramItemsByCtrlAndShift?this.hasCtrlAndShiftModifier(a.modifiers):this.hasAltModifier(a.modifiers))},r.prototype.canCalculateFixedPosition=function(a){return!(!this.allowFixedDrag||!this.hasShiftModifier(a.modifiers))&&(!this.copyDiagramItemsByCtrlAndShift||!this.hasCtrlModifier(a.modifiers))},r.prototype.canStartZoomOnWheel=function(a){return this.allowZoomOnWheel&&this.hasCtrlModifier(a.modifiers)},r.prototype.canFinishZoomOnWheel=function(a){return this.allowZoomOnWheel&&!this.hasCtrlModifier(a.modifiers)},r.prototype.onStartScrollPageByKeyboard=function(a){this.canStartScrollingPageByKeyboard(a)&&(this.raiseDragScrollStart(),this.shouldScrollPage=!0)},r.prototype.onFinishScrollPageByKeyboard=function(a){this.canEndScrollingPageByKeyboard(a)&&this.finishScrollingPage()},r.prototype.onFinishScrollPageByMouse=function(a){this.canEndScrollingPage(a)&&this.finishScrollingPage()},r.prototype.finishScrollingPage=function(){this.shouldScrollPage=!1,this.raiseDragScrollEnd(),this.switchToDefaultState()},r.prototype.hasCtrlOrShiftModifier=function(a){return this.hasCtrlModifier(a)||this.hasShiftModifier(a)},r.prototype.hasCtrlAndShiftModifier=function(a){return this.hasCtrlModifier(a)&&this.hasShiftModifier(a)},r.prototype.hasCtrlModifier=function(a){return(a&e.ModifierKey.Ctrl)>0},r.prototype.hasAltModifier=function(a){return(a&e.ModifierKey.Alt)>0},r.prototype.hasShiftModifier=function(a){return(a&e.ModifierKey.Shift)>0},r.prototype.canStartScrollingPageByKeyboard=function(a){return!this.startScrollingPageByCtrl&&!this.shouldScrollPage&&a.keyCode===e.KeyCode.Space},r.prototype.canEndScrollingPageByKeyboard=function(a){return!this.startScrollingPageByCtrl&&a.keyCode===e.KeyCode.Space},r.prototype.canEndScrollingPage=function(a){return!this.startScrollingPageByCtrl||this.hasCtrlModifier(a.modifiers)},r.prototype.getSnappedPointOnDragDiagramItem=function(a,c,l,y,g){var f=this.getSnapToCellOnDragDiagramItem(a);return new p.Point(this.getSnappedPos(this.getFixedXPosition(a,c,l,g),!0,f),this.getSnappedPos(this.getFixedYPosition(a,c,y,g),!1,f))},r.prototype.getSnappedPointOnDragPoint=function(a,c,l){var y=this.getSnapToCellOnDragPoint(a),g=this.getSnappedPos(c.x,!0,y),f=this.getSnappedPos(c.y,!1,y);return l===void 0?new p.Point(g,f):Math.pow(c.x-g,2)+Math.pow(c.y-f,2)<Math.pow(c.x-l.x,2)+Math.pow(c.y-l.y,2)?new p.Point(g,f):l},r.prototype.getSnappedOffsetOnDragPoint=function(a,c){var l=this.getSnapToCellOnDragPoint(a);return new p.Point(this.getSnappedPos(a.modelPoint.x-c.x,!0,l),this.getSnappedPos(a.modelPoint.y-c.y,!1,l))},r.prototype.lockAspectRatioOnShapeResize=function(a){return this.hasShiftModifier(a.modifiers)},r.prototype.getSnappedPositionOnResizeShape=function(a,c,l){return this.getSnapToCellOnResizeShape(a)?u.ModelUtils.getSnappedPos(this.model,this.settings.gridSize,c,l):c},r.prototype.getSnappedPos=function(a,c,l){return l?u.ModelUtils.getSnappedPos(this.model,this.settings.gridSize,a,c):a},r.prototype.getFixedXPosition=function(a,c,l,y){return l?c.x:c.x+a.modelPoint.x-y.x},r.prototype.getFixedYPosition=function(a,c,l,y){return l?c.y:c.y+a.modelPoint.y-y.y},r.prototype.getSnapToCellOnDragDiagramItem=function(a){return this.allowSnapToCellOnDragDiagramItem&&this.settings.snapToGrid&&!this.hasCtrlModifier(a.modifiers)},r.prototype.getSnapToCellOnDragPoint=function(a){return this.allowSnapToCellOnDragPoint&&this.settings.snapToGrid&&!this.hasCtrlModifier(a.modifiers)},r.prototype.getSnapToCellOnResizeShape=function(a){return this.allowSnapToCellOnResizeShape&&this.settings.snapToGrid&&!this.hasCtrlModifier(a.modifiers)},r.prototype.tryUpdateModelSize=function(a){this.lockPermissions(),u.ModelUtils.tryUpdateModelRectangle(this.history,a),this.unlockPermissions()},r.prototype.canAddDiagramItemToSelection=function(a){return a.source.key&&(a.button===P.MouseButton.Left||a.button===P.MouseButton.Right)},r.prototype.addDiagramItemToSelection=function(a){this.pressedDiagramItemKey=a.source.key,this.pressedDiagramItemInSelection=this.selection.hasKey(this.pressedDiagramItemKey),this.canMultipleSelection(a)?this.selection.add(a.source.key):this.changeSingleSelection(a.source.key)},r.prototype.canRemoveDiagramItemToSelection=function(a){return this.pressedDiagramItemKey&&a.source.key&&this.pressedDiagramItemKey===a.source.key&&(a.button===P.MouseButton.Left||a.button===P.MouseButton.Right)},r.prototype.removeDiagramItemFromSelection=function(a,c){this.pressedDiagramItemInSelection&&this.selection.getKeys().length>1&&a===P.MouseButton.Left&&this.selection.remove(c)},r.prototype.changeSingleSelection=function(a){this.selection.hasKey(a)||this.selection.set([a])},r.prototype.notifySelectionChanged=function(a){this.pressedDiagramItemKey&&!this.selection.hasKey(this.pressedDiagramItemKey)&&(this.pressedDiagramItemKey=void 0,this.pressedDiagramItemInSelection=!1)},r.prototype.raiseDragStart=function(a){this.eventManager.onDocumentDragStart(a)},r.prototype.raiseDragEnd=function(a){this.eventManager.onDocumentDragEnd(a)},r.prototype.raiseDragScrollStart=function(){this.eventManager.onDocumentDragScrollStart()},r.prototype.raiseDragScrollEnd=function(){this.eventManager.onDocumentDragScrollEnd()},r.prototype.raiseClick=function(a){this.eventManager.onDocumentClick(a)},r.prototype.beginStorePermissions=function(){this.permissionsProvider.beginStorePermissions()},r.prototype.endStorePermissions=function(){this.permissionsProvider.endStorePermissions()},r.prototype.isStoredPermissionsGranted=function(){return this.permissionsProvider.isStoredPermissionsGranted()},r.prototype.lockPermissions=function(){this.permissionsProvider.lockPermissions()},r.prototype.unlockPermissions=function(){this.permissionsProvider.unlockPermissions()},r.prototype.canPerformChangeConnection=function(a,c){var l=!0;return a?l=this.permissionsProvider.canChangeConnection(a,c.item,c.oldItem,c.position,c.connectionPointIndex):c.item&&(l=this.permissionsProvider.canChangeConnection(void 0,c.item,c.oldItem,c.position,c.connectionPointIndex)),l},r.prototype.canPerformChangeConnectionOnUpdateUI=function(a,c){this.permissionsProvider.beginUpdateUI();var l=this.canPerformChangeConnection(a,c);return this.permissionsProvider.endUpdateUI(),l},r.prototype.canFinishTextEditing=function(){return this.eventManager.canFinishTextEditing()},r.prototype.restartState=function(){this.state&&!this.finishStateLock&&(this.finishStateLock++,this.state.finish(),this.finishStateLock--),this.state.start()},r.prototype.switchToDefaultState=function(){this.switchState(this.defaultState)},r.prototype.switchState=function(a){this.newState=a,this.state&&!this.finishStateLock&&(this.finishStateLock++,this.state.finish(),this.finishStateLock--),this.newState&&(this.state=this.newState,this.state.start(),this.newState=void 0)},r.prototype.addInteractingItem=function(a,c){this.permissionsProvider.addInteractingItem(a,c)},r.prototype.clearInteractingItems=function(){this.permissionsProvider.clearInteractingItems()},r.prototype.notifyReadOnlyChanged=function(a){this.readOnly=a,this.initializeDefaultState()},r.prototype.notifySelectionRectShow=function(a){},r.prototype.notifySelectionRectHide=function(){},r.prototype.notifyResizeInfoShow=function(a,c){},r.prototype.notifyResizeInfoHide=function(){},r.prototype.notifyConnectionPointsShow=function(a,c,l,y){this.state.onConnectionPointsShow(a,c)},r.prototype.notifyConnectionPointsHide=function(){},r.prototype.notifyConnectionTargetShow=function(a,c){this.state.onConnectionTargetShow(a,c)},r.prototype.notifyConnectionTargetHide=function(){},r.prototype.notifyContainerTargetShow=function(a,c){},r.prototype.notifyContainerTargetHide=function(){},r.prototype.notifyExtensionLinesShow=function(a){},r.prototype.notifyExtensionLinesHide=function(){},r}();h.MouseHandler=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveConnectorPointState=void 0;var p=d(0),u=d(148),s=d(6),i=d(4),t=d(32),e=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return P(o,n),o.prototype.onMouseDown=function(r){this.connector=this.model.findConnector(r.source.key),this.pointIndex=parseInt(r.source.value),this.pointIndex===0?this.pointPosition=s.ConnectorPosition.Begin:this.pointIndex===this.connector.points.length-1&&(this.pointPosition=s.ConnectorPosition.End),this.handler.addInteractingItem(this.connector),n.prototype.onMouseDown.call(this,r)},o.prototype.onApplyChanges=function(r){this.connector.properties.lineOption===t.ConnectorLineOption.Orthogonal&&this.pointIndex!==0&&this.pointIndex!==this.connector.points.length-1||n.prototype.onApplyChanges.call(this,r)},o.prototype.onFinishWithChanges=function(){n.prototype.onFinishWithChanges.call(this),i.ModelUtils.deleteConnectorUnnecessaryPoints(this.history,this.connector),this.handler.tryUpdateModelSize()},o.prototype.getSnappedPoint=function(r,a){var c=this.connector.points,l=this.pointIndex;if(0<l&&l<c.length-1){var y=(c[l+1].y-c[l-1].y)/(c[l+1].x-c[l-1].x),g=a.x,f=c[l+1].y-(c[l+1].x-g)*y;return this.handler.getSnappedPointOnDragPoint(r,a,new p.Point(g,f))}return this.handler.getSnappedPointOnDragPoint(r,a)},o}(u.MouseHandlerMoveConnectorPointStateBase);h.MouseHandlerMoveConnectorPointState=e},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerResizeShapeState=void 0;var p=d(2),u=d(0),s=d(11),i=d(34),t=d(4),e=d(7),n=d(16),o=function(r){function a(c,l,y,g,f,v){var C=r.call(this,c,l)||this;return C.model=y,C.selection=g,C.visualizerManager=f,C.settings=v,C.startScrollLeft=0,C.startScrollTop=0,C.rotation=0,C}return P(a,r),a.prototype.finish=function(){this.visualizerManager.resetResizeInfo(),this.visualizerManager.resetExtensionLines(),r.prototype.finish.call(this)},a.prototype.onMouseDown=function(c){var l=this,y=parseInt(c.source.value);this.resizeEventSource=y,this.startPoint=c.modelPoint,this.lockH=y===s.ResizeEventSource.ResizeBox_S||y===s.ResizeEventSource.ResizeBox_N,this.lockV=y===s.ResizeEventSource.ResizeBox_E||y===s.ResizeEventSource.ResizeBox_W,this.sideH=y===s.ResizeEventSource.ResizeBox_E||y===s.ResizeEventSource.ResizeBox_NE||y===s.ResizeEventSource.ResizeBox_SE,this.sideV=y===s.ResizeEventSource.ResizeBox_SE||y===s.ResizeEventSource.ResizeBox_S||y===s.ResizeEventSource.ResizeBox_SW,this.shapes=this.selection.getSelectedShapes(),this.shapes.length!==0?(this.shapes.forEach(function(g){l.handler.addInteractingItem(g,n.DiagramModelOperation.ResizeShape),l.handler.addInteractingItem(g,n.DiagramModelOperation.MoveShape)}),this.connectors=this.selection.getSelectedConnectors(),this.startRectangle=t.ModelUtils.createRectangle(this.shapes),this.startShapeSizes=this.shapes.map(function(g){return g.size.clone()}),this.startShapePositions=this.shapes.map(function(g){return g.position.clone()}),this.startConnectorPoints=this.connectors.map(function(g){return g.points.map(function(f){return f.clone()})}),r.prototype.onMouseDown.call(this,c)):this.handler.switchToDefaultState()},a.prototype.onMouseMove=function(c){r.prototype.onMouseMove.call(this,c);var l=this.selection.getSelectedShapes();this.visualizerManager.setExtensionLines(l)},a.prototype.onApplyChanges=function(c){var l=this,y=t.ModelUtils.createRectangle(this.shapes),g=this.shapes.length===1?this.shapes[0].getMinWidth(this.settings.shapeMinWidth):e.ShapeMinDimension,f=this.shapes.length===1?this.shapes[0].getMinHeight(this.settings.shapeMinHeight):e.ShapeMinDimension,v=this.shapes.length===1?this.shapes[0].getMaxWidth(this.settings.shapeMaxWidth):void 0,C=this.shapes.length===1?this.shapes[0].getMaxHeight(this.settings.shapeMaxHeight):void 0,b=this.getSize(c,y.createPosition(),this.startRectangle.createSize(),g,f,v,C,this.handler.lockAspectRatioOnShapeResize(c)),S=this.getPosition(c,b,this.startRectangle.createSize(),this.startRectangle.createPosition()),x=b.width/this.startRectangle.width,I=b.height/this.startRectangle.height;this.shapes.forEach(function(w,_){var T=l.startShapeSizes[_].width*(w.allowResizeHorizontally?x:1);T=l.getNormalizedSize(T,w.getMinWidth(l.settings.shapeMinWidth),w.getMaxWidth(l.settings.shapeMaxWidth));var R=l.startShapeSizes[_].height*(w.allowResizeVertically?I:1);R=l.getNormalizedSize(R,w.getMinHeight(l.settings.shapeMinHeight),w.getMaxHeight(l.settings.shapeMaxHeight));var E=w.allowResizeHorizontally?S.x+(l.startShapePositions[_].x-l.startRectangle.x)*x:l.startShapePositions[_].x,D=w.allowResizeVertically?S.y+(l.startShapePositions[_].y-l.startRectangle.y)*I:l.startShapePositions[_].y;t.ModelUtils.setShapeSize(l.history,l.model,w,new u.Point(E,D),new p.Size(T,R))}),this.connectors.forEach(function(w,_){for(var T=w.beginItem?1:0,R=w.endItem?w.points.length-2:w.points.length-1,E=T;E<=R;E++){var D=new u.Point(S.x+(l.startConnectorPoints[_][E].x-l.startRectangle.x)*x,S.y+(l.startConnectorPoints[_][E].y-l.startRectangle.y)*I);t.ModelUtils.moveConnectorPoint(l.history,w,E,D)}}),this.selection.getSelectedShapes(!1,!0).forEach(function(w){t.ModelUtils.updateShapeAttachedConnectors(l.history,l.model,w)}),this.tryUpdateModelSize(),this.visualizerManager.setResizeInfo(this.shapes)},a.prototype.tryUpdateModelSize=function(){var c=this;this.handler.tryUpdateModelSize(function(l,y){c.startShapePositions.forEach(function(g){g.x+=l,g.y+=y}),c.startConnectorPoints.forEach(function(g){g.forEach(function(f){f.x+=l,f.y+=y})}),c.startRectangle.x+=l,c.startRectangle.y+=y,c.startPoint.x+=l,c.startPoint.y+=y})},a.prototype.getDraggingElementKeys=function(){return this.shapes.map(function(c){return c.key})},a.prototype.getNormalizedSize=function(c,l,y){return l!==void 0&&(c=Math.max(c,l)),y!==void 0&&(c=Math.min(c,y)),c},a.prototype.getSize=function(c,l,y,g,f,v,C,b){var S,x,I=c.modelPoint.x-(this.startScrollLeft-c.scrollX)-this.startPoint.x,w=c.modelPoint.y-(this.startScrollTop-c.scrollY)-this.startPoint.y,_=I*Math.cos(this.rotation)- -w*Math.sin(this.rotation),T=-(I*Math.sin(this.rotation)+-w*Math.cos(this.rotation));return T=!this.sideV&&T>0?Math.min(y.height+1,T):T,_=!this.sideH&&_>0?Math.min(y.width+1,_):_,this.lockH||this.lockV||!b?(_=this.lockH?0:_,T=this.lockV?0:T,S=this.getNormalizedSize(this.sideH?y.width+_:y.width-_,g,v),x=this.getNormalizedSize(this.sideV?y.height+T:y.height-T,f,C)):Math.abs(_)>Math.abs(T)?(S=this.getNormalizedSize(this.sideH?y.width+_:y.width-_,g,v),x=y.height*(S/y.width)):(x=this.getNormalizedSize(this.sideV?y.height+T:y.height-T,f,C),S=y.width*(x/y.height)),this.lockH||(S=this.getSnappedPosition(c,l.x+S,!0)-l.x),this.lockV||(x=this.getSnappedPosition(c,l.y+x,!1)-l.y),new p.Size(S,x)},a.prototype.getPosition=function(c,l,y,g){var f=g.x,v=g.y;if(this.resizeEventSource===s.ResizeEventSource.ResizeBox_N||this.resizeEventSource===s.ResizeEventSource.ResizeBox_NE||this.resizeEventSource===s.ResizeEventSource.ResizeBox_NW){v+=y.height-l.height;var C=this.getSnappedPosition(c,v,!1);l.height+=v-C,v=C}if(this.resizeEventSource===s.ResizeEventSource.ResizeBox_W||this.resizeEventSource===s.ResizeEventSource.ResizeBox_NW||this.resizeEventSource===s.ResizeEventSource.ResizeBox_SW){f+=y.width-l.width;var b=this.getSnappedPosition(c,f,!0);l.width+=f-b,f=b}return new u.Point(f,v)},a.prototype.getSnappedPosition=function(c,l,y){return this.handler.getSnappedPositionOnResizeShape(c,l,y)},a}(i.MouseHandlerDraggingState);h.MouseHandlerResizeShapeState=o},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveConnectorSideState=void 0;var p=d(34),u=d(4),s=function(i){function t(e,n,o){var r=i.call(this,e,n)||this;return r.model=o,r}return P(t,i),t.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.connectorKey=e.source.key,this.pointIndex=parseInt(e.source.value)+1,i.prototype.onMouseDown.call(this,e)},t.prototype.onApplyChanges=function(e){var n=this.getSnappedPoint(e,e.modelPoint),o=this.model.findConnector(this.connectorKey);this.pointCreated?u.ModelUtils.moveConnectorPoint(this.history,o,this.pointIndex,n):(this.handler.addInteractingItem(o),u.ModelUtils.addConnectorPoint(this.history,this.connectorKey,this.pointIndex,n.clone()),this.pointCreated=!0),this.handler.tryUpdateModelSize()},t.prototype.onFinishWithChanges=function(){var e=this.model.findConnector(this.connectorKey);u.ModelUtils.deleteConnectorUnnecessaryPoints(this.history,e),u.ModelUtils.fixConnectorBeginEndConnectionIndex(this.history,e),this.handler.tryUpdateModelSize()},t.prototype.getDraggingElementKeys=function(){return[this.connectorKey]},t}(p.MouseHandlerDraggingState);h.MouseHandlerMoveConnectorSideState=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDragParameterPointState=void 0;var p=d(34),u=d(112),s=function(i){function t(e,n,o){var r=i.call(this,e,n)||this;return r.model=o,r.startScrollLeft=0,r.startScrollTop=0,r}return P(t,i),t.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.shape=this.model.findShape(e.source.key),this.parameterPointKey=e.source.value,this.startParameters=this.shape.parameters.clone(),i.prototype.onMouseDown.call(this,e)},t.prototype.onApplyChanges=function(e){var n=this.handler.getSnappedOffsetOnDragPoint(e,this.startPoint),o=this.startParameters.clone();this.shape.description.modifyParameters(this.shape,o,n.x,n.y),this.history.addAndRedo(new u.ChangeShapeParametersHistoryItem(this.shape.key,o))},t.prototype.getDraggingElementKeys=function(){return[this.shape.key]},t}(p.MouseHandlerDraggingState);h.MouseHandlerDragParameterPointState=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var v in f)f.hasOwnProperty(v)&&(g[v]=f[v])})(l,y)},function(l,y){function g(){this.constructor=l}m(l,y),l.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerCreateConnectorState=void 0;var p=d(6),u=d(48),s=d(66),i=d(9),t=d(148),e=d(68),n=d(53),o=d(4),r=d(67),a=d(113),c=function(l){function y(g,f,v,C,b,S,x){var I=l.call(this,g,f,v,C)||this;return I.shapeDescriptionManager=b,I.selection=S,I.connectionPointIndex=x,I}return P(y,l),y.prototype.onMouseDown=function(g){this.connectionPointIndex===void 0&&(this.connectionPointIndex=parseInt(g.source.value)),this.connectedItem=this.model.findItem(g.source.key),this.pointIndex=1,this.pointPosition=p.ConnectorPosition.End,l.prototype.onMouseDown.call(this,g)},y.prototype.onMouseUp=function(g){this.connector&&!this.connector.endItem&&this.createNewShapeAtConnectorEnd(g),l.prototype.onMouseUp.call(this,g)},y.prototype.onApplyChanges=function(g){var f=this.getSnappedPoint(g,g.modelPoint);if(this.connector)l.prototype.onApplyChanges.call(this,g);else{var v=new s.AddConnectorHistoryItem([this.connectedItem.getConnectionPointPosition(this.connectionPointIndex,f),f]);this.history.addAndRedo(v),this.connector=this.model.findConnector(v.connectorKey),this.handler.addInteractingItem(this.connector),this.history.addAndRedo(new u.AddConnectionHistoryItem(this.connector,this.connectedItem,this.connectionPointIndex,p.ConnectorPosition.Begin)),o.ModelUtils.updateNewConnectorProperties(this.history,this.selection,this.connector.key)}},y.prototype.checkStoredPermissionsOnFinish=function(){this.connector&&this.connector.endItem&&l.prototype.checkStoredPermissionsOnFinish.call(this)},y.prototype.onFinishWithChanges=function(){l.prototype.onFinishWithChanges.call(this),this.history.addAndRedo(new e.SetSelectionHistoryItem(this.selection,[this.connector.key]))},y.prototype.createNewShapeAtConnectorEnd=function(g){var f=this,v=this.connector&&this.connector.beginItem;if(v)if(!this.connector||this.handler.canPerformChangeConnection(this.connector,{position:p.ConnectorPosition.End,connectionPointIndex:-1})){var C=this.getNewShapeSide(this.connector),b=this.getSnappedPoint(g,g.modelPoint),S=this.shapeDescriptionManager.getCategoryByDescription(v.description);this.handler.showContextToolbox(b,function(x){var I=x.clone();I.position=b.clone();var w=f.getNewShapePosition(I,C);return f.handler.getSnappedPointOnDragPoint(g,w)},C,S,function(x){if(x){f.handler.beginStorePermissions(),f.history.beginTransaction();var I=new n.AddShapeHistoryItem(f.shapeDescriptionManager.get(x),b);f.history.addAndRedo(I);var w=f.model.findShape(I.shapeKey),_=f.targetItem&&f.model.findNearestContainer(f.targetItem.key);_&&o.ModelUtils.insertToContainer(f.history,f.model,w,_);var T=f.getNewShapePosition(w,C);o.ModelUtils.setShapePosition(f.history,f.model,w,f.getSnappedPoint(g,T)),o.ModelUtils.updateNewShapeProperties(f.history,f.selection,w.key),f.history.addAndRedo(new u.AddConnectionHistoryItem(f.connector,w,w.getConnectionPointIndexForSide(C),p.ConnectorPosition.End)),_&&o.ModelUtils.updateConnectorContainer(f.history,f.model,f.connector),o.ModelUtils.updateShapeAttachedConnectors(f.history,f.model,w),f.handler.isStoredPermissionsGranted()?(f.handler.tryUpdateModelSize(),f.history.addAndRedo(new e.SetSelectionHistoryItem(f.selection,[w.key]))):(f.handler.lockPermissions(),f.history.undoTransaction(),f.handler.unlockPermissions(),f.checkNewConnectorPermissions()),f.history.endTransaction(),f.handler.endStorePermissions(),f.handler.hideContextToolbox(!0)}},function(){f.checkNewConnectorPermissions()})}else this.cancelChanges()},y.prototype.checkNewConnectorPermissions=function(){this.connector&&!this.handler.canPerformChangeConnection(this.connector,{position:p.ConnectorPosition.End,connectionPointIndex:-1})&&(this.handler.lockPermissions(),this.history.beginTransaction(),this.history.addAndRedo(new e.SetSelectionHistoryItem(this.selection,[])),this.connector.beginItem&&this.history.addAndRedo(new r.DeleteConnectionHistoryItem(this.connector,p.ConnectorPosition.Begin)),this.connector.endItem&&this.history.addAndRedo(new r.DeleteConnectionHistoryItem(this.connector,p.ConnectorPosition.End)),this.history.addAndRedo(new a.DeleteConnectorHistoryItem(this.connector.key)),this.history.endTransaction(),this.handler.unlockPermissions())},y.prototype.getNewShapePosition=function(g,f){switch(f){case i.ConnectionPointSide.North:return g.position.clone().offset(-g.size.width/2,0);case i.ConnectionPointSide.South:return g.position.clone().offset(-g.size.width/2,-g.size.height);case i.ConnectionPointSide.East:return g.position.clone().offset(-g.size.width,-g.size.height/2);case i.ConnectionPointSide.West:return g.position.clone().offset(0,-g.size.height/2)}},y.prototype.getNewShapeSide=function(g){var f=g.getRenderPoints();return y.getNewShapeSideByConnectorPoints(f[f.length-1],f[f.length-2])},y.prototype.getSourceItem=function(){return this.connectedItem},y.getNewShapeSideByConnectorPoints=function(g,f){return g.x===f.x?g.y>f.y?i.ConnectionPointSide.North:i.ConnectionPointSide.South:g.x>f.x?g.y===f.y?i.ConnectionPointSide.West:g.y>f.y?Math.abs(g.x-f.x)>Math.abs(g.y-f.y)?i.ConnectionPointSide.West:i.ConnectionPointSide.North:Math.abs(g.x-f.x)>Math.abs(g.y-f.y)?i.ConnectionPointSide.West:i.ConnectionPointSide.South:g.y===f.y?i.ConnectionPointSide.East:g.y>f.y?Math.abs(g.x-f.x)>Math.abs(g.y-f.y)?i.ConnectionPointSide.East:i.ConnectionPointSide.North:Math.abs(g.x-f.x)>Math.abs(g.y-f.y)?i.ConnectionPointSide.East:i.ConnectionPointSide.South},y}(t.MouseHandlerMoveConnectorPointStateBase);h.MouseHandlerCreateConnectorState=c},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveConnectorOrthogonalSideState=void 0;var p=d(0),u=d(6),s=d(9),i=d(4),t=function(e){function n(o,r,a){var c=e.call(this,o,r)||this;return c.model=a,c}return P(n,e),n.prototype.onMouseDown=function(o){this.startPoint=o.modelPoint,this.connector=this.model.findConnector(o.source.key),this.handler.addInteractingItem(this.connector);var r=o.source.value.split("_"),a=parseInt(r[0]),c=parseInt(r[1]),l=this.connector.getRenderPoints(!0);this.renderPoint1=l[a].clone(),this.renderPoint2=l[c].clone(),this.isVerticalOrientation=this.renderPoint1.x===this.renderPoint2.x,this.renderPoint1.pointIndex!==-1?(this.pointIndex1=this.renderPoint1.pointIndex,this.pointIndex1===0?(this.pointIndex1++,this.correctEdgePoint(this.renderPoint1,this.renderPoint2,this.connector.beginItem,this.connector.beginConnectionPointIndex)):this.point1=this.connector.points[this.pointIndex1].clone()):this.pointIndex1=this.findPointIndex(l,a,!1)+1,this.renderPoint2.pointIndex!==-1?(this.pointIndex2=this.renderPoint2.pointIndex,this.pointIndex2===this.connector.points.length-1?this.correctEdgePoint(this.renderPoint2,this.renderPoint1,this.connector.endItem,this.connector.endConnectionPointIndex):this.point2=this.connector.points[this.pointIndex2].clone()):this.pointIndex2=this.findPointIndex(l,c,!0),e.prototype.onMouseDown.call(this,o)},n.prototype.onApplyChanges=function(o){var r=this;if(!this.pointCreated){var a=void 0,c=void 0;this.point1===void 0&&(this.point1=new p.Point(this.renderPoint1.x,this.renderPoint1.y),i.ModelUtils.addConnectorPoint(this.history,this.connector.key,this.pointIndex1,this.point1.clone()),a=this.point1.clone(),this.pointIndex2++),this.point2===void 0&&(this.point2=new p.Point(this.renderPoint2.x,this.renderPoint2.y),i.ModelUtils.addConnectorPoint(this.history,this.connector.key,this.pointIndex2,this.point2.clone()),c=this.point2.clone());var l=[];a&&l.push(a),c&&l.push(c);var y=this.createUnnecessaryPoints(this.connector,l);Object.keys(y).forEach(function(f){var v=parseInt(f);v<r.pointIndex1&&r.pointIndex1--,v<r.pointIndex2&&r.pointIndex2--}),this.pointCreated=!0}var g=this.getSnappedPoint(o,o.modelPoint);this.isVerticalOrientation?(this.point1.x=g.x,this.point2.x=g.x):(this.point1.y=g.y,this.point2.y=g.y),i.ModelUtils.moveConnectorRightAnglePoints(this.history,this.connector,this.point1.clone(),this.pointIndex1,this.point2.clone(),this.pointIndex2),this.handler.tryUpdateModelSize()},n.prototype.createUnnecessaryPoints=function(o,r){var a=o.getRenderPoints(!0).map(function(f){return f.clone()}),c=i.ModelUtils.createUnnecessaryRenderPoints(a.filter(function(f){return!f.skipped}).map(function(f){return f.clone()}),o.skippedRenderPoints,function(f){return i.ModelUtils.findFirstPointIndex(a,function(v){return v.equals(f)})},function(f){return!r.some(function(v){return v.equals(f)})}),l={};if(Object.keys(c).length){var y=o.points.map(function(f){return f.clone()}),g=y.length-1;y.forEach(function(f,v){v===0||v===g||i.ModelUtils.isNecessaryPoint(f,v,c)||(l[v]=f)})}return l},n.prototype.onFinishWithChanges=function(){i.ModelUtils.deleteConnectorUnnecessaryPoints(this.history,this.connector),i.ModelUtils.fixConnectorBeginEndConnectionIndex(this.history,this.connector),this.handler.tryUpdateModelSize()},n.prototype.findPointIndex=function(o,r,a){for(var c;c=o[r];){if(c.pointIndex!==-1)return c.pointIndex;r+=a?1:-1}},n.prototype.correctEdgePoint=function(o,r,a,c){var l=0;if(a){var y=a.getConnectionPointSideByIndex(c),g=a.rectangle;switch(l=u.Connector.minOffset,y){case s.ConnectionPointSide.South:l+=g.bottom-o.y;break;case s.ConnectionPointSide.North:l+=o.y-g.y;break;case s.ConnectionPointSide.East:l+=g.right-o.x;break;case s.ConnectionPointSide.West:l+=o.x-g.x}}this.isVerticalOrientation?o.y>r.y?o.y-=Math.min(l,o.y-r.y):o.y+=Math.min(l,r.y-o.y):o.x>r.x?o.x-=Math.min(l,o.x-r.x):o.x+=Math.min(l,r.x-o.x)},n.prototype.getDraggingElementKeys=function(){return[this.connector.key]},n}(d(34).MouseHandlerDraggingState);h.MouseHandlerMoveConnectorOrthogonalSideState=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(y,g){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,v){f.__proto__=v}||function(f,v){for(var C in v)v.hasOwnProperty(C)&&(f[C]=v[C])})(y,g)},function(y,g){function f(){this.constructor=y}m(y,g),y.prototype=g===null?Object.create(g):(f.prototype=g.prototype,new f)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerToolboxDraggingState=h.MouseHandlerBeforeToolboxDraggingState=void 0;var p=d(11),u=d(0),s=d(53),i=d(68),t=d(34),e=d(114),n=d(4),o=d(40),r=d(16),a=300,c=function(y){function g(f,v,C,b,S,x){var I=y.call(this,f)||this;return I.history=v,I.model=C,I.selection=b,I.visualizerManager=S,I.shapeDescriptionManager=x,I.isModelEmpty=C.items.length===0,I}return P(g,y),g.prototype.cancelChanges=function(){this.tryRemoveTimer()},g.prototype.onDragStart=function(f){this.dragging=f},g.prototype.onDragEnd=function(f){this.cancelChanges(),this.handler.switchToDefaultState()},g.prototype.onMouseMove=function(f){var v=this;f.source.type>p.MouseEventElementType.Background?(this.tryRemoveTimer(),this.switchToDraggingState(f,!1)):f.source.type!==p.MouseEventElementType.Background||this.isModelEmpty?this.nonPageAreaTimer!==void 0&&this.tryRemoveTimer():(this.savedEvt=f,this.nonPageAreaTimer===void 0&&(this.nonPageAreaTimer=setTimeout(function(){return v.switchToDraggingState(v.savedEvt,!0)},500)))},g.prototype.switchToDraggingState=function(f,v){this.handler.switchState(new l(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.shapeDescriptionManager,v)),this.handler.state.onDragStart(this.dragging),this.handler.state.onMouseMove(f)},g.prototype.tryRemoveTimer=function(){this.nonPageAreaTimer!==void 0&&(clearTimeout(this.nonPageAreaTimer),delete this.nonPageAreaTimer)},g.prototype.finish=function(){this.tryRemoveTimer()},g}(o.MouseHandlerCancellableState);h.MouseHandlerBeforeToolboxDraggingState=c;var l=function(y){function g(f,v,C,b,S,x,I){var w=y.call(this,f,v)||this;return w.model=C,w.selection=b,w.visualizerManager=S,w.shapeDescriptionManager=x,I||(w.updatePageSizeTimer=setTimeout(function(){w.processAndRemoveUpdatePageSizeTimer()},a)),w}return P(g,y),g.prototype.cancelChanges=function(){this.tryRemoveUpdatePageSizeTimer(),y.prototype.cancelChanges.call(this)},g.prototype.tryRemoveUpdatePageSizeTimer=function(){this.updatePageSizeTimer!==void 0&&(clearTimeout(this.updatePageSizeTimer),delete this.updatePageSizeTimer)},g.prototype.processAndRemoveUpdatePageSizeTimer=function(){this.updatePageSizeTimer!==void 0&&(this.handler.tryUpdateModelSize(),delete this.updatePageSizeTimer)},g.prototype.onMouseMove=function(f){y.prototype.onMouseMove.call(this,f);var v=this.model.findShape(this.shapeKey);if(v){this.visualizerManager.setExtensionLines([v]);var C=n.ModelUtils.findContainerByEventKey(this.model,this.selection,f.source.key);C&&this.allowInsertToContainer(f,v,C)?this.visualizerManager.setContainerTarget(C,f.source.type):this.visualizerManager.resetContainerTarget()}},g.prototype.getDraggingElementKeys=function(){return this.shapeKey===void 0?[]:[this.shapeKey]},g.prototype.onApplyChanges=function(f){var v=this;if(f.source.type===p.MouseEventElementType.Undefined){if(this.dragging.onCaptured(!1),this.shapeKey!==void 0&&!this.deleteHistoryItem){var C=this.model.findShape(this.shapeKey);n.ModelUtils.detachConnectors(this.history,C),n.ModelUtils.removeFromContainer(this.history,this.model,C),this.deleteHistoryItem=new e.DeleteShapeHistoryItem(this.shapeKey,!0),this.history.addAndRedo(this.deleteHistoryItem)}}else{if(this.dragging.onCaptured(!0),this.shapeKey===void 0){this.startPoint=f.modelPoint,this.shapeKey=this.insertToolboxItem(f);var b=this.model.findShape(this.shapeKey);b&&this.handler.addInteractingItem(b,r.DiagramModelOperation.AddShape)}this.deleteHistoryItem&&(this.history.undoTransactionTo(this.deleteHistoryItem),delete this.deleteHistoryItem);var S=this.getPosition(f,this.startShapePosition);C=this.model.findShape(this.shapeKey),n.ModelUtils.setShapePosition(this.history,this.model,C,S),n.ModelUtils.updateMovingShapeConnections(this.history,C,this.connectorsWithoutBeginItemInfo,this.connectorsWithoutEndItemInfo,function(){v.visualizerManager.resetConnectionTarget(),v.visualizerManager.resetConnectionPoints()},function(I,w){v.visualizerManager.setConnectionTarget(I,p.MouseEventElementType.Shape),v.visualizerManager.setConnectionPoints(I,p.MouseEventElementType.Shape,w,!0)},function(I){return v.handler.addInteractingItem(I)}),n.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,C);var x=n.ModelUtils.findContainerByEventKey(this.model,this.selection,f.source.key);C&&x&&this.allowInsertToContainer(f,C,x)?n.ModelUtils.insertToContainer(this.history,this.model,C,x):n.ModelUtils.removeFromContainer(this.history,this.model,C),this.updatePageSizeTimer===void 0&&this.handler.tryUpdateModelSize(function(I,w){v.connectorsWithoutBeginItemInfo.forEach(function(_){_.point.x+=I,_.point.y+=w}),v.connectorsWithoutEndItemInfo.forEach(function(_){_.point.x+=I,_.point.y+=w})})}},g.prototype.onFinishWithChanges=function(){this.deleteHistoryItem||this.history.addAndRedo(new i.SetSelectionHistoryItem(this.selection,[this.shapeKey]))},g.prototype.onDragStart=function(f){this.dragging=f,this.connectorsWithoutBeginItemInfo=n.ModelUtils.getConnectorsWithoutBeginItemInfo(this.model),this.connectorsWithoutEndItemInfo=n.ModelUtils.getConnectorsWithoutEndItemInfo(this.model)},g.prototype.onDragEnd=function(f){this.shapeKey!==void 0&&f.source.type===p.MouseEventElementType.Undefined&&this.cancelChanges(),this.handler.switchToDefaultState()},g.prototype.finish=function(){this.visualizerManager.resetExtensionLines(),this.visualizerManager.resetContainerTarget(),this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints(),this.processAndRemoveUpdatePageSizeTimer(),this.dragging.onFinishDragging(),y.prototype.finish.call(this)},g.prototype.insertToolboxItem=function(f){var v=this.shapeDescriptionManager.get(this.dragging.data);this.startShapePosition=this.getSnappedPoint(f,new u.Point(f.modelPoint.x-v.defaultSize.width/2,f.modelPoint.y-v.defaultSize.height/2));var C=new s.AddShapeHistoryItem(v,this.startShapePosition);return this.history.addAndRedo(C),n.ModelUtils.updateNewShapeProperties(this.history,this.selection,C.shapeKey),C.shapeKey},g.prototype.allowInsertToContainer=function(f,v,C){return!this.handler.canMultipleSelection(f)&&C&&C.expanded&&n.ModelUtils.canInsertToContainer(this.model,v,C)},g.prototype.getPosition=function(f,v){return this.getSnappedPoint(f,new u.Point(v.x+f.modelPoint.x-this.startPoint.x,v.y+f.modelPoint.y-this.startPoint.y))},g}(t.MouseHandlerDraggingState);h.MouseHandlerToolboxDraggingState=l},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveConnectorTextState=void 0;var p=d(34),u=d(313),s=d(69),i=function(t){function e(n,o,r){var a=t.call(this,n,o)||this;return a.model=r,a}return P(e,t),e.prototype.onMouseDown=function(n){this.connector=this.model.findConnector(n.source.key),this.position=parseFloat(n.source.value),this.text=this.connector.getText(this.position),this.savedText="",t.prototype.onMouseDown.call(this,n)},e.prototype.onApplyChanges=function(n){var o=this.connector.getTextPositionByPoint(n.modelPoint);if(o!==this.position){var r=this.connector.getText(o);r!==""&&r!==this.text&&(this.history.addAndRedo(new s.ChangeConnectorTextHistoryItem(this.connector,o,"")),this.savedText=r),this.history.addAndRedo(new u.ChangeConnectorTextPositionHistoryItem(this.connector,this.position,o)),this.savedText!==""&&this.savedText!==r&&(this.history.addAndRedo(new s.ChangeConnectorTextHistoryItem(this.connector,this.position,this.savedText)),this.savedText=""),this.position=o}},e.prototype.getDraggingElementKeys=function(){return[this.connector.key]},e}(p.MouseHandlerDraggingState);h.MouseHandlerMoveConnectorTextState=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorTextPositionHistoryItem=void 0;var p=function(u){function s(i,t,e){var n=u.call(this)||this;return n.connectorKey=i.key,n.position=t,n.newPosition=e,n}return P(s,u),s.prototype.redo=function(i){var t=i.model.findConnector(this.connectorKey);i.changeConnectorTextPosition(t,this.position,this.newPosition)},s.prototype.undo=function(i){var t=i.model.findConnector(this.connectorKey);i.changeConnectorTextPosition(t,this.newPosition,this.position)},s}(d(8).HistoryItem);h.ChangeConnectorTextPositionHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerToggleShapeExpandedState=void 0;var p=d(40),u=d(315),s=d(4),i=function(t){function e(n,o,r,a){var c=t.call(this,n)||this;return c.history=o,c.model=r,c.selection=a,c}return P(e,t),e.prototype.onMouseUp=function(n){var o=this.model.findShape(n.source.key);o&&!o.isLocked&&(this.history.beginTransaction(),this.history.addAndRedo(new u.ToggleShapeExpandedHistoryItem(o)),s.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,o),s.ModelUtils.updateContainerConnectorsAttachedPoints(this.history,this.model,o),s.ModelUtils.updateSelection(this.history,this.selection),this.handler.tryUpdateModelSize(),this.history.endTransaction(),this.handler.raiseClick([o.key])),this.handler.switchToDefaultState()},e}(p.MouseHandlerStateBase);h.MouseHandlerToggleShapeExpandedState=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.ToggleShapeExpandedHistoryItem=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.shapeKey=i.key,t.expanded=i.expanded,t}return P(s,u),s.prototype.redo=function(i){var t=i.model.findShape(this.shapeKey);i.changeShapeExpanded(t,!this.expanded)},s.prototype.undo=function(i){var t=i.model.findShape(this.shapeKey);i.changeShapeExpanded(t,this.expanded)},s}(d(8).HistoryItem);h.ToggleShapeExpandedHistoryItem=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerSelectionState=void 0;var p=d(11),u=d(13),s=function(i){function t(e,n,o){var r=i.call(this,e)||this;return r.selection=n,r.visualizerManager=o,r}return P(t,i),t.prototype.finish=function(){this.handler.raiseDragEnd([]),this.visualizerManager.resetSelectionRectangle(),i.prototype.finish.call(this)},t.prototype.cancelChanges=function(){},t.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.handler.raiseDragStart([])},t.prototype.onMouseMove=function(e){e.button!==p.MouseButton.Left?this.handler.switchToDefaultState():(this.rectangle=u.Rectangle.fromPoints(this.startPoint,e.modelPoint),this.visualizerManager.setSelectionRectangle(this.rectangle))},t.prototype.onMouseUp=function(e){this.rectangle!==void 0?this.selection.selectRect(this.rectangle):this.selection.set([]),this.rectangle=void 0,this.handler.switchToDefaultState()},t}(d(40).MouseHandlerCancellableState);h.MouseHandlerSelectionState=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerZoomOnWheelState=void 0;var p=d(40),u=d(11),s=d(28),i=function(t){function e(n,o,r){var a=t.call(this,n)||this;return a.settings=o,a.view=r,a}return P(e,t),e.prototype.onMouseWheel=function(n){return this.trySwitchToDefault(n)?this.handler.state.onMouseWheel(n):(this.settings.zoomLevel=this.view.getNextStepZoom(n.deltaY<0),n.source.type===u.MouseEventElementType.Background?this.view.resetScroll():(this.view.scrollTo(n.modelPoint,n.offsetPoint),this.view.normalize()),n.preventDefault=!0,!0)},e.prototype.onMouseUp=function(n){this.handler.switchToDefaultState(),this.handler.state.onMouseUp(n)},e.prototype.onMouseDown=function(n){this.handler.switchToDefaultState(),this.handler.state.onMouseDown(n)},e.prototype.onMouseMove=function(n){this.trySwitchToDefault(n)&&this.handler.state.onMouseMove(n)},e.prototype.trySwitchToDefault=function(n){return!!this.handler.canFinishZoomOnWheel(n)&&(this.handler.switchToDefaultState(),!0)},e.prototype.start=function(){t.prototype.start.call(this),this.settings.zoomLevel=this.view.getZoom(),this.settings.autoZoom=s.AutoZoomMode.Disabled},e}(p.MouseHandlerStateBase);h.MouseHandlerZoomOnWheelState=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerZoomOnPinchState=void 0;var p=d(28),u=d(0),s=d(150),i=d(35),t=function(e){function n(o,r,a,c){var l=e.call(this,o,c,r)||this;return l.selection=r,l.settings=a,l.view=c,l}return P(n,e),n.prototype.onMouseDown=function(o){e.prototype.onMouseDown.call(this,o),o.touches.length>1&&(this.startDistance=this.getTouchDistance(o),this.startZoomLevel=this.settings.zoomLevel,this.prevDistance=this.startDistance)},n.prototype.onMouseMove=function(o){if(o.touches.length>1){var r=this.getTouchDistance(o);Math.abs(this.prevDistance-r)>1&&(this.settings.zoomLevel=this.startZoomLevel*(r/this.startDistance),this.view.scrollTo(this.getMiddleLayoutPoint(o),this.getMiddleAbsPoint(o)),this.view.normalize(),this.prevDistance=r)}e.prototype.onMouseMove.call(this,o)},n.prototype.onMouseUp=function(o){o.touches.length===0&&setTimeout((function(){this.handler.switchToDefaultState()}).bind(this),1)},n.prototype.start=function(){e.prototype.start.call(this),this.settings.zoomLevel=this.view.getZoom(),this.settings.autoZoom=p.AutoZoomMode.Disabled},n.prototype.getTouchDistance=function(o){var r=new u.Point(o.touches[0].offsetPoint.x,o.touches[0].offsetPoint.y),a=new u.Point(o.touches[1].offsetPoint.x,o.touches[1].offsetPoint.y);return i.Metrics.euclideanDistance(r,a)},n.prototype.getPointByEvent=function(o){return this.getMiddleAbsPoint(o)},n.prototype.getMiddleAbsPoint=function(o){return o.touches.length>1?n.getMiddlePointByEvent(o,function(r){return r.offsetPoint}):o.offsetPoint},n.prototype.getMiddleLayoutPoint=function(o){return o.touches.length>1?n.getMiddlePointByEvent(o,function(r){return r.modelPoint}):o.modelPoint},n.getMiddlePointByEvent=function(o,r){if(o.touches.length>1)return new u.Point((r(o.touches[0]).x+r(o.touches[1]).x)/2,(r(o.touches[0]).y+r(o.touches[1]).y)/2)},n}(s.MouseHandlerScrollingState);h.MouseHandlerZoomOnPinchState=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveShapeState=void 0;var p=function(u){function s(i,t,e,n,o){var r=u.call(this,i,t,e,n,o)||this;return r.model=e,r.selection=n,r.visualizerManager=o,r}return P(s,u),Object.defineProperty(s.prototype,"areValidDraggingShapes",{get:function(){return this.shouldClone||this.draggingShapes.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"areValidDraggingConnectors",{get:function(){return!0},enumerable:!1,configurable:!0}),s}(d(151).MouseHandlerDragDiagramItemStateBase);h.MouseHandlerMoveShapeState=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerMoveConnectorState=void 0;var p=d(4),u=function(s){function i(t,e,n,o,r){var a=s.call(this,t,e,n,o,r)||this;return a.model=n,a.selection=o,a.visualizerManager=r,a}return P(i,s),Object.defineProperty(i.prototype,"areValidDraggingShapes",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"areValidDraggingConnectors",{get:function(){var t=this;return this.shouldClone?this.draggingShapes.length>0||this.draggingConnectors.length>0:!!this.draggingConnectors.length&&(this.draggingShapes.length?p.ModelUtils.canMoveConnector(this.selectedItems,this.draggingConnectors[this.draggingConnectorsIndexByKey[this.handler.mouseDownEvent.source.key]].connector):!this.draggingConnectors.some(function(e){return!p.ModelUtils.canMoveConnector(t.selectedItems,e.connector)}))},enumerable:!1,configurable:!0}),i}(d(151).MouseHandlerDragDiagramItemStateBase);h.MouseHandlerMoveConnectorState=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDefaultReadOnlyTouchState=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.canDragObjectOnMouseDown=function(i){return!1},s.prototype.canExpandContainerOnMouseDown=function(i){return!1},s.prototype.canClearSelectionOnMouseDown=function(){return!0},s.prototype.canSelectOnMouseUp=function(i){return!this.inSelection(i)},s.prototype.canClearSelectionOnMouseUp=function(){return!1},s}(d(152).MouseHandlerDefaultReadOnlyState);h.MouseHandlerDefaultReadOnlyTouchState=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.MouseHandlerDefaultTouchState=void 0;var p=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return P(s,u),s.prototype.updateConnectionsOnMouseMove=function(i){},s.prototype.canDragObjectOnMouseDown=function(i){return this.inSelection(i)},s.prototype.canExpandContainerOnMouseDown=function(i){return!0},s.prototype.canClearSelectionOnMouseDown=function(){return!0},s.prototype.canSelectOnMouseUp=function(i){return!this.inSelection(i)},s.prototype.canClearSelectionOnMouseUp=function(){return!1},s}(d(147).MouseHandlerDefaultState);h.MouseHandlerDefaultTouchState=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.TextInputHandler=void 0;var m=d(153),P=d(11),p=d(25),u=d(14),s=d(6),i=d(69),t=function(){function e(n){this.control=n}return e.prototype.startTextInput=function(n,o){if(!n.isLocked&&n.enableText&&n.allowEditText&&!this.control.settings.readOnly&&this.canFinishTextEditing()){this.control.beginUpdate(),this.textInputItem=n;var r=!0;if(this.textInputItem instanceof u.Shape){var a=this.textInputItem.textEditRectangle;(r=this.control.permissionsProvider.canChangeShapeText(this.textInputItem))&&this.control.eventManager.raiseTextInputStart(this.textInputItem,this.textInputItem.text,a.createPosition(),a.createSize())}else this.textInputItem instanceof s.Connector&&(this.textInputPosition=o,(r=this.control.permissionsProvider.canChangeConnectorText(this.textInputItem,this.textInputPosition))&&this.control.eventManager.raiseTextInputStart(this.textInputItem,this.textInputItem.getText(this.textInputPosition),this.textInputItem.getTextPoint(this.textInputPosition)));r||(delete this.textInputItem,this.control.endUpdate())}},e.prototype.endTextInput=function(n){var o=this.textInputItem;delete this.textInputItem,this.control.eventManager.raiseTextInputEnd(o,n),this.control.endUpdate(),this.control.barManager.updateItemsState()},e.prototype.raiseTextInputPermissionsCheck=function(n){this.control.eventManager.raiseTextInputPermissionsCheck(this.textInputItem,n)},e.prototype.applyTextInput=function(n,o){if(this.canFinishTextEditing(n)){var r=this.textInputItem,a=this.textInputPosition;this.endTextInput(o),r instanceof u.Shape?r.text!==n&&this.control.history.addAndRedo(new m.ChangeShapeTextHistoryItem(r,n)):r instanceof s.Connector&&r.getText(a)!==n&&this.control.history.addAndRedo(new i.ChangeConnectorTextHistoryItem(r,a,n))}},e.prototype.canFinishTextEditing=function(n){var o=!0;if(this.isTextInputActive()){var r=n||this.getTextInputElementValue();this.textInputItem instanceof u.Shape?o=this.control.permissionsProvider.canApplyShapeTextChange(this.textInputItem,r):this.textInputItem instanceof s.Connector&&(o=this.control.permissionsProvider.canApplyConnectorTextChange(this.textInputItem,this.textInputPosition,r)),this.raiseTextInputPermissionsCheck(o)}return o},e.prototype.getTextInputElementValue=function(){return this.control.render?this.control.render.input.getTextInputElementValue():""},e.prototype.cancelTextInput=function(){this.raiseTextInputPermissionsCheck(!0),this.endTextInput(!0)},e.prototype.isTextInputActive=function(){return this.textInputItem!==void 0},e.prototype.processDblClick=function(n){if(n.source.type===P.MouseEventElementType.Shape){var o=this.control.model.findShape(n.source.key);this.startTextInput(o)}else if(n.source.type===P.MouseEventElementType.Connector){var r=(a=this.control.model.findConnector(n.source.key)).getTextPositionByPoint(n.modelPoint);this.startTextInput(a,r)}else if(n.source.type===P.MouseEventElementType.ConnectorText){var a=this.control.model.findConnector(n.source.key);r=parseFloat(n.source.value),this.startTextInput(a,r)}},e.prototype.onDblClick=function(n){var o=this;setTimeout(function(){o.processDblClick(n)},10)},e.prototype.onKeyDown=function(n){this.isTextInputActive()&&(n.keyCode===13&&this.hasCtrlModifier(n.modifiers)&&(n.preventDefault=!0,this.applyTextInput(n.inputText,!0)),n.keyCode===27&&this.cancelTextInput())},e.prototype.onBlur=function(n){this.isTextInputActive()&&this.applyTextInput(n.inputText)},e.prototype.onFocus=function(n){},e.prototype.hasCtrlModifier=function(n){return(n&p.ModifierKey.Ctrl)>0},e}();h.TextInputHandler=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ContextMenuTouchHandler=void 0;var p=d(11),u=d(154),s=d(4),i=function(t){function e(n){var o=t.call(this)||this;return o.selection=n,o.contextToolboxVisible=!1,o.selection.onChanged.add(o),o}return P(e,t),e.prototype.onMouseDown=function(n){n.source.key===void 0&&this.hideContextMenu()},e.prototype.onMouseUp=function(n){},e.prototype.onFocus=function(n){var o=this;setTimeout(function(){o.showContextMenuAtSelection()},1)},e.prototype.onBlur=function(n){var o=this;setTimeout(function(){o.hideContextMenu()},1)},e.prototype.onTextInputFocus=function(n){var o=this;setTimeout(function(){o.hideContextMenu()},1)},e.prototype.onTextInputBlur=function(n){var o=this;setTimeout(function(){o.showContextMenuAtSelection()},1)},e.prototype.onLongTouch=function(n){n.source.type===p.MouseEventElementType.Document&&this.showContextMenuAtEmptySelection(n.modelPoint)},e.prototype.onKeyDown=function(n){},e.prototype.onShortcut=function(n){},e.prototype.getSelectedItems=function(){return this.selection.getSelectedItems(!0)},e.prototype.showContextMenuAtSelection=function(){if(!this.contextToolboxVisible){var n=this.getSelectedItems();n.length!==0&&this.showContextMenu(void 0,s.ModelUtils.createRectangle(n).createPosition())}},e.prototype.showContextMenuAtEmptySelection=function(n){this.contextToolboxVisible||this.getSelectedItems().length===0&&this.showContextMenu(void 0,n)},e.prototype.notifyDragStart=function(n){this.hideContextMenu()},e.prototype.notifyDragEnd=function(n){this.showContextMenuAtSelection()},e.prototype.notifySelectionChanged=function(n){this.isUpdateLocked()?this.registerOccurredEvent(1):this.raiseSelectionChanged()},e.prototype.raiseSelectionChanged=function(){this.getSelectedItems().length!==0?this.showContextMenuAtSelection():this.hideContextMenu()},e.prototype.onUpdateUnlocked=function(n){1&n&&this.raiseSelectionChanged()},e.prototype.notifyShowContextToolbox=function(n,o,r,a,c){this.contextToolboxVisible=!0,this.hideContextMenu()},e.prototype.notifyHideContextToolbox=function(){this.contextToolboxVisible=!1,this.showContextMenuAtSelection()},e}(u.ContextMenuHandler);h.ContextMenuTouchHandler=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectionTargetVisualizer=h.ConnectionTargetInfo=void 0;var p=d(156),u=function(){return function(i,t){this.rect=i,this.strokeWidth=t,this.allowed=!0}}();h.ConnectionTargetInfo=u;var s=function(i){function t(e){return i.call(this,e)||this}return P(t,i),t.prototype.raiseShow=function(){var e=this,n=new u(this.targetRect,this.targetStrokeWidth);this.dispatcher.raise1(function(o){return o.notifyConnectionTargetShow(e.key,n)})},t.prototype.raiseHide=function(){this.dispatcher.raise1(function(e){return e.notifyConnectionTargetHide()})},t}(p.TargetVisualizerBase);h.ConnectionTargetVisualizer=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ContainerTargetVisualizer=h.ContainerTargetInfo=void 0;var p=d(156),u=function(){return function(i,t){this.rect=i,this.strokeWidth=t}}();h.ContainerTargetInfo=u;var s=function(i){function t(e){return i.call(this,e)||this}return P(t,i),t.prototype.raiseShow=function(){var e=this,n=new u(this.targetRect,this.targetStrokeWidth);this.dispatcher.raise1(function(o){return o.notifyContainerTargetShow(e.key,n)})},t.prototype.raiseHide=function(){this.dispatcher.raise1(function(e){return e.notifyContainerTargetHide()})},t}(p.TargetVisualizerBase);h.ContainerTargetVisualizer=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectionPointsVisualizer=h.ConnectionPointInfo=void 0;var m=function(){return function(p,u){this.point=p,this.side=u,this.allowed=!0}}();h.ConnectionPointInfo=m;var P=function(){function p(u){this.dispatcher=u}return p.prototype.getKey=function(){return this.key},p.prototype.setPoints=function(u,s,i,t){this.key===u&&this.pointIndex===i||(this.key=u,this.points=s,this.pointIndex=i,this.outsideRectangle=t,this.raiseShow())},p.prototype.setPointIndex=function(u){0<=u&&u<this.points.length&&this.pointIndex!==u&&(this.pointIndex=u,this.raiseShow())},p.prototype.update=function(){this.raiseShow()},p.prototype.reset=function(){this.key!=="-1"&&(this.key="-1",this.points=[],this.pointIndex=-1,this.outsideRectangle=void 0,this.raiseHide())},p.prototype.raiseShow=function(){var u=this;this.dispatcher.raise1(function(s){return s.notifyConnectionPointsShow(u.key,u.points,u.pointIndex,u.outsideRectangle)})},p.prototype.raiseHide=function(){this.dispatcher.raise1(function(u){return u.notifyConnectionPointsHide()})},p}();h.ConnectionPointsVisualizer=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ResizeInfoVisualizer=void 0;var m=function(){function P(p){this.dispatcher=p}return P.prototype.set=function(p,u){this.point=p,this.text=u,this.raiseShow()},P.prototype.reset=function(){this.point!==void 0&&(this.point=void 0,this.text=void 0,this.raiseHide())},P.prototype.raiseShow=function(){var p=this;this.dispatcher.raise1(function(u){return u.notifyResizeInfoShow(p.point,p.text)})},P.prototype.raiseHide=function(){this.dispatcher.raise1(function(p){return p.notifyResizeInfoHide()})},P}();h.ResizeInfoVisualizer=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.SelectionRectVisualizer=void 0;var m=function(){function P(p){this.dispatcher=p}return P.prototype.setRectangle=function(p){this.rect=p,this.raiseShow()},P.prototype.reset=function(){this.rect=void 0,this.raiseHide()},P.prototype.raiseShow=function(){var p=this;this.dispatcher.raise1(function(u){return u.notifySelectionRectShow(p.rect)})},P.prototype.raiseHide=function(){this.dispatcher.raise1(function(p){return p.notifySelectionRectHide()})},P}();h.SelectionRectVisualizer=m},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.VisualizerTouchManager=void 0;var p=d(155),u=d(11),s=function(i){function t(e,n,o,r,a){a===void 0&&(a=r.readOnly);var c=i.call(this,e,n,o,r,a)||this;return e.onChanged.add(c),c}return P(t,i),t.prototype.onBlur=function(e){var n=this;setTimeout(function(){n.hideConnections()},1)},t.prototype.onFocus=function(e){var n=this;setTimeout(function(){n.showConnections()},1)},t.prototype.hideConnections=function(){this.readOnly||this.resetConnectionPoints()},t.prototype.showConnections=function(){if(!this.readOnly&&this.needShowConnections()){var e=this.selection.getSelectedShapes();e.length===1&&this.setConnectionPoints(e[0],u.MouseEventElementType.ShapeConnectionPoint,-1,!e[0].allowResizeHorizontally&&!e[0].allowResizeVertically||e[0].isLocked)}},t.prototype.needShowConnections=function(){var e=this.selection.getSelectedItems(),n=this.selection.getSelectedShapes();return e.length===1&&n.length===1},t.prototype.notifySelectionChanged=function(e){this.isUpdateLocked()?this.registerOccurredEvent(1):this.raiseSelectionChanged()},t.prototype.raiseSelectionChanged=function(){this.needShowConnections()?this.showConnections():this.hideConnections()},t.prototype.onUpdateUnlocked=function(e){1&e&&this.raiseSelectionChanged()},t.prototype.notifyDragStart=function(e){this.hideConnections()},t.prototype.notifyDragEnd=function(e){this.showConnections()},t}(p.VisualizerManager);h.VisualizerTouchManager=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ContextToolboxHandler=void 0;var m=d(11),P=d(3),p=d(25),u=d(18),s=function(){function i(){this.contextToolboxVisible=!1,this.onVisibilityChanged=new P.EventDispatcher}return i.prototype.onMouseDown=function(t){t.source.type!==m.MouseEventElementType.Undefined&&this.hideContextToolbox()},i.prototype.onMouseUp=function(t){t.source.type===m.MouseEventElementType.Undefined&&u.Browser.TouchUI||this.hideContextToolbox()},i.prototype.onFocus=function(t){},i.prototype.onBlur=function(t){},i.prototype.onKeyDown=function(t){t.keyCode===p.KeyCode.Esc&&this.hideContextToolbox()},i.prototype.onShortcut=function(t){this.hideContextToolbox()},i.prototype.showContextToolbox=function(t,e,n,o,r,a){this.onVisibilityChanged.raise1(function(c){return c.notifyShowContextToolbox(t,e,n,o,r)}),this.contextToolboxVisible=!0,this.contextToolboxCancelCallback=a},i.prototype.hideContextToolbox=function(t){this.contextToolboxVisible&&(this.onVisibilityChanged.raise1(function(e){return e.notifyHideContextToolbox()}),this.contextToolboxCancelCallback&&(t||this.contextToolboxCancelCallback(),this.contextToolboxCancelCallback=void 0),this.contextToolboxVisible=!1)},i}();h.ContextToolboxHandler=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Selection=void 0;var m=d(3),P=d(333),p=d(14),u=d(6),s=d(44),i=function(){function t(e){this.onChanged=new m.EventDispatcher,this.inputPosition=new P.InputPosition(this),this.onChanged.add(this.inputPosition),this.initialize(e)}return t.prototype.initialize=function(e){this.model=e,this.keys=[],this.inputPosition.initialize()},t.prototype.add=function(e){this.keys.indexOf(e)<0&&(this.keys.push(e),this.raiseSelectionChanged())},t.prototype.remove=function(e){this.keys.indexOf(e)>=0&&(this.keys.splice(this.keys.indexOf(e),1),this.raiseSelectionChanged())},t.prototype.clear=function(){this.keys.length>0&&(this.keys=[],this.raiseSelectionChanged())},t.prototype.set=function(e,n){!n&&s.Data.ArrayEqual(e,this.keys)||(this.keys=e,this.raiseSelectionChanged())},t.prototype.getKeys=function(){return this.keys},t.prototype.getKey=function(e){return this.keys[e]},t.prototype.getSelectedItemsInsideContainers=function(e){var n=this,o=e.slice();return e.forEach(function(r){r instanceof p.Shape&&n.getSelectedItemsInsideContainers(n.model.getChildren(r)).forEach(function(a){o.indexOf(a)!==-1||n.hasKey(a.key)||o.push(a)})}),o},t.prototype.getSelectedItemsCore=function(e){var n=this;return this.keys.map(function(o){return n.model.findItem(o)}).filter(function(o){return o&&(e||!o.isLocked)})},t.prototype.getSelectedItems=function(e,n){return n?this.getSelectedItemsInsideContainers(this.getSelectedItemsCore(e)):this.getSelectedItemsCore(e)},t.prototype.getSelectedShapes=function(e,n){var o=this;if(n){var r=this.getSelectedItemsCore(e);return this.getSelectedItemsInsideContainers(r).map(function(a){return a instanceof p.Shape?a:void 0}).filter(function(a){return a})}return this.keys.map(function(a){return o.model.findShape(a)}).filter(function(a){return a&&(e||!a.isLocked)})},t.prototype.getSelectedConnectors=function(e,n){var o=this;if(n){var r=this.keys.map(function(a){return o.model.findItem(a)});return this.getSelectedItemsInsideContainers(r).map(function(a){return a instanceof u.Connector?a:void 0}).filter(function(a){return a&&(e||!a.isLocked)})}return this.keys.map(function(a){return o.model.findConnector(a)}).filter(function(a){return a&&(e||!a.isLocked)})},t.prototype.hasKey=function(e){return this.keys.indexOf(e)>=0},t.prototype.isEmpty=function(e){return!this.getSelectedItems(e).length},t.prototype.selectRect=function(e){var n=[];this.model.iterateItems(function(o){o.intersectedByRect(e)&&n.push(o.key)}),this.set(n)},t.prototype.raiseSelectionChanged=function(){this.onChanged.raise("notifySelectionChanged",this)},t}();h.Selection=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.InputPosition=void 0;var m=d(334),P=d(44),p=function(){function u(s){this.selection=s,this.initialProperties=new m.InputPositionProperties(this.selection),this.defaultProperties=new m.InputPositionProperties(this.selection,this.initialProperties,!0),this.currentProperties=new m.InputPositionProperties(this.selection,this.defaultProperties)}return u.prototype.initialize=function(){this.reset(),this.defaultProperties.reset()},u.prototype.reset=function(){this.currentProperties.reset()},u.prototype.getDefaultConnectorProperties=function(){return this.defaultProperties.getConnectorProperties()},u.prototype.getDefaultConnectorPropertyValue=function(s){return this.defaultProperties.getConnectorPropertyValue(s)},u.prototype.getCurrentConnectorPropertyValue=function(s){return this.currentProperties.getConnectorPropertyValue(s)},u.prototype.setConnectorPropertyValue=function(s,i){this.currentProperties.setConnectorPropertyValue(s,i),this.selection.isEmpty(!0)&&this.defaultProperties.setConnectorPropertyValue(s,i)},u.prototype.setInitialConnectorProperties=function(s){for(var i in this.defaultProperties.reset(),this.currentProperties.reset(),s)Object.prototype.hasOwnProperty.call(s,i)&&this.initialProperties.setConnectorPropertyValue(i,s[i])},u.prototype.getDefaultStyle=function(){return this.defaultProperties.getStyle()},u.prototype.getDefaultStylePropertyValue=function(s){return this.defaultProperties.getStylePropertyValue(s)},u.prototype.getDefaultTextStyle=function(){return this.defaultProperties.getTextStyle()},u.prototype.getDefaultTextStylePropertyValue=function(s){return this.defaultProperties.getTextStylePropertyValue(s)},u.prototype.getCurrentStylePropertyValue=function(s){return this.currentProperties.getStylePropertyValue(s)},u.prototype.getCurrentTextStylePropertyValue=function(s){return this.currentProperties.getTextStylePropertyValue(s)},u.prototype.setStylePropertyValue=function(s,i){this.currentProperties.setStylePropertyValue(s,i),this.selection.isEmpty(!0)&&this.defaultProperties.setStylePropertyValue(s,i)},u.prototype.setTextStylePropertyValue=function(s,i){this.currentProperties.setTextStylePropertyValue(s,i),this.selection.isEmpty(!0)&&this.defaultProperties.setTextStylePropertyValue(s,i)},u.prototype.setInitialStyleProperties=function(s){this.defaultProperties.reset(),this.currentProperties.reset();var i=typeof s=="string"?P.Data.cssTextToObject(s):s;for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&this.initialProperties.setStylePropertyValue(t,i[t])},u.prototype.setInitialTextStyleProperties=function(s){this.defaultProperties.reset(),this.currentProperties.reset();var i=typeof s=="string"?P.Data.cssTextToObject(s):s;for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&this.initialProperties.setTextStylePropertyValue(t,i[t])},u.prototype.notifySelectionChanged=function(s){this.reset()},u}();h.InputPosition=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.InputPositionProperties=void 0;var m=d(32),P=d(26),p=function(){function u(s,i,t){this.selection=s,this.baseProperties=i,this.disableMergingStyles=t,this.selection=s}return u.prototype.reset=function(){this.connectorProperties=null,this.style=null,this.textStyle=null},u.prototype.getConnectorProperties=function(){return this.connectorProperties||(this.connectorProperties=this.baseProperties?this.baseProperties.getConnectorProperties().clone():new m.ConnectorProperties,this.updateConnectorProperties(this.connectorProperties)),this.connectorProperties},u.prototype.getConnectorPropertyValue=function(s){return this.getConnectorProperties()[s]},u.prototype.setConnectorPropertyValue=function(s,i){this.getConnectorProperties()[s]=i},u.prototype.getStyle=function(){return this.style||(this.style=this.baseProperties?this.baseProperties.getStyle().clone():new P.Style,this.disableMergingStyles||this.updateStyle(this.style,"style")),this.style},u.prototype.getStylePropertyValue=function(s){return this.getStyle()[s]},u.prototype.setStylePropertyValue=function(s,i){this.getStyle()[s]=i},u.prototype.getTextStyle=function(){return this.textStyle||(this.textStyle=this.baseProperties?this.baseProperties.getTextStyle().clone():new P.TextStyle,this.disableMergingStyles||this.updateStyle(this.textStyle,"styleText")),this.textStyle},u.prototype.getTextStylePropertyValue=function(s){return this.getTextStyle()[s]},u.prototype.setTextStylePropertyValue=function(s,i){this.getTextStyle()[s]=i},u.prototype.updateConnectorProperties=function(s){var i=this,t=this.selection.getSelectedConnectors(!0);s.forEach(function(e){i.updatePropertyValue(s,t,function(n){return n.properties},e)})},u.prototype.updateStyle=function(s,i){var t=this,e=this.selection.getSelectedItems(!0);s.forEach(function(n){t.updatePropertyValue(s,e,function(o){return o[i]},n)})},u.prototype.updatePropertyValue=function(s,i,t,e){var n,o=!1;i.forEach(function(r){var a=t(r)[e];if(n===void 0&&a!==void 0)n=a,o=!0;else if(o&&n!==a)return void(n=void 0)}),o&&(s[e]=n)},u}();h.InputPositionProperties=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.History=void 0;var m=d(8),P=d(3),p=function(){function u(s,i){this.modelManipulator=s,this.diagram=i,this.historyItems=[],this.currentIndex=-1,this.incrementalId=-1,this.transactionLevel=-1,this.unmodifiedIndex=-1,this.currTransactionId=0,this.onChanged=new P.EventDispatcher}return u.prototype.isModified=function(){if(this.unmodifiedIndex===this.currentIndex)return!1;for(var s=Math.min(this.unmodifiedIndex,this.currentIndex),i=Math.max(this.unmodifiedIndex,this.currentIndex),t=s+1;t<=i;t++)if(this.historyItems[t].changeModified())return!0;return!1},u.prototype.undo=function(){this.canUndo()&&(this.historyItems[this.currentIndex].undo(this.modelManipulator),this.currentIndex--,this.raiseChanged())},u.prototype.redo=function(){this.canRedo()&&(this.startDataSyncItem&&(this.startDataSyncItem.undo(this.modelManipulator),this.startDataSyncItem=void 0),this.currentIndex++,this.historyItems[this.currentIndex].redo(this.modelManipulator),this.raiseChanged())},u.prototype.canUndo=function(){return this.currentIndex>=0},u.prototype.canRedo=function(){return this.currentIndex<this.historyItems.length-1},u.prototype.beginTransaction=function(){return this.transactionLevel++,this.transactionLevel===0&&(this.transaction=new m.CompositionHistoryItem),this.currTransactionId++},u.prototype.endTransaction=function(s){if(!(--this.transactionLevel>=0)){var i=this.transaction.historyItems.length;if(i>0){var t=i>1?this.transaction:this.transaction.historyItems.pop();s?this.addDataSyncItem(t):this.addInternal(t)}i>0&&!s&&this.raiseChanged(),delete this.transaction}},u.prototype.addAndRedo=function(s){this.add(s),s.redo(this.modelManipulator),this.raiseChanged()},u.prototype.add=function(s){this.transactionLevel>=0?this.transaction.add(s):this.addInternal(s)},u.prototype.addInternal=function(s){this.currentIndex<this.historyItems.length-1&&(this.historyItems.splice(this.currentIndex+1),this.unmodifiedIndex=Math.min(this.unmodifiedIndex,this.currentIndex)),this.historyItems.push(s),this.currentIndex++,this.deleteOldItems()},u.prototype.addDataSyncItem=function(s){var i=this.historyItems[this.currentIndex];if(i){var t=void 0;i instanceof m.CompositionHistoryItem?t=i:(this.historyItems.splice(this.currentIndex,1),t=new m.CompositionHistoryItem,this.historyItems.push(t),t.historyItems.push(i)),t.dataSyncItems.push(s)}else this.historyItems.length&&(this.startDataSyncItem=s)},u.prototype.deleteOldItems=function(){var s=this.historyItems.length-u.MAX_HISTORY_ITEM_COUNT;s>0&&this.currentIndex>s&&(this.historyItems.splice(0,s),this.currentIndex-=s)},u.prototype.getNextId=function(){return this.incrementalId++,this.incrementalId},u.prototype.clear=function(){this.currentIndex=-1,this.unmodifiedIndex=-1,this.incrementalId=-1,this.historyItems=[],delete this.transaction,this.transactionLevel=-1},u.prototype.resetModified=function(){this.unmodifiedIndex=this.currentIndex},u.prototype.getCurrentItemId=function(){if(this.currentIndex===-1)return-1;var s=this.historyItems[this.currentIndex];return s.uniqueId===-1&&(s.uniqueId=this.getNextId()),s.uniqueId},u.prototype.undoTransaction=function(){this.diagram.beginUpdateCanvas();for(var s=this.transaction.historyItems;s.length;)s.pop().undo(this.modelManipulator);this.diagram.endUpdateCanvas()},u.prototype.undoTransactionTo=function(s){this.diagram.beginUpdateCanvas();for(var i=this.transaction.historyItems;i.length;){var t=i.pop();if(t.undo(this.modelManipulator),t===s)return}this.diagram.endUpdateCanvas()},u.prototype.raiseChanged=function(){this.transactionLevel===-1&&this.onChanged.raise("notifyHistoryChanged")},u.MAX_HISTORY_ITEM_COUNT=100,u}();h.History=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.BarManager=void 0;var p=function(u){function s(i){var t=u.call(this)||this;return t.bars=[],t.control=i,t}return P(s,u),s.prototype.clean=function(){var i=this;this.bars.forEach(function(t){return t.onChanged.remove(i)}),this.bars=[]},s.prototype.registerBar=function(i){this.bars.push(i),i.onChanged.add(this),this.updateBarItemsState(i)},s.prototype.updateItemsState=function(i){if(!this.isUpdateLocked())for(var t=0,e=void 0;e=this.bars[t];t++)this.updateBarItemsState(e,i)},s.prototype.updateBarItemsState=function(i,t){if(!this.isUpdateLocked()){if(this.control.permissionsProvider.beginUpdateUI(),i.isVisible()){var e=void 0;if(t){var n=i.getCommandKeys().reduce(function(a,c){return a[c]=!0,a},{});e=t.filter(function(a){return n[a]})}else e=i.getCommandKeys();for(var o=e.length,r=0;r<o;r++)this.updateBarItem(i,e[r])}this.control.permissionsProvider.endUpdateUI()}},s.prototype.updateBarItem=function(i,t){var e=this.control.commandManager.getCommand(t);if(e){var n=e.getState();if(i.setItemVisible(t,n.visible),n.visible&&(i.setItemEnabled(t,n.enabled),!n.denyUpdateValue)){var o=this.getItemValue(n.value);n.items&&i.setItemSubItems(t,n.items),i.setItemValue(t,o,this.getDefaultItemValue(n.defaultValue))}}},s.prototype.setEnabled=function(i){for(var t=0,e=void 0;e=this.bars[t];t++)e.setEnabled(i)},s.prototype.notifyBarCommandExecuted=function(i,t){this.control.commandManager.getCommand(i).execute(t)||this.updateItemsState([i])},s.prototype.notifyBarUpdateRequested=function(){this.updateItemsState()},s.prototype.notifySelectionChanged=function(i){this.updateItemsState()},s.prototype.onUpdateUnlocked=function(i){},s.prototype.getItemValue=function(i){return i},s.prototype.getDefaultItemValue=function(i){return i},s}(d(81).BatchUpdatableObject);h.BarManager=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.RenderManager=h.DBL_CLICK_TIMEOUT=h.LONG_TOUCH_TIMEOUT=void 0;var m=d(11),P=d(65),p=d(27),u=d(0),s=d(25),i=d(18),t=d(17),e=d(78),n=d(338),o=d(28),r=d(339),a=d(340),c=d(342),l=d(158),y=d(344),g=d(79),f=d(15),v=d(100),C=d(3);h.LONG_TOUCH_TIMEOUT=500,h.DBL_CLICK_TIMEOUT=500;var b=function(){function S(x,I,w,_,T,R){this.moveLocked=!1,this.lockMouseMoveTimer=-1,this.lastClickElement=void 0,this.longTouchTimer=void 0,this.dblTouchTimer=void 0,this.pointers={};var E=f.RenderHelper.createMainElement(x),D=f.RenderHelper.createSvgElement(E);this.scroll=T||new n.NativeScrollView(x),this.measurer=w,this.dom=new v.DOMManipulator(this.measurer),this.view=new c.CanvasViewManager(this.scroll,D,_.modelSize,_.zoomLevel,_.autoZoom,_.simpleView,_.rectangle,this.dom),this.input=new r.InputManager(E,this.view,I,this.measurer,_.zoomLevel,R),this.items=new e.CanvasItemsManager(this.view.canvasElement,_.zoomLevel,this.dom),this.page=new a.CanvasPageManager(this.view.pageElement,_,this.dom),this.selection=new l.CanvasSelectionManager(this.view.canvasElement,_.zoomLevel,_.readOnly,this.dom),this.contextMenuEnabled=_.contextMenuEnabled,this.view.onViewChanged.add(this.page),this.view.onViewChanged.add(this.items),this.view.onViewChanged.add(this.selection),this.view.onViewChanged.add(this.input),this.autoScroll=new y.AutoScrollController(this.scroll,D,this.view,this.dom),this.attachEvents(D),this.mainElement=E,this.svgElement=D,this.events=I,this.notifyReadOnlyChanged(_.readOnly)}return S.prototype.clean=function(x){this.killLockMouseMoveTimer(),this.clearLastMouseDownEvent(),this.detachEvents(this.svgElement),this.scroll.detachEvents(),this.input.detachEvents(),this.dom.cancelAnimation(),x&&x(this.mainElement)},S.prototype.replaceParent=function(x,I){this.mainElement&&this.mainElement.parentNode!==x&&x.appendChild(this.mainElement),I&&I!==this.scroll&&(this.scroll&&this.scroll.detachEvents(),this.scroll=I),this.measurer instanceof g.TextMeasurer&&this.measurer.replaceParent(x)},S.prototype.update=function(x){this.view.adjust({horizontal:!x,vertical:!x}),this.page.redraw()},S.prototype.onNewModel=function(x){this.measurer.onNewModel(x,this.dom)},S.prototype.clear=function(){this.items.clear(),this.selection.clear()},S.prototype.attachPointerEvents=function(x){p.DomUtils.addClassName(x,"dxdi-touch-action"),f.RenderHelper.addEventListener(x,"pointerdown",this.onPointerDownHandler),f.RenderHelper.addEventListener(i.Browser.TouchUI?x:document,"pointerup",this.onPointerUpHandler),f.RenderHelper.addEventListener(i.Browser.TouchUI?x:document,"pointermove",this.onPointerMoveHandler),f.RenderHelper.addEventListener(x,"pointercancel",this.onPointerCancelHandler),f.RenderHelper.addEventListener(x,"pointerleave",this.onPointerLeaveHandler)},S.prototype.detachPointerEvents=function(x){f.RenderHelper.removeEventListener(x,"pointerdown",this.onPointerDownHandler),f.RenderHelper.removeEventListener(i.Browser.TouchUI?x:document,"pointerup",this.onPointerUpHandler),f.RenderHelper.removeEventListener(i.Browser.TouchUI?x:document,"pointermove",this.onPointerMoveHandler),f.RenderHelper.removeEventListener(x,"pointercancel",this.onPointerCancelHandler),f.RenderHelper.removeEventListener(x,"pointerleave",this.onPointerLeaveHandler),p.DomUtils.removeClassName(x,"dxdi-touch-action")},S.prototype.attachMouseTouchEvents=function(x){f.RenderHelper.addEventListener(x,this.mouseDownEventName,this.onMouseDownHandler),f.RenderHelper.addEventListener(document,this.mouseMoveEventName,this.onMouseMoveHandler),f.RenderHelper.addEventListener(document,this.mouseUpEventName,this.onMouseUpHandler)},S.prototype.detachMouseTouchEvents=function(x){f.RenderHelper.removeEventListener(x,this.mouseDownEventName,this.onMouseDownHandler),f.RenderHelper.removeEventListener(document,this.mouseMoveEventName,this.onMouseMoveHandler),f.RenderHelper.removeEventListener(document,this.mouseUpEventName,this.onMouseUpHandler)},S.prototype.attachEvents=function(x){this.mouseDownEventName=i.Browser.TouchUI?"touchstart":"mousedown",this.mouseMoveEventName=i.Browser.TouchUI?"touchmove":"mousemove",this.mouseUpEventName=i.Browser.TouchUI?"touchend":"mouseup",this.onPointerDownHandler=this.onPointerDown.bind(this),this.onPointerUpHandler=this.onPointerUp.bind(this),this.onPointerMoveHandler=this.onPointerMove.bind(this),this.onPointerCancelHandler=this.onPointerCancel.bind(this),this.onPointerLeaveHandler=this.onPointerLeave.bind(this),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onMouseEnterHandler=this.onMouseEnter.bind(this),this.onMouseLeaveHandler=this.onMouseLeave.bind(this),this.onMouseWheelHandler=this.onMouseWheel.bind(this),this.onMouseDblClickHandler=this.onMouseDblClick.bind(this),this.onContextMenuHandler=this.onContextMenu.bind(this),this.onMouseMoveHandler=this.onMouseMove.bind(this),this.onMouseUpHandler=this.onMouseUp.bind(this),this.onWindowResizelHandler=this.onWindowResize.bind(this),this.onOrientationChangeHandler=this.onOrientationChange.bind(this),this.onMouseClickHandler=this.onMouseClick.bind(this),C.EventUtils.isPointerEvents()?this.attachPointerEvents(x):(this.attachMouseTouchEvents(x),f.RenderHelper.addEventListener(x,"mouseenter",this.onMouseEnterHandler),f.RenderHelper.addEventListener(x,"mouseleave",this.onMouseLeaveHandler)),f.RenderHelper.addEventListener(x,"wheel",this.onMouseWheelHandler),f.RenderHelper.addEventListener(x,"dblclick",this.onMouseDblClickHandler),f.RenderHelper.addEventListener(x,"click",this.onMouseClickHandler),f.RenderHelper.addEventListener(x,"contextmenu",this.onContextMenuHandler),f.RenderHelper.addEventListener(window,"resize",this.onWindowResizelHandler),f.RenderHelper.addEventListener(window,"orientationchange",this.onOrientationChangeHandler),this.input.mouseWheelHandler=this.onMouseWheelHandler},S.prototype.detachEvents=function(x){C.EventUtils.isPointerEvents()?this.detachPointerEvents(x):(this.detachMouseTouchEvents(x),f.RenderHelper.removeEventListener(x,"mouseenter",this.onMouseEnterHandler),f.RenderHelper.removeEventListener(x,"mouseleave",this.onMouseLeaveHandler)),f.RenderHelper.removeEventListener(x,"wheel",this.onMouseWheelHandler),f.RenderHelper.removeEventListener(x,"dblclick",this.onMouseDblClickHandler),f.RenderHelper.removeEventListener(x,"contextmenu",this.onContextMenuHandler),f.RenderHelper.removeEventListener(x,"click",this.onMouseClickHandler),f.RenderHelper.removeEventListener(window,"resize",this.onWindowResizelHandler),f.RenderHelper.removeEventListener(window,"orientationchange",this.onOrientationChangeHandler)},S.prototype.setPointerPosition=function(x){this.pointers[x.pointerId]={clientX:x.clientX,clientY:x.clientY}},S.prototype.clearPointerPosition=function(x){delete this.pointers[x.pointerId]},S.prototype.onPointerDown=function(x){this.setPointerPosition(x),this.getPointerCount()>2&&(this.pointers={}),this.onMouseDown(x)},S.prototype.onPointerUp=function(x){this.clearPointerPosition(x),this.onMouseUp(x)},S.prototype.onPointerMove=function(x){(i.Browser.TouchUI&&!C.EventUtils.isMousePointer(x)||C.EventUtils.isLeftButtonPressed(x))&&this.setPointerPosition(x),this.onMouseMove(x)},S.prototype.onPointerCancel=function(x){this.clearPointerPosition(x)},S.prototype.onPointerLeave=function(x){C.EventUtils.isMousePointer(x)&&this.onMouseLeave(x),this.clearPointerPosition(x)},S.prototype.onMouseDown=function(x){var I=this;this.lockMouseMove(),this.input.lockFocus(),this.autoScroll.onMouseDown(x),this.lastDownMouseEvent=this.createDiagramMouseEvent(x),t.raiseEvent(x,this.lastDownMouseEvent,function(T){return I.events.onMouseDown(T)}),this.events.canFinishTextEditing()&&this.input.captureFocus(),C.EventUtils.isTouchEvent(x)&&this.processTouchDown(x);var w=P.EvtUtils.getEventSource(x),_=w&&w.tagName;if(i.Browser.TouchUI||_.toLowerCase()==="img"||_.toLowerCase()==="image")return P.EvtUtils.preventEventAndBubble(x),!1},S.prototype.onMouseMove=function(x){var I=this;this.moveLocked||(this.autoScroll.onMouseMove(x,function(){return I.onMouseMoveCore(x)}),this.onMouseMoveCore(x),i.Browser.IE&&this.lockMouseMove(),C.EventUtils.isTouchEvent(x)&&this.processTouchMove(x))},S.prototype.onMouseMoveCore=function(x){var I=this;t.raiseEvent(x,this.createDiagramMouseEvent(x),function(w){return I.events.onMouseMove(w)})},S.prototype.onMouseUp=function(x){var I=this;this.lockMouseMove();var w=this.createDiagramMouseEvent(x);t.raiseEvent(x,w,function(_){return I.events.onMouseUp(_)}),this.autoScroll.onMouseUp(x),w.source.type!==m.MouseEventElementType.Undefined&&this.input.captureFocus(!0),C.EventUtils.isTouchEvent(x)&&this.processTouchUp(x)},S.prototype.onMouseEnter=function(x){var I=this;this.autoScroll.onMouseEnter(x),t.raiseEvent(x,this.createDiagramMouseEvent(x),function(w){return I.events.onMouseEnter(w)})},S.prototype.onMouseLeave=function(x){var I=this;t.raiseEvent(x,this.createDiagramMouseEvent(x),function(w){return I.events.onMouseLeave(w)})},S.prototype.onMouseDblClick=function(x){var I=this;t.raiseEvent(x,this.createDiagramMouseEvent(x),function(w){return I.events.onDblClick(w)})},S.prototype.onMouseClick=function(x){var I=this;C.EventUtils.isTouchEvent(x)?C.EventUtils.isMousePointer(x)||this.input.captureFocus():t.raiseEvent(x,this.createActualMouseClickEvent(x),function(w){return I.events.onClick(w)})},S.prototype.createActualMouseClickEvent=function(x){return this.lastDownMouseEvent?new m.DiagramMouseEvent(this.lastDownMouseEvent.modifiers,this.lastDownMouseEvent.button,this.lastDownMouseEvent.offsetPoint.clone(),this.lastDownMouseEvent.modelPoint.clone(),this.lastDownMouseEvent.source,this.createDiagramMouseEventTouches(x)):this.createDiagramMouseEvent(x)},S.prototype.onContextMenu=function(x){var I=this;if(this.contextMenuEnabled)return t.raiseEvent(x,this.createDiagramContextMenuEvent(x),function(w){return I.events.onContextMenu(w)}),this.input.captureFocus(),P.EvtUtils.preventEventAndBubble(x)},S.prototype.processTouchDown=function(x){var I=this;this.touchDownPoint=this.getTouchPointFromEvent(x),this.resetLongTouch(),this.longTouchTimer=setTimeout(function(){t.raiseEvent(x,I.createDiagramMouseEvent(x),function(w){return I.events.onLongTouch(w)}),I.resetLongTouch(),I.resetDblClick()},h.LONG_TOUCH_TIMEOUT)},S.prototype.processTouchMove=function(x){var I=this.getTouchPointFromEvent(x);this.touchDownPoint&&I&&(Math.abs(this.touchDownPoint.x-I.x)>S.touchPositionLimit||Math.abs(this.touchDownPoint.y-I.y)>S.touchPositionLimit)&&(this.resetLongTouch(),this.resetDblClick())},S.prototype.getPointers=function(){var x=this;return Object.keys(this.pointers).map(function(I){return x.pointers[I]})},S.prototype.getPointerCount=function(){return Object.keys(this.pointers).length},S.prototype.getTouchPointFromEvent=function(x){var I,w=x.touches;if(w&&w.length>0)I=new u.Point(w[0].clientX,w[0].clientY);else{var _=this.getPointers();_.length&&(I=new u.Point(_[0].clientX,_[0].clientY))}return I},S.prototype.processTouchUp=function(x){var I=this;if(this.longTouchTimer!==void 0){t.raiseEvent(x,this.createDiagramMouseEvent(x),function(_){return I.events.onClick(_)});var w=P.EvtUtils.getEventSource(x);this.dblTouchTimer!==void 0&&this.lastClickElement===w?(t.raiseEvent(x,this.createDiagramMouseEvent(x),function(_){return I.events.onDblClick(_)}),this.resetDblClick()):(this.resetDblClick(),this.dblTouchTimer=setTimeout(function(){return I.dblTouchTimer=void 0},h.DBL_CLICK_TIMEOUT)),this.lastClickElement=w}this.resetLongTouch(),this.touchDownPoint=void 0},S.prototype.resetLongTouch=function(){this.longTouchTimer!==void 0&&clearTimeout(this.longTouchTimer),this.longTouchTimer=void 0},S.prototype.resetDblClick=function(){this.dblTouchTimer!==void 0&&clearTimeout(this.dblTouchTimer),this.dblTouchTimer=void 0},S.prototype.onOrientationChange=function(){var x=this;setTimeout(function(){return x.onWindowResize()},100)},S.prototype.onWindowResize=function(){var x={horizontal:!1,vertical:!1};if(this.view.autoZoom!==o.AutoZoomMode.Disabled)x.horizontal=!0,x.vertical=!0;else{var I=this.view.checkFitToCanvas(),w=this.view.checkFitToCanvas(this.scroll.getSize());x={horizontal:I.horizontal!==w.horizontal||w.horizontal,vertical:I.vertical!==w.vertical||w.vertical}}this.view.adjust(x)},S.prototype.onMouseWheel=function(x){var I=this;t.raiseEvent(x,this.createDiagramWheelEvent(x),function(w){return I.events.onMouseWheel(w)})},S.prototype.notifyModelSizeChanged=function(x,I){this.view.notifyModelSizeChanged(x,I)},S.prototype.notifyModelRectangleChanged=function(x){this.view.notifyModelRectangleChanged(x)},S.prototype.notifyReadOnlyChanged=function(x){p.DomUtils.toggleClassName(this.mainElement,"dxdi-read-only",x)},S.prototype.notifyDragStart=function(x){},S.prototype.notifyDragEnd=function(x){},S.prototype.notifyDragScrollStart=function(){this.autoScroll.onDragScrollStart()},S.prototype.notifyDragScrollEnd=function(){this.autoScroll.onDragScrollEnd()},S.prototype.notifyToolboxDragStart=function(x){this.onMouseEnter(x)},S.prototype.notifyToolboxDragEnd=function(x){x&&C.EventUtils.isPointerEvents()&&this.onMouseUp(x)},S.prototype.notifyToolboxDraggingMouseMove=function(x){this.onMouseMove(x)},S.prototype.createDiagramMouseEvent=function(x){var I=s.KeyUtils.getKeyModifiers(x),w=function(L){return i.Browser.MSTouchUI?L.button!==2:C.EventUtils.isLeftButtonPressed(L)}(x)?m.MouseButton.Left:m.MouseButton.Right,_=this.getOffsetPointByEvent(x),T=this.getModelPoint(_),R=C.EventUtils.isTouchEvent(x),E=this.getEventSource(x,R),D=this.createDiagramMouseEventTouches(x);return new m.DiagramMouseEvent(I,w,_,T,E,D,R)},S.prototype.createDiagramMouseEventTouches=function(x){var I=[];if(x.touches)for(var w=0;w<x.touches.length;w++){var _=x.touches[w].clientX,T=x.touches[w].clientY,R=this.getOffsetPointByEventPoint(_,T),E=this.getModelPoint(R);I.push(new m.DiagramMouseEventTouch(R,E))}else{var D=this.getPointers();for(w=0;w<D.length;w++)_=D[w].clientX,T=D[w].clientY,R=this.getOffsetPointByEventPoint(_,T),E=this.getModelPoint(R),I.push(new m.DiagramMouseEventTouch(R,E))}return I},S.prototype.createDiagramContextMenuEvent=function(x){var I=s.KeyUtils.getKeyModifiers(x),w=new u.Point(x.pageX,x.pageY),_=this.getOffsetPointByEvent(x),T=this.getModelPoint(_);return new m.DiagramContextMenuEvent(I,w,T)},S.prototype.createDiagramWheelEvent=function(x){var I=s.KeyUtils.getKeyModifiers(x),w=this.getOffsetPointByEvent(x),_=this.view.getModelPoint(w),T=this.getEventSource(x),R=x.deltaX||x.originalEvent&&x.originalEvent.deltaX,E=x.deltaY||x.originalEvent&&x.originalEvent.deltaY;return new m.DiagramWheelEvent(I,R,E,w,_,T)},S.prototype.getEventSource=function(x,I){var w=I?P.EvtUtils.getEventSourceByPosition(x):P.EvtUtils.getEventSource(x);if(this.isDiagramControl(w))for(;w&&!this.isDocumentContainer(w);){var _=t.RenderUtils.getElementEventData(w);if(_!==void 0)return _;if(this.input.isTextInputElement(w))return new m.MouseEventSource(m.MouseEventElementType.Document);w=w.parentNode}var T=new m.MouseEventSource(m.MouseEventElementType.Undefined);return w&&this.isDocumentContainer(w)&&(T.type=m.MouseEventElementType.Background),T},S.prototype.isDiagramControl=function(x){for(;x;){if(this.isDocumentContainer(x))return!0;x=x.parentNode}return!1},S.prototype.isDocumentContainer=function(x){return x===this.mainElement},S.prototype.lockMouseMove=function(){var x=this;this.moveLocked=!0,this.lockMouseMoveTimer=setTimeout(function(){x.moveLocked=!1,x.lockMouseMoveTimer=-1},10)},S.prototype.killLockMouseMoveTimer=function(){this.lockMouseMoveTimer!==-1&&(clearTimeout(this.lockMouseMoveTimer),this.lockMouseMoveTimer=-1)},S.prototype.clearLastMouseDownEvent=function(){this.lastDownMouseEvent=void 0},S.prototype.getModelPoint=function(x){return this.view.getModelPoint(x)},S.prototype.getOffsetPointByEvent=function(x){var I=P.EvtUtils.getEventX(x),w=P.EvtUtils.getEventY(x);return this.getOffsetPointByEventPoint(I,w)},S.prototype.getOffsetPointByEventPoint=function(x,I){var w=this.scroll.getScrollContainer(),_=p.DomUtils.getAbsolutePositionX(w),T=p.DomUtils.getAbsolutePositionY(w);return new u.Point(x-_,I-T)},S.prototype.getModelPointByEventPoint=function(x,I){var w=this.getOffsetPointByEventPoint(x,I);return this.view.getModelPoint(w)},S.prototype.getEventPointByModelPoint=function(x){var I=this.view.getAbsolutePoint(x),w=this.scroll.getScrollContainer();return new u.Point(p.DomUtils.getAbsolutePositionX(w)+I.x,p.DomUtils.getAbsolutePositionY(w)+I.y)},S.touchPositionLimit=4,S}();h.RenderManager=b},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.NativeScrollView=void 0;var m=d(3),P=d(2),p=d(0),u=d(27),s=d(15),i=function(){function t(e){this.onScroll=new m.EventDispatcher,this.scrollBarWidth=u.DomUtils.getVerticalScrollBarWidth(),this.mainElement=e,this.attachEvents()}return t.prototype.attachEvents=function(){var e=this;this.onScrollHandler=function(){return e.onScroll.raise1(function(n){return n.notifyScrollChanged(function(){return e.getScroll()})})},s.RenderHelper.addEventListener(this.mainElement,"scroll",this.onScrollHandler)},t.prototype.detachEvents=function(){s.RenderHelper.removeEventListener(this.mainElement,"scroll",this.onScrollHandler)},t.prototype.getScrollContainer=function(){return this.mainElement},t.prototype.setScroll=function(e,n){var o=this;this.mainElement.style.overflow="scroll",this.mainElement.scrollLeft=e,this.mainElement.scrollTop=n,this.mainElement.style.overflow="",this.onScroll.raise1(function(r){return r.notifyScrollChanged(function(){return o.getScroll()})})},t.prototype.offsetScroll=function(e,n){var o=this;e&&(this.mainElement.scrollLeft+=e),n&&(this.mainElement.scrollTop+=n),this.onScroll.raise1(function(r){return r.notifyScrollChanged(function(){return o.getScroll()})})},t.prototype.getScroll=function(){return new p.Point(this.mainElement.scrollLeft,this.mainElement.scrollTop)},t.prototype.getSize=function(){var e=this.mainElement.getBoundingClientRect();return new P.Size(Math.floor(e.width),Math.floor(e.height))},t.prototype.getScrollBarWidth=function(){return this.scrollBarWidth},t}();h.NativeScrollView=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.InputManager=void 0;var m=d(25),P=d(27),p=d(17),u=d(11),s=d(14),i=d(6),t=d(65),e=d(43),n=d(18),o=d(12),r=d(15),a=d(64),c=d(3),l=function(){function y(g,f,v,C,b,S){this.mainElement=g,this.layoutPointResolver=f,this.eventManager=v,this.textMeasurer=C,this.actualZoom=b,this.focusElementsParent=S,this.focused=!1,this.focusLocked=!1,this.createInputElements(this.mainElement,this.focusElementsParent)}return y.prototype.detachEvents=function(){this.detachInputElementEvents(),this.detachTextInputElementEvents()},y.prototype.isFocused=function(){return this.focused},y.prototype.captureFocus=function(g){g&&document.activeElement===this.textInputElement?c.HtmlFocusUtils.focusWithPreventScroll(this.textInputElement||this.inputElement):c.HtmlFocusUtils.focusWithPreventScroll(this.inputElement)},y.prototype.setClipboardData=function(g){this.clipboardInputElement.value=g,c.HtmlFocusUtils.focusWithPreventScroll(this.clipboardInputElement),this.clipboardInputElement.select(),document.execCommand("copy"),this.captureFocus()},y.prototype.getClipboardData=function(g){var f=this;navigator&&navigator.clipboard?navigator.clipboard.readText().then(function(v){g(v),f.captureFocus()}).catch(function(){g(""),f.captureFocus()}):n.Browser.IE&&(this.clipboardInputElement.value="",c.HtmlFocusUtils.focusWithPreventScroll(this.clipboardInputElement),this.clipboardInputElement.select(),document.execCommand("Paste"),g(this.clipboardInputElement.value),this.captureFocus())},y.prototype.isPasteSupportedByBrowser=function(){return n.Browser.IE||n.Browser.WebKitFamily&&navigator&&navigator.clipboard!==void 0},y.prototype.createInputElements=function(g,f){this.createFocusInputElement(f||g),this.createTextInputElement(g),this.createClipboardInputElement(f||g),this.attachInputElementEvents()},y.prototype.setInputElementFocusHandlerMode=function(g){this.textInputElementContainer.setAttribute("class","dxdi-text-input-container"),g&&this.captureFocus()},y.prototype.setInputElementTextInputMode=function(g,f,v,C,b,S){this.textInputElementContainer.setAttribute("class","dxdi-text-input-container "+b),this.textInputElement.value=g,this.setTextInputElementBounds(f,v,S),this.setTextInputElementStyle(C),this.updateTextInputPadding();var x=this.textInputElement||this.inputElement;c.HtmlFocusUtils.focusWithPreventScroll(x),x.select&&x.select()},y.prototype.setTextInputElementBounds=function(g,f,v){this.savedTextInputPosition=g,this.savedTextInputSize=f,this.savedTextInputAngle=v;var C=this.layoutPointResolver.getAbsolutePoint(g,!0);this.textInputElementContainer.style.left=C.x+"px",this.textInputElementContainer.style.top=C.y+"px",this.textInputElementContainer.style.width=f&&f.width+"px"||"0px",this.textInputElementContainer.style.height=f&&f.height+"px"||"0px";var b=[];this.textInputElementContainer.style.transform="",this.actualZoom!==1&&b.push("scale("+this.actualZoom+")"),v&&b.push("rotate("+v+"deg)"),this.textInputElementContainer.style.transform=b.join(" "),this.textInputElement.style.width=f&&f.width+"px"||"",this.textInputElement.style.height=f&&f.height+"px"||"auto"},y.prototype.setTextInputElementStyle=function(g){this.savedTextInputStyle=g,p.RenderUtils.applyStyleToElement(g,this.textInputElement)},y.prototype.createFocusInputElement=function(g){this.inputElement=document.createElement("textarea"),this.inputElement.readOnly=n.Browser.TouchUI,this.inputElement.setAttribute("class","dxdi-focus-input"),g.appendChild(this.inputElement)},y.prototype.attachInputElementEvents=function(){this.onInputBlurHandler=this.onInputBlur.bind(this),this.onInputFocusHandler=this.onInputFocus.bind(this),this.onInputKeyDownHandler=this.onInputKeyDown.bind(this),this.onInputKeyPressHandler=this.onInputKeyPress.bind(this),this.onInputKeyUpHandler=this.onInputKeyUp.bind(this),this.onPasteHandler=this.onPaste.bind(this),r.RenderHelper.addEventListener(this.inputElement,"blur",this.onInputBlurHandler),r.RenderHelper.addEventListener(this.inputElement,"focus",this.onInputFocusHandler),r.RenderHelper.addEventListener(this.inputElement,"keydown",this.onInputKeyDownHandler),r.RenderHelper.addEventListener(this.inputElement,"keypress",this.onInputKeyPressHandler),r.RenderHelper.addEventListener(this.inputElement,"keyup",this.onInputKeyUpHandler),r.RenderHelper.addEventListener(this.inputElement,"paste",this.onPasteHandler)},y.prototype.detachInputElementEvents=function(){r.RenderHelper.removeEventListener(this.inputElement,"blur",this.onInputBlurHandler),r.RenderHelper.removeEventListener(this.inputElement,"focus",this.onInputFocusHandler),r.RenderHelper.removeEventListener(this.inputElement,"keydown",this.onInputKeyDownHandler),r.RenderHelper.removeEventListener(this.inputElement,"keypress",this.onInputKeyPressHandler),r.RenderHelper.removeEventListener(this.inputElement,"keyup",this.onInputKeyUpHandler),r.RenderHelper.removeEventListener(this.inputElement,"paste",this.onPasteHandler)},y.prototype.createTextInputElement=function(g){this.textInputElementContainer=document.createElement("div"),this.textInputElementContainer.setAttribute("class","dxdi-text-input-container"),g.appendChild(this.textInputElementContainer),this.textInputElement=document.createElement("textarea"),this.textInputElement.setAttribute("class","dxdi-text-input"),this.attachTextInputElementEvents(),this.textInputElementContainer.appendChild(this.textInputElement)},y.prototype.attachTextInputElementEvents=function(){this.onTextInputBlurHandler=this.onTextInputBlur.bind(this),this.onTextInputFocusHandler=this.onTextInputFocus.bind(this),this.onTextInputKeyDownHandler=this.onTextInputKeyDown.bind(this),this.onTextInputMouseWheelHandler=this.onTextInputMouseWheel.bind(this),this.onTextInputMouseUpHandler=this.onTextInputMouseUp.bind(this),this.onTextInputKeyUpHandler=this.onTextInputKeyUp.bind(this),this.onTextInputChangeHandler=this.onTextInputChange.bind(this),r.RenderHelper.addEventListener(this.textInputElement,"mousewheel",this.onTextInputMouseWheelHandler),r.RenderHelper.addEventListener(this.textInputElement,"mouseup",this.onTextInputMouseUpHandler),r.RenderHelper.addEventListener(this.textInputElement,"blur",this.onTextInputBlurHandler),r.RenderHelper.addEventListener(this.textInputElement,"focus",this.onTextInputFocusHandler),r.RenderHelper.addEventListener(this.textInputElement,"keydown",this.onTextInputKeyDownHandler),r.RenderHelper.addEventListener(this.textInputElement,"keyup",this.onTextInputKeyUpHandler),r.RenderHelper.addEventListener(this.textInputElement,"change",this.onTextInputChangeHandler)},y.prototype.detachTextInputElementEvents=function(){r.RenderHelper.removeEventListener(this.textInputElement,"mousewheel",this.onTextInputMouseWheelHandler),r.RenderHelper.removeEventListener(this.textInputElement,"mouseup",this.onTextInputMouseUpHandler),r.RenderHelper.removeEventListener(this.textInputElement,"blur",this.onTextInputBlurHandler),r.RenderHelper.removeEventListener(this.textInputElement,"focus",this.onTextInputFocusHandler),r.RenderHelper.removeEventListener(this.textInputElement,"keydown",this.onTextInputKeyDownHandler),r.RenderHelper.removeEventListener(this.textInputElement,"keyup",this.onTextInputKeyUpHandler),r.RenderHelper.removeEventListener(this.textInputElement,"change",this.onTextInputChangeHandler)},y.prototype.createClipboardInputElement=function(g){this.clipboardInputElement=document.createElement("textarea"),this.clipboardInputElement.setAttribute("class","dxdi-clipboard-input"),g.appendChild(this.clipboardInputElement)},y.prototype.blurControl=function(){this.focusLocked||(this.focused=!1,P.DomUtils.removeClassName(this.mainElement,"focused"))},y.prototype.focusControl=function(){this.focused=!0,this.focusLocked=!1,P.DomUtils.addClassName(this.mainElement,"focused")},y.prototype.updateTextInputPadding=function(){var g=this.textInputElement.value;if(this.savedTextInputSize){v=this.textMeasurer.measureWords(g,this.savedTextInputStyle,e.TextOwner.Shape),C=a.getTextHeight(g,this.savedTextInputSize.width,v,!0);var f=Math.max(0,.5*(this.savedTextInputSize.height-C));this.textInputElement.style.paddingTop=Math.ceil(f)+"px",this.textInputElement.style.height=Math.floor(this.savedTextInputSize.height)+"px"}else{var v=this.textMeasurer.measureWords(" ",this.savedTextInputStyle,e.TextOwner.Connector),C=a.getLineHeight(v)*((a.textToParagraphs(g).length||1)+1);this.textInputElement.style.height=Math.ceil(C)+"px"}},y.prototype.onInputBlur=function(g){var f=this;this.blurControl(),p.raiseEvent(g,this.getDiagramFocusEvent(g),function(v){return f.eventManager.onBlur(v)})},y.prototype.onInputFocus=function(g){var f=this;this.focusControl(),p.raiseEvent(g,this.getDiagramFocusEvent(g),function(v){return f.eventManager.onFocus(v)})},y.prototype.onInputKeyDown=function(g){var f=this;p.raiseEvent(g,this.getDiagramKeyboardEvent(g),function(v){return f.eventManager.onKeyDown(v)})},y.prototype.onInputKeyPress=function(g){!g.preventDefault||n.Browser.Safari&&g.code==="KeyV"||g.preventDefault()},y.prototype.onInputKeyUp=function(g){var f=this;p.raiseEvent(g,this.getDiagramKeyboardEvent(g),function(v){return f.eventManager.onKeyUp(v)})},y.prototype.onTextInputBlur=function(g){var f=this;if(this.eventManager.canFinishTextEditing())this.blurControl(),p.raiseEvent(g,this.getDiagramFocusEvent(g),function(C){return f.eventManager.onTextInputBlur(C)});else{var v=t.EvtUtils.getEventSource(g);document.activeElement!==v&&v.focus()}},y.prototype.onTextInputFocus=function(g){var f=this;this.focusControl(),p.raiseEvent(g,this.getDiagramFocusEvent(g),function(v){return f.eventManager.onTextInputFocus(v)})},y.prototype.onTextInputKeyDown=function(g){var f=this;p.raiseEvent(g,this.getDiagramKeyboardEvent(g),function(v){return f.eventManager.onTextInputKeyDown(v)})},y.prototype.onTextInputKeyUp=function(g){this.updateTextInputPadding()},y.prototype.onTextInputChange=function(g){this.updateTextInputPadding()},y.prototype.onPaste=function(g){var f=this;p.raiseEvent(g,this.getDiagramClipboardEvent(g),function(v){return f.eventManager.onPaste(v)})},y.prototype.onTextInputMouseWheel=function(g){this.mouseWheelHandler&&this.mouseWheelHandler(g)},y.prototype.onTextInputMouseUp=function(g){g.stopPropagation&&g.stopPropagation(),t.EvtUtils.cancelBubble(g)},y.prototype.getDiagramKeyboardEvent=function(g){return new u.DiagramKeyboardEvent(m.KeyUtils.getKeyModifiers(g),m.KeyUtils.getEventKeyCode(g),this.textInputElement.value)},y.prototype.getTextInputElementValue=function(){return this.textInputElement.value},y.prototype.getDiagramFocusEvent=function(g){return new u.DiagramFocusEvent(g.target.value)},y.prototype.getDiagramClipboardEvent=function(g){var f,v=g.clipboardData||g.originalEvent&&g.originalEvent.clipboardData;return f=v!==void 0?v.getData("text/plain"):window.clipboardData.getData("Text"),new u.DiagramClipboardEvent(f)},y.prototype.isTextInputElement=function(g){return typeof g.className=="string"&&g.className.indexOf("dxdi-text-input")>-1},y.prototype.lockFocus=function(){var g=this;this.focusLocked=!0,setTimeout(function(){return g.focusLocked=!1},10)},y.prototype.notifyViewAdjusted=function(g){},y.prototype.notifyActualZoomChanged=function(g){this.actualZoom=g,this.savedTextInputPosition&&this.savedTextInputSize&&this.setTextInputElementBounds(this.savedTextInputPosition,this.savedTextInputSize,this.savedTextInputAngle)},y.prototype.notifyTextInputStart=function(g,f,v,C){var b,S="";g instanceof s.Shape?(S="shape-text",b=g.textAngle):g instanceof i.Connector&&(S="connector-text"),C=C&&C.clone().applyConverter(o.UnitConverter.twipsToPixels),this.setInputElementTextInputMode(f,v,C,g.styleText,S,b)},y.prototype.notifyTextInputEnd=function(g,f){this.setInputElementFocusHandlerMode(f)},y.prototype.notifyTextInputPermissionsCheck=function(g,f){},y}();h.InputManager=l},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(y,g){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,v){f.__proto__=v}||function(f,v){for(var C in v)v.hasOwnProperty(C)&&(f[C]=v[C])})(y,g)},function(y,g){function f(){this.constructor=y}m(y,g),y.prototype=g===null?Object.create(g):(f.prototype=g.prototype,new f)});Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasPageManager=void 0;var p=d(26),u=d(21),s=d(5),i=d(341),t=d(56),e=d(42),n=d(2),o=d(0),r=d(17),a=d(22),c=d(12),l=function(y){function g(f,v,C){var b=y.call(this,v.zoomLevel,C)||this;return b.snapPoint=new o.Point(0,0),b.gridPatternId=r.RenderUtils.generateSvgElementId("gridPattern"),b.pagesGridPatternId=r.RenderUtils.generateSvgElementId("pagesGridPattern"),b.pagesGridClipId=r.RenderUtils.generateSvgElementId("pagesGridClip"),b.pageColor=v.pageColor,b.modelSize=v.modelSize,b.simpleView=v.simpleView,b.gridSize=v.gridSize,b.gridVisible=v.gridVisible,b.pageSize=v.pageLandscape?new n.Size(v.pageSize.height,v.pageSize.width):v.pageSize,b.canvasViewOffset=new o.Point(0,0),b.initContainers(f),b}return P(g,y),g.prototype.initContainers=function(f){this.backgroundContainer=f},g.prototype.redraw=function(){this.redrawPage(this.pageColor),this.redrawGrid()},g.prototype.redrawPage=function(f){var v=new p.Style;v.fill=a.ColorUtils.colorToHash(f),this.getOrCreateElement("page-bg",new u.RectanglePrimitive(0,0,"100%","100%",v,"page"),this.backgroundContainer),this.createTextFloodFilter("page-bg-textflood-filter",this.backgroundContainer,f)},g.prototype.redrawGrid=function(){this.updateGridElements(),this.updatePagesGridElements()},g.prototype.getGridRectElement=function(f){return this.gridRectElement===void 0&&(this.gridRectElement=this.createPrimitiveElement(f,this.backgroundContainer)),this.gridRectElement},g.prototype.getGridPatternElement=function(f){return this.gridPatternElement===void 0&&(this.gridPatternElement=this.createPrimitiveElement(f,this.backgroundContainer)),this.gridPatternElement},g.prototype.updateGridElements=function(){var f=this,v=new u.RectanglePrimitive("0","0","100%","100%",null,"grid",null,function(E){E.style.setProperty("fill",r.RenderUtils.getUrlPathById(f.gridPatternId))}),C=this.getGridRectElement(v);if(this.gridVisible){C.style.display="",this.changePrimitiveElement(v,C);for(var b=c.UnitConverter.twipsToPixelsF(this.gridSize)*this.actualZoom,S=[0,1,2,3,4].map(function(E){return Math.round(b*E)}),x=[new s.PathPrimitiveMoveToCommand(S[4].toString(),"0"),new s.PathPrimitiveLineToCommand(S[4].toString(),S[4].toString()),new s.PathPrimitiveLineToCommand("0",S[4].toString())],I=[],w=1;w<=3;w++)I.push(new s.PathPrimitiveMoveToCommand(S[w].toString(),"0")),I.push(new s.PathPrimitiveLineToCommand(S[w].toString(),S[4].toString()));for(w=1;w<=3;w++)I.push(new s.PathPrimitiveMoveToCommand("0",S[w].toString())),I.push(new s.PathPrimitiveLineToCommand(S[4].toString(),S[w].toString()));var _=4*b,T=this.simpleView?this.canvasViewOffset:o.Point.zero(),R=new i.PatternPrimitive(this.gridPatternId,[this.createGridPathPrimitive(x,"grid-outer-line"),this.createGridPathPrimitive(I,"grid-inner-line")],this.createGridPatternPrimitivePosition(T.x,this.snapPoint.x,_),this.createGridPatternPrimitivePosition(T.y,this.snapPoint.y,_),_.toString(),_.toString());this.changePrimitiveElement(R,this.getGridPatternElement(R))}else C.style.display="none"},g.prototype.createGridPatternPrimitivePosition=function(f,v,C){return(((f+v*this.actualZoom)%C-C)%C).toString()},g.prototype.createGridPathPrimitive=function(f,v){return new s.PathPrimitive(f,p.StrokeStyle.default1pxNegativeOffsetInstance,v)},g.prototype.getPagesGridRectElement=function(f){return this.getOrCreateElement("grid-pages-rect",f,this.backgroundContainer)},g.prototype.getPagesGridClipPathElement=function(f){return this.pagesGridClipPathElement===void 0&&(this.pagesGridClipPathElement=this.createPrimitiveElement(f,this.backgroundContainer)),this.pagesGridClipPathElement},g.prototype.getPagesGridPatternElement=function(f){return this.pagesGridPatternElement===void 0&&(this.pagesGridPatternElement=this.createPrimitiveElement(f,this.backgroundContainer)),this.pagesGridPatternElement},g.prototype.updatePagesGridElements=function(){var f=this,v=this.getAbsoluteSize(this.pageSize),C=new u.RectanglePrimitive("0","0","100%","100%",null,"grid-page",this.pagesGridClipId,function(w){w.style.setProperty("fill",r.RenderUtils.getUrlPathById(f.pagesGridPatternId)),w.style.setProperty("display",f.simpleView?"none":"")});if(this.getPagesGridRectElement(C),!this.simpleView){var b=this.modelSize.clone().multiply(this.actualZoom,this.actualZoom),S=[new s.PathPrimitiveMoveToCommand((v.width-1).toString(),"0"),new s.PathPrimitiveLineToCommand((v.width-1).toString(),(v.height-1).toString()),new s.PathPrimitiveLineToCommand("0",(v.height-1).toString())],x=new i.PatternPrimitive(this.pagesGridPatternId,[new s.PathPrimitive(S,null,"pages-grid-line")],0,0,v.width.toString(),v.height.toString());this.changePrimitiveElement(x,this.getPagesGridPatternElement(x));var I=new t.ClipPathPrimitive(this.pagesGridClipId,[new u.RectanglePrimitive(0,0,(c.UnitConverter.twipsToPixelsF(b.width)-4).toString(),(c.UnitConverter.twipsToPixelsF(b.height)-4).toString())]);this.changePrimitiveElement(I,this.getPagesGridClipPathElement(I))}},g.prototype.notifyModelSizeChanged=function(f,v){this.modelSize=f.clone(),this.redraw()},g.prototype.notifyModelRectangleChanged=function(f){},g.prototype.notifySnapPointPositionChanged=function(f){this.snapPoint=f.clone().applyConverter(c.UnitConverter.twipsToPixelsF),this.redrawGrid()},g.prototype.notifyPageColorChanged=function(f){this.pageColor=f,this.redrawPage(this.pageColor)},g.prototype.notifyModelChanged=function(f){},g.prototype.notifyPageSizeChanged=function(f,v){this.pageSize=v?new n.Size(f.height,f.width):f.clone(),this.redraw()},g.prototype.notifyActualZoomChanged=function(f){this.actualZoom=f,this.redraw()},g.prototype.notifyViewAdjusted=function(f){this.canvasViewOffset.equals(f)||(this.canvasViewOffset=f,this.simpleView&&this.redraw())},g.prototype.notifyViewChanged=function(f){this.simpleView=f,this.redraw()},g.prototype.notifyGridChanged=function(f,v){this.gridVisible=f,this.gridSize=v,this.redraw()},g}(e.CanvasManagerBase);h.CanvasPageManager=l},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(s,i){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(s,i)},function(s,i){function t(){this.constructor=s}m(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0}),h.PatternPrimitive=void 0;var p=d(15),u=function(s){function i(t,e,n,o,r,a,c){var l=s.call(this,c)||this;return l.id=t,l.x=n,l.y=o,l.width=r,l.height=a,l.children=e,l}return P(i,s),i.prototype.createMainElement=function(){var t=document.createElementNS(p.svgNS,"pattern");return t.setAttribute("patternUnits","userSpaceOnUse"),t.setAttribute("id",this.id),t},i.prototype.applyElementProperties=function(t,e){this.setUnitAttribute(t,"x",this.x),this.setUnitAttribute(t,"y",this.y),this.setUnitAttribute(t,"width",this.width),this.setUnitAttribute(t,"height",this.height),this.setPositionCorrectionAttribute(t),s.prototype.applyElementProperties.call(this,t,e)},i}(d(24).SvgPrimitive);h.PatternPrimitive=u},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(v,C){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var x in S)S.hasOwnProperty(x)&&(b[x]=S[x])})(v,C)},function(v,C){function b(){this.constructor=v}m(v,C),v.prototype=C===null?Object.create(C):(b.prototype=C.prototype,new b)});Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasViewManager=h.CROP_OFFSET=h.CANVAS_SCROLL_PADDING=h.CANVAS_MIN_PADDING=void 0;var p=d(42),u=d(28),s=d(3),i=d(87),t=d(2),e=d(0),n=d(39),o=d(56),r=d(21),a=d(17),c=d(343),l=d(26),y=d(27),g=d(12);h.CANVAS_MIN_PADDING=8,h.CANVAS_SCROLL_PADDING=18,h.CROP_OFFSET=40;var f=function(v){function C(b,S,x,I,w,_,T,R){var E=v.call(this,I,R)||this;return E.svgElement=S,E.paddings=new i.Offsets(0,0,0,0),E.scroll=new e.Point(0,0),E.crop=i.Offsets.empty(),E.lockAutoZoom=!1,E.autoScrollLocker=0,E.pageClipPathId=a.RenderUtils.generateSvgElementId("page-clip"),E.pageShadowId=a.RenderUtils.generateSvgElementId("page-shadow"),E.onViewChanged=new s.EventDispatcher,b.onScroll.add(E),x=x.clone().applyConverter(g.UnitConverter.twipsToPixelsF),E.scrollView=b,E.modelSize=x,E.simpleView=_,E.fixedZoomLevel=I,E.autoZoom=w,E.crop=E.rectangleToCrop(T,x),E.updateElements(x.clone().multiply(I,I),e.Point.zero(),_),E.getOrCreateElement("shadow",new c.ShadowFilterPrimitive(E.pageShadowId),E.svgElement),E.containerSize=b.getSize(),E}return P(C,v),C.prototype.adjust=function(b,S){var x;b||(b={vertical:!1,horizontal:!1},x=i.Offsets.empty()),this.containerSize=this.scrollView.getSize(),this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,this.simpleView,this.crop,b,this.containerSize,x,S),this.tryNormalizePaddings()},C.prototype.notifyModelSizeChanged=function(b,S){b=b.clone().applyConverter(g.UnitConverter.twipsToPixelsF);var x={horizontal:!S,vertical:!S};this.adjustCore(b,this.fixedZoomLevel,this.autoZoom,this.simpleView,this.crop,x,this.containerSize,S&&S.clone().applyConverter(g.UnitConverter.twipsToPixelsF)),this.modelSize=b},C.prototype.notifyModelRectangleChanged=function(b){var S=this.rectangleToCrop(b,this.modelSize);this.crop&&this.crop.equals(S)||(this.simpleView&&this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,this.simpleView,S,{horizontal:!1,vertical:!1},this.containerSize,i.Offsets.empty()),this.crop=S)},C.prototype.notifySnapPointPositionChanged=function(b){},C.prototype.notifyZoomChanged=function(b,S){this.adjustCore(this.modelSize,b,S,this.simpleView,this.crop,{horizontal:!1,vertical:!1},this.containerSize),this.fixedZoomLevel=b,this.autoZoom=S},C.prototype.notifyViewChanged=function(b){this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,b,this.crop,{vertical:!0,horizontal:!0},this.containerSize),this.simpleView=b},C.prototype.notifyGridChanged=function(b,S){},C.prototype.notifyDragStart=function(b){this.lockAutoZoom=!0,y.DomUtils.addClassName(this.svgElement,"dxdi-drag-item")},C.prototype.notifyDragEnd=function(b){this.lockAutoZoom=!1,y.DomUtils.removeClassName(this.svgElement,"dxdi-drag-item"),this.adjustAfterDragEnd()},C.prototype.adjustAfterDragEnd=function(){this.autoZoom&&!this.autoZoomLocked&&this.adjust({horizontal:!0,vertical:this.autoZoom===u.AutoZoomMode.FitContent},this.autoZoom===u.AutoZoomMode.FitToWidth)},C.prototype.notifyShowContextToolbox=function(){this.autoZoomLocked=!0},C.prototype.notifyHideContextToolbox=function(){this.autoZoomLocked=!1,this.adjustAfterDragEnd()},C.prototype.notifyDragScrollStart=function(){y.DomUtils.addClassName(this.svgElement,"dxdi-drag-scroll")},C.prototype.notifyDragScrollEnd=function(){y.DomUtils.removeClassName(this.svgElement,"dxdi-drag-scroll")},C.prototype.notifyScrollChanged=function(b){this.scroll=b()},C.prototype.checkFitToCanvas=function(b){b=b||this.containerSize;var S=this.scrollView.getScrollBarWidth();b=b.clone().offset(2*-h.CANVAS_MIN_PADDING,2*-h.CANVAS_MIN_PADDING).nonNegativeSize();var x=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).clone().multiply(this.actualZoom,this.actualZoom),I=this.checkScrollBars(b,S,x,i.Offsets.empty());return{vertical:(b=b.clone().offset(I.vertical?-S:0,I.horizontal?-S:0).nonNegativeSize()).height>=x.height,horizontal:b.width>=x.width}},C.prototype.rectangleToCrop=function(b,S){var x=b.clone().applyConverter(g.UnitConverter.twipsToPixelsF);return new i.Offsets(this.correctCrop(x.x),this.correctCrop(S.width-x.right),this.correctCrop(x.y),this.correctCrop(S.height-x.bottom))},C.prototype.correctCrop=function(b){return h.CROP_OFFSET*Math.floor(b/h.CROP_OFFSET)},C.prototype.setActualZoom=function(b){this.actualZoom!==b&&(this.actualZoom=b,this.raiseActualZoomChanged())},C.prototype.getActualAutoZoomLevel=function(b){if(b===u.AutoZoomMode.Disabled)return this.actualZoom;var S=this.containerSize,x=this.scrollView.getScrollBarWidth(),I=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop);return this.getActualAutoZoom(S,x,I,b)},C.prototype.getActualZoom=function(b,S,x,I,w){return this.lockAutoZoom?this.actualZoom:w===u.AutoZoomMode.Disabled?I:this.getActualAutoZoom(b,S,x,w)},C.prototype.getActualAutoZoom=function(b,S,x,I){return b.width===0||b.height===0?1:I===u.AutoZoomMode.FitContent?Math.min((b.width-2*h.CANVAS_MIN_PADDING)/x.width,(b.height-2*h.CANVAS_MIN_PADDING)/x.height,1):Math.min((b.width-2*h.CANVAS_MIN_PADDING-S)/x.width,1)},C.prototype.raiseActualZoomChanged=function(){var b=this;this.onViewChanged.raise1(function(S){return S.notifyActualZoomChanged(b.actualZoom)})},C.prototype.tryNormalizePaddings=function(){var b=this.scrollView.getScrollBarWidth(),S=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).clone().multiply(this.actualZoom,this.actualZoom),x=new e.Point(this.paddings.left,this.paddings.top),I=new t.Size(this.paddings.right,this.paddings.bottom),w=this.getTailSpace(x,this.scroll,S,this.containerSize,b);w.equals(I)||this.applyChanges(new i.Offsets(x.x,w.width,x.y,w.height),S,this.simpleView,this.crop.clone().multiply(this.actualZoom))},C.prototype.scrollBy=function(b){var S,x,I,w=this.scroll,_=this.containerSize,T=this.scrollView.getScrollBarWidth(),R=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).clone().multiply(this.actualZoom,this.actualZoom),E=this.checkScrollBars(_,T,R,this.paddings),D=new e.Point(this.paddings.left,this.paddings.top),L=new t.Size(this.paddings.right,this.paddings.bottom);return w=(S=this.changeScrollByOffset(D,w,L,R,b,_,E)).scroll,b=S.offset,D=(x=this.changeTranslateByOffset(D,L,b,E)).translate,b=x.offset,D=(I=this.cropHiddenHead(D,w)).translate,w=I.scroll,L=this.getTailSpace(D,w,R,_,T),this.applyChanges(new i.Offsets(D.x,L.width,D.y,L.height),R,this.simpleView,this.crop.clone().multiply(this.actualZoom),w),b},C.prototype.changeScrollByOffset=function(b,S,x,I,w,_,T){var R=S.clone(),E=w.clone();return w.x&&T.horizontal&&(R.x-=E.x=-this.getScrollDeltaByOffset(w.x,S.x,b.x+I.width+x.width,_.width,T.vertical)),w.y&&T.vertical&&(R.y-=E.y=-this.getScrollDeltaByOffset(w.y,S.y,b.y+I.height+x.height,_.height,T.horizontal)),{scroll:R,offset:E}},C.prototype.changeTranslateByOffset=function(b,S,x,I){var w=b.clone(),_=x.clone();return x.x&&!I.horizontal&&(w.x+=_.x=this.getTranslateDeltaByOffset(x.x,w.x,S.width)),x.y&&!I.vertical&&(w.y+=_.y=this.getTranslateDeltaByOffset(x.y,w.y,S.height)),{translate:w,offset:_}},C.prototype.getScrollDeltaByOffset=function(b,S,x,I,w){if(b>0)return-Math.min(S,b);var _=x-(I-(w?this.scrollView.getScrollBarWidth():0));return Math.min(_-S,-b)},C.prototype.getTranslateDeltaByOffset=function(b,S,x){return b?b<0?-Math.min(S-h.CANVAS_MIN_PADDING,-b):Math.min(x-h.CANVAS_MIN_PADDING,b):0},C.prototype.getActualModelSizeWithoutZoom=function(b,S,x){return S&&x?b.clone().offset(-x.horizontal,-x.vertical).nonNegativeSize():b},C.prototype.setScrollTo=function(b,S){var x=this.containerSize,I=this.getVisibileAreaAbsShift(),w=b.clone().applyConverter(g.UnitConverter.twipsToPixelsF).clone().multiply(this.actualZoom,this.actualZoom).clone().offset(I.x,I.y),_=this.scroll;S?(_.x+=w.x-S.x,_.y+=w.y-S.y):(w.x<0&&(_.x+=w.x-h.CANVAS_MIN_PADDING),w.y<0&&(_.y+=w.y-h.CANVAS_MIN_PADDING),w.x>x.width&&(_.x+=w.x-x.width+h.CANVAS_MIN_PADDING),w.y>x.height&&(_.y+=w.y-x.height+h.CANVAS_MIN_PADDING)),this.setScroll(_)},C.prototype.scrollIntoView=function(b){b=b.clone().applyConverter(g.UnitConverter.twipsToPixelsF).multiply(this.actualZoom,this.actualZoom).moveRectangle(this.paddings.left,this.paddings.top);var S=this.scroll,x=this.containerSize;if(!(b.x>=S.x&&b.y>=S.y&&b.right<=S.x+x.width&&b.bottom<=S.y+x.height)){var I=S.clone();b.x<S.x?I.x=b.x-h.CANVAS_SCROLL_PADDING:b.right>S.x+x.width&&(I.x=Math.min(b.x-h.CANVAS_SCROLL_PADDING,b.right+h.CANVAS_SCROLL_PADDING-x.width)),b.y<S.y?I.y=b.y-h.CANVAS_SCROLL_PADDING:I.y=Math.min(b.y-h.CANVAS_SCROLL_PADDING,b.bottom+h.CANVAS_SCROLL_PADDING-x.height),this.setScroll(I)}},C.prototype.setScroll=function(b){var S=this,x=this.modelSize.clone().multiply(this.actualZoom,this.actualZoom);b.x=Math.max(0,Math.min(b.x,x.width+this.paddings.horizontal-this.containerSize.width)),b.y=Math.max(0,Math.min(b.y,x.height+this.paddings.vertical-this.containerSize.height)),this.dom.changeByFunc(null,function(){S.scrollView.setScroll(b.x,b.y)}),this.scroll=b.clone()},C.prototype.updateElements=function(b,S,x){this.updatePageElement(b,S,x),this.updateCanvasElement(S)},C.prototype.updateCanvasElement=function(b){this.canvasElement=this.getOrCreateElement("dxdi-main",new n.GroupPrimitive([],"dxdi-main",null,null,function(S){S.setAttribute("transform","translate("+Math.round(b.x)+", "+Math.round(b.y)+")")}),this.svgElement)},C.prototype.updatePageElement=function(b,S,x){if(x)this.updatePageElementCore("",0,0,b.width,b.height);else{var I=S.x,w=S.y,_=b.width,T=b.height;this.createPageShadow(I,w,_,T),this.updatePageElementCore(this.pageClipPathId,Math.round(I),Math.round(w),_,T)}},C.prototype.createPageShadow=function(b,S,x,I){this.getOrCreateElement("pageShadowRect",new r.RectanglePrimitive(b.toString(),S.toString(),x.toString(),I.toString(),new l.EmptyStyle({filter:a.RenderUtils.getUrlPathById(this.pageShadowId)}),"dxdi-page-shadow"),this.svgElement,this.svgElement.firstChild)},C.prototype.updatePageElementCore=function(b,S,x,I,w){this.pageElement=this.getOrCreateElement("page",new n.GroupPrimitive([],"dxdi-page",null,b,function(_){_.setAttribute("transform","translate("+S+", "+x+")")}),this.svgElement),this.getOrCreateElement("pageClip",this.createPageClipPathPrimitive(I,w),this.svgElement)},C.prototype.createPageClipPathPrimitive=function(b,S){return new o.ClipPathPrimitive(this.pageClipPathId,[new r.RectanglePrimitive(0,0,b.toString(),S.toString())])},C.prototype.adjustCore=function(b,S,x,I,w,_,T,R,E){var D=this.getActualModelSizeWithoutZoom(b,I,w);if(this.lockAutoZoom||!x&&R&&this.modelSize)this.resizeView(D,this.actualZoom,T,I,w,R);else{var L=this.scrollView.getScrollBarWidth(),H=this.getActualZoom(T,L,D,S,x);!x||H!==this.actualZoom||_.horizontal&&(_.vertical||E)?(this.resetView(D,H,T,I,w,_),this.setActualZoom(H)):this.resizeView(D,H,T,I,w,R||i.Offsets.empty())}},C.prototype.resetView=function(b,S,x,I,w,_){var T=b.clone().multiply(S,S),R=i.Offsets.fromNumber(h.CANVAS_MIN_PADDING);!(_=_||{horizontal:!0,vertical:!0}).horizontal&&this.paddings&&(R.left=this.paddings.left,R.right=this.paddings.right),!_.vertical&&this.paddings&&(R.top=this.paddings.top,R.bottom=this.paddings.bottom);var E=this.checkScrollBars(x,this.scrollView.getScrollBarWidth(),T,R),D=this.scrollView.getScrollBarWidth(),L=_.horizontal||_.vertical?this.scroll:void 0;if(_.horizontal){var H=Math.max((x.width-(E.vertical?D:0)-T.width)/2,h.CANVAS_MIN_PADDING);R.left=H,R.right=H,L.x=0}if(_.vertical){var O=Math.max((x.height-(E.horizontal?D:0)-T.height)/2,h.CANVAS_MIN_PADDING);R.top=O,R.bottom=O,L.y=0}this.applyChanges(R,T,I,w.clone().multiply(S),L)},C.prototype.resizeView=function(b,S,x,I,w,_){var T,R,E=this.actualZoom,D=this.simpleView&&this.crop?this.crop.clone().multiply(E):i.Offsets.empty(),L=b.clone().multiply(S,S);_=_.clone().multiply(S);var H=I&&w?w.clone().multiply(S):i.Offsets.empty(),O=new e.Point(this.paddings.left,this.paddings.top),z=this.scroll;O=(T=this.applyOffset(O,z,D,H,_)).translate,z=T.scroll,O=(R=this.cropHiddenHead(O,z)).translate,z=R.scroll;var K=this.getTailSpace(O,z,L,x,this.scrollView.getScrollBarWidth());if(!I){var A=x.width-h.CANVAS_SCROLL_PADDING,M=x.height-h.CANVAS_SCROLL_PADDING;_.left<0&&O.x>A&&(O.x=A,z.x=0),_.right<0&&K.width>A&&(K.width=A,z.x>L.width&&(z.x=L.width)),_.top<0&&O.y>M&&(O.y=M,z.y=0),_.bottom<0&&K.height>M&&(K.height=M,z.y>L.height&&(z.y=L.height))}var U=new i.Offsets(O.x,K.width,O.y,K.height);this.applyChanges(U,L,I,H,z)},C.prototype.applyChanges=function(b,S,x,I,w){var _=this,T=new e.Point(b.left,b.top);x&&I&&(T=T.clone().offset(-I.left,-I.top)),this.updateElements(S,T,x),this.setSvgSize(S.width+b.horizontal,S.height+b.vertical),this.onViewChanged.raise1(function(R){return R.notifyViewAdjusted(new e.Point(T.x,T.y))}),w&&(this.lockAutoScroll(),w&&this.dom.changeByFunc(this.scrollView,function(R){R.setScroll(w.x,w.y),_.unlockAutoScroll()}),this.scroll=w),this.paddings=b},C.prototype.isAutoScrollLocked=function(){return this.autoScrollLocker!==0},C.prototype.lockAutoScroll=function(){this.autoScrollLocker++},C.prototype.unlockAutoScroll=function(){this.autoScrollLocker--},C.prototype.applyOffset=function(b,S,x,I,w){var _=b.clone(),T=S.clone(),R=this.getActualOffset(x,I,w);return R.left&&(_.x=Math.max(h.CANVAS_MIN_PADDING,_.x-R.left),T.x+=R.left-(b.x-_.x)),R.top&&(_.y=Math.max(h.CANVAS_MIN_PADDING,_.y-R.top),T.y+=R.top-(b.y-_.y)),{translate:_,scroll:T}},C.prototype.cropHiddenHead=function(b,S){var x=S.clone(),I=b.clone();if(x.x&&I.x>h.CANVAS_MIN_PADDING){var w=I.x-Math.max(h.CANVAS_MIN_PADDING,I.x-x.x);I.x-=w,x.x-=w}return x.y&&I.y>h.CANVAS_MIN_PADDING&&(w=I.y-Math.max(h.CANVAS_MIN_PADDING,I.y-x.y),I.y-=w,x.y-=w),{translate:I,scroll:x}},C.prototype.getTailSpace=function(b,S,x,I,w){var _=b.clone(),T=S.clone(),R=Math.max(I.width+T.x-(_.x+x.width),h.CANVAS_MIN_PADDING),E=Math.max(I.height+T.y-(_.y+x.height),h.CANVAS_MIN_PADDING),D=this.checkScrollBars(I,w,x,new i.Offsets(_.x,R,_.y,E));return D.vertical&&(R=Math.max(h.CANVAS_MIN_PADDING,R-w)),D.horizontal&&(E=Math.max(h.CANVAS_MIN_PADDING,E-w)),new t.Size(R,E)},C.prototype.getActualOffset=function(b,S,x){return new i.Offsets(-(S.left-b.left)+x.left,-(S.right-b.right)+x.right,-(S.top-b.top)+x.top,-(S.bottom-b.bottom)+x.bottom)},C.prototype.checkScrollBars=function(b,S,x,I){var w=b.width<x.width+I.horizontal,_=b.height<x.height+I.vertical;return w&&!_&&(_=b.height-S<x.height+I.vertical),_&&!w&&(w=b.width-S<x.width+I.horizontal),{horizontal:w,vertical:_}},C.prototype.setSvgSize=function(b,S){b===this.lastWidth&&S===this.lastHeight||(this.dom.changeByFunc(this.svgElement,function(x){return a.RenderUtils.updateSvgElementSize(x,b,S)}),this.lastWidth=b,this.lastHeight=S)},C.prototype.getVisibileAreaAbsShift=function(b){var S=this.scroll,x=this.paddings.clone(),I=this.simpleView,w=I&&this.crop?this.crop.left*this.actualZoom:0,_=I&&this.crop?this.crop.top*this.actualZoom:0;return new e.Point(x.left-w-(b?0:S.x),x.top-_-(b?0:S.y))},C.prototype.getModelPoint=function(b,S){var x=this.getVisibileAreaAbsShift(),I=b.clone().offset(-x.x,-x.y).multiply(1/this.actualZoom,1/this.actualZoom);if(S){var w=this.containerSize;if(b.x<0||b.y<0||b.x>w.width||b.y>w.height||I.x<0||I.y<0||I.x>this.modelSize.width||I.y>this.modelSize.height)return null}return I.clone().applyConverter(g.UnitConverter.pixelsToTwips)},C.prototype.getAbsolutePoint=function(b,S,x){var I=this.getVisibileAreaAbsShift(S),w=b.clone().multiply(this.actualZoom,this.actualZoom).clone().applyConverter(g.UnitConverter.twipsToPixelsF).clone().offset(I.x,I.y);if(x){if(w.x<0||w.y<0)return null;var _=this.containerSize;if(w.x>_.width||w.y>_.height)return null}return w},C}(p.CanvasManagerBase);h.CanvasViewManager=f},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.ShadowFilterPrimitive=void 0;var p=d(108),u=d(15),s=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return P(t,i),t.prototype.createChildElements=function(e){var n=document.createElementNS(u.svgNS,"feGaussianBlur");n.setAttribute("in","SourceGraphic"),n.setAttribute("stdDeviation","4.6"),e.appendChild(n);var o=document.createElementNS(u.svgNS,"feOffset");o.setAttribute("dx","0"),o.setAttribute("dy","0"),e.appendChild(o);var r=document.createElementNS(u.svgNS,"feMerge");e.appendChild(r);var a=document.createElementNS(u.svgNS,"feMergeNode");r.appendChild(a);var c=document.createElementNS(u.svgNS,"feMergeNode");c.setAttribute("in","SourceGraphic"),r.appendChild(c)},t}(p.FilterPrimitive);h.ShadowFilterPrimitive=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.AutoScrollController=void 0;var m=d(15),P=d(27),p=d(2),u=d(3),s=function(){function i(t,e,n,o){this.scroll=t,this.svgElement=e,this.view=n,this.dom=o,this.leftButtonPressed=!1,this.scrollDragging=!1,this.scrollTimer=-1,this.scrollBarWidth=P.DomUtils.getVerticalScrollBarWidth()}return i.prototype.onMouseMove=function(t,e){this.clearScrollTimer(),u.EventUtils.isLeftButtonPressed(t)||(this.leftButtonPressed=!1),this.canAutoScroll()&&this.changeScrollPosition(t,e,!1)},i.prototype.onMouseDown=function(t){this.leftButtonPressed=!!u.EventUtils.isLeftButtonPressed(t)},i.prototype.onMouseUp=function(t){this.clearScrollTimer(),this.leftButtonPressed=!1},i.prototype.onMouseEnter=function(t){var e=this;u.EventUtils.isLeftButtonPressed(t)&&setTimeout(function(){e.leftButtonPressed=!0},500)},i.prototype.onDragScrollStart=function(){this.scrollDragging=!0},i.prototype.onDragScrollEnd=function(){this.scrollDragging=!1},i.prototype.canAutoScroll=function(){return this.leftButtonPressed&&!this.scrollDragging},i.prototype.changeScrollPosition=function(t,e,n){var o=this,r=!1;if(!this.view.isAutoScrollLocked()){var a=this.scroll.getScrollContainer(),c=t.pageX-P.DomUtils.getAbsolutePositionX(a),l=t.pageY-P.DomUtils.getAbsolutePositionY(a),y=this.scroll.getSize(),g=new p.Size(parseFloat(this.svgElement.style.width),parseFloat(this.svgElement.style.height)),f=y.width;y.width<g.width&&(f-=this.scrollBarWidth);var v=y.height;y.height<g.height&&(v-=this.scrollBarWidth),c<=40?(this.dom.changeByFunc(null,function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(-o.getScrollingOffset(c),0)}),r=!0):f-40<=c&&(this.dom.changeByFunc(null,function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(o.getScrollingOffset(f-c),0)}),r=!0),l<=40?(this.dom.changeByFunc(null,function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(0,-o.getScrollingOffset(l))}),r=!0):v-40<=l&&(this.dom.changeByFunc(null,function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(0,o.getScrollingOffset(v-l))}),r=!0)}(r||this.view.isAutoScrollLocked())&&(this.scrollTimer=window.setTimeout(function(){return o.changeScrollPosition(t,e,r)},50)),n&&e()},i.prototype.clearScrollTimer=function(){this.scrollTimer>-1&&(window.clearTimeout(this.scrollTimer),this.scrollTimer=-1)},i.prototype.getScrollingOffset=function(t){var e=Math.pow((40-t)/5,2);return Math.round(Math.min(e,5))},i.createMainElement=function(t){var e=document.createElement("div");return e.setAttribute("class","dxdi-control"),t.appendChild(e),e},i.createSvgElement=function(t,e){e===void 0&&(e=!1);var n=document.createElementNS(m.svgNS,"svg");return n.className.baseVal="dxdi-canvas"+(e?" export":""),t.appendChild(n),n},i}();h.AutoScrollController=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(y,g){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,v){f.__proto__=v}||function(f,v){for(var C in v)v.hasOwnProperty(C)&&(f[C]=v[C])})(y,g)},function(y,g){function f(){this.constructor=y}m(y,g),y.prototype=g===null?Object.create(g):(f.prototype=g.prototype,new f)});Object.defineProperty(h,"__esModule",{value:!0}),h.DocumentDataSource=h.UpdateNodeKeyRelatedObjectsStackAction=h.UpdateNodeKeyRelatedObjectsStackItem=void 0;var p=d(1),u=d(14),s=d(6),i=d(346),t=d(4),e=d(44),n=d(3),o=d(49),r=d(31),a=function(){return function(y,g){this.shape=y,this.nodeObj=g}}();h.UpdateNodeKeyRelatedObjectsStackItem=a;var c=function(){return function(y,g){this.kind=y,this.nodeObj=g}}();h.UpdateNodeKeyRelatedObjectsStackAction=c;var l=function(y){function g(f,v,C,b,S,x){var I=y.call(this,"Document",v,C,b,S,x)||this;return I.changesListener=f,I.nodeInsertingLockCount=0,I.updateNodeKeyRelatedObjectsCount=0,I.updateNodeKeyRelatedObjectsStack=[],I.updateNodeKeyRelatedObjectsStackActions=[],I}return P(g,y),g.prototype.updateItemsByModel=function(f){var v=this;this.beginChangesNotification(),this.deleteNodes(f),this.deleteEdges(f),f.items.forEach(function(C){C instanceof u.Shape&&v.updateNode(f,C),C instanceof s.Connector&&v.updateEdge(f,C)}),this.endChangesNotification(!1)},g.prototype.isItemObjectModified=function(f,v,C){var b=C.setLocked&&v.locked!==f.locked||C.setZIndex&&v.zIndex!==f.zIndex||C.setCustomData&&!n.ObjectUtils.compareObjects(v.customData,f.customData);if(!b&&C.setStyle){var S=f.style.getDefaultInstance();f.style.forEach(function(I){f.style[I]!==S[I]&&f.style[I]!==(v.style&&v.style[I])&&(b=!0)})}if(!b&&C.setStyleText){var x=f.styleText.getDefaultInstance();f.styleText.forEach(function(I){f.styleText[I]!==x[I]&&f.styleText[I]!==(v.styleText&&v.styleText[I])&&(b=!0)})}return b},g.prototype.setDataObjectKeyRelatedProperty=function(f,v,C,b){(b||this.autoGeneratedDataKeys[C]===void 0)&&f(v,C)},g.prototype.updateItemObjectProperties=function(f,v,C){if(C.setCustomData&&(f.customData=n.ObjectUtils.cloneObject(v.customData),f.dataObj&&f.customData!==void 0&&C.setCustomData(f.dataObj,v.customData)),C.setLocked&&(f.locked=v.locked,f.dataObj&&f.locked!==void 0&&C.setLocked(f.dataObj,v.locked)),C.setStyle){var b=v.style.toObject();f.style=b,f.dataObj&&f.style!==void 0&&C.setStyle(f.dataObj,e.Data.objectToCssText(b))}if(C.setStyleText){var S=v.styleText.toObject();f.styleText=S,f.dataObj&&f.styleText!==void 0&&C.setStyleText(f.dataObj,e.Data.objectToCssText(S))}C.setZIndex&&(f.zIndex=v.zIndex,f.dataObj&&f.zIndex!==void 0&&C.setZIndex(f.dataObj,v.zIndex))},g.prototype.deleteItems=function(f,v,C,b){f.slice().forEach(function(S){if(S.key!==void 0&&S.key!==null&&!v(S.key)){var x=C(S),I=x.indexOf(S.dataObj);x.splice(I,1),b(S,I>-1)}})},g.prototype.updateNode=function(f,v){var C=this,b=this.findNode(v.dataKey);if(b)this.isNodeObjectModified(v,b,f.units)?(this.updateNodeObjectProperties(v,b,f.units),this.updateNodeObjectConnectedProperties(v,b),this.beginChangesNotification(),this.changesListener.notifyNodeUpdated.call(this.changesListener,this.nodeDataImporter.getKey(b.dataObj||b.key),b.dataObj,function(x,I){C.endChangesNotification(!1)},function(x){C.endChangesNotification(!1)})):this.updateNodeObjectConnectedProperties(v,b,this.changesListener);else{var S={};v.dataKey!==void 0&&v.dataKey!==null&&this.nodeDataImporter.setKey(S,v.dataKey),b=this.addNodeInternal(S,v.description.key,v.text),this.nodeDataSource.push(b.dataObj),this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setKey,S,b.key,this.addInternalKeyOnInsert),this.updateNodeObjectProperties(v,b,f.units),this.updateNodeObjectConnectedProperties(v,b),this.updateNodeObjectKey(v,b,b.dataObj),this.beginChangesNotification(),this.beginNodeInserting(),this.changesListener.notifyNodeInserted.call(this.changesListener,b.dataObj,function(x){C.updateNodeObjectKey(v,b,x),C.endNodeInserting(),C.endChangesNotification(!1)},function(x){C.endNodeInserting(),C.endChangesNotification(!1)})}},g.prototype.areImageUrlsEqual=function(f,v){return f===v||o.StringUtils.isNullOrEmpty(f)&&o.StringUtils.isNullOrEmpty(v)},g.prototype.isNodeObjectModified=function(f,v,C){return this.isItemObjectModified(f,v,this.nodeDataImporter)||v.type!==f.description.key&&!(v.type===void 0&&f.description.key===p.ShapeTypes.Rectangle)||!this.compareStrings(v.text,f.text)||this.nodeDataImporter.setImage&&!this.areImageUrlsEqual(v.image,f.image.actualUrl)||this.nodeDataImporter.setLeft&&!r.MathUtils.numberCloseTo(v.left,t.ModelUtils.getlUnitValue(C,f.position.x))||this.nodeDataImporter.setTop&&!r.MathUtils.numberCloseTo(v.top,t.ModelUtils.getlUnitValue(C,f.position.y))||this.nodeDataImporter.setWidth&&!r.MathUtils.numberCloseTo(v.width,t.ModelUtils.getlUnitValue(C,f.size.width))||this.nodeDataImporter.setHeight&&!r.MathUtils.numberCloseTo(v.height,t.ModelUtils.getlUnitValue(C,f.size.height))},g.prototype.updateNodeObjectProperties=function(f,v,C){if(this.updateItemObjectProperties(v,f,this.nodeDataImporter),this.nodeDataImporter.setType&&(v.type=f.description.key,this.nodeDataImporter.setType(v.dataObj,f.description.key)),this.nodeDataImporter.setText&&(v.text=f.text,this.nodeDataImporter.setText(v.dataObj,f.text)),this.nodeDataImporter.setImage&&(v.image=f.image.actualUrl,this.nodeDataImporter.setImage(v.dataObj,f.image.actualUrl===void 0?null:f.image.actualUrl)),this.nodeDataImporter.setLeft){var b=t.ModelUtils.getlUnitValue(C,f.position.x);v.left=b,this.nodeDataImporter.setLeft(v.dataObj,b)}if(this.nodeDataImporter.setTop){var S=t.ModelUtils.getlUnitValue(C,f.position.y);v.top=S,this.nodeDataImporter.setTop(v.dataObj,S)}if(this.nodeDataImporter.setWidth){var x=t.ModelUtils.getlUnitValue(C,f.size.width);v.width=x,this.nodeDataImporter.setWidth(v.dataObj,x)}if(this.nodeDataImporter.setHeight){var I=t.ModelUtils.getlUnitValue(C,f.size.height);v.height=I,this.nodeDataImporter.setHeight(v.dataObj,I)}},g.prototype.updateNodeObjectConnectedProperties=function(f,v,C){if(this.useNodeParentId&&this.nodeDataImporter.setParentKey!==void 0){var b=this.getParentItemKey(f),S=this.findNode(b);this.updateNodeObjectParentKey(v,S,C)}if(this.useNodeContainerId&&this.nodeDataImporter.setContainerKey!==void 0){var x=this.getContainerShapeKey(f),I=this.findNode(x);this.updateNodeObjectContainerKey(v,I,C)}this.useNodeItems&&this.nodeDataImporter.setItems!==void 0&&(b=this.getParentItemKey(f),S=this.findNode(b),this.updateNodeObjectItems(v,S,C)),this.useNodeChildren&&this.nodeDataImporter.setChildren!==void 0&&(x=this.getContainerShapeKey(f),I=this.findNode(x),this.updateNodeObjectChildren(v,I,C))},g.prototype.IsNodeParentIdMode=function(){return this.useNodeParentId&&this.nodeDataImporter.setParentKey!==void 0},g.prototype.IsNodeItemsMode=function(){return this.useNodeItems&&this.nodeDataImporter.setItems!==void 0},g.prototype.updateNodeObjectParentKey=function(f,v,C){var b=this.nodeDataImporter.getParentKey(f.dataObj),S=v?this.nodeDataImporter.getKey(v.dataObj):void 0;b===S||this.isRootParentKey(b)&&this.isRootParentKey(S)||(this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setParentKey,f.dataObj,S,!1),C&&(this.isInUpdateNodeKeyRelatedObjects()?this.addToUpdateNodeKeyRelatedObjectsStackAction("shape",f):this.updateNodeObjectContainerOrParentKeyInternal(f,C)))},g.prototype.updateNodeObjectParentKeyInternal=function(f,v){var C=this;this.beginChangesNotification(),v.notifyNodeUpdated.call(v,this.nodeDataImporter.getKey(f.dataObj)||f.key,f.dataObj,function(b,S){C.endChangesNotification(!1)},function(b){C.endChangesNotification(!1)})},g.prototype.updateNodeObjectContainerKey=function(f,v,C){var b=this.nodeDataImporter.getContainerKey(f.dataObj),S=v?this.nodeDataImporter.getKey(v.dataObj):void 0;b===S||this.isRootParentKey(b)&&this.isRootParentKey(S)||(this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setContainerKey,f.dataObj,S,!1),C&&(this.isInUpdateNodeKeyRelatedObjects()?this.addToUpdateNodeKeyRelatedObjectsStackAction("shape",f):this.updateNodeObjectContainerOrParentKeyInternal(f,C)))},g.prototype.updateNodeObjectContainerOrParentKeyInternal=function(f,v){var C=this;this.beginChangesNotification(),v.notifyNodeUpdated.call(v,this.nodeDataImporter.getKey(f.dataObj)||f.key,f.dataObj,function(b,S){C.endChangesNotification(!1)},function(b){C.endChangesNotification(!1)})},g.prototype.isRootParentKey=function(f){return f==null||!this.findNode(f)},g.prototype.updateNodeObjectItems=function(f,v,C){var b=this;if((v&&f.parentDataObj!==v.dataObj||!v&&f.parentDataObj)&&(!v||!this.checkNodeCyrcleItems(f.dataObj,v.dataObj))){var S=f.parentDataObj?this.nodeDataImporter.getItems(f.parentDataObj):this.nodeDataSource,x=S.indexOf(f.dataObj);S.splice(x,1);var I=v?this.nodeDataImporter.getItems(v.dataObj):this.nodeDataSource;I?I.push(f.dataObj):this.nodeDataImporter.setItems(v.dataObj,[f.dataObj]),f.parentDataObj=v&&v.dataObj,C&&(this.beginChangesNotification(),C.notifyNodeUpdated.call(C,this.nodeDataImporter.getKey(f.dataObj)||f.key,f.dataObj,function(w,_){b.endChangesNotification(!1)},function(w){b.endChangesNotification(!1)}))}},g.prototype.updateNodeObjectChildren=function(f,v,C){var b=this;if(v&&f.containerDataObj!==v.dataObj||!v&&f.containerDataObj){var S=f.containerDataObj?this.nodeDataImporter.getChildren(f.containerDataObj):this.nodeDataSource,x=S.indexOf(f.dataObj);S.splice(x,1);var I=v?this.nodeDataImporter.getChildren(v.dataObj):this.nodeDataSource;I?I.push(f.dataObj):this.nodeDataImporter.setChildren(v.dataObj,[f.dataObj]),f.containerDataObj=v&&v.dataObj,C&&(this.beginChangesNotification(),C.notifyNodeUpdated.call(C,this.nodeDataImporter.getKey(f.dataObj)||f.key,f.dataObj,function(w,_){b.endChangesNotification(!1)},function(w){b.endChangesNotification(!1)}))}},g.prototype.checkNodeCyrcleItems=function(f,v){var C=this,b=!1,S=this.nodeDataImporter.getItems(f);return S&&S.forEach(function(x){b=b||x===v||C.checkNodeCyrcleItems(x,v)}),b},g.prototype.updateNodeObjectKey=function(f,v,C){var b=this.nodeDataImporter.getKey(C),S=!1;if(b!=null&&b!==v.key&&(delete this.autoGeneratedDataKeys[v.key],v.key=b,S=!0),f.dataKey=v.key,v.dataObj!==C){var x=this.getNodeArray(v),I=x.indexOf(v.dataObj);x.splice(I,1,C),v.dataObj=C}S&&this.updateNodeKeyRelatedObjects(f,v)},g.prototype.updateNodeKeyRelatedObjects=function(f,v){var C=this;this.isInNodeInserting()?this.addToUpdateNodeKeyRelatedObjectsStack(f,v):(this.useNodeParentId&&this.nodeDataImporter.setParentKey!==void 0&&this.getChildItems(f).forEach(function(b){var S=C.findNode(b.dataKey);S&&C.updateNodeObjectParentKey(S,v,C.changesListener)}),this.useNodeContainerId&&this.nodeDataImporter.setContainerKey!==void 0&&f.children.forEach(function(b){var S=b instanceof u.Shape?C.findNode(b.dataKey):void 0;S&&C.updateNodeObjectContainerKey(S,v,C.changesListener)}),this.useEdgesArray()&&f.attachedConnectors.forEach(function(b){var S=C.findEdge(b.dataKey);S&&(f===b.beginItem&&C.updateEdgeObjectFromProperty(v,S,C.changesListener),f===b.endItem&&C.updateEdgeObjectToProperty(v,S,C.changesListener))}))},g.prototype.deleteNodes=function(f){var v=this;this.deleteItems(this.nodes,function(C){return f.findShapeByDataKey(C)},function(C){return v.getNodeArray(C)},function(C,b){var S=C.dataObj&&v.nodeDataImporter.getKey(C.dataObj)||C.key,x=v.findNode(S);x&&v.nodes.splice(v.nodes.indexOf(x),1),b&&(v.beginChangesNotification(),v.changesListener.notifyNodeRemoved.call(v.changesListener,S,C.dataObj,function(I,w){v.endChangesNotification(!1)},function(I){v.endChangesNotification(!1)}))})},g.prototype.getParentItem=function(f){for(var v=0;v<f.attachedConnectors.length;v++)if(f.attachedConnectors[v].endItem===f)return f.attachedConnectors[v].beginItem},g.prototype.getParentItemKey=function(f){var v=this.getParentItem(f);return v&&v.dataKey},g.prototype.getNodeArray=function(f){var v;return this.useNodeItems&&f.parentDataObj?v=this.nodeDataImporter.getItems(f.parentDataObj):f.containerDataObj&&(v=this.nodeDataImporter.getChildren(f.containerDataObj)),v||this.nodeDataSource},g.prototype.getContainerShapeKey=function(f){return f.container&&f.container.dataKey},g.prototype.getChildItems=function(f){for(var v=[],C=0;C<f.attachedConnectors.length;C++)f.attachedConnectors[C].beginItem===f&&f.attachedConnectors[C].endItem&&v.push(f.attachedConnectors[C].endItem);return v},g.prototype.updateEdge=function(f,v){var C=this,b=v.beginItem?v.beginItem.dataKey:void 0,S=v.endItem?v.endItem.dataKey:void 0,x=this.findEdge(v.dataKey);if(x)this.isEdgeObjectModified(v,x,f.units)&&(this.updateEdgeObjectProperties(v,x,f.units),x.dataObj&&(this.beginChangesNotification(),this.changesListener.notifyEdgeUpdated.call(this.changesListener,this.edgeDataImporter.getKey(x.dataObj)||x.key,x.dataObj,function(w,_){C.endChangesNotification(!1)},function(w){C.endChangesNotification(!1)})));else{var I=this.useEdgesArray()&&this.canUpdateEdgeDataSource?{}:void 0;I&&v.dataKey!==void 0&&v.dataKey!==null&&this.edgeDataImporter.setKey(I,v.dataKey),x=this.addEdgeInternal(I,b,S),I&&(this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setKey,I,x.key,this.addInternalKeyOnInsert),this.edgeDataSource.push(x.dataObj)),this.updateEdgeObjectProperties(v,x,f.units),this.updateEdgeObjectKey(v,x,x.dataObj),I&&(this.beginChangesNotification(),this.beginNodeInserting(),this.changesListener.notifyEdgeInserted.call(this.changesListener,x.dataObj,function(w){C.updateEdgeObjectKey(v,x,w),C.endNodeInserting(),C.endChangesNotification(!1)},function(w){C.endNodeInserting(),C.endChangesNotification(!1)}))}},g.prototype.isEdgeObjectModified=function(f,v,C){return this.isItemObjectModified(f,v,this.edgeDataImporter)||(v.from!==null?v.from:void 0)!==(f.beginItem?f.beginItem.dataKey:void 0)||(v.to===null?void 0:v.to)!==(f.endItem?f.endItem.dataKey:void 0)||this.edgeDataImporter.setFromPointIndex&&v.fromPointIndex!==f.beginConnectionPointIndex||this.edgeDataImporter.setToPointIndex&&v.toPointIndex!==f.endConnectionPointIndex||this.edgeDataImporter.setPoints&&(!v.points||!this.pointsAreEqual(v.points.map(function(b){return b.x}),f.points.map(function(b){return t.ModelUtils.getlUnitValue(C,b.x)}))||!this.pointsAreEqual(v.points.map(function(b){return b.y}),f.points.map(function(b){return t.ModelUtils.getlUnitValue(C,b.y)})))||this.edgeDataImporter.setText&&!this.compareTexts(v,f)||this.edgeDataImporter.setLineOption&&v.lineOption!==f.properties.lineOption||this.edgeDataImporter.setStartLineEnding&&v.startLineEnding!==f.properties.startLineEnding||this.edgeDataImporter.setEndLineEnding&&v.endLineEnding!==f.properties.endLineEnding},g.prototype.pointsAreEqual=function(f,v){var C=f.length;if(C!==f.length)return!1;for(var b=0;b<C;b++)if(!r.MathUtils.numberCloseTo(f[b],v[b]))return!1;return!0},g.prototype.updateEdgeObjectFromProperty=function(f,v,C){if(v.from=f&&f.key,v.dataObj){var b=f&&f.dataObj&&this.nodeDataImporter.getKey(f.dataObj);this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setFrom,v.dataObj,b,!1),C&&(this.isInUpdateNodeKeyRelatedObjects()?this.addToUpdateNodeKeyRelatedObjectsStackAction("edge",v):this.updateEdgeObjectFromOrToPropertyInternal(v,C))}},g.prototype.updateEdgeObjectFromOrToPropertyInternal=function(f,v){var C=this;this.beginChangesNotification(),v.notifyEdgeUpdated.call(v,this.nodeDataImporter.getKey(f.dataObj)||f.key,f.dataObj,function(b,S){C.endChangesNotification(!1)},function(b){C.endChangesNotification(!1)})},g.prototype.updateEdgeObjectToProperty=function(f,v,C){if(v.to=f&&f.key,v.dataObj){var b=f&&f.dataObj&&this.nodeDataImporter.getKey(f.dataObj);this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setTo,v.dataObj,b,!1),C&&(this.isInUpdateNodeKeyRelatedObjects()?this.addToUpdateNodeKeyRelatedObjectsStackAction("edge",v):this.updateEdgeObjectFromOrToPropertyInternal(v,C))}},g.prototype.updateEdgeObjectProperties=function(f,v,C){if(this.updateItemObjectProperties(v,f,this.edgeDataImporter),this.edgeDataImporter.setFrom){var b=this.findNode(f.beginItem&&f.beginItem.dataKey);this.updateEdgeObjectFromProperty(b,v)}if(this.edgeDataImporter.setTo){var S=this.findNode(f.endItem&&f.endItem.dataKey);this.updateEdgeObjectToProperty(S,v)}if(this.edgeDataImporter.setFromPointIndex&&(v.fromPointIndex=f.beginConnectionPointIndex,v.dataObj&&this.edgeDataImporter.setFromPointIndex(v.dataObj,f.beginConnectionPointIndex)),this.edgeDataImporter.setToPointIndex&&(v.toPointIndex=f.endConnectionPointIndex,v.dataObj&&this.edgeDataImporter.setToPointIndex(v.dataObj,f.endConnectionPointIndex)),this.edgeDataImporter.setPoints){var x=f.points.map(function(T){return{x:t.ModelUtils.getlUnitValue(C,T.x),y:t.ModelUtils.getlUnitValue(C,T.y)}});v.points=x,v.dataObj&&this.edgeDataImporter.setPoints(v.dataObj,x)}if(this.edgeDataImporter.setText){var I=void 0;f.getTextCount()===1&&f.getText()&&(I=f.getText());var w={};if(f.texts.forEach(function(T){w[T.position]=T.value}),v.texts=w,v.dataObj){var _="";I?_=I:w&&Object.keys(w).length&&(_=w),this.edgeDataImporter.setText(v.dataObj,_)}}this.edgeDataImporter.setLineOption&&(v.lineOption=f.properties.lineOption,v.dataObj&&this.edgeDataImporter.setLineOption(v.dataObj,f.properties.lineOption)),this.edgeDataImporter.setStartLineEnding&&(v.startLineEnding=f.properties.startLineEnding,v.dataObj&&this.edgeDataImporter.setStartLineEnding(v.dataObj,f.properties.startLineEnding)),this.edgeDataImporter.setEndLineEnding&&(v.endLineEnding=f.properties.endLineEnding,v.dataObj&&this.edgeDataImporter.setEndLineEnding(v.dataObj,f.properties.endLineEnding))},g.prototype.updateEdgeObjectKey=function(f,v,C){var b=C&&this.edgeDataImporter.getKey(C);if(b!=null&&b!==v.key&&(delete this.autoGeneratedDataKeys[v.key],v.key=b),f.dataKey=v.key,v.dataObj!==C){var S=this.edgeDataSource,x=S.indexOf(v.dataObj);S.splice(x,1,C),v.dataObj=C}},g.prototype.deleteEdges=function(f){var v=this;this.deleteItems(this.edges,function(C){return f.findConnectorByDataKey(C)},function(C){return v.edgeDataSource},function(C,b){var S=C.dataObj&&v.edgeDataImporter.getKey(C.dataObj)||C.key,x=v.findEdge(S);x&&v.edges.splice(v.edges.indexOf(x),1),b&&(v.beginChangesNotification(),v.changesListener.notifyEdgeRemoved.call(v.changesListener,S,C.dataObj,function(I,w){v.endChangesNotification(!1)},function(I){v.endChangesNotification(!1)}))})},g.prototype.beginNodeInserting=function(){this.nodeInsertingLockCount++},g.prototype.endNodeInserting=function(){this.nodeInsertingLockCount--,this.nodeInsertingLockCount===0&&this.raiseNodeInsertingStack()},g.prototype.isInNodeInserting=function(){return this.nodeInsertingLockCount>0},g.prototype.addToUpdateNodeKeyRelatedObjectsStack=function(f,v){var C=new a(f,v);this.updateNodeKeyRelatedObjectsStack.push(C)},g.prototype.raiseNodeInsertingStack=function(){for(this.beginUpdateNodeKeyRelatedObjects();this.updateNodeKeyRelatedObjectsStack.length>0;){var f=this.updateNodeKeyRelatedObjectsStack[0];this.updateNodeKeyRelatedObjects(f.shape,f.nodeObj),this.updateNodeKeyRelatedObjectsStack.splice(0,1),f.shape.description.hasTemplate&&f.nodeObj&&this.changesListener.reloadInsertedItem(f.nodeObj.key)}this.endUpdateNodeKeyRelatedObjects()},g.prototype.beginUpdateNodeKeyRelatedObjects=function(){this.updateNodeKeyRelatedObjectsCount++},g.prototype.endUpdateNodeKeyRelatedObjects=function(){this.updateNodeKeyRelatedObjectsCount--,this.updateNodeKeyRelatedObjectsCount===0&&this.raiseUpdateNodeKeyRelatedObjectsStack()},g.prototype.isInUpdateNodeKeyRelatedObjects=function(){return this.updateNodeKeyRelatedObjectsCount>0},g.prototype.addToUpdateNodeKeyRelatedObjectsStackAction=function(f,v){for(var C=new c(f,v),b=0;b<this.updateNodeKeyRelatedObjectsStackActions.length;b++)if(this.updateNodeKeyRelatedObjectsStackActions[b].kind===f&&this.updateNodeKeyRelatedObjectsStackActions[b].nodeObj===v)return;this.updateNodeKeyRelatedObjectsStackActions.push(C)},g.prototype.raiseUpdateNodeKeyRelatedObjectsStack=function(){for(;this.updateNodeKeyRelatedObjectsStackActions.length>0;){var f=this.updateNodeKeyRelatedObjectsStackActions[0];switch(f.kind){case"shape":this.updateNodeObjectContainerOrParentKeyInternal(f.nodeObj,this.changesListener);break;case"edge":this.updateEdgeObjectFromOrToPropertyInternal(f.nodeObj,this.changesListener)}this.updateNodeKeyRelatedObjectsStackActions.splice(0,1)}},g.prototype.beginChangesNotification=function(){this.changesListener.beginChangesNotification()},g.prototype.endChangesNotification=function(f){this.changesListener.endChangesNotification(f)},g}(i.DataSource);h.DocumentDataSource=l},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DataSource=void 0;var m=d(12),P=d(0),p=d(2),u=d(48),s=d(66),i=d(53),t=d(67),e=d(115),n=d(88),o=d(69),r=d(116),a=d(117),c=d(146),l=d(153),y=d(102),g=d(89),f=d(70),v=d(6),C=d(4),b=d(1),S=d(43),x=d(3),I=d(22),w=d(44),_=d(110),T=d(64),R=d(347),E=d(348),D=d(86),L=function(){function H(O,z,K,A,M,U){if(this.key=O,this.nodes=[],this.edges=[],this.autoGeneratedDataKeys={},this.addInternalKeyOnInsert=!1,this.useNodeParentId=!1,this.useNodeContainerId=!1,this.useNodeChildren=!1,this.useNodeItems=!1,this.canUseAutoSize=!1,this.canUpdateEdgeDataSource=!1,this.containers=null,O==null)throw new Error("DataSource key must be specified");this.key=O.toString(),this.loadParameters(A||{}),this.nodeDataImporter=this.createNodeDataImporter(M),this.edgeDataImporter=this.createEdgeDataImporter(U),this.nodeDataSource=z||[],this.edgeDataSource=K||[],this.canUpdateEdgeDataSource=!!K,this.fetchData()}return H.prototype.loadParameters=function(O){this.addInternalKeyOnInsert=!!O.addInternalKeyOnInsert},H.prototype.isAutoGeneratedKey=function(O){return O&&!!this.autoGeneratedDataKeys[O]},H.prototype.createNodeDataImporter=function(O){var z=new R.DataSourceNodeDataImporter;return O&&this.assignNodeDataImporterProperties(O,z),z},H.prototype.createEdgeDataImporter=function(O){var z=new R.DataSourceEdgeDataImporter;return O&&this.assignEdgeDataImporterProperties(O,z),z},H.prototype.assignItemDataImporterProperties=function(O,z){O.getKey&&(z.getKey=O.getKey),O.setKey&&(z.setKey=O.setKey),O.getCustomData&&(z.getCustomData=O.getCustomData),O.setCustomData&&(z.setCustomData=O.setCustomData),O.getLocked&&(z.getLocked=O.getLocked),O.setLocked&&(z.setLocked=O.setLocked),O.getStyle&&(z.getStyle=O.getStyle),O.setStyle&&(z.setStyle=O.setStyle),O.getStyleText&&(z.getStyleText=O.getStyleText),O.setStyleText&&(z.setStyleText=O.setStyleText),O.getZIndex&&(z.getZIndex=O.getZIndex),O.setZIndex&&(z.setZIndex=O.setZIndex)},H.prototype.assignNodeDataImporterProperties=function(O,z){this.assignItemDataImporterProperties(O,z),O.getType&&(z.getType=O.getType),O.setType&&(z.setType=O.setType),O.getImage&&(z.getImage=O.getImage),O.setImage&&(z.setImage=O.setImage),O.getText&&(z.getText=O.getText),O.setText&&(z.setText=O.setText),O.getLeft&&(z.getLeft=O.getLeft),O.setLeft&&(z.setLeft=O.setLeft),O.getTop&&(z.getTop=O.getTop),O.setTop&&(z.setTop=O.setTop),O.getWidth&&(z.getWidth=O.getWidth),O.setWidth&&(z.setWidth=O.setWidth),O.getHeight&&(z.getHeight=O.getHeight),O.setHeight&&(z.setHeight=O.setHeight),O.getChildren&&(z.getChildren=O.getChildren),O.setChildren&&(z.setChildren=O.setChildren),O.getParentKey&&(z.getParentKey=O.getParentKey),O.setParentKey&&(z.setParentKey=O.setParentKey),O.getItems&&(z.getItems=O.getItems),O.setItems&&(z.setItems=O.setItems),O.getContainerKey&&(z.getContainerKey=O.getContainerKey),O.setContainerKey&&(z.setContainerKey=O.setContainerKey)},H.prototype.assignEdgeDataImporterProperties=function(O,z){this.assignItemDataImporterProperties(O,z),O.getFrom&&(z.getFrom=O.getFrom),O.setFrom&&(z.setFrom=O.setFrom),O.getFromPointIndex&&(z.getFromPointIndex=O.getFromPointIndex),O.setFromPointIndex&&(z.setFromPointIndex=O.setFromPointIndex),O.getTo&&(z.getTo=O.getTo),O.setTo&&(z.setTo=O.setTo),O.getToPointIndex&&(z.getToPointIndex=O.getToPointIndex),O.setToPointIndex&&(z.setToPointIndex=O.setToPointIndex),O.getPoints&&(z.getPoints=O.getPoints),O.setPoints&&(z.setPoints=O.setPoints),O.getText&&(z.getText=O.getText),O.setText&&(z.setText=O.setText),O.getLineOption&&(z.getLineOption=O.getLineOption),O.setLineOption&&(z.setLineOption=O.setLineOption),O.getStartLineEnding&&(z.getStartLineEnding=O.getStartLineEnding),O.setStartLineEnding&&(z.setStartLineEnding=O.setStartLineEnding),O.getEndLineEnding&&(z.getEndLineEnding=O.getEndLineEnding),O.setEndLineEnding&&(z.setEndLineEnding=O.setEndLineEnding)},H.prototype.fetchData=function(){var O=this;if(this.nodes=[],this.edges=[],this.autoGeneratedDataKeys={},this.useNodeParentId=this.nodeDataImporter.getParentKey!==void 0,this.useNodeContainerId=this.nodeDataImporter.getContainerKey!==void 0,this.useNodeItems=this.nodeDataImporter.getItems!==void 0,this.useNodeChildren=this.nodeDataImporter.getChildren!==void 0,this.canUseAutoSize=this.nodeDataImporter.getWidth===void 0&&this.nodeDataImporter.getText!==void 0,this.useEdgesArray()&&this.useNodeParentId)throw new Error("You cannot use edges array and parentKey simultaneously.");if(this.useEdgesArray()&&this.useNodeItems)throw new Error("You cannot use edges array and items array simultaneously.");if(this.useNodeParentId&&this.useNodeItems)throw new Error("You cannot use parentKey and items array simultaneously.");if(this.useNodeContainerId&&this.useNodeChildren)throw new Error("You cannot use containerKey and children array simultaneously.");this.nodeDataSource.forEach(function(z){O.addNode(z)}),this.useEdgesArray()?this.edgeDataSource.forEach(function(z){O.addEdge(z)}):this.nodes.forEach(function(z){O.addNodeEdgesByParentId(z)})},H.prototype.isContainer=function(O){var z=this;return!this.containers&&this.useNodeContainerId&&(this.containers=this.nodeDataSource.map(function(K){return z.nodeDataImporter.getContainerKey(K)}).filter(function(K){return K!=null}).reduce(function(K,A){return K[A]=!0,K},{})),this.containers&&this.containers[O]},H.prototype.refetchData=function(O,z){var K=this;this.nodeDataSource=O||this.nodeDataSource,this.edgeDataSource=z||this.edgeDataSource;var A=this.nodes.slice(),M=this.edges.slice();return this.fetchData(),{nodes:this.getItemChanges(A,this.nodes,function(U,V){return U.key===V.key||U.dataObj===V.dataObj}),edges:this.getItemChanges(M,this.edges,function(U,V){return K.useNodeParentId||K.useNodeItems?U.key===V.key||U.from===V.from&&U.to===V.to:U.key===V.key||U.dataObj===V.dataObj})}},H.prototype.getItemChanges=function(O,z,K){var A=this,M=O.filter(function(G){return A.containsItem(z,G,K)}),U=O.filter(function(G){return!A.containsItem(z,G,K)}),V=z.filter(function(G){return!A.containsItem(O,G,K)});return{remained:M.map(function(G){return G.key}),remainedNewKeys:M.map(function(G){var Y;return(Y=z.find(function(tt){return K(G,tt)}))===null||Y===void 0?void 0:Y.key}),removed:U.map(function(G){return G.key}),added:V.map(function(G){return G.key})}},H.prototype.containsItem=function(O,z,K){var A=!1;return O.forEach(function(M){!A&&K(M,z)&&(A=!0)}),A},H.prototype.useEdgesArray=function(){return Array.isArray(this.edgeDataSource)&&(this.edgeDataSource.length||!(this.useNodeParentId||this.useNodeItems))},H.prototype.addNode=function(O,z,K,A){var M=this,U=this.nodeDataImporter.getChildren&&this.nodeDataImporter.getChildren(O),V=U&&Array.isArray(U)&&U.length,G=V||this.isContainer(this.nodeDataImporter.getKey(O)),Y=this.nodeDataImporter.getType&&this.nodeDataImporter.getType(O)||G&&b.ShapeTypes.VerticalContainer||b.ShapeTypes.Rectangle,tt=this.nodeDataImporter.getText&&(this.nodeDataImporter.getText(O)||""),W=this.addNodeInternal(O,Y,tt,z,K,A);if(this.assignNodeProperties(W,O),V&&U.forEach(function(k){M.addNode(k,void 0,W.key,O)}),this.useNodeItems){var N=this.nodeDataImporter.getItems(O);Array.isArray(N)&&N.length&&N.forEach(function(k){var B=M.addNode(k,O,K,A);M.addEdgeInternal(void 0,W.key,B.key)})}return W},H.prototype.addNodeEdgesByParentId=function(O){if(this.useNodeParentId){var z=this.nodeDataImporter.getParentKey(O.dataObj);z!=null&&this.findNode(z)&&this.addEdgeInternal(void 0,this.getNodeKey(O.dataObj,this.nodeDataImporter.getParentKey),this.getNodeKey(O.dataObj,this.nodeDataImporter.getKey))}},H.prototype.addNodeInternal=function(O,z,K,A,M,U){var V=this.nodeDataImporter.getKey(O),G=V??C.ModelUtils.getGuidItemKey(),Y=new E.DataSourceNodeItem(this.key,G,O,z,K,A,M,U);return this.nodes.push(Y),V==null&&(V=G,this.autoGeneratedDataKeys[G]=!0),Y},H.prototype.addEdge=function(O){var z=this.addEdgeInternal(O,this.getNodeKey(O,this.edgeDataImporter.getFrom),this.getNodeKey(O,this.edgeDataImporter.getTo));return this.assignEdgeProperties(z,O),z},H.prototype.addEdgeInternal=function(O,z,K){var A=O&&this.edgeDataImporter.getKey(O),M=A??C.ModelUtils.getGuidItemKey(),U=new E.DataSourceEdgeItem(this.key,M,O,z,K);return this.edges.push(U),A==null&&(A=M,this.autoGeneratedDataKeys[M]=!0),U},H.prototype.assignItemProperties=function(O,z,K){if(K.getCustomData&&(O.customData=x.ObjectUtils.cloneObject(K.getCustomData(z))),K.getLocked&&(O.locked=K.getLocked(z)),K.getStyle){var A=K.getStyle(z);O.style=typeof A=="string"?w.Data.cssTextToObject(A):A}K.getStyleText&&(A=K.getStyleText(z),O.styleText=typeof A=="string"?w.Data.cssTextToObject(A):A),K.getZIndex&&(O.zIndex=K.getZIndex(z))},H.prototype.assignNodeProperties=function(O,z){this.assignItemProperties(O,z,this.nodeDataImporter),this.nodeDataImporter.getImage&&(O.image=this.nodeDataImporter.getImage(z)),this.nodeDataImporter.getLeft&&(O.left=this.nodeDataImporter.getLeft(z)),this.nodeDataImporter.getTop&&(O.top=this.nodeDataImporter.getTop(z)),this.nodeDataImporter.getWidth&&(O.width=this.nodeDataImporter.getWidth(z)),this.nodeDataImporter.getHeight&&(O.height=this.nodeDataImporter.getHeight(z)),this.nodeDataImporter.getContainerKey&&(O.containerKey=this.nodeDataImporter.getContainerKey(z))},H.prototype.assignEdgeProperties=function(O,z){if(this.assignItemProperties(O,z,this.edgeDataImporter),this.edgeDataImporter.getFromPointIndex&&(O.fromPointIndex=this.edgeDataImporter.getFromPointIndex(z)),this.edgeDataImporter.getToPointIndex&&(O.toPointIndex=this.edgeDataImporter.getToPointIndex(z)),this.edgeDataImporter.getPoints&&(O.points=this.edgeDataImporter.getPoints(z)),this.edgeDataImporter.getText){var K=this.edgeDataImporter.getText(z);if(O.texts={},typeof K=="object"){for(var A in K)if(Object.prototype.hasOwnProperty.call(K,A)){var M=parseFloat(A),U=K[A];isNaN(M)||typeof U!="string"||U===""||(M=Math.min(1,Math.max(0,M)),O.texts[M]=U)}}else typeof K=="string"&&K!==""&&(O.texts[v.CONNECTOR_DEFAULT_TEXT_POSITION]=K)}this.edgeDataImporter.getLineOption&&(O.lineOption=this.edgeDataImporter.getLineOption(z)),this.edgeDataImporter.getStartLineEnding&&(O.startLineEnding=this.edgeDataImporter.getStartLineEnding(z)),this.edgeDataImporter.getEndLineEnding&&(O.endLineEnding=this.edgeDataImporter.getEndLineEnding(z))},H.prototype.findNode=function(O){return this.nodes.filter(function(z){return O!==void 0&&z.key===O})[0]},H.prototype.findEdge=function(O){return this.edges.filter(function(z){return O!==void 0&&z.key===O})[0]},H.prototype.getNodeKey=function(O,z){return z(O)},H.prototype.createModelItems=function(O,z,K,A,M,U,V,G){var Y=this;this.beginChangesNotification(),O.clear(),O.beginTransaction(),C.ModelUtils.deleteAllItems(O,z,A),z.initializeKeyCounter();var tt=0,W=0,N={},k=[],B=[];this.nodes.forEach(function(F){var Z=new P.Point(2e3*W++,2e3*tt),q=Y.createShapeByNode(O,z,A,K,F,Z,M,U,V,G);F.key!==void 0&&(N[F.key]=q.key),W>4&&(W=0,tt++),k.push(q)}),this.nodes.forEach(function(F){if(F.containerKey!==void 0&&F.containerKey!==null){var Z=N[F.key],q=z.findShape(Z),J=N[F.containerKey],$=z.findShape(J);$&&C.ModelUtils.insertToContainer(O,z,q,$)}}),this.edges.forEach(function(F){var Z=z.findShape(N[F.to]),q=z.findShape(N[F.from]),J=Y.createConnectorByEdge(O,z,A,F,q,Z);J&&(B.push(J),C.ModelUtils.updateConnectorContainer(O,z,J))}),M.needAutoLayout&&this.applyLayout(O,z,k,B,M,U,V),C.ModelUtils.tryUpdateModelRectangle(O),O.endTransaction(!0),this.endChangesNotification(!0)},H.prototype.updateModelItems=function(O,z,K,A,M,U,V,G,Y,tt,W,N){var k=this;this.beginChangesNotification(),O.beginTransaction();var B=[],F=[],Z=[],q=Y.nodes.removed.map(function(Q){return z.findShapeByDataKey(Q)}).filter(function(Q){return Q});q.forEach(function(Q){Q.attachedConnectors.forEach(function(nt){nt.beginItem&&nt.beginItem!==Q&&F.push(nt.beginItem),nt.endItem&&nt.endItem!==Q&&F.push(nt.endItem)})}),C.ModelUtils.deleteItems(O,z,A,q,!0);var J=Y.edges.removed.map(function(Q){return z.findConnectorByDataKey(Q)}).filter(function(Q){return Q});J.forEach(function(Q){Q.beginItem&&F.push(Q.beginItem),Q.endItem&&F.push(Q.endItem)}),C.ModelUtils.deleteItems(O,z,A,J,!0),F=this.purgeLayoutShapes(F,q),(V||[]).forEach(function(Q){if(Y.nodes.remained.indexOf(Q)!==-1){var nt=k.findNode(Q);if(nt){var ot=z.findShapeByDataKey(Q);if(ot){var it=ot.position.clone();k.changeShapeByDataItem(O,z,ot,nt,it),k.changeItemByDataItem(O,ot,nt)}else ot=k.createShapeByNode(O,z,A,K,nt,new P.Point(0,0),M,tt,W,N);k.updateShapeContainer(O,z,ot,nt),F.push(ot),B.push(ot)}}}),Y.nodes.remained.forEach(function(Q,nt){var ot=z.findShapeByDataKey(Q);ot&&(ot.dataKey=Y.nodes.remainedNewKeys[nt])}),Y.nodes.added.forEach(function(Q){var nt=k.findNode(Q),ot=k.createShapeByNode(O,z,A,K,nt,new P.Point(0,0),M,tt,W,N);k.updateShapeContainer(O,z,ot,nt),F.push(ot)}),Y.edges.added.forEach(function(Q){var nt=k.findEdge(Q),ot=z.findShapeByDataKey(nt.from),it=z.findShapeByDataKey(nt.to),rt=k.createConnectorByEdge(O,z,A,nt,ot,it);rt&&(C.ModelUtils.updateConnectorContainer(O,z,rt),Z.push(rt))});var $=V||[];Y.edges.remained.forEach(function(Q){var nt=k.findEdge(Q);!nt||Y.nodes.added.indexOf(nt.from)===-1&&Y.nodes.added.indexOf(nt.to)===-1||$.push(Q)}),$.forEach(function(Q){if(Y.edges.remained.indexOf(Q)!==-1){var nt=k.findEdge(Q);if(nt){var ot=z.findShapeByDataKey(nt.from),it=z.findShapeByDataKey(nt.to),rt=z.findConnectorByDataKey(Q);rt?(k.changeConnectorPointsByDataItem(O,rt,k.getConnectorPointsByEdge(z,nt,ot,it,!1)),k.changeConnectorByDataItem(O,z,rt,ot,it,nt),k.changeItemByDataItem(O,rt,nt)):rt=k.createConnectorByEdge(O,z,A,nt,ot,it),rt&&(C.ModelUtils.updateConnectorContainer(O,z,rt),Z.push(rt),B.push(rt))}}}),Y.edges.remained.forEach(function(Q,nt){var ot=z.findConnectorByDataKey(Q);ot&&(ot.dataKey=Y.edges.remainedNewKeys[nt])}),B.length&&G&&B.forEach(function(Q){Q.hasTemplate&&G(Q)}),M.needAutoLayout&&(F.length||Z.length)&&this.applyLayout(O,z,F,Z,M,tt,W),C.ModelUtils.tryUpdateModelRectangle(O),O.endTransaction(!U),this.endChangesNotification(!1)},H.prototype.purgeLayoutShapes=function(O,z){var K=z.reduce(function(A,M){return(A[M.key]=!0)&&A},{});return O.reduce(function(A,M){return A.keySet[M.key]===void 0&&K[M.key]===void 0&&(A.uniqueShapes.push(M),A.keySet[M.key]=!0),A},{uniqueShapes:[],keySet:{}}).uniqueShapes},H.prototype.applyShapeAutoSize=function(O,z,K,A,M,U){if(A.description.enableText){var V=A.textRectangle.createSize(),G=A.size,Y=V.width-G.width,tt=V.height-G.height,W=A.getMaxWidth(K.shapeMaxWidth),N=A.getMaxHeight(K.shapeMaxHeight),k=function(Z,q){return typeof Z=="number"?m.UnitConverter.twipsToPixelsF(Z+(q?Y:tt)):void 0},B=T.getOptimalTextRectangle(A.text,A.styleText,S.TextOwner.Shape,z,V.clone().applyConverter(m.UnitConverter.twipsToPixelsF),A.description.keepRatioOnAutoSize,k(A.getMinWidth(K.shapeMinWidth),!0),k(W,!0),k(A.getMinHeight(K.shapeMinHeight),!1),k(N,!1)).clone().applyConverter(m.UnitConverter.pixelsToTwips);if(!B.equals(V)){var F=A.description.getSizeByText(B,A);M&&U&&(F=new p.Size(Math.min(U*Math.ceil(F.width/U),W||Number.MAX_VALUE),Math.min(U*Math.ceil(F.height/U),N||Number.MAX_VALUE))),O.addAndRedo(new e.ResizeShapeHistoryItem(A.key,A.position,F))}}},H.prototype.applyLayout=function(O,z,K,A,M,U,V){C.ModelUtils.getGraphInfoByItems(z,K,A).forEach(function(G){var Y=M.getLayoutBuilder(G.graph).build(),tt=C.ModelUtils.getNonGraphItems(z,G.container,Y.nodeToLayout,K,A);C.ModelUtils.applyLayout(O,z,G.container,G.graph,Y,tt,M.layoutSettings,U,V,M.skipPointIndices)})},H.prototype.changeItemByDataItem=function(O,z,K){if(K.customData===void 0||x.ObjectUtils.compareObjects(K.customData,z.customData)||O.addAndRedo(new r.ChangeCustomDataHistoryItem(z.key,K.customData)),K.zIndex!==void 0&&K.zIndex!==z.zIndex&&O.addAndRedo(new y.ChangeZindexHistoryItem(z,K.zIndex)),K.style!==void 0)for(var A in K.style)Object.prototype.hasOwnProperty.call(K.style,A)&&(U=this.getPreparedStyleValue(K.style[A],_.isColorProperty(A)))!==z.style[A]&&O.addAndRedo(new g.ChangeStyleHistoryItem(z.key,A,U));var M=z.style.getDefaultInstance();if(z.style.forEach(function(G){K.style&&K.style[G]===void 0&&z.style[G]!==M[G]&&O.addAndRedo(new g.ChangeStyleHistoryItem(z.key,G,M[G]))}),K.styleText!==void 0)for(var A in K.styleText){var U;Object.prototype.hasOwnProperty.call(K.styleText,A)&&(U=this.getPreparedStyleValue(K.styleText[A],_.isColorProperty(A)))!==z.styleText[A]&&O.addAndRedo(new f.ChangeStyleTextHistoryItem(z.key,A,U))}var V=z.styleText.getDefaultInstance();z.styleText.forEach(function(G){K.styleText&&K.styleText[G]===void 0&&z.styleText[G]!==V[G]&&O.addAndRedo(new f.ChangeStyleTextHistoryItem(z.key,G,V[G]))}),K.locked!==void 0&&K.locked!==z.locked&&O.addAndRedo(new a.ChangeLockedHistoryItem(z,K.locked))},H.prototype.getPreparedStyleValue=function(O,z){if(z){var K=I.ColorUtils.stringToHash(O);K!==null&&(O=K)}return O},H.prototype.createShapeByNode=function(O,z,K,A,M,U,V,G,Y,tt){var W=new i.AddShapeHistoryItem(A.get(M.type),U,"",M.key);O.addAndRedo(W);var N=z.findShape(W.shapeKey);return C.ModelUtils.updateNewShapeProperties(O,K,W.shapeKey),this.changeShapeByDataItem(O,z,N,M,U),this.changeItemByDataItem(O,N,M),tt&&this.canUseAutoSize&&V.autoSizeEnabled&&this.applyShapeAutoSize(O,tt,V.sizeSettings,N,G,Y),N},H.prototype.changeShapeByDataItem=function(O,z,K,A,M){A.left!==void 0&&(M.x=C.ModelUtils.getTwipsValue(z.units,A.left)),A.top!==void 0&&(M.y=C.ModelUtils.getTwipsValue(z.units,A.top)),C.ModelUtils.setShapePosition(O,z,K,M,!1);var U=K.size.clone();A.width!==void 0&&(U.width=C.ModelUtils.getTwipsValue(z.units,A.width)),A.height!==void 0&&(U.height=C.ModelUtils.getTwipsValue(z.units,A.height)),C.ModelUtils.setShapeSize(O,z,K,M,U),C.ModelUtils.updateShapeAttachedConnectors(O,z,K),A.text!==void 0&&A.text!==K.text&&O.addAndRedo(new l.ChangeShapeTextHistoryItem(K,A.text)),A.image!==void 0&&A.image!==K.image.actualUrl&&O.addAndRedo(new c.ChangeShapeImageHistoryItem(K,A.image))},H.prototype.updateShapeContainer=function(O,z,K,A){var M=A.containerKey!==void 0?z.findShapeByDataKey(A.containerKey):void 0;M!==K.container&&(M?C.ModelUtils.insertToContainer(O,z,K,M):C.ModelUtils.removeFromContainer(O,z,K))},H.prototype.getConnectorPointsByEdge=function(O,z,K,A,M){var U=[],V=this.createModelPointFromDataSourceEdgeItemPoints(O.units,z);if(V&&V.length>1)for(var G=V.length-1,Y=0;Y<=G;Y++){var tt=V[Y];if(tt!==null)U.push(tt);else{if(!K&&!A)return;Y===0&&K?U.push(K.position.clone()):Y===G&&A&&U.push(A.position.clone())}}else M&&(K&&U.push(K.position.clone()),A&&U.push(A.position.clone()));return U},H.prototype.createModelPointFromDataSourceEdgeItemPoints=function(O,z){var K=this,A=[];if(Array.isArray(z.points))return z.points.forEach(function(M){return A.push(K.isValidDataSourceEdgeItemPoint(M)?K.createModelPoint(O,M):null)}),A},H.prototype.createModelPoint=function(O,z){return new P.Point(C.ModelUtils.getTwipsValue(O,z.x),C.ModelUtils.getTwipsValue(O,z.y))},H.prototype.isValidDataSourceEdgeItemPoint=function(O){return O!=null&&O.x!==void 0&&O.y!==void 0&&O.x!==null&&O.y!==null},H.prototype.createConnectorByEdge=function(O,z,K,A,M,U){var V,G=A.key,Y=this.getConnectorPointsByEdge(z,A,M,U,!0);if(Y&&Y.length>1){var tt=new s.AddConnectorHistoryItem(Y,G);O.addAndRedo(tt),V=z.findConnector(tt.connectorKey),C.ModelUtils.updateNewConnectorProperties(O,K,tt.connectorKey),this.changeConnectorByDataItem(O,z,V,M,U,A),this.changeItemByDataItem(O,V,A)}return V},H.prototype.changeConnectorByDataItem=function(O,z,K,A,M,U){var V=U.fromPointIndex!==void 0?U.fromPointIndex:K.beginConnectionPointIndex;K.beginItem===A&&K.beginConnectionPointIndex===V||(K.beginItem&&O.addAndRedo(new t.DeleteConnectionHistoryItem(K,v.ConnectorPosition.Begin)),A&&O.addAndRedo(new u.AddConnectionHistoryItem(K,A,V,v.ConnectorPosition.Begin)));var G=U.toPointIndex!==void 0?U.toPointIndex:K.endConnectionPointIndex;if(K.endItem===M&&K.endConnectionPointIndex===G||(K.endItem&&O.addAndRedo(new t.DeleteConnectionHistoryItem(K,v.ConnectorPosition.End)),M&&O.addAndRedo(new u.AddConnectionHistoryItem(K,M,G,v.ConnectorPosition.End))),C.ModelUtils.updateConnectorAttachedPoints(O,z,K),U.texts!==void 0&&!this.compareTexts(U,K)){for(var Y in K.texts.forEach(function(W){O.addAndRedo(new o.ChangeConnectorTextHistoryItem(K,W.position,void 0))}),U.texts)if(Object.prototype.hasOwnProperty.call(U.texts,Y)){var tt=parseFloat(Y);O.addAndRedo(new o.ChangeConnectorTextHistoryItem(K,tt,U.texts[Y]))}}U.lineOption!==void 0&&U.lineOption!==K.properties.lineOption&&O.addAndRedo(new n.ChangeConnectorPropertyHistoryItem(K.key,"lineOption",U.lineOption)),U.startLineEnding!==void 0&&U.startLineEnding!==K.properties.startLineEnding&&O.addAndRedo(new n.ChangeConnectorPropertyHistoryItem(K.key,"startLineEnding",U.startLineEnding)),U.endLineEnding!==void 0&&U.endLineEnding!==K.properties.endLineEnding&&O.addAndRedo(new n.ChangeConnectorPropertyHistoryItem(K.key,"endLineEnding",U.endLineEnding))},H.prototype.changeConnectorPointsByDataItem=function(O,z,K){K&&K.length>1&&K.join(",")!==z.points.join(",")&&O.addAndRedo(new D.ReplaceConnectorPointsHistoryItem(z.key,K))},H.prototype.compareTexts=function(O,z){var K=O.texts||{},A=Object.keys(K).length===z.getTextCount();if(A){for(var M in K)if(Object.prototype.hasOwnProperty.call(K,M)){var U=parseFloat(M);this.compareStrings(z.getText(U),K[M])||(A=!1)}}return A},H.prototype.compareStrings=function(O,z){return typeof O=="string"&&typeof z=="string"?O===z:this.isEmptyString(O)&&this.isEmptyString(z)},H.prototype.isEmptyString=function(O){return O===""||O==null},H}();h.DataSource=L},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(i,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])})(i,t)},function(i,t){function e(){this.constructor=i}m(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0}),h.DataSourceEdgeDataImporter=h.DataSourceNodeDataImporter=h.DataSourceItemDataImporter=void 0;var p=function(){return function(){this.getKey=function(i){return i.id},this.setKey=function(i,t){i.id=t},this.getCustomData=void 0,this.setCustomData=void 0,this.getLocked=void 0,this.setLocked=void 0,this.getStyle=void 0,this.setStyle=void 0,this.getStyleText=void 0,this.setStyleText=void 0,this.getZIndex=void 0,this.setZIndex=void 0}}();h.DataSourceItemDataImporter=p;var u=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.getType=void 0,e.setType=void 0,e.getText=void 0,e.setText=void 0,e.getImage=void 0,e.setImage=void 0,e.getLeft=void 0,e.setLeft=void 0,e.getTop=void 0,e.setTop=void 0,e.getWidth=void 0,e.setWidth=void 0,e.getHeight=void 0,e.setHeight=void 0,e.getChildren=void 0,e.setChildren=void 0,e.getParentKey=void 0,e.setParentKey=void 0,e.getItems=void 0,e.setItems=void 0,e.getContainerKey=void 0,e.setContainerKey=void 0,e}return P(t,i),t}(p);h.DataSourceNodeDataImporter=u;var s=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.getFrom=function(n){return n.from},e.setFrom=function(n,o){n.from=o},e.getFromPointIndex=void 0,e.setFromPointIndex=void 0,e.getTo=function(n){return n.to},e.setTo=function(n,o){n.to=o},e.getToPointIndex=void 0,e.setToPointIndex=void 0,e.getPoints=void 0,e.setPoints=void 0,e.getText=void 0,e.setText=void 0,e.getLineOption=void 0,e.setLineOption=void 0,e.getStartLineEnding=void 0,e.setStartLineEnding=void 0,e.getEndLineEnding=void 0,e.setEndLineEnding=void 0,e}return P(t,i),t}(p);h.DataSourceEdgeDataImporter=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.DataSourceEdgeItem=h.DataSourceNodeItem=h.DataSourceItem=void 0;var p=d(6),u=function(){return function(t,e,n){this.sourceKey=t,this.key=e,this.dataObj=n}}();h.DataSourceItem=u;var s=function(t){function e(n,o,r,a,c,l,y,g){var f=t.call(this,n,o,r)||this;return f.type=a,f.text=c,f.parentDataObj=l,f.containerKey=y,f.containerDataObj=g,f}return P(e,t),e}(u);h.DataSourceNodeItem=s;var i=function(t){function e(n,o,r,a,c){var l=t.call(this,n,o,r)||this;return l.sourceKey=n,l.from=a,l.to=c,l}return P(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this.texts&&this.texts[p.CONNECTOR_DEFAULT_TEXT_POSITION]},enumerable:!1,configurable:!0}),e}(u);h.DataSourceEdgeItem=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ViewController=void 0;var m=d(82),P=Math.log(.05),p=Math.log(3),u=40,s=n(1),i=[m.DiagramCommand.ZoomLevel,m.DiagramCommand.ZoomLevelInPercentage,m.DiagramCommand.Zoom100,m.DiagramCommand.Zoom125,m.DiagramCommand.Zoom200,m.DiagramCommand.Zoom25,m.DiagramCommand.Zoom50,m.DiagramCommand.Zoom75],t=[m.DiagramCommand.SwitchAutoZoom,m.DiagramCommand.ToggleAutoZoom,m.DiagramCommand.AutoZoomToContent,m.DiagramCommand.AutoZoomToWidth],e=function(){function o(r,a){this.settings=r,this.bars=a,r.onZoomChanged.add(this),this.autoZoom=r.autoZoom}return o.prototype.initialize=function(r){this.view=r,this.view.onViewChanged.add(this)},o.prototype.scrollTo=function(r,a){this.view&&this.view.setScrollTo(r,a)},o.prototype.scrollBy=function(r){return!this.view||r.x===0&&r.y===0?r:this.view.scrollBy(r)},o.prototype.scrollIntoView=function(r){this.view&&this.view.scrollIntoView(r)},o.prototype.normalize=function(){this.view.tryNormalizePaddings()},o.prototype.getNextStepZoom=function(r){var a=this.getNearestCurrentZoomStep(),c=r?1:-1,l=Math.min(u-1,Math.max(0,a+c));if(l!==s){var y=P+(p-P)*l/(u-1);return Math.exp(y)}return 1},o.prototype.getNearestCurrentZoomStep=function(){return n(this.getZoom())},o.prototype.getZoom=function(){return this.view?this.view.actualZoom:this.settings.zoomLevel},o.prototype.resetScroll=function(){this.view.adjust({horizontal:!0,vertical:!0})},o.prototype.notifyViewAdjusted=function(r){},o.prototype.notifyActualZoomChanged=function(r){this.bars.updateItemsState(i)},o.prototype.notifyZoomChanged=function(r,a){this.autoZoom!==a&&(this.autoZoom=a,this.bars.updateItemsState(t))},o}();function n(o){var r=Math.log(o);return Math.round((r-P)*(u-1)/(p-P))}h.ViewController=e},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ToolboxManager=void 0;var m=d(351),P=d(352),p=d(79),u=d(31),s=function(){function i(t){this.shapeDescriptionManager=t,this.toolboxes=[],this.measurers={}}return i.prototype.create=function(t,e,n,o,r,a,c){var l=Array.isArray(r)?r:this.shapeDescriptionManager.getTypesByCategory(r),y=o?new m.TextToolbox(t,e,n,this.shapeDescriptionManager,l,a):new P.IconToolbox(t,e,n,this.shapeDescriptionManager,l,a,c,this.getOrCreateMeasurer(t));return y.render(),this.toolboxes.push(y),y},i.prototype.clean=function(t,e){var n=this;if(e)e.clean(t),this.toolboxes.splice(this.toolboxes.indexOf(e),1),Object.keys(this.measurers).forEach(function(r){n.measurers[r]===e.measurer&&delete n.measurers[r]});else{for(var o=0;o<this.toolboxes.length;o++)this.toolboxes[o].clean(t);this.toolboxes=[],this.measurers={}}},i.prototype.refresh=function(t){this.toolboxes.forEach(function(e,n){(!t||Array.isArray(t)&&t.indexOf(n)>-1||n===t)&&e.render()})},i.prototype.applyFilter=function(t,e){var n=this;return this.toolboxes.reduce(function(o,r,a){return(!e||Array.isArray(e)&&e.indexOf(a)>-1||a===e)&&r.render(function(c){return n.searchFilter(c,t,a)})&&o.push(a),o},[])},i.prototype.searchFilter=function(t,e,n,o){if(!e||o&&o.indexOf(n)===-1)return!0;e=e.toLowerCase();var r=this.shapeDescriptionManager.get(t);return r.getTitle().toLowerCase().indexOf(e)>-1||r.getDefaultText().toLowerCase().indexOf(e)>-1},i.prototype.getOrCreateMeasurer=function(t){var e=t.getAttribute("data-dxdiMeasurerID");return e&&this.measurers[e]||(e=u.MathUtils.generateGuid(),this.measurers[e]=new p.TextMeasurer(t),t.setAttribute("data-dxdiMeasurerID",e)),this.measurers[e]},i}();h.ToolboxManager=s},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(u,s){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(u,s)},function(u,s){function i(){this.constructor=u}m(u,s),u.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)});Object.defineProperty(h,"__esModule",{value:!0}),h.TextToolbox=void 0;var p=function(u){function s(i,t,e,n,o,r){return u.call(this,i,t,e,n,o,r)||this}return P(s,u),s.prototype.createElements=function(i,t){var e=this;t.forEach(function(n){var o=e.shapeDescriptionManager.get(n),r=document.createElement("div");r.setAttribute("class","toolbox-text-item"),r.setAttribute("data-tb-type",n),r.textContent=o.getDefaultText()||o.getTitle(),i.appendChild(r)})},s.prototype.createDraggingElement=function(i){var t=document.createElement("DIV");t.setAttribute("class","dxdi-toolbox-drag-text-item");var e=this.shapeDescriptionManager.get(i.evt.data);return t.textContent=e.getDefaultText()||e.getTitle(),document.body.appendChild(t),t},s}(d(159).Toolbox);h.TextToolbox=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(c,l){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var f in g)g.hasOwnProperty(f)&&(y[f]=g[f])})(c,l)},function(c,l){function y(){this.constructor=c}m(c,l),c.prototype=l===null?Object.create(l):(y.prototype=l.prototype,new y)});Object.defineProperty(h,"__esModule",{value:!0}),h.IconToolbox=void 0;var p=d(159),u=d(15),s=d(14),i=d(12),t=d(0),e=d(121),n=d(26),o=d(126),r=d(21),a=function(c){function l(y,g,f,v,C,b,S,x){var I=c.call(this,y,g,f,v,C,b)||this;return I.options=S,I.measurer=x,I}return P(l,c),l.prototype.createElements=function(y,g){var f=document.createElementNS(u.svgNS,"svg");f.className.baseVal="dxdi-canvas",y.appendChild(f),this.drawShapeIcons(f,g,this.options.toolboxWidth||f.getBoundingClientRect().width)},l.prototype.drawShapeIcons=function(y,g,f){var v=this,C=n.DEFAULT_STROKE_WIDTH,b=f-2*C,S=this.options.shapeIconSize;!S&&this.options.shapeIconSpacing&&this.options.shapeIconCountInRow&&(S=Math.floor((b-(this.options.shapeIconCountInRow-1)*this.options.shapeIconSpacing)/this.options.shapeIconCountInRow)),S||(S=32);var x=S=Math.max(S,this.options.shapeIconSpacing/2),I=this.options.shapeIconCountInRow;if(!I)for(I=1;x<b;)(x+=this.options.shapeIconSpacing+S)<b&&I++;var w=I>1?(b-S*I)/(I-1):0,_=C,T=C,R=i.UnitConverter.pixelsToTwips(S);g.forEach(function(E,D){D>0&&D%I==0&&(_=C,T+=S+w);var L=v.shapeDescriptionManager.get(E),H=v.createShape(L,_,T,S<26);v.updateShapeIconBounds(H,S);var O=v.drawShape(y,H);v.drawSelector(O,i.UnitConverter.pixelsToTwips(_),i.UnitConverter.pixelsToTwips(T),R),_+=S+w}),y.style.height=T+S+C+"px",y.style.width=f+"px"},l.prototype.drawShape=function(y,g){var f=this,v=g.description.createPrimitives(g,!0),C=document.createElementNS(u.svgNS,"g");if(C.setAttribute("data-tb-type",g.description.key.toString()),C.setAttribute("class","toolbox-item"),C.setAttribute("title",g.description.getTitle()),this.options.shapeIconAttributes)for(var b in this.options.shapeIconAttributes)Object.prototype.hasOwnProperty.call(this.options.shapeIconAttributes,b)&&C.setAttribute(b,this.options.shapeIconAttributes[b]);return y.appendChild(C),v.forEach(function(S){var x=S.createElement(function(I){return C.appendChild(I)});S.applyElementProperties(x,f.measurer)}),C},l.prototype.drawSelector=function(y,g,f,v){var C=this,b=new r.RectanglePrimitive(g,f,v,v,void 0,"selector");b.createElement(function(S){b.applyElementProperties(S,C.measurer),y.appendChild(S)})},l.prototype.createShape=function(y,g,f,v){var C=i.UnitConverter.pixelsToTwips(g),b=i.UnitConverter.pixelsToTwips(f),S=new s.Shape(y,new t.Point(C,b),!0);return this.needResetShapeText(y)?S.text="":v&&(S.text="T"),S},l.prototype.needResetShapeText=function(y){return!(y instanceof e.TextShapeDescription)&&!(y instanceof o.CustomShapeDescription&&y.baseDescription instanceof e.TextShapeDescription)},l.prototype.updateShapeIconBounds=function(y,g){var f=i.UnitConverter.pixelsToTwips(g);if(y.size.height=y.size.width*y.getToolboxHeightToWidthRatio(),y.size.width>y.size.height){var v=y.size.height/y.size.width;y.size.width=f,y.size.height=f*v,y.position.y=y.position.y+(f-y.size.height)/2,y.parameters.forEach(function(C){C.value=C.value*f/y.description.defaultSize.width})}else y.size.width<y.size.height?(v=y.size.width/y.size.height,y.size.height=f,y.size.width=f*v,y.position.x=y.position.x+(f-y.size.width)/2,y.parameters.forEach(function(C){C.value=C.value*f/y.description.defaultSize.height})):(y.size.width=f,y.size.height=f,y.parameters.forEach(function(C){C.value=C.value*f/y.description.defaultSize.width}))},l.prototype.createDraggingElement=function(y){var g=document.createElement("DIV");g.setAttribute("class","dxdi-toolbox-drag-item"),document.body.appendChild(g);var f=document.createElementNS(u.svgNS,"svg");f.className.baseVal="dxdi-canvas",g.appendChild(f);var v=this.shapeDescriptionManager.get(y.evt.data),C=this.createShape(v,n.DEFAULT_STROKE_WIDTH,n.DEFAULT_STROKE_WIDTH);return this.drawShape(f,C),g.style.width=i.UnitConverter.twipsToPixels(C.size.width)+2*n.DEFAULT_STROKE_WIDTH+"px",g.style.height=i.UnitConverter.twipsToPixels(C.size.height)+2*n.DEFAULT_STROKE_WIDTH+"px",g},l}(p.Toolbox);h.IconToolbox=a},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(n,o){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c])})(n,o)},function(n,o){function r(){this.constructor=n}m(n,o),n.prototype=o===null?Object.create(o):(r.prototype=o.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0}),h.ApiController=void 0;var p,u=d(81),s=d(11),i=d(4),t=d(58),e=function(n){function o(r,a,c){var l=n.call(this)||this;return l.events=r,l.model=c,l.selection=a,l}return P(o,n),o.prototype.notifySelectionChanged=function(r){this.isUpdateLocked()?this.registerOccurredEvent(p.SelectionChanged):this.raiseSelectionChanged()},o.prototype.notifyToolboxDragStart=function(){this.events.raise("notifyToolboxItemDragStart")},o.prototype.notifyToolboxDragEnd=function(){this.events.raise("notifyToolboxItemDragEnd")},o.prototype.notifyToolboxDraggingMouseMove=function(){},o.prototype.notifyClick=function(r){var a=this;this.tryRaiseUserAction(r,function(c){return a.events.raise("notifyItemClick",c)})},o.prototype.notifyDblClick=function(r){var a=this;this.tryRaiseUserAction(r,function(c){return a.events.raise("notifyItemDblClick",c)})},o.prototype.createNativeItem=function(r){return r&&this.cleanupNativeItem(r.toNative(this.model.units))},o.prototype.createNativeShape=function(r){return this.createNativeItem(r)},o.prototype.createNativeConnector=function(r){return this.createNativeItem(r)},o.prototype.convertUnit=function(r){return i.ModelUtils.getlUnitValue(this.model.units,r)},o.prototype.convertPoint=function(r){return new t.Point(this.convertUnit(r.x),this.convertUnit(r.y))},o.prototype.convertSize=function(r){return new t.Size(this.convertUnit(r.width),this.convertUnit(r.height))},o.prototype.cleanupNativeItem=function(r){var a=this.dataSource;return a&&(a.isAutoGeneratedKey(r.fromKey)&&(r.fromKey=void 0),a.isAutoGeneratedKey(r.key)&&(r.key=void 0),a.isAutoGeneratedKey(r.toKey)&&(r.toKey=void 0)),r},o.prototype.setDataSource=function(r){this.dataSource=r},o.prototype.tryRaiseUserAction=function(r,a){var c=this;if(this.isUserAction(r)){var l=this.model.findItem(r.source.key);l&&this.events.raise1(function(y){return a(c.createNativeItem(l))})}},o.prototype.isUserAction=function(r){return r.source&&(r.source.type===s.MouseEventElementType.Shape||r.source.type===s.MouseEventElementType.ShapeExpandButton||r.source.type===s.MouseEventElementType.ShapeParameterBox||r.source.type===s.MouseEventElementType.ShapeResizeBox||r.source.type===s.MouseEventElementType.ShapeConnectionPoint||r.source.type===s.MouseEventElementType.Connector||r.source.type===s.MouseEventElementType.ConnectorPoint||r.source.type===s.MouseEventElementType.ConnectorSide||r.source.type===s.MouseEventElementType.ConnectorOrthogonalSide||r.source.type===s.MouseEventElementType.ConnectorText)},o.prototype.onUpdateUnlocked=function(r){r&p.SelectionChanged&&this.raiseSelectionChanged()},o.prototype.raiseSelectionChanged=function(){var r=this,a=this.selection.getKeys().map(function(c){return r.createNativeItem(r.model.findItem(c))});this.events.raise1(function(c){return c.notifySelectionChanged(a)})},o}(u.BatchUpdatableObject);h.ApiController=e,function(n){n[n.SelectionChanged=1]="SelectionChanged"}(p||(p={}))},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PermissionsProvider=void 0;var m=d(14),P=d(3),p=d(16),u=d(6),s=d(355),i=d(356),t=d(357),e=d(358),n=d(359),o=d(360),r=d(361),a=d(362),c=d(363),l=d(364),y=d(365),g=d(366),f=d(367),v=function(){function C(b){this.onRequestOperation=new P.EventDispatcher,this.cache=[],this.permissionsLockCount=0,this.requestDeleteItems={},this.updateUICount=0,this.apiController=b,this.operationSettings=new p.ModelOperationSettings,this.storage=new y.PermissionsProviderStorage}return C.prototype.notifySelectionChanged=function(b){this.clearCache()},C.prototype.notifyModelChanged=function(b){this.clearCache()},C.prototype.notifyPageColorChanged=function(b){},C.prototype.notifyPageSizeChanged=function(b,S){},C.prototype.clearCache=function(b){this.cache=b!==void 0?this.cache.filter(function(S){return S.operation!==b}):[]},C.prototype.canDeleteItems=function(b){var S=this,x=!0;return b.forEach(function(I){var w;I instanceof m.Shape&&(w=new i.DeleteShapeRequestedEntity(S.apiController,I)),I instanceof u.Connector&&(w=new t.DeleteConnectorRequestedEntity(S.apiController,I)),x=x&&S.requestOperation(w)}),x},C.prototype.canAddItems=function(b){var S=this,x=!0;return b.forEach(function(I){I instanceof m.Shape&&(x=x&&S.requestOperation(new s.AddShapeRequestedEntity(S.apiController,I))),I instanceof u.Connector&&(x=(x=x&&S.canChangeConnection(I,I.beginItem,void 0,u.ConnectorPosition.Begin,I.beginConnectionPointIndex))&&S.canChangeConnection(I,I.endItem,void 0,u.ConnectorPosition.End,I.endConnectionPointIndex))}),x},C.prototype.canAddShapeFromToolbox=function(b){return this.requestOperation(new e.AddShapeFromToolboxRequestedEntity(this.apiController,b))},C.prototype.canChangeConnection=function(b,S,x,I,w){return!(!b||!this.requestDeleteItems[b.key])||!(S==null||S instanceof m.Shape)||this.requestOperation(new n.ChangeConnectionRequestedEntity(this.apiController,b,S,x,I,w))},C.prototype.canChangeConnectorPoints=function(b,S,x){return!(!b||!this.requestDeleteItems[b.key])||this.requestOperation(new o.ChangeConnectorPointsRequestedEntity(this.apiController,b,S,x))},C.prototype.canChangeShapeText=function(b){return this.requestOperation(new r.BeforeChangeShapeTextRequestedEntity(this.apiController,b))},C.prototype.canChangeConnectorText=function(b,S){return this.requestOperation(new a.BeforeChangeConnectorTextRequestedEntity(this.apiController,b,S))},C.prototype.canApplyShapeTextChange=function(b,S){return this.requestOperation(new c.ChangeShapeTextRequestedEntity(this.apiController,b,S))},C.prototype.canApplyConnectorTextChange=function(b,S,x){return this.requestOperation(new l.ChangeConnectorTextRequestedEntity(this.apiController,b,S,x))},C.prototype.canResizeShapes=function(b){var S=this,x=!0;return b.forEach(function(I){x=x&&S.requestOperation(new g.ResizeShapeRequestedEntity(S.apiController,I.shape,I.oldSize,I.size))}),x},C.prototype.canMoveShapes=function(b){var S=this,x=!0;return b.forEach(function(I){x=x&&S.requestOperation(new f.MoveShapeRequestedEntity(S.apiController,I.shape,I.oldPosition,I.position))}),x},C.prototype.requestOperation=function(b){var S,x=!0;return!this.permissionsLockCount&&(this.updateUICount>0&&this.cache.forEach(function(I){I.equals(b)&&(S=I)}),S?x=S.allowed:(this.requestOperationCore(b),this.updateUICount>0&&this.cache.push(b),x=b.allowed),this.updateUICount===0&&this.storage.needStorePermissions())?(this.storage.storePermission(b.storageKey,x),this.storage.isStoredPermissionsGranted()):x},C.prototype.requestOperationCore=function(b){b.eventArgs.allowed=this.operationSettings[b.settingsKey],b.eventArgs.updateUI=this.updateUICount>0,b.allowed&&this.onRequestOperation.raise("notifyRequestOperation",b.operation,b.eventArgs)},C.prototype.lockPermissions=function(){this.permissionsLockCount++},C.prototype.unlockPermissions=function(){this.permissionsLockCount--},C.prototype.beginDeleteItems=function(b){var S=this;b.forEach(function(x){return S.requestDeleteItems[x.key]=x})},C.prototype.endDeleteItems=function(){this.requestDeleteItems={}},C.prototype.beginUpdateUI=function(){this.updateUICount++},C.prototype.endUpdateUI=function(){this.updateUICount--},C.prototype.addInteractingItem=function(b,S){this.storage.addInteractingItem(b,S)},C.prototype.getInteractingItem=function(b,S){return this.storage.getInteractingItem(b,S)},C.prototype.getInteractingItemCount=function(){return this.storage.getInteractingItemCount()},C.prototype.clearInteractingItems=function(){this.storage.clearInteractingItems()},C.prototype.beginStorePermissions=function(){this.storage.beginStorePermissions()},C.prototype.endStorePermissions=function(){this.storage.endStorePermissions()},C.prototype.isStoredPermissionsGranted=function(){return this.permissionsLockCount>0||this.storage.isStoredPermissionsGranted()},C}();h.PermissionsProvider=v},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.AddShapeEventArgs=h.AddShapeRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o){var r=t.call(this,n)||this;return r.shape=o,r}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.AddShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeShape(this.shape),this.apiController.convertPoint(this.shape.position))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"addShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shape===n.shape&&this.shape.position.equals(n.shape.position)},e}(u.RequestedEntity);h.AddShapeRequestedEntity=s;var i=function(t){function e(n,o){var r=t.call(this)||this;return r.shape=n,r.position=o,r}return P(e,t),e}(u.PermissionRequestEventArgs);h.AddShapeEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteShapeEventArgs=h.DeleteShapeRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o){var r=t.call(this,n)||this;return r.shape=o,r}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.DeleteShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeShape(this.shape))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"deleteShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shape===n.shape},e}(u.RequestedEntity);h.DeleteShapeRequestedEntity=s;var i=function(t){function e(n){var o=t.call(this)||this;return o.shape=n,o}return P(e,t),e}(u.PermissionRequestEventArgs);h.DeleteShapeEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.DeleteConnectorEventArgs=h.DeleteConnectorRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o){var r=t.call(this,n)||this;return r.connector=o,r}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.DeleteConnector},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeConnector(this.connector))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"deleteConnector"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.connector===n.connector},e}(u.RequestedEntity);h.DeleteConnectorRequestedEntity=s;var i=function(t){function e(n){var o=t.call(this)||this;return o.connector=n,o}return P(e,t),e}(u.PermissionRequestEventArgs);h.DeleteConnectorEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.AddShapeFromToolboxEventArgs=h.AddShapeFromToolboxRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o){var r=t.call(this,n)||this;return r.shapeType=o,r}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.AddShapeFromToolbox},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.shapeType)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"addShapeFromToolbox"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+this.shapeType},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shapeType===n.shapeType},e}(u.RequestedEntity);h.AddShapeFromToolboxRequestedEntity=s;var i=function(t){function e(n){var o=t.call(this)||this;return o.shapeType=n,o}return P(e,t),e}(u.PermissionRequestEventArgs);h.AddShapeFromToolboxEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectionEventArgs=h.ChangeConnectionRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o,r,a,c,l){var y=t.call(this,n)||this;return y.connector=o,y.shape=r,y.oldShape=a,y.position=c,y.connectionPointIndex=l,y}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.ChangeConnection},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeConnector(this.connector),this.apiController.createNativeShape(this.shape),this.apiController.createNativeShape(this.oldShape),this.position,this.connectionPointIndex)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnection"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)+"_"+this.position},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){if(n instanceof e){var o=!this.connector&&!n.connector||this.connector&&n.connector&&this.connector===n.connector,r=!this.shape&&!n.shape||this.shape&&n.shape&&this.shape===n.shape,a=!this.oldShape&&!n.oldShape||this.oldShape&&n.oldShape&&this.oldShape===n.oldShape;return r&&a&&o&&this.position===n.position&&this.connectionPointIndex===n.connectionPointIndex}return!1},e}(u.RequestedEntity);h.ChangeConnectionRequestedEntity=s;var i=function(t){function e(n,o,r,a,c){var l=t.call(this)||this;return l.connector=n,l.shape=o,l.oldShape=r,l.position=a,l.connectionPointIndex=c,l}return P(e,t),e}(u.PermissionRequestEventArgs);h.ChangeConnectionEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a])})(e,n)},function(e,n){function o(){this.constructor=e}m(e,n),e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorPointsEventArgs=h.ChangeConnectorPointsRequestedEntity=void 0;var p=d(16),u=d(23),s=d(3),i=function(e){function n(o,r,a,c){var l=e.call(this,o)||this;return l.connector=r,l.oldPoints=a,l.points=c,l}return P(n,e),Object.defineProperty(n.prototype,"operation",{get:function(){return p.DiagramModelOperation.ChangeConnectorPoints},enumerable:!1,configurable:!0}),n.prototype.createEventArgs=function(){var o=this;return new t(this.apiController.createNativeConnector(this.connector),this.oldPoints.map(function(r){return o.apiController.convertPoint(r)}),this.points.map(function(r){return o.apiController.convertPoint(r)}))},Object.defineProperty(n.prototype,"settingsKey",{get:function(){return"changeConnectorPoints"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),n.prototype.equals=function(o){return o instanceof n&&this.connector===o.connector&&s.GeometryUtils.arePointsEqual(this.oldPoints,o.oldPoints)&&s.GeometryUtils.arePointsEqual(this.points,o.points)},n}(u.RequestedEntity);h.ChangeConnectorPointsRequestedEntity=i;var t=function(e){function n(o,r,a){var c=e.call(this)||this;return c.connector=o,c.oldPoints=r,c.points=a,c}return P(n,e),n}(u.PermissionRequestEventArgs);h.ChangeConnectorPointsEventArgs=t},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.BeforeChangeShapeTextEventArgs=h.BeforeChangeShapeTextRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o){var r=t.call(this,n)||this;return r.shape=o,r}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.BeforeChangeShapeText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeShape(this.shape))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeShapeText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return"before"+this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shape===n.shape&&this.shape.text===n.shape.text},e}(u.RequestedEntity);h.BeforeChangeShapeTextRequestedEntity=s;var i=function(t){function e(n){var o=t.call(this)||this;return o.shape=n,o}return P(e,t),e}(u.PermissionRequestEventArgs);h.BeforeChangeShapeTextEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.BeforeChangeConnectorTextEventArgs=h.BeforeChangeConnectorTextRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o,r){var a=t.call(this,n)||this;return a.connector=o,a.position=r,a}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.BeforeChangeConnectorText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeConnector(this.connector),this.position,this.connector.texts.map(function(n){return n}).sort(function(n,o){return n.position-o.position}).indexOf(this.connector.texts.get(this.position)))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnectorText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return"before"+this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.connector===n.connector&&this.position===n.position&&this.connector.texts.get(this.position)===n.connector.texts.get(n.position)},e}(u.RequestedEntity);h.BeforeChangeConnectorTextRequestedEntity=s;var i=function(t){function e(n,o,r){var a=t.call(this)||this;return a.connector=n,a.position=o,a.index=r,a}return P(e,t),e}(u.PermissionRequestEventArgs);h.BeforeChangeConnectorTextEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeShapeTextEventArgs=h.ChangeShapeTextRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o,r){var a=t.call(this,n)||this;return a.shape=o,a.text=r,a}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.ChangeShapeText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeShape(this.shape),this.text)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeShapeText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shape===n.shape&&this.text===n.text},e}(u.RequestedEntity);h.ChangeShapeTextRequestedEntity=s;var i=function(t){function e(n,o){var r=t.call(this)||this;return r.shape=n,r.text=o,r}return P(e,t),e}(u.PermissionRequestEventArgs);h.ChangeShapeTextEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ChangeConnectorTextEventArgs=h.ChangeConnectorTextRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o,r,a){var c=t.call(this,n)||this;return c.connector=o,c.position=r,c.text=a,c}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.ChangeConnectorText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeConnector(this.connector),this.position,this.connector.texts.map(function(n){return n}).sort(function(n,o){return n.position-o.position}).indexOf(this.connector.texts.get(this.position)),this.text)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnectorText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.connector===n.connector&&this.position===n.position&&this.text===n.text},e}(u.RequestedEntity);h.ChangeConnectorTextRequestedEntity=s;var i=function(t){function e(n,o,r,a){var c=t.call(this)||this;return c.connector=n,c.position=o,c.index=r,c.text=a,c}return P(e,t),e}(u.PermissionRequestEventArgs);h.ChangeConnectorTextEventArgs=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PermissionsProviderStorage=void 0;var m=d(14),P=d(6),p=function(){function u(){this.interactingItems={},this.storedPermissions={}}return u.prototype.addInteractingItem=function(s,i){var t=this.getInteractingItemKey(s,i);this.interactingItems[t]===void 0&&(s instanceof m.Shape||s instanceof P.Connector)&&(this.interactingItems[t]=s.clone())},u.prototype.getInteractingItem=function(s,i){var t=this.getInteractingItemKey(s,i);return this.interactingItems[t]},u.prototype.getInteractingItemCount=function(){return Object.keys(this.interactingItems).length},u.prototype.clearInteractingItems=function(){this.interactingItems={}},u.prototype.getInteractingItemKey=function(s,i){return s.key+(i!==void 0?"_"+i.toString():"")},u.prototype.needStorePermissions=function(){return this.storePermissions},u.prototype.beginStorePermissions=function(){this.storePermissions=!0},u.prototype.endStorePermissions=function(){this.storePermissions=!1,this.storedPermissions={}},u.prototype.isStoredPermissionsGranted=function(){for(var s=Object.keys(this.storedPermissions),i=!0,t=0;t<s.length;t++)i=i&&this.storedPermissions[s[t]];return i},u.prototype.storePermission=function(s,i){this.storedPermissions[s]=i},u}();h.PermissionsProviderStorage=p},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.ResizeShapeEventArgs=h.ResizeShapeRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o,r,a){var c=t.call(this,n)||this;return c.shape=o,c.oldSize=r,c.size=a,c}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.ResizeShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeShape(this.shape),this.apiController.convertSize(this.oldSize),this.apiController.convertSize(this.size))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"resizeShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shape===n.shape&&this.oldSize.equals(n.oldSize)&&this.size.equals(n.size)},e}(u.RequestedEntity);h.ResizeShapeRequestedEntity=s;var i=function(t){function e(n,o,r){var a=t.call(this)||this;return a.shape=n,a.oldSize=o,a.size=r,a}return P(e,t),e}(u.PermissionRequestEventArgs);h.ResizeShapeEventArgs=i},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var r in o)o.hasOwnProperty(r)&&(n[r]=o[r])})(t,e)},function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0}),h.MoveShapeEventArgs=h.MoveShapeRequestedEntity=void 0;var p=d(16),u=d(23),s=function(t){function e(n,o,r,a){var c=t.call(this,n)||this;return c.shape=o,c.oldPosition=r,c.position=a,c}return P(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return p.DiagramModelOperation.MoveShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new i(this.apiController.createNativeShape(this.shape),this.apiController.convertPoint(this.oldPosition),this.apiController.convertPoint(this.position))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"moveShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(n){return n instanceof e&&this.shape===n.shape&&this.oldPosition.equals(n.oldPosition)&&this.position.equals(n.position)},e}(u.RequestedEntity);h.MoveShapeRequestedEntity=s;var i=function(t){function e(n,o,r){var a=t.call(this)||this;return a.shape=n,a.oldPosition=o,a.position=r,a}return P(e,t),e}(u.PermissionRequestEventArgs);h.MoveShapeEventArgs=i},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorRoutingModel=h.ConnectorRoutingPenaltyDescription=void 0;var m=d(28),P=d(14),p=d(6),u=d(32),s=d(369),i=function(){return function(){this.shape=20,this.margin=2,this.turnBack=20,this.turnLeft=3.1,this.turnRight=3}}();h.ConnectorRoutingPenaltyDescription=i;var t=function(){function e(){this.connectorRoutingMode=m.ConnectorRoutingMode.AllShapesOnly,this.shapeMargins=p.Connector.minOffset,this.shouldReverseConnections=!0,this.shouldResizeConnections=!0,this.penaltyDescription=new i}return e.prototype.initialize=function(n){this.model=n},e.prototype.createStrategy=function(n){if(this.model!==void 0&&this.connectorRoutingMode!==m.ConnectorRoutingMode.None&&n===u.ConnectorLineOption.Orthogonal)return new s.RightAngleConnectorRoutingStrategy(this)},e.prototype.getItems=function(n,o){return this.getShapes(n,o)},e.prototype.notifyConnectorRoutingModeChanged=function(n){this.connectorRoutingMode=n},e.prototype.getShapes=function(n,o){return this.model===void 0||this.connectorRoutingMode===void 0||this.connectorRoutingMode===m.ConnectorRoutingMode.None?[]:this.connectorRoutingMode===m.ConnectorRoutingMode.AllShapesOnly?this.model.items.filter(function(r){return r instanceof P.Shape}):this.getConnectorShapes(n,o)},e.prototype.getConnectorShapes=function(n,o){var r=[];return n&&r.push(n),o&&n!==o&&r.push(o),r},e}();h.ConnectorRoutingModel=t},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.RightAngleConnectorRoutingStrategy=void 0;var m=d(33),P=d(29),p=d(370),u=d(4),s=function(){function i(t){this.model=t}return i.prototype.createRenderPoints=function(t,e,n,o,r,a,c){if(e.length>1){var l=new p.RightAngleConnectorRoutingContext(this.model,t,e,n,o,r,a);if(l.initialize(c),l.shouldCreateRenderPoints)return this.createRenderPointsCore(l)}},i.prototype.clone=function(){return new i(this.model)},i.prototype.onAddPoint=function(t,e,n,o){var r=o.map(function(f){return new P.ConnectorRenderPoint(f.x,f.y,f.pointIndex)}),a=u.ModelUtils.findFirstPointIndex(r,function(f){return f.equals(n)});if(a===0)return r.splice(1,0,new P.ConnectorRenderPoint(n.x,n.y,e)),u.ModelUtils.validateRenderPointIndexes(t,r,2);var c=r.length-1;if(a===c)return r.splice(c,0,new P.ConnectorRenderPoint(n.x,n.y,e)),r[c+1].pointIndex=e+1,r;if(a>0){var l=r[a];return r[a]=new P.ConnectorRenderPoint(l.x,l.y,e,l.skipped),u.ModelUtils.validateRenderPointIndexes(t,r,a+1)}var y=new m.Segment(r[0],r[1]),g=new P.ConnectorRenderPoint(n.x,n.y);return y.containsPoint(g)?(r.splice(1,0,new P.ConnectorRenderPoint(g.x,g.y,-1)),r.splice(2,0,new P.ConnectorRenderPoint(g.x,g.y,e)),u.ModelUtils.validateRenderPointIndexes(t,r,3)):new m.Segment(r[c-1],r[c]).containsPoint(g)?(r.splice(c,0,new P.ConnectorRenderPoint(g.x,g.y,e)),r.splice(c+1,0,new P.ConnectorRenderPoint(g.x,g.y,-1)),r[c+2].pointIndex=e+1,r):o},i.prototype.onDeletePoint=function(t,e,n){var o=n.map(function(b){return new P.ConnectorRenderPoint(b.x,b.y,b.pointIndex)}),r=this.getRenderPointIndexByPointIndex(o,e);if(r===1){var a=o[0],c=o[1];return a.equals(c)?(o.splice(1,1),u.ModelUtils.validateRenderPointIndexes(t,o,1)):(o[1]=new P.ConnectorRenderPoint(c.x,c.y,-1,c.skipped),u.ModelUtils.validateRenderPointIndexes(t,o,2))}if(r===2){a=o[1];var l=o[2];return a.equals(l)?(o.splice(1,2),u.ModelUtils.validateRenderPointIndexes(t,o,1)):(o[2]=new P.ConnectorRenderPoint(l.x,l.y,-1,l.skipped),u.ModelUtils.validateRenderPointIndexes(t,o,3))}var y=o.length-1;if(r===y-1){var g=o[y-1],f=o[y];return g.equals(f)?(o.splice(y-1,1),u.ModelUtils.validateRenderPointIndexes(t,o,y-1)):(o[y-1]=new P.ConnectorRenderPoint(g.x,g.y,-1,g.skipped),u.ModelUtils.validateRenderPointIndexes(t,o,y))}if(r===y-2){var v=o[y-2];return f=o[y-1],v.equals(f)?(o.splice(y-2,2),u.ModelUtils.validateRenderPointIndexes(t,o,y-2)):(o[y-2]=new P.ConnectorRenderPoint(v.x,v.y,-1,v.skipped),u.ModelUtils.validateRenderPointIndexes(t,o,y-1))}var C=o[r];return o[r]=new P.ConnectorRenderPoint(C.x,C.y,-1,C.skipped),u.ModelUtils.validateRenderPointIndexes(t,o,r+1)},i.prototype.onMovePoint=function(t,e,n,o){if(e===0||e===t.length-1)return o;var r=o.map(function(a){return new P.ConnectorRenderPoint(a.x,a.y,a.pointIndex)});return this.onMovePointCore(r,e,n),u.ModelUtils.skipUnnecessaryRightAngleRenderPoints(r),r},i.prototype.onMovePoints=function(t,e,n,o,r,a){if(e===0||o===t.length-1)return a;var c=a.map(function(l){return new P.ConnectorRenderPoint(l.x,l.y,l.pointIndex)});return this.onMovePointCore(c,e,n),this.onMovePointCore(c,o,r),u.ModelUtils.skipUnnecessaryRightAngleRenderPoints(c),c},i.prototype.onMovePointCore=function(t,e,n){var o=this.getRenderPointIndexByPointIndex(t,e);if(o>=0){var r=t[o];t[o]=new P.ConnectorRenderPoint(n.x,n.y,e,r.skipped)}},i.prototype.createRenderPointsCore=function(t){var e,n=[],o=-1,r=-1;t.setup();var a=t.renderSegments,c=a[a.length-1].endPoint,l=t.points;do this.registerCustomPoints(n,l,r+2,a[o+1].startPointIndex-1),r=(e=a[++o]).startPointIndex,this.registerRenderPoints(n,t.createRoutedPoints(e.startInfo,e.endInfo,e.createProhibitedSegments()),r);while(!e.endPoint.equals(c));return t.validateRenderPoints(n),n},i.prototype.getRenderPointIndexByPointIndex=function(t,e){return u.ModelUtils.findFirstPointIndex(t,function(n){return n.pointIndex===e})},i.prototype.registerRenderPoints=function(t,e,n){var o=this;e.forEach(function(r,a){var c=a===0?n:a===e.length-1?n+1:-1;o.registerPoint(t,r,c)})},i.prototype.registerCustomPoints=function(t,e,n,o){for(var r=n;r<=o;r++)this.registerPoint(t,e[r],r)},i.prototype.registerPoint=function(t,e,n){t.push(new P.ConnectorRenderPoint(e.x,e.y,n))},i}();h.RightAngleConnectorRoutingStrategy=s},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.RightAngleConnectorRoutingContext=h.IntersectingItemsByPointsContext=h.CuttingItemsContext=void 0;var m=d(0),P=d(33),p=d(60),u=d(9),s=d(160),i=d(371),t=d(373),e=d(4),n=d(161),o=d(374),r=d(378),a=d(3),c=function(){function g(){this.cuttingItemKeys=[]}return Object.defineProperty(g.prototype,"isEmpty",{get:function(){return this.cuttingItemKeys.length===0},enumerable:!1,configurable:!0}),g.prototype.registerShape=function(f,v,C){return!!a.GeometryUtils.areSegmentsCutRectangle(C,v)&&(this.cuttingItemKeys.push(f),!0)},g}();h.CuttingItemsContext=c;var l=function(){function g(){this.items={}}return g.prototype.getOrAddItems=function(f,v){if(f){var C=f.toString(),b=this.items[C];if(b!==void 0)return b.items;if(v){var S=v(f);return this.items[C]={point:f,items:S},S}}},g}();h.IntersectingItemsByPointsContext=l;var y=function(){function g(f,v,C,b,S,x,I){this.routingModel=f,this.points=v,this.supportRenderPoints=C,this.beginConnectionShape=b,this.endConnectionShape=S,this.beginConnectionSide=this.getConnectionSide(this.beginConnectionShape,x,this.beginPoint),this.endConnectionSide=this.getConnectionSide(this.endConnectionShape,I,this.endPoint),this.ignorableItemKeys={},this.cuttingShapesContext=new c,this.intersectedItemsByPointsContext=new l,this.isInvalidRenderSegments=!0}return Object.defineProperty(g.prototype,"shapeMargins",{get:function(){return this.routingModel.shapeMargins},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"beginPoint",{get:function(){return this.points[0]},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"endPoint",{get:function(){return this.points[this.points.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"hasIntersecting",{get:function(){return!this.cuttingShapesContext.isEmpty},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"shouldCreateRenderPoints",{get:function(){return this.isInvalidRenderSegments||!this.isSmallPath&&(this.hasIntersecting||this.isReversedStartConnection||this.isReversedEndConnection)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"beginPathPoint",{get:function(){return this.beginConnectionSegment instanceof P.Segment?this.beginConnectionSegment.startPoint:this.beginConnectionSegment},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"endPathPoint",{get:function(){return this.endConnectionSegment instanceof P.Segment?this.endConnectionSegment.endPoint:this.endConnectionSegment},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isReversedStartConnection",{get:function(){if(!this.beginConnectionShape||this.beginConnectionSide===u.ConnectionPointSide.Undefined)return!1;var f=this.beginConnectionSegment;return!(f instanceof m.Point)&&this.isReversedConnectionSegment(this.supportSegments[0],f)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isReversedEndConnection",{get:function(){if(!this.endConnectionShape||this.endConnectionSide===u.ConnectionPointSide.Undefined)return!1;var f=this.endConnectionSegment;return!(f instanceof m.Point)&&this.isReversedConnectionSegment(this.supportSegments[this.supportSegments.length-1],f)},enumerable:!1,configurable:!0}),g.prototype.isReversedConnectionSegment=function(f,v){return p.Vector.scalarProduct(p.Vector.fromSegment(f),p.Vector.fromPoints(v.startPoint,v.endPoint))<=0},Object.defineProperty(g.prototype,"isSmallPath",{get:function(){var f=2*this.routingModel.shapeMargins;return Math.abs(this.beginPathPoint.x-this.endPathPoint.x)<f&&Math.abs(this.beginPathPoint.y-this.endPathPoint.y)<f},enumerable:!1,configurable:!0}),g.prototype.initialize=function(f){this.processContainers(f),this.processSupportSegments(),this.processIntersection(),this.processConnections(),this.processRenderSegments()},g.prototype.setup=function(){this.processRoutingGrid(),this.processRoutingMetrics()},g.prototype.createRoutedPoints=function(f,v,C){var b=f instanceof m.Point?f:f.endPoint,S=v instanceof m.Point?v:v.startPoint,x=this.createAStarContext(b,S,C);r.AStarCalculator.calculate(x);var I=x.path;return this.addConnectionRoutedPoints(I,f,v),s.RightAngleConnectorRoutingMathOperations.unionPoints(I),I},g.prototype.getIntersectedItems=function(f,v){var C=this;return this.intersectedItemsByPointsContext.getOrAddItems(f,function(b){return C.routingModel.getItems(C.beginConnectionShape,C.endConnectionShape).filter(function(S){return!C.isIgnorableItem(S)&&v(b,S)})})},g.prototype.validateRenderPoints=function(f){this.isInvalidRenderSegments&&(s.RightAngleConnectorRoutingMathOperations.unionPoints(f),e.ModelUtils.validateRenderPointIndexes(this.points,f,0)),e.ModelUtils.skipUnnecessaryRightAngleRenderPoints(f)},g.prototype.processContainers=function(f){if(f&&this.registerIgnorableShape(f),this.beginConnectionShape){var v=this.beginConnectionShape.container;v&&this.registerIgnorableShape(v)}if(this.endConnectionShape){var C=this.endConnectionShape.container;C&&this.registerIgnorableShape(C)}},g.prototype.processSupportSegments=function(){this.supportSegments=this.createSupportSegments()},g.prototype.processIntersection=function(){var f=this,v=this.routingModel.getItems(this.beginConnectionShape,this.endConnectionShape);v&&v.forEach(function(C){var b=C.key,S=C.rectangle;f.cuttingShapesContext.registerShape(b,S,f.supportSegments)?f.ignorableItemKeys[b]!==void 0&&delete f.ignorableItemKeys[b]:(!f.isConnectedByStart(C)&&S.containsPoint(f.beginPoint)||!f.isConnectedByEnd(C)&&S.containsPoint(f.endPoint))&&f.registerIgnorableShape(C)})},g.prototype.processConnections=function(){var f=!1,v=!1;this.beginConnectionShape!==this.endConnectionShape&&(f=this.shapeContainsOtherConnection(this.beginConnectionShape,this.endConnectionShape,this.endPoint),v=this.shapeContainsOtherConnection(this.endConnectionShape,this.beginConnectionShape,this.beginPoint),f&&this.registerIgnorableShape(this.beginConnectionShape),v&&this.registerIgnorableShape(this.endConnectionShape));var C=this.routingModel.shapeMargins;this.beginConnectionSegment=this.createBeginConnectionSegment(C,f),this.endConnectionSegment=this.createEndConnectionSegment(C,v)},g.prototype.processRenderSegments=function(){this.isInvalidRenderSegments=!1,this.renderSegments=this.createRenderSegments();for(var f=0;f<this.renderSegments.length-1;f++){var v=this.renderSegments[f],C=this.renderSegments[f+1];if(v.endPoint.equals(C.startPoint))return void(this.isInvalidRenderSegments=!0)}},g.prototype.createGridPoints=function(){var f=[];return this.renderSegments.forEach(function(v){return v.createGridPoints().forEach(function(C){return f.push(C)})}),f},g.prototype.processRoutingGrid=function(){this.routingGrid=this.createGrid()},g.prototype.processRoutingMetrics=function(){this.metrics=this.createAStarMetrics()},g.prototype.createAStarMetrics=function(){return new n.AStarMetrics(new n.TurnDirectionMetrics(this.routingModel.penaltyDescription),new n.IntersectedShapesMetrics(new n.IntersectedShapeMetrics(this.routingModel.penaltyDescription,this.routingModel.shapeMargins)))},g.prototype.createAStarContext=function(f,v,C){return new o.AStarContext(this,f,v,C,this.routingGrid,this.metrics)},g.prototype.addConnectionRoutedPoints=function(f,v,C){v instanceof P.Segment&&f.splice(0,0,v.startPoint),C instanceof P.Segment&&f.push(C.endPoint)},g.prototype.createSupportSegments=function(){var f=this;return this.supportRenderPoints.length<=1?[]:a.GeometryUtils.createSegments(this.supportRenderPoints).filter(function(v){return!f.isCustomSegment(v,f.supportRenderPoints[0],f.supportRenderPoints[f.supportRenderPoints.length-1])})},g.prototype.isCustomSegment=function(f,v,C){var b=f.startPoint;if(b.equals(v))return!1;var S=f.endPoint;return!S.equals(C)&&S.pointIndex-b.pointIndex==1},g.prototype.createRenderSegments=function(){var f=this,v=s.RightAngleConnectorRoutingMathOperations.createUnionSegments(this.supportSegments,function(b,S){return f.shouldCreateSegment(b,S)}),C=v.length-1;return v.map(function(b,S){return new i.ConnectorRenderSegment(S>0?new m.Point(b.startPoint.x,b.startPoint.y):f.beginConnectionSegment,S<C?new m.Point(b.endPoint.x,b.endPoint.y):f.endConnectionSegment,b.startPoint.pointIndex,f.createPreviousCustomSegment(b.startPoint))})},g.prototype.createPreviousCustomSegment=function(f){var v=f.pointIndex-1;return v>=0?new P.Segment(this.points[v].clone(),new m.Point(f.x,f.y)):void 0},g.prototype.shouldCreateSegment=function(f,v){return!f.equals(v)||v.pointIndex>0},g.prototype.isPathNormal=function(f){return f===u.ConnectionPointSide.Undefined||s.RightAngleConnectorRoutingMathOperations.isSegmentNormal(new P.Segment(this.beginPoint,this.endPoint),f===u.ConnectionPointSide.East||f===u.ConnectionPointSide.West)},g.prototype.registerIgnorableShape=function(f){this.ignorableItemKeys[f.key]=!0},g.prototype.isConnectedByStart=function(f){return this.beginConnectionShape&&this.beginConnectionShape.key===f.key&&this.beginConnectionSide!==u.ConnectionPointSide.Undefined},g.prototype.isConnectedByEnd=function(f){return this.endConnectionShape&&this.endConnectionShape.key===f.key&&this.endConnectionSide!==u.ConnectionPointSide.Undefined},g.prototype.getConnectionSide=function(f,v,C){return f?f.getConnectionPointSideByIndex(v,C):u.ConnectionPointSide.Undefined},g.prototype.shapeContainsOtherConnection=function(f,v,C){if(!f)return!1;var b=f.rectangle;return b.containsPoint(C)&&(!v||!v.rectangle.equals(b))},g.prototype.createBeginConnectionSegment=function(f,v){if(this.beginConnectionSide===u.ConnectionPointSide.Undefined)return this.createBeginConnectionSegmentCore(f);if(!v||!this.routingModel.shouldReverseConnections){var C=this.createBeginConnectionSegmentCore(f);if(C instanceof m.Point||!this.routingModel.shouldResizeConnections)return C;for(var b=C.startPoint,S=C.endPoint,x=f;this.hasIntersectedItemsByPoint(S,b,this.beginConnectionShape);)x/=2,S=(C=this.createBeginConnectionSegmentCore(x)).endPoint;return C}if(!this.endConnectionShape)return this.createBeginConnectionSegmentCore(-f);if(this.isPathNormal(this.endConnectionSide))return this.createBeginConnectionSegmentCore(-f);var I=this.createBeginConnectionSegmentCore(-2*f);return this.isEndConnectionRectanleLineIntersected(I,!1,!0)?this.createBeginConnectionSegmentCore(f):this.createBeginConnectionSegmentCore(-f)},g.prototype.hasIntersectedItemsByPoint=function(f,v,C){var b=this.getIntersectedItems(f,function(S,x){return x.rectangle.containsPoint(S)&&!x.rectangle.containsPoint(v)&&x.key!==C.key});return b!==void 0&&b.length>0},g.prototype.createEndConnectionSegment=function(f,v){if(this.endConnectionSide===u.ConnectionPointSide.Undefined)return this.createEndConnectionSegmentCore(f);if(!v||!this.routingModel.shouldReverseConnections){var C=this.createEndConnectionSegmentCore(f);if(C instanceof m.Point||!this.routingModel.shouldResizeConnections)return C;for(var b=C.endPoint,S=C.startPoint,x=f;this.hasIntersectedItemsByPoint(S,b,this.endConnectionShape);)x/=2,S=(C=this.createEndConnectionSegmentCore(x)).startPoint;return C}if(!this.beginConnectionShape)return this.createEndConnectionSegmentCore(-f);if(this.isPathNormal(this.beginConnectionSide))return this.createEndConnectionSegmentCore(-f);var I=this.createEndConnectionSegmentCore(-2*f);return this.isBeginConnectionRectanleLineIntersected(I,!0,!1)?this.createEndConnectionSegmentCore(f):this.createEndConnectionSegmentCore(-f)},g.prototype.createBeginConnectionSegmentCore=function(f){return s.RightAngleConnectorRoutingMathOperations.createBeginConnectionSegment(this.beginConnectionSide,this.beginPoint,f,function(v,C){return new m.Point(v,C)})},g.prototype.createEndConnectionSegmentCore=function(f){return s.RightAngleConnectorRoutingMathOperations.createEndConnectionSegment(this.endConnectionSide,this.endPoint,f,function(v,C){return new m.Point(v,C)})},g.prototype.isBeginConnectionRectanleLineIntersected=function(f,v,C){return s.RightAngleConnectorRoutingMathOperations.isConnectionRectanleLineIntersected(this.beginConnectionShape.rectangle,f,this.beginConnectionSide,v,C,function(b,S){return new m.Point(b,S)})},g.prototype.isEndConnectionRectanleLineIntersected=function(f,v,C){return s.RightAngleConnectorRoutingMathOperations.isConnectionRectanleLineIntersected(this.endConnectionShape.rectangle,f,this.endConnectionSide,v,C,function(b,S){return new m.Point(b,S)})},g.prototype.isIgnorableItem=function(f){return this.ignorableItemKeys[f.key]!==void 0},g.prototype.createExtendedShapesBounds=function(){var f=this;return this.routingModel.getItems(this.beginConnectionShape,this.endConnectionShape).map(function(v){return v.rectangle.clone().inflate(f.routingModel.shapeMargins)})},g.prototype.createGrid=function(){return t.RoutingGrid.create(this.createGridPoints(),this.createExtendedShapesBounds(),function(f,v){return new m.Point(f,v)})},g}();h.RightAngleConnectorRoutingContext=y},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorRenderSegment=void 0;var m=d(33),P=d(372),p=function(){function u(s,i,t,e){this.startInfo=s,this.endInfo=i,this.startPointIndex=t,this.previousCustomSegment=e}return Object.defineProperty(u.prototype,"startPathPoint",{get:function(){return this.startInfo instanceof m.Segment?this.startInfo.endPoint:this.startInfo},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"endPathPoint",{get:function(){return this.endInfo instanceof m.Segment?this.endInfo.startPoint:this.endInfo},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"startPoint",{get:function(){return this.startInfo instanceof m.Segment?this.startInfo.startPoint:this.startInfo},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"endPoint",{get:function(){return this.endInfo instanceof m.Segment?this.endInfo.endPoint:this.endInfo},enumerable:!1,configurable:!0}),u.prototype.createGridPoints=function(){var s=[];return this.endInfo instanceof m.Segment?(s.push(this.endInfo.startPoint),s.push(this.endInfo.endPoint)):s.push(this.endInfo),s},u.prototype.createProhibitedSegments=function(){if(this.startInfo instanceof m.Segment){var s=this.createProhibitedSegmentsCore(this.startInfo);return this.endInfo instanceof m.Segment&&(s.addSegment(this.endInfo),s.addExludedPoint(this.endInfo.startPoint)),this.previousCustomSegment&&s.addSegment(this.previousCustomSegment),s}return this.endInfo instanceof m.Segment?((s=this.createProhibitedSegmentsCore(this.endInfo)).addExludedPoint(this.endInfo.startPoint),this.previousCustomSegment&&s.addSegment(this.previousCustomSegment),s):this.previousCustomSegment?this.createProhibitedSegmentsCore(this.previousCustomSegment):void 0},u.prototype.createProhibitedSegmentsCore=function(s){var i=new P.ConnectorProhibitedSegments;return i.addSegment(s),i},u}();h.ConnectorRenderSegment=p},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConnectorProhibitedSegments=void 0;var m=function(){function P(){this.segments=[],this.exludedPoints={}}return P.prototype.addSegment=function(p){this.segments.push(p)},P.prototype.addExludedPoint=function(p){this.exludedPoints[p.toString()]=p},P.prototype.allowPoint=function(p){if(this.exludedPoints[p.toString()]===void 0){for(var u=0;u<this.segments.length;u++)if(this.segments[u].containsPoint(p))return!1}return!0},P}();h.ConnectorProhibitedSegments=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.RoutingGrid=void 0;var m=d(41),P=function(){function p(u,s,i){this.verticalGridLines=u,this.horizontalGridLines=s,this.createPoint=i}return p.create=function(u,s,i){var t=this,e=[],n=[],o={},r={};return s.forEach(function(a){t.addLine(a.x,e,o),t.addLine(a.right,e,o),t.addLine(a.y,n,r),t.addLine(a.bottom,n,r)}),u.forEach(function(a){t.addLine(a.x,e,o),t.addLine(a.y,n,r)}),e.sort(function(a,c){return a-c}),n.sort(function(a,c){return a-c}),new p(e,n,i)},p.addLine=function(u,s,i){i[u]||(s.push(u),i[u]=!0)},p.prototype.getNeighborPoints=function(u){var s=[];if(!(this.horizontalGridLines&&this.horizontalGridLines.length&&this.verticalGridLines&&this.verticalGridLines.length))return s;var i=m.SearchUtils.binaryIndexOf(this.verticalGridLines,function(e){return e-u.x});i<0?(i=~i,this.isValidArrayIndex(this.verticalGridLines,i)&&s.push(this.createPoint(this.verticalGridLines[i],u.y))):this.isValidArrayIndex(this.verticalGridLines,i+1)&&s.push(this.createPoint(this.verticalGridLines[i+1],u.y)),this.isValidArrayIndex(this.verticalGridLines,i-1)&&s.push(this.createPoint(this.verticalGridLines[i-1],u.y));var t=m.SearchUtils.binaryIndexOf(this.horizontalGridLines,function(e){return e-u.y});return t<0?(t=~t,this.isValidArrayIndex(this.horizontalGridLines,t)&&s.push(this.createPoint(u.x,this.horizontalGridLines[t]))):this.isValidArrayIndex(this.horizontalGridLines,t+1)&&s.push(this.createPoint(u.x,this.horizontalGridLines[t+1])),this.isValidArrayIndex(this.horizontalGridLines,t-1)&&s.push(this.createPoint(u.x,this.horizontalGridLines[t-1])),s},p.prototype.isValidArrayIndex=function(u,s){return u&&s>=0&&s<u.length},p}();h.RoutingGrid=P},function(j,h,d){"use strict";var m,P=this&&this.__extends||(m=function(r,a){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var y in l)l.hasOwnProperty(y)&&(c[y]=l[y])})(r,a)},function(r,a){function c(){this.constructor=r}m(r,a),r.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.AStarContext=h.AStarContextBase=void 0;var p=d(375),u=d(376),s=d(377),i=d(33),t=d(160),e=d(3),n=function(){function r(a,c,l){this.startPosition=a,this.targetPosition=c,this.maxStepsCount=l,this.prohibitedPoints={}}return Object.defineProperty(r.prototype,"shouldStartContinue",{get:function(){return this.updatableSet.count>0&&this.stepsCount<this.maxStepsCount},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"shouldFinish",{get:function(){return this.currentNode.position.equals(this.targetPosition)},enumerable:!1,configurable:!0}),r.prototype.start=function(){this.generalSet=new p.SortedQueues(function(c){return c.key}),this.updatableSet=new u.UniqueAStarNodePositions;var a=new s.AStarNode(this.startPosition,this.getDistance(this.startPosition,this.targetPosition));this.currentNode=a,this.generalSet.enqueue(a),this.updatableSet.add(a.position,a),this.stepsCount=0,this.openNode=void 0},r.prototype.startContinue=function(){this.currentNode=this.generalSet.dequeueMin()},r.prototype.endContinue=function(){var a=this,c=this.currentNode.position;this.updatableSet.remove(c),this.addProhibitedPoint(c),this.getNeighborPoints(c).forEach(function(l){var y=a.getPenalty(a.currentNode,l),g=a.updatableSet.getNode(l);if(g===void 0)(g=new s.AStarNode(l,a.getDistance(l,a.targetPosition))).parent=a.currentNode,g.penalty=y,a.generalSet.enqueue(g),a.updatableSet.add(l,g);else if(g.penalty>y){var f=a.generalSet;f.remove(g),g.parent=a.currentNode,g.penalty=y,f.enqueue(g)}a.openNode=g}),this.stepsCount++},r.prototype.finishWithPath=function(){this.path=this.currentNode.getPath()},r.prototype.finishWithoutPath=function(){this.path=[]},r}();h.AStarContextBase=n;var o=function(r){function a(c,l,y,g,f,v){var C=r.call(this,l,y,1e4)||this;return C.routingContext=c,C.startPosition=l,C.targetPosition=y,C.prohibitedSegments=g,C.grid=f,C.metrics=v,C}return P(a,r),a.prototype.addProhibitedPoint=function(c){this.prohibitedPoints[c.toString()]=c},a.prototype.getNeighborPoints=function(c){var l=this;return this.grid.getNeighborPoints(c).filter(function(y){return l.allowPoint(y)})},a.prototype.getDistance=function(c,l){return this.metrics.distance(c,l)},a.prototype.getPenalty=function(c,l){var y=c.parent,g=c.position,f=this.getTurnDirection(y?e.GeometryUtils.createAngle(y.position,g,l):0),v=this.getDistance(g,l),C=new i.Segment(g,l).center;return c.penalty+this.metrics.penalty(v,C,f,this.getIntersectedItems(C))},a.prototype.allowPoint=function(c){return this.prohibitedPoints[c.toString()]===void 0&&(!this.prohibitedSegments||this.prohibitedSegments.allowPoint(c))},a.prototype.getTurnDirection=function(c){return t.RightAngleConnectorRoutingMathOperations.getTurnDirection(c)},a.prototype.getIntersectedItems=function(c){var l=this,y=this.routingContext.shapeMargins;return this.routingContext.getIntersectedItems(c,function(g,f){return l.hasIntersectedItem(g,f,y)})},a.prototype.hasIntersectedItem=function(c,l,y){return!!this.isIntersectedWithExtendedRectangle(c,l,y)&&(!!this.hasOneShapeConnection(l)||!this.itemContainsConnectionPoints(l))},a.prototype.isIntersectedWithExtendedRectangle=function(c,l,y){return l.rectangle.clone().inflate(y).containsPoint(c)},a.prototype.itemContainsConnectionPoints=function(c){var l=c.rectangle;return l.containsPoint(this.routingContext.beginPoint)&&l.containsPoint(this.routingContext.endPoint)},a.prototype.hasOneShapeConnection=function(c){var l=c.getConnectionPoints();return this.isConnectionPoint(l,this.routingContext.beginPoint)&&this.isConnectionPoint(l,this.routingContext.endPoint)},a.prototype.isConnectionPoint=function(c,l){return c.filter(function(y){return y.equals(l)}).length>0},a}(n);h.AStarContext=o},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.SortedQueues=void 0;var m=d(41),P=function(){function p(u){this.getKey=u,this._itemsArrays={},this._sortedKeys=[]}return Object.defineProperty(p.prototype,"sortedKeys",{get:function(){return this._sortedKeys},enumerable:!1,configurable:!0}),p.prototype.getQueue=function(u){return this._itemsArrays[u]},p.prototype.enqueue=function(u){var s=this.getKey(u);this._itemsArrays[s]===void 0?(this._itemsArrays[s]=[u],this.addSortedKey(s)):this._itemsArrays[s].push(u)},p.prototype.remove=function(u){var s=this.getKey(u),i=this._itemsArrays[s];i!==void 0&&(i.length?i[0]===u?(i.shift(),i.length||this.removeCore(s)):this._itemsArrays[s]=i.filter(function(t){return t!==u}):this.removeCore(s))},p.prototype.dequeueMin=function(){if(this._sortedKeys.length){var u=this._sortedKeys[0],s=this._itemsArrays[u],i=s.shift();return s.length||this.removeCore(u),i}},p.prototype.removeCore=function(u){delete this._itemsArrays[u],this.removeSortedKey(u)},p.prototype.removeSortedKey=function(u){var s=m.SearchUtils.binaryIndexOf(this._sortedKeys,function(i){return i-u});s>=0&&this.sortedKeys.splice(s,1)},p.prototype.addSortedKey=function(u){var s=m.SearchUtils.binaryIndexOf(this._sortedKeys,function(i){return i-u});s<0&&this._sortedKeys.splice(-(s+1),0,u)},p}();h.SortedQueues=P},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.UniqueAStarNodePositions=void 0;var m=function(){function P(p){p===void 0&&(p=function(u){return u.toString()}),this.getKey=p,this.items={}}return Object.defineProperty(P.prototype,"count",{get:function(){return Object.keys(this.items).length},enumerable:!1,configurable:!0}),P.prototype.getNode=function(p){var u=this.items[this.getKey(p)];return u!==void 0?u.node:void 0},P.prototype.add=function(p,u){var s=this.getKey(p);this.items[s]===void 0&&(this.items[s]={position:p,node:u})},P.prototype.remove=function(p){var u=this.getKey(p);this.items[u]!==void 0&&delete this.items[u]},P}();h.UniqueAStarNodePositions=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.AStarNode=void 0;var m=function(){function P(p,u){this.position=p,this.distance=u,this.penalty=0}return Object.defineProperty(P.prototype,"key",{get:function(){return this.distance+this.penalty},enumerable:!1,configurable:!0}),P.prototype.getPath=function(){for(var p=[],u=this;u!==void 0;)p.splice(0,0,u.position),u=u.parent;return p},P}();h.AStarNode=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.AStarCalculator=void 0;var m=function(){function P(){}return P.calculate=function(p){if(p)for(var u=this.start(p);u;)u=u(p)},P.start=function(p){return p.start(),p.shouldStartContinue?P.startContinue:P.finishWithPath},P.startContinue=function(p){return p.startContinue(),p.shouldFinish?P.finishWithPath:P.endContinue},P.endContinue=function(p){return p.endContinue(),p.shouldStartContinue?P.startContinue:P.finishWithoutPath},P.finishWithPath=function(p){p.finishWithPath()},P.finishWithoutPath=function(p){p.finishWithoutPath()},P}();h.AStarCalculator=m},function(j,h,d){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ReloadContentParameters=void 0;var m=function(){function P(){this.isEmpty=!0}return P.prototype.add=function(p,u,s){p!==void 0&&(this._dataKeys===void 0&&(this._dataKeys=[]),Array.isArray(p)?this._dataKeys=this._dataKeys.concat(p):this._dataKeys.push(p)),this._getData=this._getData||u,this._layoutParameters=this._layoutParameters||s,this.isEmpty=!1},P.prototype.clear=function(){this.isEmpty=!0,this._dataKeys=void 0,this._getData=void 0,this._layoutParameters=void 0},Object.defineProperty(P.prototype,"empty",{get:function(){return this.isEmpty},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"dataKeys",{get:function(){return this._dataKeys},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"getData",{get:function(){return this._getData},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"layoutParameters",{get:function(){return this._layoutParameters},enumerable:!1,configurable:!0}),P}();h.ReloadContentParameters=m},function(j,h,d){}])})})(mt,mt.exports);var xt=mt.exports;const _t=It(xt),Mt=wt({__proto__:null,default:_t},[xt]);export{_t as D,Mt as a};
