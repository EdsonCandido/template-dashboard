import{_ as I,a as Me}from"./@babel-EnWrEA7o.js";import{r as n}from"./react-DvpkfkhJ.js";import"./prop-types-CjdIqZjW.js";import{F as We,a as Ge,f as Be,g as Ae,b as Z,m as ee,c as re,e as De,d as je,h as He,i as qe,j as Ue,k as te,l as ke}from"./focus-lock-B6tW63jD.js";import{u as _e}from"./use-callback-ref-DQzgWeaL.js";import{c as j,a as Ve}from"./use-sidecar-TqgxduIf.js";import{w as ze}from"./react-clientside-effect-5lQa3ANZ.js";var C={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Je=function(e){var r=e.children,o=r===void 0?null:r;return n.createElement(n.Fragment,null,n.createElement("div",{key:"guard-first","data-focus-guard":!0,"data-focus-auto-guard":!0,style:C}),o,o&&n.createElement("div",{key:"guard-last","data-focus-guard":!0,"data-focus-auto-guard":!0,style:C}))};Je.propTypes={};var oe=j({},function(t){var e=t.target,r=t.currentTarget;return{target:e,currentTarget:r}}),ne=j(),ue=j(),Ke=Ve({async:!0,ssr:typeof document<"u"}),Qe=n.createContext(void 0),Xe=[],H=n.forwardRef(function(e,r){var o,u=n.useState(),s=u[0],a=u[1],c=n.useRef(),v=n.useRef(!1),h=n.useRef(null),b=n.useState({}),L=b[1],d=e.children,E=e.disabled,l=E===void 0?!1:E,N=e.noFocusGuards,p=N===void 0?!1:N,T=e.persistentFocus,m=T===void 0?!1:T,f=e.crossFrame,g=f===void 0?!0:f,O=e.autoFocus,G=O===void 0?!0:O,Tr=e.allowTextSelection,pe=e.group,me=e.className,Fe=e.whiteList,Ee=e.hasPositiveIndices,_=e.shards,B=_===void 0?Xe:_,V=e.as,he=V===void 0?"div":V,z=e.lockProps,ye=z===void 0?{}:z,be=e.sideCar,J=e.returnFocus,$=J===void 0?!1:J,Te=e.focusOptions,A=e.onActivation,D=e.onDeactivation,ge=n.useState({}),xe=ge[0],Se=n.useCallback(function(F){var x=F.captureFocusRestore;if(!h.current){var S,y=(S=document)==null?void 0:S.activeElement;h.current=y,y!==document.body&&(h.current=x(y))}c.current&&A&&A(c.current),v.current=!0,L()},[A]),Pe=n.useCallback(function(){v.current=!1,D&&D(c.current),L()},[D]),we=n.useCallback(function(F){var x=h.current;if(x){var S=(typeof x=="function"?x():x)||document.body,y=typeof $=="function"?$(S):$;if(y){var Q=typeof y=="object"?y:void 0;h.current=null,F?Promise.resolve().then(function(){return S.focus(Q)}):S.focus(Q)}}},[$]),Ie=n.useCallback(function(F){v.current&&oe.useMedium(F)},[]),Le=ne.useMedium,Ce=n.useCallback(function(F){c.current!==F&&(c.current=F,a(F))},[]),Re=I((o={},o[We]=l&&"disabled",o[Ge]=pe,o),ye),K=p!==!0,Ne=K&&p!=="tail",Oe=_e([r,Ce]),$e=n.useMemo(function(){return{observed:c,shards:B,enabled:!l,active:v.current}},[l,v.current,B,s]);return n.createElement(n.Fragment,null,K&&[n.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:l?-1:0,style:C}),Ee?n.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:l?-1:1,style:C}):null],!l&&n.createElement(be,{id:xe,sideCar:Ke,observed:s,disabled:l,persistentFocus:m,crossFrame:g,autoFocus:G,whiteList:Fe,shards:B,onActivation:Se,onDeactivation:Pe,returnFocus:we,focusOptions:Te,noFocusGuards:p}),n.createElement(he,I({ref:Oe},Re,{className:me,onBlur:Le,onFocus:Ie}),n.createElement(Qe.Provider,{value:$e},d)),Ne&&n.createElement("div",{"data-focus-guard":!0,tabIndex:l?-1:0,style:C}))});H.propTypes={};function q(t){setTimeout(t,1)}var U=function(e,r){var o={};return o[e]=r,o},Ye=function(e){return e&&"current"in e?e.current:e},se=function(){return document&&document.activeElement===document.body},Ze=function(){return se()||Be()},P=null,i=null,X=function(){return null},w=null,R=!1,k=!1,er=function(){return!0},rr=function(e){return(P.whiteList||er)(e)},tr=function(e,r){w={observerNode:e,portaledElement:r}},or=function(e){return w&&w.portaledElement===e};function Y(t,e,r,o){var u=null,s=t;do{var a=o[s];if(a.guard)a.node.dataset.focusAutoGuard&&(u=a);else if(a.lockItem){if(s!==t)return;u=null}else break}while((s+=r)!==e);u&&(u.node.tabIndex=0)}var nr=function(e){return e?!!R:R==="meanwhile"},ur=function t(e,r,o){return r&&(r.host===e&&(!r.activeElement||o.contains(r.activeElement))||r.parentNode&&t(e,r.parentNode,o))},sr=function(e,r){return r.some(function(o){return ur(e,o,o)})},ae=function(e){return Ae(e,new Map)},ar=function(e){return!ae([e.parentNode]).some(function(r){return r.node===e})},M=function(){var e=!1;if(P){var r=P,o=r.observed,u=r.persistentFocus,s=r.autoFocus,a=r.shards,c=r.crossFrame,v=r.focusOptions,h=r.noFocusGuards,b=o||w&&w.portaledElement;if(se()&&i&&(!document.body.contains(i)||ar(i))){i=null;var L=X();L&&L.focus()}var d=document&&document.activeElement;if(b){var E=[b].concat(a.map(Ye).filter(Boolean)),l=function(){if(!nr(c)||!h||!i||k)return!1;var f=ae(E),g=f.findIndex(function(O){var G=O.node;return G===i});return g===0||g===f.length-1};if((!d||rr(d))&&(u||l()||!Ze()||!i&&s)&&(b&&!(Z(E)||d&&sr(d,E)||or(d,b))&&(document&&!i&&d&&!s?(d.blur&&d.blur(),document.body.focus()):(e=ee(E,i,{focusOptions:v}),w={})),R=!1,i=document&&document.activeElement,X=re(i)),document&&d!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var N=document&&document.activeElement,p=De(E),T=p.map(function(m){var f=m.node;return f}).indexOf(N);T>-1&&(p.filter(function(m){var f=m.guard,g=m.node;return f&&g.dataset.focusAutoGuard}).forEach(function(m){var f=m.node;return f.removeAttribute("tabIndex")}),Y(T,p.length,1,p),Y(T,-1,-1,p))}}}return e},ce=function(e){M()&&e&&(e.stopPropagation(),e.preventDefault())},W=function(){return q(M)},ie=function(e){var r=e.target,o=e.currentTarget;o.contains(r)||tr(o,r)},cr=function(){return null},ir=function(e){var r=e.children;return n.createElement("div",{onBlur:W,onFocus:ie},r)};ir.propTypes={};var de=function(){k=!0},fe=function(){k=!1,R="just",q(function(){R="meanwhile"})},dr=function(){document.addEventListener("focusin",ce),document.addEventListener("focusout",W),window.addEventListener("focus",de),window.addEventListener("blur",fe)},fr=function(){document.removeEventListener("focusin",ce),document.removeEventListener("focusout",W),window.removeEventListener("focus",de),window.removeEventListener("blur",fe)};function lr(t){return t.filter(function(e){var r=e.disabled;return!r})}var le={moveFocusInside:ee,focusInside:Z,focusNextElement:je,focusPrevElement:He,focusFirstElement:qe,focusLastElement:Ue,captureFocusRestore:re};function vr(t){var e=t.slice(-1)[0];e&&!P&&dr();var r=P,o=r&&e&&e.id===r.id;P=e,r&&!o&&(r.onDeactivation(),t.filter(function(u){var s=u.id;return s===r.id}).length||r.returnFocus(!e)),e?(i=null,(!o||r.observed!==e.observed)&&e.onActivation(le),M(!0),q(M)):(fr(),i=null)}oe.assignSyncMedium(ie);ne.assignMedium(W);ue.assignMedium(function(t){return t(le)});const pr=ze(lr,vr)(cr);var mr=n.forwardRef(function(e,r){return n.createElement(H,I({sideCar:pr,ref:r},e))}),ve=H.propTypes||{},Nr=ve.sideCar,Or=Me(ve,["sideCar"]);mr.propTypes={};var Fr=function(e){var r=e.disabled,o=r===void 0?!1:r,u=e.children,s=e.className,a=s===void 0?void 0:s;return n.createElement("div",I({},U(te,!o),{className:a}),u)};Fr.propTypes={};var Er=function(e){n.useEffect(function(){var r=!0;return ue.useMedium(function(o){var u=e&&e.current;r&&u&&(o.focusInside(u)||o.moveFocusInside(u,null))}),function(){r=!1}},[e])};function hr(t){var e=t.disabled,r=e===void 0?!1:e,o=t.className,u=t.children,s=n.useRef(null);return Er(r?void 0:s),n.createElement("div",I({},U(te,!r),{ref:s,className:o}),u)}hr.propTypes={};var yr=function(e){var r=e.children,o=e.className;return n.createElement("div",I({},U(ke,!0),{className:o}),r)};yr.propTypes={};var br=function(){return{emit:function(r){for(var o=arguments.length,u=new Array(o>1?o-1:0),s=1;s<o;s++)u[s-1]=arguments[s];for(var a=0,c=this.events[r]||[],v=c.length;a<v;a++)c[a].apply(c,u)},events:{},on:function(r,o){var u,s=this;return((u=this.events)[r]||(u[r]=[])).push(o),function(){var a;s.events[r]=(a=s.events[r])==null?void 0:a.filter(function(c){return o!==c})}}}},$r=br();export{mr as F};
