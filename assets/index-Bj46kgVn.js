import{j as e,r as o}from"./react-DvpkfkhJ.js";import{S as $,T as h,m as ue,r as me,n as pe,s as xe,t as he,v as fe,F as n,I as P,w as K,x as Q,B as F,y as X,z as Y,E as G,G as ge}from"./@chakra-ui-C9DuU7ys.js";import{d as je}from"./react-icons-BlHos5WE.js";import{d as we,P as ve,S as Se,a as be,b as Ce,C as g,B as ye}from"./devextreme-react-DHTNyOwS.js";import{L as Z,d as De,f as ee}from"./index-CjR_1hqN.js";import{u as se}from"./index-Ds7_Wb9Z.js";import{B as p}from"./react-toastify-Cqs8j3S4.js";import{e as Pe}from"./react-router-Bo5PTHDi.js";import"./@babel-EnWrEA7o.js";import"./lodash.mergewith-MzEnzzL6.js";import"./copy-to-clipboard-B5MxSLyl.js";import"./toggle-selection-D00ubgGT.js";import"./@zag-js-CSdeJI-4.js";import"./framesync-DZVyisK4.js";import"./color2k-C2CVZzAR.js";import"./@emotion-C5Sm4HH8.js";import"./stylis-DVCB9w4v.js";import"./hoist-non-react-statics-DDprGHWZ.js";import"./react-is-dWBEnTxV.js";import"./framer-motion-B4PBGtp1.js";import"./react-fast-compare-BL8hGDR_.js";import"./react-dom-CF0dK92T.js";import"./scheduler-Cli78dbN.js";import"./react-focus-lock-o1DDLFEd.js";import"./prop-types-CjdIqZjW.js";import"./focus-lock-B6tW63jD.js";import"./use-callback-ref-DQzgWeaL.js";import"./use-sidecar-TqgxduIf.js";import"./tslib-PVoL_lNK.js";import"./detect-node-es-vyeUQQMA.js";import"./react-clientside-effect-5lQa3ANZ.js";import"./@popperjs-VWH4A8P6.js";import"./aria-hidden-JgPW08nP.js";import"./react-remove-scroll-BQ-6cI2l.js";import"./react-remove-scroll-bar-EDN2jL_s.js";import"./react-style-singleton-zeAVULNG.js";import"./get-nonce-CgXfylQE.js";import"./devextreme-C0VZ1woi.js";import"./devexpress-diagram-LzCszTuq.js";import"./jszip-Crv7fNFW.js";import"./devexpress-gantt-DPmbUJ3C.js";import"./devextreme-quill-CVQqOFz3.js";import"./rrule-mVpBVL30.js";import"./inferno-B6I4Zw_M.js";import"./@devextreme-JjotehCy.js";import"./inferno-create-element-BMpTjFue.js";import"./date-fns-KlCNVD47.js";import"./next-themes-DiVf4tRQ.js";import"./react-router-dom-DUfO2FZg.js";import"./@remix-run-CDfvuXmI.js";import"./axios--aCgW92I.js";import"./rsuite-CY3zEWee.js";import"./classnames-D1gig9Ag.js";import"./lodash-CJT0cwKt.js";import"./@rsuite-DzjRYDZ2.js";import"./dom-lib-9y2JbmSD.js";import"./@juggle-C8OzoCMD.js";import"./react-window-BAMTUyjQ.js";import"./memoize-one-CcMeOnPo.js";import"./schema-typed-pIcAd6pZ.js";import"./get-value-At7x-fOk.js";import"./isobject-CEi73sWr.js";import"./set-value-CHDA_Ij2.js";import"./is-primitive-DHkDp9ST.js";import"./is-plain-object-D4VpqrHc.js";import"./react-use-set-D9zgYVzE.js";import"./rsuite-table-nYf0olwj.js";import"./clsx-B-dksMZM.js";const Fe=({isLoadingPage:t,dataFormat:l,onPressModal:i})=>{const r=a=>{i(a)},c=a=>e.jsx(e.Fragment,{children:e.jsx("p",{style:{backgroundColor:a?"#38a169":"#e53e3e",borderRadius:"5px",color:"white",textAlign:"center",height:"20px",paddingRight:"5px",paddingLeft:"5px"},children:a?"Sim":"Não"})});return e.jsx(e.Fragment,{children:t?e.jsx($,{w:"100%",bg:"white",borderRadius:"5px",p:"10px",gap:"10px",boxShadow:"lg",children:e.jsx(Z,{})}):e.jsx($,{w:"100%",bg:"white",borderRadius:"5px",p:"10px",gap:"10px",boxShadow:"lg",children:e.jsxs(we.DataGrid,{dataSource:l,keyExpr:"cod",width:"100%",height:"35hw",hoverStateEnabled:!0,showRowLines:!0,allowColumnResizing:!0,columnAutoWidth:!0,showBorders:!0,children:[e.jsx(ve,{showPageSizeSelector:!0,showNavigationButtons:!0,showInfo:!0,infoText:"Total de itens: {2} ",visible:!0}),e.jsx(Se,{visible:!0}),e.jsx(be,{defaultPageSize:25,enabled:!0}),e.jsx(Ce,{mode:"single"}),e.jsx(g,{caption:" - ",dataField:"cod",alignment:"center",fixedPosition:"right",type:"buttons",width:"50px",allowResizing:!1,children:e.jsx(ye,{icon:"search",onClick:a=>{r(a.row.data.cod)}})}),e.jsx(g,{caption:"Criado em.",dataField:"created_at",minWidth:100,cellRender:a=>e.jsxs(h,{children:[" ",De(a.value,"dd/MM/yyyy")]})}),e.jsx(g,{caption:"Usuário",dataField:"nome",minWidth:110,alignment:"center",cellRender:a=>e.jsx(h,{children:a.value})}),e.jsx(g,{caption:"Login",alignment:"center",dataField:"login"}),e.jsx(g,{caption:"CPF",alignment:"center",dataField:"cpf",cellRender:a=>e.jsx(h,{children:ee(a.value)})}),e.jsx(g,{caption:"Admin",alignment:"center",dataField:"is_admin",cellRender:a=>c(a.value)}),e.jsx(g,{caption:"Ativo",alignment:"center",dataField:"is_ativo",cellRender:a=>c(a.value)}),e.jsx(g,{caption:"Primeiro Acesso",alignment:"center",dataField:"is_primeiro_acesso",cellRender:a=>c(a.value)})]})})})};function Le(t,l){const[i,r]=o.useState(t);return o.useEffect(()=>{const c=setTimeout(()=>{r(t)},l);return()=>{clearTimeout(c)}},[t,l]),i}function W(t){if(typeof t!="string"||(t=t.replace(/[\s.-]*/gim,""),!t||t.length!==11||t==="00000000000"||t==="11111111111"||t==="22222222222"||t==="33333333333"||t==="44444444444"||t==="55555555555"||t==="66666666666"||t==="77777777777"||t==="88888888888"||t==="99999999999"))return!1;let l=0,i;for(let r=1;r<=9;r++)l=l+parseInt(t.substring(r-1,r))*(11-r);if(i=l*10%11,(i===10||i===11)&&(i=0),i!==parseInt(t.substring(9,10)))return!1;l=0;for(let r=1;r<=10;r++)l=l+parseInt(t.substring(r-1,r))*(12-r);return i=l*10%11,(i===10||i===11)&&(i=0),i===parseInt(t.substring(10,11))}const Ae=t=>`${t}`.replace(/\D/g,""),_e=({onSuccess:t,isOpen:l,userId:i,setIsOpenModal:r,setUserId:c})=>{const{validLogin:a,createNewUser:L,findUser:A}=se(),[f,_]=o.useState(!1),[u,j]=o.useState(!1),[y,d]=o.useState(""),[w,E]=o.useState(""),[M,R]=o.useState(!0),[T,N]=o.useState(!1),[U,z]=o.useState(!1),[x,q]=o.useState(""),[te,B]=o.useState(!1),[v,ie]=o.useState(""),[D,oe]=o.useState(""),[k,H]=o.useState(!1),V=Le(w,500),[I,J]=o.useState(!0),[ae,re]=o.useState(!1),b=o.useMemo(()=>{const s={valid:!0,message:""};if(v.length>3||D.length>3){if(i&&v.length<1)return s;D!=v&&(s.message="As senhas não são iguais",s.valid=!1)}return s},[D,v,i]),ne=async()=>{j(!0),p.dismiss();let s=!1;if(y.length<1&&(p.warn("Nome do usuário não pode ser vazio",{position:"top-left"}),s=!0),b.valid||(p.warn(b.message,{position:"top-left"}),s=!0),D.length<1&&v.length<1&&!i&&(p.warn("Senha do usuário nao pode ser vazia",{position:"top-left"}),s=!0),(w.length<5||!w.includes("@"))&&(p.warn("Login inválido, tente outro",{position:"top-left"}),s=!0),I===!1&&(p.warn("Login inválido, tente outro",{position:"top-left"}),s=!0),x.length<1&&(p.warn("CPf não pode ser vazio",{position:"top-left"}),s=!0),s){p.warn("Preença todos os campos corretamente",{position:"top-left"}),setTimeout(()=>{j(!1)},1500);return}const m={cod:i||void 0,is_ativo:M?1:0,is_admin:T?1:0,is_primeiro_acesso:U?1:0,cpf:Ae(x),login:w,senha:v,nome:y},C=await L(m);C.success?(p.success("Usuário cadastrado com sucesso!"),j(!1),O()):(console.error(C),p.warn(C.message)),j(!1),await t()},le=async()=>{var s,m,C;if(i){const S=await A(i);S.success&&(d(S.data.nome),E(S.data.login),R(!!((s=S.data)!=null&&s.is_ativo)),N(!!((m=S.data)!=null&&m.is_admin)),z(!!((C=S.data)!=null&&C.is_primeiro_acesso)),q(S.data.cpf))}},O=()=>{d(""),E(""),R(!1),N(!1),r(!1),z(!1),c(null)},de=async()=>{_(!0),i&&(await le(),re(!0)),_(!1)},ce=async s=>{const m=await a(s);return!!(m!=null&&m.data)};return o.useEffect(()=>{x.length>10?(W(x)&&B(!1),W(x)===!1&&B(!0)):B(!0)},[x]),o.useEffect(()=>{(async()=>{if(V.length>3){const m=await ce(V);ae||(m&&J(!1),m||J(!0))}})()},[V]),o.useEffect(()=>{l&&de()},[l]),e.jsxs(ue,{onClose:O,closeOnOverlayClick:!1,closeOnEsc:!1,isOpen:l,size:"sm",children:[e.jsx(me,{}),e.jsxs(pe,{children:[e.jsx(xe,{}),e.jsx(he,{as:"p",children:i?"Editar Usuário":"Novo Usuário"}),e.jsx(fe,{children:f?e.jsx(Z,{}):e.jsxs(n,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(n,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(n,{children:[e.jsx(h,{children:"Nome"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(P,{isDisabled:u,value:y,onChange:s=>d(s.target.value),type:"text"})]}),e.jsxs(n,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(n,{children:[e.jsx(h,{children:"Login"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("span",{style:{fontSize:"14px"},children:"Seu login deve ser uma e-mail válido."}),e.jsx(P,{isDisabled:u,placeholder:"exemple@exemple.com",value:w,onChange:s=>E(s.target.value),type:"text",isInvalid:!I}),!I&&e.jsx("span",{style:{color:"red"},children:"Email já cadastrado"})]}),e.jsxs(n,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(n,{children:[e.jsx(h,{children:"CPF"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(P,{isDisabled:u,value:ee(x),onChange:s=>q(s.target.value),type:"text"}),x.length>10&&!W(x)&&e.jsx("span",{style:{color:"red"},children:"CPF inválido"})]}),e.jsxs(n,{align:"flex-end",justify:"center",children:[e.jsxs(n,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(n,{children:[e.jsx(h,{children:"Senha"}),!i&&e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(K,{children:[e.jsx(P,{isDisabled:u,isInvalid:!b.valid,onChange:s=>ie(s.target.value),value:v,type:k?"text":"password"}),e.jsx(Q,{h:"full",children:e.jsx(F,{variant:"ghost",onClick:()=>H(s=>!s),children:k?e.jsx(X,{}):e.jsx(Y,{})})})]})]}),e.jsxs(n,{w:"100%",py:1,gap:1,flexDir:"column",children:[e.jsxs(n,{children:[e.jsx(h,{children:"Confirmação de Senha"}),!i&&e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(K,{children:[e.jsx(P,{isDisabled:u,isInvalid:!b.valid,onChange:s=>oe(s.target.value),value:D,type:k?"text":"password"}),e.jsx(Q,{h:"full",children:e.jsx(F,{variant:"ghost",onClick:()=>H(s=>!s),children:k?e.jsx(X,{}):e.jsx(Y,{})})})]})]})]}),i&&e.jsx("small",{children:"Caso não queira mudar a senha atual, deixe em branco"}),!b.valid&&e.jsx(n,{w:"100%",justify:"center",mb:"20px",children:e.jsx("span",{style:{color:"red"},children:b.message})}),e.jsxs(n,{gap:3,p:1,children:[e.jsx(G,{isDisabled:u,value:M?1:0,defaultChecked:M,onChange:s=>R(s.target.checked),children:"Ativo"}),e.jsx(G,{isDisabled:u,value:T?1:0,defaultChecked:T,onChange:s=>N(s.target.checked),children:"Admin"}),e.jsx(G,{isDisabled:u,value:U?1:0,defaultChecked:U,onChange:s=>z(s.target.checked),children:"Primeiro Acesso"})]})]})}),e.jsx(ge,{children:!f&&e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"outline",mr:3,onClick:O,children:"Cancelar"}),e.jsx(F,{colorScheme:"blue",onClick:ne,disabled:!I||te,children:"Salvar"})]})})]})]})},$s=()=>{const t=Pe(),{listUserAdmin:l}=se(),[i,r]=o.useState(null),[c,a]=o.useState(!1),[L,A]=o.useState(!1),[f,_]=o.useState(null),u=(d=null)=>{A(!0),r(d)},j=async()=>{a(!0);const d=await l();d.success&&_(d==null?void 0:d.data),setTimeout(()=>{a(!1)},1500)},y=o.useMemo(()=>f?f==null?void 0:f.map((d,w)=>({index:w,...d})):[],[f]);return o.useEffect(()=>{j()},[]),e.jsx(e.Fragment,{children:e.jsxs(n,{flexDir:"column",justifyContent:"center",alignItems:"flex-start",gap:"10px",children:[e.jsx(n,{children:e.jsx(h,{cursor:"pointer",onClick:()=>t(-1),_hover:{textDecoration:"underline",color:"blue"},children:" Configurações / Admin / Usuários"})}),e.jsx($,{w:"100%",bg:"white",borderRadius:"5px",p:"10px",gap:"10px",boxShadow:"lg",children:e.jsxs(n,{w:"100%",justify:"space-between",children:[e.jsx(n,{w:"100%"}),e.jsx(n,{w:"100%",justify:"flex-end",children:e.jsx(F,{onClick:()=>u(),isDisabled:c,isLoading:c,colorScheme:"green",size:"sm",leftIcon:e.jsx(je,{}),children:"  Novo "})})]})}),e.jsx(Fe,{dataFormat:y,isLoadingPage:c,onPressModal:u}),L&&e.jsx(_e,{onSuccess:j,isOpen:L,setIsOpenModal:A,setUserId:r,userId:i})]})})};export{$s as default};
