import{j as e,r as i}from"./react-DvpkfkhJ.js";import{S as P,F as o,T as m,m as Q,r as X,n as Y,s as Z,t as ee,v as te,I as _,J as se,G as ae,B as T}from"./@chakra-ui-C9DuU7ys.js";import{e as oe,f as ie,g as re,d as ne}from"./react-icons-BlHos5WE.js";import{h as k,u as le}from"./index-BxOASv8c.js";import{e as ce}from"./react-router-Bo5PTHDi.js";import{d as K,P as de,S as pe,a as ue,b as me,C as S}from"./devextreme-react-DE8YcfHx.js";import{L as G,d as A}from"./index-CjR_1hqN.js";import{B as c}from"./react-toastify-Cqs8j3S4.js";import{I as L}from"./rsuite-CY3zEWee.js";import"./@babel-EnWrEA7o.js";import"./lodash.mergewith-MzEnzzL6.js";import"./copy-to-clipboard-B5MxSLyl.js";import"./toggle-selection-D00ubgGT.js";import"./@zag-js-CSdeJI-4.js";import"./framesync-DZVyisK4.js";import"./color2k-C2CVZzAR.js";import"./@emotion-C5Sm4HH8.js";import"./stylis-DVCB9w4v.js";import"./hoist-non-react-statics-DDprGHWZ.js";import"./react-is-dWBEnTxV.js";import"./framer-motion-B4PBGtp1.js";import"./react-fast-compare-BL8hGDR_.js";import"./react-dom-CF0dK92T.js";import"./scheduler-Cli78dbN.js";import"./react-focus-lock-o1DDLFEd.js";import"./prop-types-CjdIqZjW.js";import"./focus-lock-B6tW63jD.js";import"./use-callback-ref-DQzgWeaL.js";import"./use-sidecar-TqgxduIf.js";import"./tslib-PVoL_lNK.js";import"./detect-node-es-vyeUQQMA.js";import"./react-clientside-effect-5lQa3ANZ.js";import"./@popperjs-VWH4A8P6.js";import"./aria-hidden-JgPW08nP.js";import"./react-remove-scroll-BQ-6cI2l.js";import"./react-remove-scroll-bar-EDN2jL_s.js";import"./react-style-singleton-zeAVULNG.js";import"./get-nonce-CgXfylQE.js";import"./next-themes-DiVf4tRQ.js";import"./react-router-dom-DUfO2FZg.js";import"./@remix-run-CDfvuXmI.js";import"./axios--aCgW92I.js";import"./devextreme-p6K8IRit.js";import"./devexpress-diagram-LzCszTuq.js";import"./jszip-Crv7fNFW.js";import"./devexpress-gantt-DPmbUJ3C.js";import"./devextreme-quill-CVQqOFz3.js";import"./rrule-mVpBVL30.js";import"./inferno-B6I4Zw_M.js";import"./@devextreme-JjotehCy.js";import"./inferno-create-element-BMpTjFue.js";import"./clsx-B-dksMZM.js";import"./classnames-D1gig9Ag.js";import"./lodash-CJT0cwKt.js";import"./@rsuite-DzjRYDZ2.js";import"./dom-lib-9y2JbmSD.js";import"./@juggle-C8OzoCMD.js";import"./react-window-BAMTUyjQ.js";import"./memoize-one-CcMeOnPo.js";import"./schema-typed-pIcAd6pZ.js";import"./get-value-At7x-fOk.js";import"./isobject-CEi73sWr.js";import"./set-value-CHDA_Ij2.js";import"./is-primitive-DHkDp9ST.js";import"./is-plain-object-D4VpqrHc.js";import"./react-use-set-D9zgYVzE.js";import"./rsuite-table-nYf0olwj.js";import"./date-fns-KlCNVD47.js";const xe=({isLoadingPage:D,dataFormat:w,onPressModal:d,onSuccess:b})=>{const v=t=>{d(t)},y=t=>e.jsx(e.Fragment,{children:e.jsx("p",{style:{backgroundColor:t?"#38a169":"#e53e3e",borderRadius:"5px",color:"white",textAlign:"center",height:"20px",paddingRight:"5px",paddingLeft:"5px"},children:t?"Sim":"Não"})}),f=async(t,n)=>{const g=await k.delete("banners/"+t).then(l=>({data:l.data,success:!0,error:null,message:"OK"})).catch(l=>{var x,j;return{data:null,success:!1,error:(x=l.response)==null?void 0:x.data,message:((j=l.response)==null?void 0:j.data)||l.message}});g.success?(c.success(`Banner ${n===1?"desativado":"ativado"} com sucesso`),await b()):c.error(g.message)};return e.jsx(e.Fragment,{children:D?e.jsx(P,{w:"100%",bg:"white",borderRadius:"5px",p:"10px",gap:"10px",boxShadow:"lg",children:e.jsx(G,{})}):e.jsx(P,{w:"100%",bg:"white",borderRadius:"5px",p:"10px",gap:"10px",boxShadow:"lg",children:e.jsxs(K.DataGrid,{dataSource:w,keyExpr:"cod",width:"100%",height:"35hw",hoverStateEnabled:!0,showRowLines:!0,allowColumnResizing:!0,columnAutoWidth:!0,showBorders:!0,children:[e.jsx(de,{showPageSizeSelector:!0,showNavigationButtons:!0,showInfo:!0,infoText:"Total de itens: {2} ",visible:!0}),e.jsx(pe,{visible:!0}),e.jsx(ue,{defaultPageSize:25,enabled:!0}),e.jsx(me,{mode:"single"}),e.jsx(S,{caption:" - ",dataField:"cod",alignment:"center",fixedPosition:"right",type:"buttons",width:"120px",allowResizing:!1,cellRender:t=>e.jsxs(o,{gap:3,justifyContent:"center",align:"center",children:[e.jsx(L,{icon:e.jsx(oe,{color:"gray",size:20}),onClick:()=>v(t.row.data.cod)}),t.row.data.is_ativo===0?e.jsx(L,{icon:e.jsx(ie,{color:"#e53e3e",size:20}),onClick:()=>{f(t.row.data.cod,t.row.data.is_ativo)}}):e.jsx(L,{icon:e.jsx(re,{color:"#38a169",size:20}),onClick:()=>f(t.row.data.cod,t.row.data.is_ativo)})]})}),e.jsx(S,{caption:"Criado em.",dataField:"created_at",minWidth:100,cellRender:t=>e.jsxs(m,{children:[" ",A(t.value,"dd/MM/yyyy")]})}),e.jsx(S,{caption:"Título",dataField:"titulo",minWidth:110,alignment:"center",cellRender:t=>e.jsx(m,{children:t.value})}),e.jsx(S,{caption:"Descrição",alignment:"center",dataField:"descricao"}),e.jsx(S,{caption:"Dt. Início",alignment:"center",dataField:"dt_inicio",cellRender:t=>e.jsx(m,{children:A(t.value,"dd/MM/yyyy")})}),e.jsx(S,{caption:"Dt. Fim",alignment:"center",dataField:"dt_fim",cellRender:t=>e.jsx(m,{children:A(t.value,"dd/MM/yyyy")})}),e.jsx(S,{caption:"Ativo",alignment:"center",dataField:"is_ativo",cellRender:t=>y(t.value)})]})})})},he=({onSuccess:D,isOpen:w,bannerId:d,setIsOpenModal:b,setBannerId:v})=>{const[y,f]=i.useState(!1),[t,n]=i.useState(!1),[g,l]=i.useState(""),[x,j]=i.useState(""),[r,C]=i.useState(""),[B,M]=i.useState(""),[U,z]=i.useState(!1),[h,E]=i.useState(),[O,q]=i.useState(""),[I,V]=i.useState(!1),$=async()=>{n(!0),c.dismiss();let s=!1;if(g.length<1&&(c.warn("Título do Banner não pode ser vazio",{position:"top-left"}),s=!0),r.length<1&&(c.warn("Data de inicio não pode ser vazia",{position:"top-left"}),s=!0),B.length<1&&(c.warn("Data final não pode ser vazia",{position:"top-left"}),s=!0),r>B&&(c.warn("Data de inicio nao pode ser maior que a data final",{position:"top-left"}),s=!0),I||h||(c.warn("Você deve anexar um banner",{position:"top-left"}),s=!0),s){c.warn("Preença todos os campos corretamente",{position:"top-left"}),setTimeout(()=>{n(!1)},1500);return}const a=new FormData;a.append("titulo",g),a.append("descricao",x),a.append("dt_inicio",r),a.append("dt_fim",B),I?a.append("is_ativo",U?"1":"0"):a.append("is_ativo","1"),h&&a.append("banner",h),d&&a.append("cod",d.toString());const p=await k.post("/banners/",a,{headers:{"Content-Type":"multipart/form-data"}}).then(u=>({data:u.data,success:!0,error:null,message:"OK"})).catch(u=>{var F,W;return{data:null,success:!1,error:(F=u.response)==null?void 0:F.data,message:((W=u.response)==null?void 0:W.data)||u.message}});p.success?(I?c.success("Banner editado com sucesso!",{position:"top-left"}):c.success("Banner cadastrado com sucesso!",{position:"top-left"}),n(!1),R()):(console.error(p),c.warn(p.message)),n(!1),await D()},N=s=>new Date(s).toISOString().split("T")[0],H=async()=>{var s;if(d){const a=await k.get("/banners/"+d).then(p=>({data:p.data,success:!0,error:null,message:"OK"})).catch(p=>{var u,F;return{data:null,success:!1,error:(u=p.response)==null?void 0:u.data,message:((F=p.response)==null?void 0:F.data)||p.message}});a.success&&(l(a.data.titulo),j(a.data.descricao),z(!!((s=a.data)!=null&&s.is_ativo)),M(N(a.data.dt_fim)),C(N(a.data.dt_inicio)),q(a.data.arquivo))}},R=()=>{l(""),j(""),z(!1),b(!1),M(""),C(""),v(null)},J=async()=>{f(!0),d&&(await H(),V(!0)),f(!1)};return i.useEffect(()=>{w&&J()},[w]),i.useEffect(()=>{h&&(async()=>{if(h){const a=new FileReader;a.onloadend=()=>{const u=a.result.split(",")[1];q(u)},a.readAsDataURL(h)}})()},[h]),e.jsxs(Q,{onClose:R,closeOnOverlayClick:!1,closeOnEsc:!1,isOpen:w,size:"sm",children:[e.jsx(X,{}),e.jsxs(Y,{children:[e.jsx(Z,{}),e.jsx(ee,{as:"p",children:d?"Editar Banner":"Novo Banner"}),e.jsx(te,{children:y?e.jsx(G,{}):e.jsxs(o,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(o,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Título"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(_,{isDisabled:t,value:g,onChange:s=>l(s.target.value),type:"text"})]}),e.jsxs(o,{w:"100%",p:1,gap:1,flexDir:"column",children:[e.jsx(m,{children:"Descrição"}),e.jsx(_,{isDisabled:t,value:x,onChange:s=>j(s.target.value),type:"text"})]}),e.jsxs(o,{children:[e.jsxs(o,{w:"50%",p:1,gap:1,flexDir:"column",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Data Inicio"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(_,{isDisabled:t,value:r,onChange:s=>C(s.target.value),type:"date"})]}),e.jsxs(o,{w:"50%",p:1,gap:1,flexDir:"column",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Data Fim"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(_,{isDisabled:t,value:B,onChange:s=>M(s.target.value),type:"date"})]})]}),e.jsx(o,{p:1,align:"center",children:e.jsxs(o,{direction:"column",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Banner"}),e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(K.FileUploader,{accept:"image/*",value:h?[h]:[],onValueChange:s=>{s&&s[0]?E(s[0]):E(void 0)},uploadMode:"useForm"})]})}),O&&e.jsx(o,{align:"center",justify:"center",children:e.jsx(se,{src:`data:image/jpg;base64,${O}`,alt:"banner",width:"80%"})})]})}),e.jsx(ae,{children:!y&&e.jsxs(e.Fragment,{children:[e.jsx(T,{variant:"outline",mr:3,onClick:R,children:"Cancelar"}),e.jsx(T,{colorScheme:"blue",onClick:$,isDisabled:t,children:"Salvar"})]})})]})]})},It=()=>{const D=ce(),{listBannersAdmin:w}=le(),[d,b]=i.useState(null),[v,y]=i.useState(!1),[f,t]=i.useState(!1),[n,g]=i.useState(null),l=(r=null)=>{t(!0),b(r)},x=async()=>{y(!0);const r=await w();r.success&&g(r==null?void 0:r.data),setTimeout(()=>{y(!1)},1500)},j=i.useMemo(()=>n?n==null?void 0:n.map((r,C)=>({index:C,...r})):[],[n]);return i.useEffect(()=>{x()},[]),e.jsx(e.Fragment,{children:e.jsxs(o,{flexDir:"column",justifyContent:"center",alignItems:"flex-start",gap:"10px",children:[e.jsx(o,{children:e.jsx(m,{cursor:"pointer",onClick:()=>D(-1),_hover:{textDecoration:"underline",color:"blue"},children:" Configurações / Admin / Banners"})}),e.jsx(P,{w:"100%",bg:"white",borderRadius:"5px",p:"10px",gap:"10px",boxShadow:"lg",children:e.jsxs(o,{w:"100%",justify:"space-between",children:[e.jsx(o,{w:"100%"}),e.jsx(o,{w:"100%",justify:"flex-end",children:e.jsx(T,{onClick:()=>l(),isDisabled:v,isLoading:v,colorScheme:"green",size:"sm",leftIcon:e.jsx(ne,{}),children:"  Novo "})})]})}),e.jsx(xe,{dataFormat:j,isLoadingPage:v,onPressModal:l,onSuccess:x}),f&&e.jsx(he,{onSuccess:x,isOpen:f,setIsOpenModal:t,setBannerId:b,bannerId:d})]})})};export{It as default};
